(self.webpackChunkfirstWebAppUserInterface=self.webpackChunkfirstWebAppUserInterface||[]).push([[179],{317:(zt,Ft,xe)=>{"use strict";var tt={};xe.r(tt),xe.d(tt,{assertParamsValid:()=>wA,computeFlatOffset:()=>EA,computeOutShape:()=>SA,getNormalizedAxes:()=>Bve,isSliceContinous:()=>IA,maskToAxes:()=>$ve,parseSliceParams:()=>kC,sliceInfo:()=>kA,startForAxis:()=>Oj,startIndicesWithElidedDims:()=>Mj,stopForAxis:()=>Fj,stopIndicesWithElidedDims:()=>Pj,stridesForAxis:()=>Rj,stridesWithElidedDims:()=>Dj});var Mi={};xe.r(Mi),xe.d(Mi,{collectGatherOpShapeInfo:()=>EM,computeOutShape:()=>BG,segOpComputeOptimalWindowSize:()=>$G});var rt={};xe.r(rt),xe.d(rt,{ERF_A1:()=>hM,ERF_A2:()=>fM,ERF_A3:()=>pM,ERF_A4:()=>mM,ERF_A5:()=>gM,ERF_P:()=>dM,PARALLELIZE_THRESHOLD:()=>oM,RowPartitionType:()=>vo,SELU_SCALE:()=>jC,SELU_SCALEALPHA:()=>HC,applyActivation:()=>BC,assertAndGetBroadcastShape:()=>ft,assertAxesAreInnerMostDims:()=>fs,assertParamsConsistent:()=>rM,assignToTypedArray:()=>CG,axesAreInnerMostDims:()=>FA,calculateShapes:()=>dd,checkEinsumDimSizes:()=>xM,checkPadOnDimRoundingMode:()=>Fs,combineLocations:()=>Gj,combineRaggedTensorToTensorShapes:()=>pG,complexWithEvenIndex:()=>vG,complexWithOddIndex:()=>xG,computeConv2DInfo:()=>es,computeConv3DInfo:()=>Rc,computeDefaultPad:()=>DA,computeDilation2DInfo:()=>Eb,computeOptimalWindowSize:()=>WC,computeOutAndReduceShapes:()=>ts,computeOutShape:()=>La,computePool2DInfo:()=>bo,computePool3DInfo:()=>Il,convertConv2DDataFormat:()=>El,decodeEinsumEquation:()=>yM,eitherStridesOrDilationsAreOne:()=>hs,expandShapeToKeepDim:()=>vi,exponent:()=>SG,exponents:()=>wG,fromStringArrayToUint8:()=>VG,fromUint8ToStringArray:()=>Rl,getAxesPermutation:()=>ti,getBroadcastDims:()=>Rf,getComplexWithIndex:()=>bM,getEinsumComputePath:()=>CM,getEinsumPermutation:()=>vM,getFusedBiasGradient:()=>$C,getFusedDyActivation:()=>LC,getImageCenter:()=>aM,getInnerMostAxes:()=>xi,getPermuted:()=>Bb,getRaggedRank:()=>gG,getReductionAxes:()=>Vi,getReshaped:()=>$b,getReshapedPermuted:()=>Vb,getRowPartitionTypesHelper:()=>mG,getSliceBeginCoords:()=>lM,getSliceSize:()=>cM,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>kG,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>TG,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>DG,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>MG,getSparseReshapeInputOutputMismatchErrorMessage:()=>RG,getSparseReshapeInputOutputMultipleErrorMessage:()=>PG,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>NG,getSparseReshapeNegativeOutputDimErrorMessage:()=>AG,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>LG,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>IM,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>OG,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>FG,getUndoAxesPermutation:()=>Fc,isIdentityPermutation:()=>wM,log:()=>i0e,mergeRealAndImagArrays:()=>Pl,prepareAndValidate:()=>uM,prepareSplitSize:()=>SM,segment_util:()=>Mi,shouldFuse:()=>VC,slice_util:()=>tt,splitRealAndImagArrays:()=>yG,stridesOrDilationsArePositive:()=>od,tupleValuesAreOne:()=>Oc,upcastType:()=>br,validateDefaultValueShape:()=>bG,validateInput:()=>V1e,validateUpdateShape:()=>_G,warn:()=>Lr});var Ln={};function Fe(n){return"function"==typeof n}function Qe(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}xe.r(Ln),xe.d(Ln,{addImpl:()=>p7,bincountImpl:()=>MP,bincountReduceImpl:()=>v7,bitwiseAndImpl:()=>x7,castImpl:()=>f7,ceilImpl:()=>C7,concatImpl:()=>w7,equalImpl:()=>E7,expImpl:()=>T7,expm1Impl:()=>N7,floorDivImpl:()=>R7,floorImpl:()=>P7,gatherNdImpl:()=>O7,gatherV2Impl:()=>F7,greaterEqualImpl:()=>$7,greaterImpl:()=>L7,lessEqualImpl:()=>V7,lessImpl:()=>B7,linSpaceImpl:()=>z7,logImpl:()=>U7,maxImpl:()=>W7,maximumImpl:()=>j7,minimumImpl:()=>G7,multiplyImpl:()=>PP,negImpl:()=>K7,notEqualImpl:()=>X7,prodImpl:()=>J7,raggedGatherImpl:()=>t9,raggedRangeImpl:()=>i9,raggedTensorToTensorImpl:()=>o9,rangeImpl:()=>a9,rsqrtImpl:()=>l9,scatterImpl:()=>xd,sigmoidImpl:()=>uNe,simpleAbsImpl:()=>g7,sliceImpl:()=>y7,sparseFillEmptyRowsImpl:()=>u9,sparseReshapeImpl:()=>d9,sparseSegmentReductionImpl:()=>BP,sqrtImpl:()=>FRe,squaredDifferenceImpl:()=>h9,staticRegexReplaceImpl:()=>f9,stridedSliceImpl:()=>p9,stringNGramsImpl:()=>m9,stringSplitImpl:()=>g9,stringToHashBucketFastImpl:()=>b9,subImpl:()=>A7,tileImpl:()=>_9,topKImpl:()=>v9,transposeImpl:()=>NP,uniqueImpl:()=>C9});const Ct=Qe(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,s)=>`${s+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Oe(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class G{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const r of e)r.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Fe(i))try{i()}catch(r){t=r instanceof Ct?r.errors:[r]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const r of s)try{ce(r)}catch(o){t=t??[],o instanceof Ct?t=[...t,...o.errors]:t.push(o)}}if(t)throw new Ct(t)}}add(t){var e;if(t&&t!==this)if(this.closed)ce(t);else{if(t instanceof G){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Oe(e,t)}remove(t){const{_finalizers:e}=this;e&&Oe(e,t),t instanceof G&&t._removeParent(this)}}G.EMPTY=(()=>{const n=new G;return n.closed=!0,n})();const ye=G.EMPTY;function De(n){return n instanceof G||n&&"closed"in n&&Fe(n.remove)&&Fe(n.add)&&Fe(n.unsubscribe)}function ce(n){Fe(n)?n():n.unsubscribe()}const _e={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},$e={setTimeout(n,t,...e){const{delegate:i}=$e;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=$e;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function je(n){$e.setTimeout(()=>{const{onUnhandledError:t}=_e;if(!t)throw n;t(n)})}function un(){}const os=wr("C",void 0,void 0);function wr(n,t,e){return{kind:n,value:t,error:e}}let Et=null;function qt(n){if(_e.useDeprecatedSynchronousErrorHandling){const t=!Et;if(t&&(Et={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=Et;if(Et=null,e)throw i}}else n()}class be extends G{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,De(t)&&t.add(this)):this.destination=Ei}static create(t,e,i){return new Je(t,e,i)}next(t){this.isStopped?Qt(function aa(n){return wr("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Qt(function Gi(n){return wr("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Qt(os,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ae=Function.prototype.bind;function P(n,t){return ae.call(n,t)}class Ae{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){Lt(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){Lt(i)}else Lt(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Lt(e)}}}class Je extends be{constructor(t,e,i){let s;if(super(),Fe(t)||!t)s={next:t??void 0,error:e??void 0,complete:i??void 0};else{let r;this&&_e.useDeprecatedNextContext?(r=Object.create(t),r.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&P(t.next,r),error:t.error&&P(t.error,r),complete:t.complete&&P(t.complete,r)}):s=t}this.destination=new Ae(s)}}function Lt(n){_e.useDeprecatedSynchronousErrorHandling?function rn(n){_e.useDeprecatedSynchronousErrorHandling&&Et&&(Et.errorThrown=!0,Et.error=n)}(n):je(n)}function Qt(n,t){const{onStoppedNotification:e}=_e;e&&$e.setTimeout(()=>e(n,t))}const Ei={closed:!0,next:un,error:function Rt(n){throw n},complete:un},di="function"==typeof Symbol&&Symbol.observable||"@@observable";function $n(n){return n}function Gs(n){return 0===n.length?$n:1===n.length?n[0]:function(e){return n.reduce((i,s)=>s(i),e)}}let dt=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,s){const r=function wZ(n){return n&&n instanceof be||function Hd(n){return n&&Fe(n.next)&&Fe(n.error)&&Fe(n.complete)}(n)&&De(n)}(e)?e:new Je(e,i,s);return qt(()=>{const{operator:o,source:a}=this;r.add(o?o.call(r,a):a?this._subscribe(r):this._trySubscribe(r))}),r}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Es(i))((s,r)=>{const o=new Je({next:a=>{try{e(a)}catch(l){r(l),o.unsubscribe()}},error:r,complete:s});this.subscribe(o)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[di](){return this}pipe(...e){return Gs(e)(this)}toPromise(e){return new(e=Es(e))((i,s)=>{let r;this.subscribe(o=>r=o,o=>s(o),()=>i(r))})}}return n.create=t=>new n(t),n})();function Es(n){var t;return null!==(t=n??_e.Promise)&&void 0!==t?t:Promise}const SZ=Qe(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ut=(()=>{class n extends dt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new RR(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new SZ}next(e){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:s,observers:r}=this;return i||s?ye:(this.currentObservers=null,r.push(e),new G(()=>{this.currentObservers=null,Oe(r,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:s,isStopped:r}=this;i?e.error(s):r&&e.complete()}asObservable(){const e=new dt;return e.source=this,e}}return n.create=(t,e)=>new RR(t,e),n})();class RR extends Ut{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:ye}}function OR(n){return Fe(n?.lift)}function fi(n){return t=>{if(OR(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Yn(n,t,e,i,s){return new IZ(n,t,e,i,s)}class IZ extends be{constructor(t,e,i,s,r,o){super(t),this.onFinalize=r,this.shouldUnsubscribe=o,this._next=e?function(a){try{e(a)}catch(l){t.error(l)}}:super._next,this._error=s?function(a){try{s(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function lt(n,t){return fi((e,i)=>{let s=0;e.subscribe(Yn(i,r=>{i.next(n.call(t,r,s++))}))})}function du(n){return this instanceof du?(this.v=n,this):new du(n)}function DZ(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function $R(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(r){e[r]=n[r]&&function(o){return new Promise(function(a,l){!function s(r,o,a,l){Promise.resolve(l).then(function(c){r({value:c,done:a})},o)}(a,l,(o=n[r](o)).done,o.value)})}}}const Z1=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function BR(n){return Fe(n?.then)}function VR(n){return Fe(n[di])}function zR(n){return Symbol.asyncIterator&&Fe(n?.[Symbol.asyncIterator])}function UR(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const WR=function AZ(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function HR(n){return Fe(n?.[WR])}function jR(n){return function TZ(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=e.apply(n,t||[]),r=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){i[h]&&(s[h]=function(f){return new Promise(function(p,g){r.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof du?Promise.resolve(h.value.v).then(c,u):d(r[0][2],h)}(i[h](f))}catch(p){d(r[0][3],p)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:s}=yield du(e.read());if(s)return yield du(void 0);yield yield du(i)}}finally{e.releaseLock()}})}function GR(n){return Fe(n?.getReader)}function qs(n){if(n instanceof dt)return n;if(null!=n){if(VR(n))return function MZ(n){return new dt(t=>{const e=n[di]();if(Fe(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Z1(n))return function PZ(n){return new dt(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(BR(n))return function RZ(n){return new dt(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,je)})}(n);if(zR(n))return qR(n);if(HR(n))return function OZ(n){return new dt(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(GR(n))return function FZ(n){return qR(jR(n))}(n)}throw UR(n)}function qR(n){return new dt(t=>{(function LZ(n,t){var e,i,s,r;return function EZ(n,t,e,i){return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?r(u.value):function s(r){return r instanceof e?r:new e(function(o){o(r)})}(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=DZ(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=e.return)&&(yield r.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Qa(n,t,e,i=0,s=!1){const r=t.schedule(function(){e(),s?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(r),!s)return r}function as(n,t,e=1/0){return Fe(t)?as((i,s)=>lt((r,o)=>t(i,r,s,o))(qs(n(i,s))),e):("number"==typeof t&&(e=t),fi((i,s)=>function $Z(n,t,e,i,s,r,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&t.complete()},f=g=>c<i?p(g):l.push(g),p=g=>{r&&t.next(g),c++;let m=!1;qs(e(g,u++)).subscribe(Yn(t,b=>{s?.(b),r?f(b):t.next(b)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;l.length&&c<i;){const b=l.shift();o?Qa(t,o,()=>p(b)):p(b)}h()}catch(b){t.error(b)}}))};return n.subscribe(Yn(t,f,()=>{d=!0,h()})),()=>{a?.()}}(i,s,n,e)))}function jd(n=1/0){return as($n,n)}const la=new dt(n=>n.complete());function KR(n){return n&&Fe(n.schedule)}function Q1(n){return n[n.length-1]}function XR(n){return Fe(Q1(n))?n.pop():void 0}function yp(n){return KR(Q1(n))?n.pop():void 0}function YR(n,t=0){return fi((e,i)=>{e.subscribe(Yn(i,s=>Qa(i,n,()=>i.next(s),t),()=>Qa(i,n,()=>i.complete(),t),s=>Qa(i,n,()=>i.error(s),t)))})}function ZR(n,t=0){return fi((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function QR(n,t){if(!n)throw new Error("Iterable cannot be null");return new dt(e=>{Qa(e,t,()=>{const i=n[Symbol.asyncIterator]();Qa(e,t,()=>{i.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function Pi(n,t){return t?function GZ(n,t){if(null!=n){if(VR(n))return function zZ(n,t){return qs(n).pipe(ZR(t),YR(t))}(n,t);if(Z1(n))return function WZ(n,t){return new dt(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(BR(n))return function UZ(n,t){return qs(n).pipe(ZR(t),YR(t))}(n,t);if(zR(n))return QR(n,t);if(HR(n))return function HZ(n,t){return new dt(e=>{let i;return Qa(e,t,()=>{i=n[WR](),Qa(e,t,()=>{let s,r;try{({value:s,done:r}=i.next())}catch(o){return void e.error(o)}r?e.complete():e.next(s)},0,!0)}),()=>Fe(i?.return)&&i.return()})}(n,t);if(GR(n))return function jZ(n,t){return QR(jR(n),t)}(n,t)}throw UR(n)}(n,t):qs(n)}function q_(...n){const t=yp(n),e=function VZ(n,t){return"number"==typeof Q1(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?qs(i[0]):jd(e)(Pi(i,t)):la}function JR(n={}){const{connector:t=(()=>new Ut),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:s=!0}=n;return r=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return fi((g,m)=>{c++,!d&&!u&&h();const b=l=l??t();m.add(()=>{c--,0===c&&!d&&!u&&(a=J1(p,s))}),b.subscribe(m),!o&&c>0&&(o=new Je({next:_=>b.next(_),error:_=>{d=!0,h(),a=J1(f,e,_),b.error(_)},complete:()=>{u=!0,h(),a=J1(f,i),b.complete()}}),qs(g).subscribe(o))})(r)}}function J1(n,t,...e){if(!0===t)return void n();if(!1===t)return;const i=new Je({next:()=>{i.unsubscribe(),n()}});return qs(t(...e)).subscribe(i)}function Sn(n){for(let t in n)if(n[t]===Sn)return t;throw Error("Could not find renamed property on target object.")}function eS(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function An(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(An).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function tS(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const qZ=Sn({__forward_ref__:Sn});function Mn(n){return n.__forward_ref__=Mn,n.toString=function(){return An(this())},n}function nt(n){return nS(n)?n():n}function nS(n){return"function"==typeof n&&n.hasOwnProperty(qZ)&&n.__forward_ref__===Mn}function iS(n){return n&&!!n.\u0275providers}const K_="https://g.co/ng/security#xss";class re extends Error{constructor(t,e){super(X_(t,e)),this.code=t}}function X_(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}function mt(n){return"string"==typeof n?n:null==n?"":String(n)}function Y_(n,t){throw new re(-201,!1)}function Yr(n,t){null==n&&function hn(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function Pe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Bn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Z_(n){return eO(n,Q_)||eO(n,nO)}function eO(n,t){return n.hasOwnProperty(t)?n[t]:null}function tO(n){return n&&(n.hasOwnProperty(sS)||n.hasOwnProperty(tQ))?n[sS]:null}const Q_=Sn({\u0275prov:Sn}),sS=Sn({\u0275inj:Sn}),nO=Sn({ngInjectableDef:Sn}),tQ=Sn({ngInjectorDef:Sn});var it=(()=>((it=it||{})[it.Default=0]="Default",it[it.Host=1]="Host",it[it.Self=2]="Self",it[it.SkipSelf=4]="SkipSelf",it[it.Optional=8]="Optional",it))();let rS;function Zr(n){const t=rS;return rS=n,t}function iO(n,t,e){const i=Z_(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&it.Optional?null:void 0!==t?t:void Y_(An(n))}const Vn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),vp={},oS="__NG_DI_FLAG__",J_="ngTempTokenPath",iQ="ngTokenPath",sQ=/\n/gm,rQ="\u0275",sO="__source";let xp;function Gd(n){const t=xp;return xp=n,t}function oQ(n,t=it.Default){if(void 0===xp)throw new re(-203,!1);return null===xp?iO(n,void 0,t):xp.get(n,t&it.Optional?null:void 0,t)}function me(n,t=it.Default){return(function nQ(){return rS}()||oQ)(nt(n),t)}function ht(n,t=it.Default){return me(n,ey(t))}function ey(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function aS(n){const t=[];for(let e=0;e<n.length;e++){const i=nt(n[e]);if(Array.isArray(i)){if(0===i.length)throw new re(900,!1);let s,r=it.Default;for(let o=0;o<i.length;o++){const a=i[o],l=aQ(a);"number"==typeof l?-1===l?s=a.token:r|=l:s=a}t.push(me(s,r))}else t.push(me(i))}return t}function Cp(n,t){return n[oS]=t,n.prototype[oS]=t,n}function aQ(n){return n[oS]}function Ja(n){return{toString:n}.toString()}var ca=(()=>((ca=ca||{})[ca.OnPush=0]="OnPush",ca[ca.Default=1]="Default",ca))(),Do=(()=>{return(n=Do||(Do={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Do;var n})();const el={},on=[],ty=Sn({\u0275cmp:Sn}),lS=Sn({\u0275dir:Sn}),cS=Sn({\u0275pipe:Sn}),oO=Sn({\u0275mod:Sn}),tl=Sn({\u0275fac:Sn}),wp=Sn({__NG_ELEMENT_ID__:Sn});let uQ=0;function Zn(n){return Ja(()=>{const t=lO(n),e={...t,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ca.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||Do.Emulated,id:"c"+uQ++,styles:n.styles||on,_:null,schemas:n.schemas||null,tView:null};cO(e);const i=n.dependencies;return e.directiveDefs=ny(i,!1),e.pipeDefs=ny(i,!0),e})}function hQ(n){return fn(n)||ks(n)}function fQ(n){return null!==n}function Qn(n){return Ja(()=>({type:n.type,bootstrap:n.bootstrap||on,declarations:n.declarations||on,imports:n.imports||on,exports:n.exports||on,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function aO(n,t){if(null==n)return el;const e={};for(const i in n)if(n.hasOwnProperty(i)){let s=n[i],r=s;Array.isArray(s)&&(r=s[1],s=s[0]),e[s]=i,t&&(t[s]=r)}return e}function Ze(n){return Ja(()=>{const t=lO(n);return cO(t),t})}function lr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function fn(n){return n[ty]||null}function ks(n){return n[lS]||null}function cr(n){return n[cS]||null}function Ir(n,t){const e=n[oO]||null;if(!e&&!0===t)throw new Error(`Type ${An(n)} does not have '\u0275mod' property.`);return e}function lO(n){const t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||on,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:aO(n.inputs,t),outputs:aO(n.outputs)}}function cO(n){n.features?.forEach(t=>t(n))}function ny(n,t){if(!n)return null;const e=t?cr:hQ;return()=>("function"==typeof n?n():n).map(i=>e(i)).filter(fQ)}const nl=0,Le=1,wt=2,pi=3,No=4,hu=5,Ts=6,Kd=7,ki=8,iy=9,sy=10,kt=11,uS=12,Sp=13,uO=14,Xd=15,Ds=16,Ip=17,Yd=18,ua=19,Ep=20,dO=21,zn=22,dS=1,hO=2,ry=7,oy=8,Zd=9,Ks=10;function Er(n){return Array.isArray(n)&&"object"==typeof n[dS]}function Ao(n){return Array.isArray(n)&&!0===n[dS]}function hS(n){return 0!=(4&n.flags)}function kp(n){return n.componentOffset>-1}function ay(n){return 1==(1&n.flags)}function Mo(n){return!!n.template}function mQ(n){return 0!=(256&n[wt])}function fu(n,t){return n.hasOwnProperty(tl)?n[tl]:null}class _Q{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function kr(){return mO}function mO(n){return n.type.prototype.ngOnChanges&&(n.setInput=vQ),yQ}function yQ(){const n=bO(this),t=n?.current;if(t){const e=n.previous;if(e===el)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function vQ(n,t,e,i){const s=this.declaredInputs[e],r=bO(n)||function xQ(n,t){return n[gO]=t}(n,{previous:el,current:null}),o=r.current||(r.current={}),a=r.previous,l=a[s];o[s]=new _Q(l&&l.currentValue,t,a===el),n[i]=t}kr.ngInherit=!0;const gO="__ngSimpleChanges__";function bO(n){return n[gO]||null}const Qr=function(n,t,e){};function bs(n){for(;Array.isArray(n);)n=n[nl];return n}function ly(n,t){return bs(t[n])}function Tr(n,t){return bs(t[n.index])}function vO(n,t){return n.data[t]}function Qd(n,t){return n[t]}function ur(n,t){const e=t[n];return Er(e)?e:e[nl]}function cy(n){return 64==(64&n[wt])}function Yl(n,t){return null==t?null:n[t]}function xO(n){n[Yd]=0}function pS(n,t){n[hu]+=t;let e=n,i=n[pi];for(;null!==i&&(1===t&&1===e[hu]||-1===t&&0===e[hu]);)i[hu]+=t,e=i,i=i[pi]}const gt={lFrame:AO(null),bindingsEnabled:!0};function wO(){return gt.bindingsEnabled}function fe(){return gt.lFrame.lView}function Kt(){return gt.lFrame.tView}function Un(n){return gt.lFrame.contextLView=n,n[ki]}function Wn(n){return gt.lFrame.contextLView=null,n}function _s(){let n=SO();for(;null!==n&&64===n.type;)n=n.parent;return n}function SO(){return gt.lFrame.currentTNode}function da(n,t){const e=gt.lFrame;e.currentTNode=n,e.isParent=t}function mS(){return gt.lFrame.isParent}function gS(){gt.lFrame.isParent=!1}function Xs(){const n=gt.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function il(){return gt.lFrame.bindingIndex}function Jd(){return gt.lFrame.bindingIndex++}function sl(n){const t=gt.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function RQ(n,t){const e=gt.lFrame;e.bindingIndex=e.bindingRootIndex=n,bS(t)}function bS(n){gt.lFrame.currentDirectiveIndex=n}function TO(){return gt.lFrame.currentQueryIndex}function yS(n){gt.lFrame.currentQueryIndex=n}function FQ(n){const t=n[Le];return 2===t.type?t.declTNode:1===t.type?n[Ts]:null}function DO(n,t,e){if(e&it.SkipSelf){let s=t,r=n;for(;!(s=s.parent,null!==s||e&it.Host||(s=FQ(r),null===s||(r=r[Xd],10&s.type))););if(null===s)return!1;t=s,n=r}const i=gt.lFrame=NO();return i.currentTNode=t,i.lView=n,!0}function vS(n){const t=NO(),e=n[Le];gt.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function NO(){const n=gt.lFrame,t=null===n?null:n.child;return null===t?AO(n):t}function AO(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function MO(){const n=gt.lFrame;return gt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const PO=MO;function xS(){const n=MO();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ys(){return gt.lFrame.selectedIndex}function pu(n){gt.lFrame.selectedIndex=n}function ri(){const n=gt.lFrame;return vO(n.tView,n.selectedIndex)}function uy(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const r=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=r;o&&(n.contentHooks??(n.contentHooks=[])).push(-e,o),a&&((n.contentHooks??(n.contentHooks=[])).push(e,a),(n.contentCheckHooks??(n.contentCheckHooks=[])).push(e,a)),l&&(n.viewHooks??(n.viewHooks=[])).push(-e,l),c&&((n.viewHooks??(n.viewHooks=[])).push(e,c),(n.viewCheckHooks??(n.viewCheckHooks=[])).push(e,c)),null!=u&&(n.destroyHooks??(n.destroyHooks=[])).push(e,u)}}function dy(n,t,e){RO(n,t,3,e)}function hy(n,t,e,i){(3&n[wt])===e&&RO(n,t,e,i)}function CS(n,t){let e=n[wt];(3&e)===t&&(e&=2047,e+=1,n[wt]=e)}function RO(n,t,e,i){const r=i??-1,o=t.length-1;let a=0;for(let l=void 0!==i?65535&n[Yd]:0;l<o;l++)if("number"==typeof t[l+1]){if(a=t[l],null!=i&&a>=i)break}else t[l]<0&&(n[Yd]+=65536),(a<r||-1==r)&&(jQ(n,e,t,l),n[Yd]=(4294901760&n[Yd])+l+2),l++}function jQ(n,t,e,i){const s=e[i]<0,r=e[i+1],a=n[s?-e[i]:e[i]];if(s){if(n[wt]>>11<n[Yd]>>16&&(3&n[wt])===t){n[wt]+=2048,Qr(4,a,r);try{r.call(a)}finally{Qr(5,a,r)}}}else{Qr(4,a,r);try{r.call(a)}finally{Qr(5,a,r)}}}const eh=-1;class Dp{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function SS(n,t,e){let i=0;for(;i<e.length;){const s=e[i];if("number"==typeof s){if(0!==s)break;i++;const r=e[i++],o=e[i++],a=e[i++];n.setAttribute(t,o,a,r)}else{const r=s,o=e[++i];FO(r)?n.setProperty(t,r,o):n.setAttribute(t,r,o),i++}}return i}function OO(n){return 3===n||4===n||6===n}function FO(n){return 64===n.charCodeAt(0)}function Np(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const s=t[i];"number"==typeof s?e=s:0===e||LO(n,e,s,null,-1===e||2===e?t[++i]:null)}}return n}function LO(n,t,e,i,s){let r=0,o=n.length;if(-1===t)o=-1;else for(;r<n.length;){const a=n[r++];if("number"==typeof a){if(a===t){o=-1;break}if(a>t){o=r-1;break}}}for(;r<n.length;){const a=n[r];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==s&&(n[r+1]=s));if(i===n[r+1])return void(n[r+2]=s)}r++,null!==i&&r++,null!==s&&r++}-1!==o&&(n.splice(o,0,t),r=o+1),n.splice(r++,0,e),null!==i&&n.splice(r++,0,i),null!==s&&n.splice(r++,0,s)}function $O(n){return n!==eh}function fy(n){return 32767&n}function py(n,t){let e=function XQ(n){return n>>16}(n),i=t;for(;e>0;)i=i[Xd],e--;return i}let IS=!0;function my(n){const t=IS;return IS=n,t}const BO=255,VO=5;let YQ=0;const ha={};function gy(n,t){const e=zO(n,t);if(-1!==e)return e;const i=t[Le];i.firstCreatePass&&(n.injectorIndex=t.length,ES(i.data,n),ES(t,null),ES(i.blueprint,null));const s=kS(n,t),r=n.injectorIndex;if($O(s)){const o=fy(s),a=py(s,t),l=a[Le].data;for(let c=0;c<8;c++)t[r+c]=a[o+c]|l[o+c]}return t[r+8]=s,r}function ES(n,t){n.push(0,0,0,0,0,0,0,0,t)}function zO(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function kS(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,s=t;for(;null!==s;){if(i=KO(s),null===i)return eh;if(e++,s=s[Xd],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return eh}function TS(n,t,e){!function ZQ(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(wp)&&(i=e[wp]),null==i&&(i=e[wp]=YQ++);const s=i&BO;t.data[n+(s>>VO)]|=1<<s}(n,t,e)}function UO(n,t,e){if(e&it.Optional||void 0!==n)return n;Y_()}function WO(n,t,e,i){if(e&it.Optional&&void 0===i&&(i=null),!(e&(it.Self|it.Host))){const s=n[iy],r=Zr(void 0);try{return s?s.get(t,i,e&it.Optional):iO(t,i,e&it.Optional)}finally{Zr(r)}}return UO(i,0,e)}function HO(n,t,e,i=it.Default,s){if(null!==n){if(1024&t[wt]){const o=function nJ(n,t,e,i,s){let r=n,o=t;for(;null!==r&&null!==o&&1024&o[wt]&&!(256&o[wt]);){const a=jO(r,o,e,i|it.Self,ha);if(a!==ha)return a;let l=r.parent;if(!l){const c=o[dO];if(c){const u=c.get(e,ha,i);if(u!==ha)return u}l=KO(o),o=o[Xd]}r=l}return s}(n,t,e,i,ha);if(o!==ha)return o}const r=jO(n,t,e,i,ha);if(r!==ha)return r}return WO(t,e,i,s)}function jO(n,t,e,i,s){const r=function eJ(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(wp)?n[wp]:void 0;return"number"==typeof t?t>=0?t&BO:tJ:t}(e);if("function"==typeof r){if(!DO(t,n,i))return i&it.Host?UO(s,0,i):WO(t,e,i,s);try{const o=r(i);if(null!=o||i&it.Optional)return o;Y_()}finally{PO()}}else if("number"==typeof r){let o=null,a=zO(n,t),l=eh,c=i&it.Host?t[Ds][Ts]:null;for((-1===a||i&it.SkipSelf)&&(l=-1===a?kS(n,t):t[a+8],l!==eh&&qO(i,!1)?(o=t[Le],a=fy(l),t=py(l,t)):a=-1);-1!==a;){const u=t[Le];if(GO(r,a,u.data)){const d=JQ(a,t,e,o,i,c);if(d!==ha)return d}l=t[a+8],l!==eh&&qO(i,t[Le].data[a+8]===c)&&GO(r,a,t)?(o=u,a=fy(l),t=py(l,t)):a=-1}}return s}function JQ(n,t,e,i,s,r){const o=t[Le],a=o.data[n+8],u=by(a,o,e,null==i?kp(a)&&IS:i!=o&&0!=(3&a.type),s&it.Host&&r===a);return null!==u?mu(t,o,u,a):ha}function by(n,t,e,i,s){const r=n.providerIndexes,o=t.data,a=1048575&r,l=n.directiveStart,u=r>>20,h=s?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<l&&e===p||f>=l&&p.type===e)return f}if(s){const f=o[l];if(f&&Mo(f)&&f.type===e)return l}return null}function mu(n,t,e,i){let s=n[e];const r=t.data;if(function GQ(n){return n instanceof Dp}(s)){const o=s;o.resolving&&function KZ(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new re(-200,`Circular dependency in DI detected for ${n}${e}`)}(function dn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():mt(n)}(r[e]));const a=my(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Zr(o.injectImpl):null;DO(n,i,it.Default);try{s=n[e]=o.factory(void 0,r,n,i),t.firstCreatePass&&e>=i.directiveStart&&function HQ(n,t,e){const{ngOnChanges:i,ngOnInit:s,ngDoCheck:r}=t.type.prototype;if(i){const o=mO(t);(e.preOrderHooks??(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks??(e.preOrderHooks=[])).push(0-n,s),r&&((e.preOrderHooks??(e.preOrderHooks=[])).push(n,r),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(n,r))}(e,r[e],t)}finally{null!==l&&Zr(l),my(a),o.resolving=!1,PO()}}return s}function GO(n,t,e){return!!(e[t+(n>>VO)]&1<<n)}function qO(n,t){return!(n&it.Self||n&it.Host&&t)}class th{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return HO(this._tNode,this._lView,t,ey(i),e)}}function tJ(){return new th(_s(),fe())}function mi(n){return Ja(()=>{const t=n.prototype.constructor,e=t[tl]||DS(t),i=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==i;){const r=s[tl]||DS(s);if(r&&r!==e)return r;s=Object.getPrototypeOf(s)}return r=>new r})}function DS(n){return nS(n)?()=>{const t=DS(nt(n));return t&&t()}:fu(n)}function KO(n){const t=n[Le],e=t.type;return 2===e?t.declTNode:1===e?n[Ts]:null}function Ap(n){return function QQ(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let s=0;for(;s<i;){const r=e[s];if(OO(r))break;if(0===r)s+=2;else if("number"==typeof r)for(s++;s<i&&"string"==typeof e[s];)s++;else{if(r===t)return e[s+1];s+=2}}}return null}(_s(),n)}const ih="__parameters__";function rh(n,t,e){return Ja(()=>{const i=function NS(n){return function(...e){if(n){const i=n(...e);for(const s in i)this[s]=i[s]}}}(t);function s(...r){if(this instanceof s)return i.apply(this,r),this;const o=new s(...r);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(ih)?l[ih]:Object.defineProperty(l,ih,{value:[]})[ih];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class Ce{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Pe({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function gu(n,t){n.forEach(e=>Array.isArray(e)?gu(e,t):t(e))}function YO(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function _y(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Rp(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function Dr(n,t,e){let i=oh(n,t);return i>=0?n[1|i]=e:(i=~i,function oJ(n,t,e,i){let s=n.length;if(s==t)n.push(e,i);else if(1===s)n.push(i,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function MS(n,t){const e=oh(n,t);if(e>=0)return n[1|e]}function oh(n,t){return function ZO(n,t,e){let i=0,s=n.length>>e;for(;s!==i;){const r=i+(s-i>>1),o=n[r<<e];if(t===o)return r<<e;o>t?s=r:i=r+1}return~(s<<e)}(n,t,1)}const Zl=Cp(rh("Optional"),8),ah=Cp(rh("SkipSelf"),4);var dr=(()=>((dr=dr||{})[dr.Important=1]="Important",dr[dr.DashCase=2]="DashCase",dr))();const $S=new Map;let TJ=0;const VS="__ngContext__";function Ns(n,t){Er(t)?(n[VS]=t[Ep],function NJ(n){$S.set(n[Ep],n)}(t)):n[VS]=t}let zS;function US(n,t){return zS(n,t)}function $p(n){const t=n[pi];return Ao(t)?t[pi]:t}function WS(n){return bF(n[Sp])}function HS(n){return bF(n[No])}function bF(n){for(;null!==n&&!Ao(n);)n=n[No];return n}function ch(n,t,e,i,s){if(null!=i){let r,o=!1;Ao(i)?r=i:Er(i)&&(o=!0,i=i[nl]);const a=bs(i);0===n&&null!==e?null==s?wF(t,e,a):bu(t,e,a,s||null,!0):1===n&&null!==e?bu(t,e,a,s||null,!0):2===n?function ZS(n,t,e){const i=Cy(n,t);i&&function YJ(n,t,e,i){n.removeChild(t,e,i)}(n,i,t,e)}(t,a,o):3===n&&t.destroyNode(a),null!=r&&function JJ(n,t,e,i,s){const r=e[ry];r!==bs(e)&&ch(t,n,i,r,s);for(let a=Ks;a<e.length;a++){const l=e[a];Bp(l[Le],l,n,t,i,r)}}(t,n,r,e,s)}}function GS(n,t,e){return n.createElement(t,e)}function yF(n,t){const e=n[Zd],i=e.indexOf(t),s=t[pi];512&t[wt]&&(t[wt]&=-513,pS(s,-1)),e.splice(i,1)}function qS(n,t){if(n.length<=Ks)return;const e=Ks+t,i=n[e];if(i){const s=i[Ip];null!==s&&s!==n&&yF(s,i),t>0&&(n[e-1][No]=i[No]);const r=_y(n,Ks+t);!function UJ(n,t){Bp(n,t,t[kt],2,null,null),t[nl]=null,t[Ts]=null}(i[Le],i);const o=r[ua];null!==o&&o.detachView(r[Le]),i[pi]=null,i[No]=null,i[wt]&=-65}return i}function vF(n,t){if(!(128&t[wt])){const e=t[kt];e.destroyNode&&Bp(n,t,e,3,null,null),function jJ(n){let t=n[Sp];if(!t)return KS(n[Le],n);for(;t;){let e=null;if(Er(t))e=t[Sp];else{const i=t[Ks];i&&(e=i)}if(!e){for(;t&&!t[No]&&t!==n;)Er(t)&&KS(t[Le],t),t=t[pi];null===t&&(t=n),Er(t)&&KS(t[Le],t),e=t&&t[No]}t=e}}(t)}}function KS(n,t){if(!(128&t[wt])){t[wt]&=-65,t[wt]|=128,function XJ(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const s=t[e[i]];if(!(s instanceof Dp)){const r=e[i+1];if(Array.isArray(r))for(let o=0;o<r.length;o+=2){const a=s[r[o]],l=r[o+1];Qr(4,a,l);try{l.call(a)}finally{Qr(5,a,l)}}else{Qr(4,s,r);try{r.call(s)}finally{Qr(5,s,r)}}}}}(n,t),function KJ(n,t){const e=n.cleanup,i=t[Kd];let s=-1;if(null!==e)for(let r=0;r<e.length-1;r+=2)if("string"==typeof e[r]){const o=e[r+3];o>=0?i[s=o]():i[s=-o].unsubscribe(),r+=2}else{const o=i[s=e[r+1]];e[r].call(o)}if(null!==i){for(let r=s+1;r<i.length;r++)(0,i[r])();t[Kd]=null}}(n,t),1===t[Le].type&&t[kt].destroy();const e=t[Ip];if(null!==e&&Ao(t[pi])){e!==t[pi]&&yF(e,t);const i=t[ua];null!==i&&i.detachView(n)}!function AJ(n){$S.delete(n[Ep])}(t)}}function xF(n,t,e){return function CF(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[nl];{const{componentOffset:s}=i;if(s>-1){const{encapsulation:r}=n.data[i.directiveStart+s];if(r===Do.None||r===Do.Emulated)return null}return Tr(i,e)}}(n,t.parent,e)}function bu(n,t,e,i,s){n.insertBefore(t,e,i,s)}function wF(n,t,e){n.appendChild(t,e)}function SF(n,t,e,i,s){null!==i?bu(n,t,e,i,s):wF(n,t,e)}function Cy(n,t){return n.parentNode(t)}function IF(n,t,e){return kF(n,t,e)}let XS,Iy,eI,Ey,kF=function EF(n,t,e){return 40&n.type?Tr(n,e):null};function wy(n,t,e,i){const s=xF(n,i,t),r=t[kt],a=IF(i.parent||t[Ts],i,t);if(null!=s)if(Array.isArray(e))for(let l=0;l<e.length;l++)SF(r,s,e[l],a,!1);else SF(r,s,e,a,!1);void 0!==XS&&XS(r,i,t,e,s)}function Sy(n,t){if(null!==t){const e=t.type;if(3&e)return Tr(t,n);if(4&e)return YS(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return Sy(n,i);{const s=n[t.index];return Ao(s)?YS(-1,s):bs(s)}}if(32&e)return US(t,n)()||bs(n[t.index]);{const i=DF(n,t);return null!==i?Array.isArray(i)?i[0]:Sy($p(n[Ds]),i):Sy(n,t.next)}}return null}function DF(n,t){return null!==t?n[Ds][Ts].projection[t.projection]:null}function YS(n,t){const e=Ks+n+1;if(e<t.length){const i=t[e],s=i[Le].firstChild;if(null!==s)return Sy(i,s)}return t[ry]}function QS(n,t,e,i,s,r,o){for(;null!=e;){const a=i[e.index],l=e.type;if(o&&0===t&&(a&&Ns(bs(a),i),e.flags|=2),32!=(32&e.flags))if(8&l)QS(n,t,e.child,i,s,r,!1),ch(t,n,s,a,r);else if(32&l){const c=US(e,i);let u;for(;u=c();)ch(t,n,s,u,r);ch(t,n,s,a,r)}else 16&l?NF(n,t,i,e,s,r):ch(t,n,s,a,r);e=o?e.projectionNext:e.next}}function Bp(n,t,e,i,s,r){QS(e,i,n.firstChild,t,s,r,!1)}function NF(n,t,e,i,s,r){const o=e[Ds],l=o[Ts].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)ch(t,n,s,l[c],r);else QS(n,t,l,o[pi],s,r,!0)}function AF(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function MF(n,t,e){const{mergedAttrs:i,classes:s,styles:r}=e;null!==i&&SS(n,t,i),null!==s&&AF(n,t,s),null!==r&&function tee(n,t,e){n.setAttribute(t,"style",e)}(n,t,r)}function uh(n){return function JS(){if(void 0===Iy&&(Iy=null,Vn.trustedTypes))try{Iy=Vn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Iy}()?.createHTML(n)||n}function FF(n){return function tI(){if(void 0===Ey&&(Ey=null,Vn.trustedTypes))try{Ey=Vn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Ey}()?.createScriptURL(n)||n}class _u{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${K_})`}}class oee extends _u{getTypeName(){return"HTML"}}class aee extends _u{getTypeName(){return"Style"}}class lee extends _u{getTypeName(){return"Script"}}class cee extends _u{getTypeName(){return"URL"}}class uee extends _u{getTypeName(){return"ResourceURL"}}function Nr(n){return n instanceof _u?n.changingThisBreaksApplicationSecurity:n}function fa(n,t){const e=function dee(n){return n instanceof _u&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${K_})`)}return e===t}class bee{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(uh(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class _ee{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const e=this.inertDocument.createElement("template");return e.innerHTML=uh(t),e}}const vee=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function ky(n){return(n=String(n)).match(vee)?n:"unsafe:"+n}function rl(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Vp(...n){const t={};for(const e of n)for(const i in e)e.hasOwnProperty(i)&&(t[i]=!0);return t}const $F=rl("area,br,col,hr,img,wbr"),BF=rl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),VF=rl("rp,rt"),nI=Vp($F,Vp(BF,rl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Vp(VF,rl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Vp(VF,BF)),iI=rl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),zF=Vp(iI,rl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),rl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),xee=rl("script,style,template");class Cee{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!nI.hasOwnProperty(e))return this.sanitizedSomething=!0,!xee.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let s=0;s<i.length;s++){const r=i.item(s),o=r.name,a=o.toLowerCase();if(!zF.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=r.value;iI[a]&&(l=ky(l)),this.buf.push(" ",o,'="',UF(l),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();nI.hasOwnProperty(e)&&!$F.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(UF(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const wee=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,See=/([^\#-~ |!])/g;function UF(n){return n.replace(/&/g,"&amp;").replace(wee,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(See,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Ty;function WF(n,t){let e=null;try{Ty=Ty||function LF(n){const t=new _ee(n);return function yee(){try{return!!(new window.DOMParser).parseFromString(uh(""),"text/html")}catch{return!1}}()?new bee(t):t}(n);let i=t?String(t):"";e=Ty.getInertBodyElement(i);let s=5,r=i;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,i=r,r=e.innerHTML,e=Ty.getInertBodyElement(i)}while(i!==r);return uh((new Cee).sanitizeChildren(sI(e)||e))}finally{if(e){const i=sI(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function sI(n){return"content"in n&&function Iee(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var an=(()=>((an=an||{})[an.NONE=0]="NONE",an[an.HTML=1]="HTML",an[an.STYLE=2]="STYLE",an[an.SCRIPT=3]="SCRIPT",an[an.URL=4]="URL",an[an.RESOURCE_URL=5]="RESOURCE_URL",an))();function dh(n){const t=zp();return t?t.sanitize(an.URL,n)||"":fa(n,"URL")?Nr(n):ky(mt(n))}function HF(n){const t=zp();if(t)return FF(t.sanitize(an.RESOURCE_URL,n)||"");if(fa(n,"ResourceURL"))return FF(Nr(n));throw new re(904,!1)}function zp(){const n=fe();return n&&n[uS]}const Dy=new Ce("ENVIRONMENT_INITIALIZER"),GF=new Ce("INJECTOR",-1),qF=new Ce("INJECTOR_DEF_TYPES");class KF{get(t,e=vp){if(e===vp){const i=new Error(`NullInjectorError: No provider for ${An(t)}!`);throw i.name="NullInjectorError",i}return e}}function Pee(...n){return{\u0275providers:XF(0,n),\u0275fromNgModule:!0}}function XF(n,...t){const e=[],i=new Set;let s;return gu(t,r=>{const o=r;rI(o,e,[],i)&&(s||(s=[]),s.push(o))}),void 0!==s&&YF(s,e),e}function YF(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];oI(s,r=>{t.push(r)})}}function rI(n,t,e,i){if(!(n=nt(n)))return!1;let s=null,r=tO(n);const o=!r&&fn(n);if(r||o){if(o&&!o.standalone)return!1;s=n}else{const l=n.ngModule;if(r=tO(l),!r)return!1;s=l}const a=i.has(s);if(o){if(a)return!1;if(i.add(s),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)rI(c,t,e,i)}}else{if(!r)return!1;{if(null!=r.imports&&!a){let c;i.add(s);try{gu(r.imports,u=>{rI(u,t,e,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&YF(c,t)}if(!a){const c=fu(s)||(()=>new s);t.push({provide:s,useFactory:c,deps:on},{provide:qF,useValue:s,multi:!0},{provide:Dy,useValue:()=>me(s),multi:!0})}const l=r.providers;null==l||a||oI(l,u=>{t.push(u)})}}return s!==n&&void 0!==n.providers}function oI(n,t){for(let e of n)iS(e)&&(e=e.\u0275providers),Array.isArray(e)?oI(e,t):t(e)}const Ree=Sn({provide:String,useValue:Sn});function aI(n){return null!==n&&"object"==typeof n&&Ree in n}function yu(n){return"function"==typeof n}const lI=new Ce("Set Injector scope."),Ny={},Fee={};let cI;function Ay(){return void 0===cI&&(cI=new KF),cI}class pa{}class JF extends pa{get destroyed(){return this._destroyed}constructor(t,e,i,s){super(),this.parent=e,this.source=i,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,dI(t,o=>this.processProvider(o)),this.records.set(GF,hh(void 0,this)),s.has("environment")&&this.records.set(pa,hh(void 0,this));const r=this.records.get(lI);null!=r&&"string"==typeof r.value&&this.scopes.add(r.value),this.injectorDefTypes=new Set(this.get(qF.multi,on,it.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=Gd(this),i=Zr(void 0);try{return t()}finally{Gd(e),Zr(i)}}get(t,e=vp,i=it.Default){this.assertNotDestroyed(),i=ey(i);const s=Gd(this),r=Zr(void 0);try{if(!(i&it.SkipSelf)){let a=this.records.get(t);if(void 0===a){const l=function zee(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ce}(t)&&Z_(t);a=l&&this.injectableDefInScope(l)?hh(uI(t),Ny):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(i&it.Self?Ay():this.parent).get(t,e=i&it.Optional&&e===vp?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[J_]=o[J_]||[]).unshift(An(t)),s)throw o;return function lQ(n,t,e,i){const s=n[J_];throw t[sO]&&s.unshift(t[sO]),n.message=function cQ(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==rQ?n.slice(2):n;let s=An(t);if(Array.isArray(t))s=t.map(An).join(" -> ");else if("object"==typeof t){let r=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o];r.push(o+":"+("string"==typeof a?JSON.stringify(a):An(a)))}s=`{${r.join(", ")}}`}return`${e}${i?"("+i+")":""}[${s}]: ${n.replace(sQ,"\n  ")}`}("\n"+n.message,s,e,i),n[iQ]=s,n[J_]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{Zr(r),Gd(s)}}resolveInjectorInitializers(){const t=Gd(this),e=Zr(void 0);try{const i=this.get(Dy.multi,on,it.Self);for(const s of i)s()}finally{Gd(t),Zr(e)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(An(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new re(205,!1)}processProvider(t){let e=yu(t=nt(t))?t:nt(t&&t.provide);const i=function $ee(n){return aI(n)?hh(void 0,n.useValue):hh(eL(n),Ny)}(t);if(yu(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=hh(void 0,Ny,!0),s.factory=()=>aS(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,i)}hydrate(t,e){return e.value===Ny&&(e.value=Fee,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Vee(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=nt(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function uI(n){const t=Z_(n),e=null!==t?t.factory:fu(n);if(null!==e)return e;if(n instanceof Ce)throw new re(204,!1);if(n instanceof Function)return function Lee(n){const t=n.length;if(t>0)throw Rp(t,"?"),new re(204,!1);const e=function eQ(n){return n&&(n[Q_]||n[nO])||null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new re(204,!1)}function eL(n,t,e){let i;if(yu(n)){const s=nt(n);return fu(s)||uI(s)}if(aI(n))i=()=>nt(n.useValue);else if(function QF(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...aS(n.deps||[]));else if(function ZF(n){return!(!n||!n.useExisting)}(n))i=()=>me(nt(n.useExisting));else{const s=nt(n&&(n.useClass||n.provide));if(!function Bee(n){return!!n.deps}(n))return fu(s)||uI(s);i=()=>new s(...aS(n.deps))}return i}function hh(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function dI(n,t){for(const e of n)Array.isArray(e)?dI(e,t):e&&iS(e)?dI(e.\u0275providers,t):t(e)}class Uee{}class tL{}class Hee{resolveComponentFactory(t){throw function Wee(n){const t=Error(`No component factory found for ${An(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let Up=(()=>{class n{}return n.NULL=new Hee,n})();function jee(){return fh(_s(),fe())}function fh(n,t){return new Ri(Tr(n,t))}let Ri=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=jee,n})();function Gee(n){return n instanceof Ri?n.nativeElement:n}class Wp{}let ol=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function qee(){const n=fe(),e=ur(_s().index,n);return(Er(e)?e:n)[kt]}(),n})(),Kee=(()=>{class n{}return n.\u0275prov=Pe({token:n,providedIn:"root",factory:()=>null}),n})();class vu{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Xee=new vu("15.2.8"),hI={},fI="ngOriginalError";function pI(n){return n[fI]}class al{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&pI(t);for(;e&&pI(e);)e=pI(e);return e||null}}function ll(n){return n instanceof Function?n():n}function sL(n,t,e){let i=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const r=t.length;if(s+r===i||n.charCodeAt(s+r)<=32)return s}e=s+1}}const rL="ng-template";function ote(n,t,e){let i=0,s=!0;for(;i<n.length;){let r=n[i++];if("string"==typeof r&&s){const o=n[i++];if(e&&"class"===r&&-1!==sL(o.toLowerCase(),t,0))return!0}else{if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===t)return!0;return!1}"number"==typeof r&&(s=!1)}}return!1}function oL(n){return 4===n.type&&n.value!==rL}function ate(n,t,e){return t===(4!==n.type||e?n.value:rL)}function lte(n,t,e){let i=4;const s=n.attrs||[],r=function dte(n){for(let t=0;t<n.length;t++)if(OO(n[t]))return t;return n.length}(s);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!ate(n,l,e)||""===l&&1===t.length){if(Po(i))return!1;o=!0}}else{const c=8&i?l:t[++a];if(8&i&&null!==n.attrs){if(!ote(n.attrs,c,e)){if(Po(i))return!1;o=!0}continue}const d=cte(8&i?"class":l,s,oL(n),e);if(-1===d){if(Po(i))return!1;o=!0;continue}if(""!==c){let h;h=d>r?"":s[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==sL(f,c,0)||2&i&&c!==h){if(Po(i))return!1;o=!0}}}}else{if(!o&&!Po(i)&&!Po(l))return!1;if(o&&Po(l))continue;o=!1,i=l|1&i}}return Po(i)||o}function Po(n){return 0==(1&n)}function cte(n,t,e,i){if(null===t)return-1;let s=0;if(i||!e){let r=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)r=!0;else{if(1===o||2===o){let a=t[++s];for(;"string"==typeof a;)a=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=r?1:2}return-1}return function hte(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function aL(n,t,e=!1){for(let i=0;i<t.length;i++)if(lte(n,t[i],e))return!0;return!1}function fte(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let s=0;s<n.length;s++)if(n[s]!==i[s])continue e;return!0}}return!1}function lL(n,t){return n?":not("+t.trim()+")":t}function pte(n){let t=n[0],e=1,i=2,s="",r=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&i){const a=n[++e];s+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?s+="."+o:4&i&&(s+=" "+o);else""!==s&&!Po(o)&&(t+=lL(r,s),s=""),i=o,r=r||!Po(i);e++}return""!==s&&(t+=lL(r,s)),t}const bt={};function W(n){cL(Kt(),fe(),Ys()+n,!1)}function cL(n,t,e,i){if(!i)if(3==(3&t[wt])){const r=n.preOrderCheckHooks;null!==r&&dy(t,r,e)}else{const r=n.preOrderHooks;null!==r&&hy(t,r,0,e)}pu(e)}function fL(n,t=null,e=null,i){const s=pL(n,t,e,i);return s.resolveInjectorInitializers(),s}function pL(n,t=null,e=null,i,s=new Set){const r=[e||on,Pee(n)];return i=i||("object"==typeof n?void 0:An(n)),new JF(r,t||Ay(),i||null,s)}let Ro=(()=>{class n{static create(e,i){if(Array.isArray(e))return fL({name:""},i,e,"");{const s=e.name??"";return fL({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=vp,n.NULL=new KF,n.\u0275prov=Pe({token:n,providedIn:"any",factory:()=>me(GF)}),n.__NG_ELEMENT_ID__=-1,n})();function ie(n,t=it.Default){const e=fe();return null===e?me(n,t):HO(_s(),e,nt(n),t)}function yI(){throw new Error("invalid")}function xL(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i+1];if(-1!==r){const o=n.data[r];yS(e[i]),o.contentQueries(2,t[r],r)}}}function Py(n,t,e,i,s,r,o,a,l,c,u){const d=t.blueprint.slice();return d[nl]=s,d[wt]=76|i,(null!==u||n&&1024&n[wt])&&(d[wt]|=1024),xO(d),d[pi]=d[Xd]=n,d[ki]=e,d[sy]=o||n&&n[sy],d[kt]=a||n&&n[kt],d[uS]=l||n&&n[uS]||null,d[iy]=c||n&&n[iy]||null,d[Ts]=r,d[Ep]=function DJ(){return TJ++}(),d[dO]=u,d[Ds]=2==t.type?n[Ds]:d,d}function gh(n,t,e,i,s){let r=n.data[t];if(null===r)r=function vI(n,t,e,i,s){const r=SO(),o=mS(),l=n.data[t]=function Vte(n,t,e,i,s,r){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:r,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?r:r&&r.parent,e,t,i,s);return null===n.firstChild&&(n.firstChild=l),null!==r&&(o?null==r.child&&null!==l.parent&&(r.child=l):null===r.next&&(r.next=l,l.prev=r)),l}(n,t,e,i,s),function PQ(){return gt.lFrame.inI18n}()&&(r.flags|=32);else if(64&r.type){r.type=e,r.value=i,r.attrs=s;const o=function Tp(){const n=gt.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();r.injectorIndex=null===o?-1:o.injectorIndex}return da(r,!0),r}function Hp(n,t,e,i){if(0===e)return-1;const s=t.length;for(let r=0;r<e;r++)t.push(i),n.blueprint.push(i),n.data.push(null);return s}function xI(n,t,e){vS(t);try{const i=n.viewQuery;null!==i&&NI(1,i,e);const s=n.template;null!==s&&CL(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&xL(n,t),n.staticViewQueries&&NI(2,n.viewQuery,e);const r=n.components;null!==r&&function Lte(n,t){for(let e=0;e<t.length;e++)one(n,t[e])}(t,r)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[wt]&=-5,xS()}}function Ry(n,t,e,i){const s=t[wt];if(128!=(128&s)){vS(t);try{xO(t),function EO(n){return gt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&CL(n,t,e,2,i);const o=3==(3&s);if(o){const c=n.preOrderCheckHooks;null!==c&&dy(t,c,null)}else{const c=n.preOrderHooks;null!==c&&hy(t,c,0,null),CS(t,0)}if(function sne(n){for(let t=WS(n);null!==t;t=HS(t)){if(!t[hO])continue;const e=t[Zd];for(let i=0;i<e.length;i++){const s=e[i];512&s[wt]||pS(s[pi],1),s[wt]|=512}}}(t),function ine(n){for(let t=WS(n);null!==t;t=HS(t))for(let e=Ks;e<t.length;e++){const i=t[e],s=i[Le];cy(i)&&Ry(s,i,s.template,i[ki])}}(t),null!==n.contentQueries&&xL(n,t),o){const c=n.contentCheckHooks;null!==c&&dy(t,c)}else{const c=n.contentHooks;null!==c&&hy(t,c,1),CS(t,1)}!function Ote(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const s=e[i];if(s<0)pu(~s);else{const r=s,o=e[++i],a=e[++i];RQ(o,r),a(2,t[r])}}}finally{pu(-1)}}(n,t);const a=n.components;null!==a&&function Fte(n,t){for(let e=0;e<t.length;e++)rne(n,t[e])}(t,a);const l=n.viewQuery;if(null!==l&&NI(2,l,i),o){const c=n.viewCheckHooks;null!==c&&dy(t,c)}else{const c=n.viewHooks;null!==c&&hy(t,c,2),CS(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[wt]&=-41,512&t[wt]&&(t[wt]&=-513,pS(t[pi],-1))}finally{xS()}}}function CL(n,t,e,i,s){const r=Ys(),o=2&i;try{pu(-1),o&&t.length>zn&&cL(n,t,zn,!1),Qr(o?2:0,s),e(i,s)}finally{pu(r),Qr(o?3:1,s)}}function CI(n,t,e){if(hS(t)){const s=t.directiveEnd;for(let r=t.directiveStart;r<s;r++){const o=n.data[r];o.contentQueries&&o.contentQueries(1,e[r],r)}}}function wI(n,t,e){wO()&&(function qte(n,t,e,i){const s=e.directiveStart,r=e.directiveEnd;kp(e)&&function ene(n,t,e){const i=Tr(t,n),s=wL(e),r=n[sy],o=Oy(n,Py(n,s,null,e.onPush?32:16,i,t,r,r.createRenderer(i,e),null,null,null));n[t.index]=o}(t,e,n.data[s+e.componentOffset]),n.firstCreatePass||gy(e,t),Ns(i,t);const o=e.initialInputs;for(let a=s;a<r;a++){const l=n.data[a],c=mu(t,n,a,e);Ns(c,t),null!==o&&tne(0,a-s,c,l,0,o),Mo(l)&&(ur(e.index,t)[ki]=mu(t,n,a,e))}}(n,t,e,Tr(e,t)),64==(64&e.flags)&&TL(n,t,e))}function SI(n,t,e=Tr){const i=t.localNames;if(null!==i){let s=t.index+1;for(let r=0;r<i.length;r+=2){const o=i[r+1],a=-1===o?e(t,n):n[o];n[s++]=a}}}function wL(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=II(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function II(n,t,e,i,s,r,o,a,l,c){const u=zn+i,d=u+s,h=function $te(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:bt);return e}(u,d),f="function"==typeof c?c():c;return h[Le]={type:n,blueprint:h,template:e,queries:null,viewQuery:a,declTNode:t,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof r?r():r,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function SL(n,t,e,i){const s=NL(t);null===e?s.push(i):(s.push(e),n.firstCreatePass&&AL(n).push(i,s.length-1))}function IL(n,t,e,i){for(let s in n)if(n.hasOwnProperty(s)){e=null===e?{}:e;const r=n[s];null===i?EL(e,t,s,r):i.hasOwnProperty(s)&&EL(e,t,i[s],r)}return e}function EL(n,t,e,i){n.hasOwnProperty(e)?n[e].push(t,i):n[e]=[t,i]}function Ar(n,t,e,i,s,r,o,a){const l=Tr(t,e);let u,c=t.inputs;!a&&null!=c&&(u=c[i])?(AI(n,e,u,i,s),kp(t)&&function Wte(n,t){const e=ur(t,n);16&e[wt]||(e[wt]|=32)}(e,t.index)):3&t.type&&(i=function Ute(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),s=null!=o?o(s,t.value||"",i):s,r.setProperty(l,i,s))}function EI(n,t,e,i){if(wO()){const s=null===i?null:{"":-1},r=function Xte(n,t){const e=n.directiveRegistry;let i=null,s=null;if(e)for(let r=0;r<e.length;r++){const o=e[r];if(aL(t,o.selectors,!1))if(i||(i=[]),Mo(o))if(null!==o.findHostDirectiveDefs){const a=[];s=s||new Map,o.findHostDirectiveDefs(o,a,s),i.unshift(...a,o),kI(n,t,a.length)}else i.unshift(o),kI(n,t,0);else s=s||new Map,o.findHostDirectiveDefs?.(o,i,s),i.push(o)}return null===i?null:[i,s]}(n,e);let o,a;null===r?o=a=null:[o,a]=r,null!==o&&kL(n,t,e,o,s,a),s&&function Yte(n,t,e){if(t){const i=n.localNames=[];for(let s=0;s<t.length;s+=2){const r=e[t[s+1]];if(null==r)throw new re(-301,!1);i.push(t[s],r)}}}(e,i,s)}e.mergedAttrs=Np(e.mergedAttrs,e.attrs)}function kL(n,t,e,i,s,r){for(let c=0;c<i.length;c++)TS(gy(e,t),n,i[c].type);!function Qte(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}(e,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=Hp(n,t,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];e.mergedAttrs=Np(e.mergedAttrs,u.hostAttrs),Jte(n,e,t,l,u),Zte(l,u,s),null!==u.contentQueries&&(e.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(e.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??(n.preOrderHooks=[])).push(e.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(e.index),a=!0),l++}!function zte(n,t,e){const s=t.directiveEnd,r=n.data,o=t.attrs,a=[];let l=null,c=null;for(let u=t.directiveStart;u<s;u++){const d=r[u],h=e?e.get(d):null,p=h?h.outputs:null;l=IL(d.inputs,u,l,h?h.inputs:null),c=IL(d.outputs,u,c,p);const g=null===l||null===o||oL(t)?null:nne(l,u,o);a.push(g)}null!==l&&(l.hasOwnProperty("class")&&(t.flags|=8),l.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=a,t.inputs=l,t.outputs=c}(n,e,r)}function TL(n,t,e){const i=e.directiveStart,s=e.directiveEnd,r=e.index,o=function OQ(){return gt.lFrame.currentDirectiveIndex}();try{pu(r);for(let a=i;a<s;a++){const l=n.data[a],c=t[a];bS(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&Kte(l,c)}}finally{pu(-1),bS(o)}}function Kte(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function kI(n,t,e){t.componentOffset=e,(n.components??(n.components=[])).push(t.index)}function Zte(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;Mo(t)&&(e[""]=n)}}function Jte(n,t,e,i,s){n.data[i]=s;const r=s.factory||(s.factory=fu(s.type)),o=new Dp(r,Mo(s),ie);n.blueprint[i]=o,e[i]=o,function jte(n,t,e,i,s){const r=s.hostBindings;if(r){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~t.index;(function Gte(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(o)!=a&&o.push(a),o.push(e,i,r)}}(n,t,i,Hp(n,e,s.hostVars,bt),s)}function ma(n,t,e,i,s,r){const o=Tr(n,t);!function TI(n,t,e,i,s,r,o){if(null==r)n.removeAttribute(t,s,e);else{const a=null==o?mt(r):o(r,i||"",s);n.setAttribute(t,s,a,e)}}(t[kt],o,r,n.value,e,i,s)}function tne(n,t,e,i,s,r){const o=r[t];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(e,d,c,u):e[u]=d}}}function nne(n,t,e){let i=null,s=0;for(;s<e.length;){const r=e[s];if(0!==r)if(5!==r){if("number"==typeof r)break;if(n.hasOwnProperty(r)){null===i&&(i=[]);const o=n[r];for(let a=0;a<o.length;a+=2)if(o[a]===t){i.push(r,o[a+1],e[s+1]);break}}s+=2}else s+=2;else s+=4}return i}function DL(n,t,e,i){return[n,!0,!1,t,null,0,i,e,null,null]}function rne(n,t){const e=ur(t,n);if(cy(e)){const i=e[Le];48&e[wt]?Ry(i,e,i.template,e[ki]):e[hu]>0&&DI(e)}}function DI(n){for(let i=WS(n);null!==i;i=HS(i))for(let s=Ks;s<i.length;s++){const r=i[s];if(cy(r))if(512&r[wt]){const o=r[Le];Ry(o,r,o.template,r[ki])}else r[hu]>0&&DI(r)}const e=n[Le].components;if(null!==e)for(let i=0;i<e.length;i++){const s=ur(e[i],n);cy(s)&&s[hu]>0&&DI(s)}}function one(n,t){const e=ur(t,n),i=e[Le];(function ane(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(i,e),xI(i,e,e[ki])}function Oy(n,t){return n[Sp]?n[uO][No]=t:n[Sp]=t,n[uO]=t,t}function Fy(n){for(;n;){n[wt]|=32;const t=$p(n);if(mQ(n)&&!t)return n;n=t}return null}function Ly(n,t,e,i=!0){const s=t[sy];s.begin&&s.begin();try{Ry(n,t,n.template,e)}catch(o){throw i&&PL(t,o),o}finally{s.end&&s.end()}}function NI(n,t,e){yS(0),t(n,e)}function NL(n){return n[Kd]||(n[Kd]=[])}function AL(n){return n.cleanup||(n.cleanup=[])}function PL(n,t){const e=n[iy],i=e?e.get(al,null):null;i&&i.handleError(t)}function AI(n,t,e,i,s){for(let r=0;r<e.length;){const o=e[r++],a=e[r++],l=t[o],c=n.data[o];null!==c.setInput?c.setInput(l,s,i,a):l[a]=s}}function cl(n,t,e){const i=ly(t,n);!function _F(n,t,e){n.setValue(t,e)}(n[kt],i,e)}function $y(n,t,e){let i=e?n.styles:null,s=e?n.classes:null,r=0;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?r=a:1==r?s=tS(s,a):2==r&&(i=tS(i,a+": "+t[++o]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=s:n.classesWithoutHost=s}function By(n,t,e,i,s=!1){for(;null!==e;){const r=t[e.index];if(null!==r&&i.push(bs(r)),Ao(r))for(let a=Ks;a<r.length;a++){const l=r[a],c=l[Le].firstChild;null!==c&&By(l[Le],l,c,i)}const o=e.type;if(8&o)By(n,t,e.child,i);else if(32&o){const a=US(e,t);let l;for(;l=a();)i.push(l)}else if(16&o){const a=DF(t,e);if(Array.isArray(a))i.push(...a);else{const l=$p(t[Ds]);By(l[Le],l,a,i,!0)}}e=s?e.projectionNext:e.next}return i}class jp{get rootNodes(){const t=this._lView,e=t[Le];return By(e,t,e.firstChild,[])}constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ki]}set context(t){this._lView[ki]=t}get destroyed(){return 128==(128&this._lView[wt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[pi];if(Ao(t)){const e=t[oy],i=e?e.indexOf(this):-1;i>-1&&(qS(t,i),_y(e,i))}this._attachedToViewContainer=!1}vF(this._lView[Le],this._lView)}onDestroy(t){SL(this._lView[Le],this._lView,null,t)}markForCheck(){Fy(this._cdRefInjectingView||this._lView)}detach(){this._lView[wt]&=-65}reattach(){this._lView[wt]|=64}detectChanges(){Ly(this._lView[Le],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new re(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function HJ(n,t){Bp(n,t,t[kt],2,null,null)}(this._lView[Le],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new re(902,!1);this._appRef=t}}class lne extends jp{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Ly(t[Le],t,t[ki],!1)}checkNoChanges(){}get context(){return null}}class RL extends Up{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=fn(t);return new Gp(e,this.ngModule)}}function OL(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class une{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=ey(i);const s=this.injector.get(t,hI,i);return s!==hI||e===hI?s:this.parentInjector.get(t,e,i)}}class Gp extends tL{get inputs(){return OL(this.componentDef.inputs)}get outputs(){return OL(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function mte(n){return n.map(pte).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,i,s){let r=(s=s||this.ngModule)instanceof pa?s:s?.injector;r&&null!==this.componentDef.getStandaloneInjector&&(r=this.componentDef.getStandaloneInjector(r)||r);const o=r?new une(t,r):t,a=o.get(Wp,null);if(null===a)throw new re(407,!1);const l=o.get(Kee,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",d=i?function Bte(n,t,e){return n.selectRootElement(t,e===Do.ShadowDom)}(c,i,this.componentDef.encapsulation):GS(c,u,function cne(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(u)),h=this.componentDef.onPush?288:272,f=II(0,null,null,1,0,null,null,null,null,null),p=Py(null,f,null,h,null,null,a,c,l,o,null);let g,m;vS(p);try{const b=this.componentDef;let _,y=null;b.findHostDirectiveDefs?(_=[],y=new Map,b.findHostDirectiveDefs(b,_,y),_.push(b)):_=[b];const v=function hne(n,t){const e=n[Le],i=zn;return n[i]=t,gh(e,i,2,"#host",null)}(p,d),x=function fne(n,t,e,i,s,r,o,a){const l=s[Le];!function pne(n,t,e,i){for(const s of n)t.mergedAttrs=Np(t.mergedAttrs,s.hostAttrs);null!==t.mergedAttrs&&($y(t,t.mergedAttrs,!0),null!==e&&MF(i,e,t))}(i,n,t,o);const c=r.createRenderer(t,e),u=Py(s,wL(e),null,e.onPush?32:16,s[n.index],n,r,c,a||null,null,null);return l.firstCreatePass&&kI(l,n,i.length-1),Oy(s,u),s[n.index]=u}(v,d,b,_,p,a,c);m=vO(f,zn),d&&function gne(n,t,e,i){if(i)SS(n,e,["ng-version",Xee.full]);else{const{attrs:s,classes:r}=function gte(n){const t=[],e=[];let i=1,s=2;for(;i<n.length;){let r=n[i];if("string"==typeof r)2===s?""!==r&&t.push(r,n[++i]):8===s&&e.push(r);else{if(!Po(s))break;s=r}i++}return{attrs:t,classes:e}}(t.selectors[0]);s&&SS(n,e,s),r&&r.length>0&&AF(n,e,r.join(" "))}}(c,b,d,i),void 0!==e&&function bne(n,t,e){const i=n.projection=[];for(let s=0;s<t.length;s++){const r=e[s];i.push(null!=r?Array.from(r):null)}}(m,this.ngContentSelectors,e),g=function mne(n,t,e,i,s,r){const o=_s(),a=s[Le],l=Tr(o,s);kL(a,s,o,e,null,i);for(let u=0;u<e.length;u++)Ns(mu(s,a,o.directiveStart+u,o),s);TL(a,s,o),l&&Ns(l,s);const c=mu(s,a,o.directiveStart+o.componentOffset,o);if(n[ki]=s[ki]=c,null!==r)for(const u of r)u(c,t);return CI(a,o,n),c}(x,b,_,y,p,[_ne]),xI(f,p,null)}finally{xS()}return new dne(this.componentType,g,fh(m,p),p,m)}}class dne extends Uee{constructor(t,e,i,s,r){super(),this.location=i,this._rootLView=s,this._tNode=r,this.instance=e,this.hostView=this.changeDetectorRef=new lne(s),this.componentType=t}setInput(t,e){const i=this._tNode.inputs;let s;if(null!==i&&(s=i[t])){const r=this._rootLView;AI(r[Le],r,s,t,e),Fy(ur(this._tNode.index,r))}}get injector(){return new th(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function _ne(){const n=_s();uy(fe()[Le],n)}function $t(n){let t=function FL(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let s;if(Mo(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new re(903,!1);s=t.\u0275dir}if(s){if(e){i.push(s);const o=n;o.inputs=MI(n.inputs),o.declaredInputs=MI(n.declaredInputs),o.outputs=MI(n.outputs);const a=s.hostBindings;a&&Cne(n,a);const l=s.viewQuery,c=s.contentQueries;if(l&&vne(n,l),c&&xne(n,c),eS(n.inputs,s.inputs),eS(n.declaredInputs,s.declaredInputs),eS(n.outputs,s.outputs),Mo(s)&&s.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(s.data.animation)}}const r=s.features;if(r)for(let o=0;o<r.length;o++){const a=r[o];a&&a.ngInherit&&a(n),a===$t&&(e=!1)}}t=Object.getPrototypeOf(t)}!function yne(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const s=n[i];s.hostVars=t+=s.hostVars,s.hostAttrs=Np(s.hostAttrs,e=Np(e,s.hostAttrs))}}(i)}function MI(n){return n===el?{}:n===on?[]:n}function vne(n,t){const e=n.viewQuery;n.viewQuery=e?(i,s)=>{t(i,s),e(i,s)}:t}function xne(n,t){const e=n.contentQueries;n.contentQueries=e?(i,s,r)=>{t(i,s,r),e(i,s,r)}:t}function Cne(n,t){const e=n.hostBindings;n.hostBindings=e?(i,s)=>{t(i,s),e(i,s)}:t}function Vy(n){return!!PI(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function PI(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function ga(n,t,e){return n[t]=e}function As(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function xu(n,t,e,i){const s=As(n,t,e);return As(n,t+1,i)||s}function zy(n,t,e,i,s){const r=xu(n,t,e,i);return As(n,t+2,s)||r}function Mr(n,t,e,i){const s=fe();return As(s,Jd(),t)&&(Kt(),ma(ri(),s,n,t,e,i)),Mr}function _h(n,t,e,i){return As(n,Jd(),e)?t+mt(e)+i:bt}function xh(n,t,e,i,s,r,o,a,l,c){const d=function eo(n,t,e,i,s,r){const o=xu(n,t,e,i);return xu(n,t+2,s,r)||o}(n,il(),e,s,o,l);return sl(4),d?t+mt(e)+i+mt(s)+r+mt(o)+a+mt(l)+c:bt}function ze(n,t,e,i,s,r,o,a){const l=fe(),c=Kt(),u=n+zn,d=c.firstCreatePass?function Mne(n,t,e,i,s,r,o,a,l){const c=t.consts,u=gh(t,n,4,o||null,Yl(c,a));EI(t,e,u,Yl(c,l)),uy(t,u);const d=u.tView=II(2,u,i,s,r,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,u),d.queries=t.queries.embeddedTView(u)),u}(u,c,l,t,e,i,s,r,o):c.data[u];da(d,!1);const h=l[kt].createComment("");wy(c,l,h,d),Ns(h,l),Oy(l,l[u]=DL(h,l,h,d)),ay(d)&&wI(c,l,d),null!=o&&SI(l,d,a)}function oe(n,t,e){const i=fe();return As(i,Jd(),t)&&Ar(Kt(),ri(),i,n,t,i[kt],e,!1),oe}function RI(n,t,e,i,s){const o=s?"class":"style";AI(n,e,t.inputs[o],o,i)}function w(n,t,e,i){const s=fe(),r=Kt(),o=zn+n,a=s[kt],l=r.firstCreatePass?function One(n,t,e,i,s,r){const o=t.consts,l=gh(t,n,2,i,Yl(o,s));return EI(t,e,l,Yl(o,r)),null!==l.attrs&&$y(l,l.attrs,!1),null!==l.mergedAttrs&&$y(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(o,r,s,t,e,i):r.data[o],c=s[o]=GS(a,t,function WQ(){return gt.lFrame.currentNamespace}()),u=ay(l);return da(l,!0),MF(a,c,l),32!=(32&l.flags)&&wy(r,s,c,l),0===function kQ(){return gt.lFrame.elementDepthCount}()&&Ns(c,s),function TQ(){gt.lFrame.elementDepthCount++}(),u&&(wI(r,s,l),CI(r,l,s)),null!==i&&SI(s,l),w}function C(){let n=_s();mS()?gS():(n=n.parent,da(n,!1));const t=n;!function DQ(){gt.lFrame.elementDepthCount--}();const e=Kt();return e.firstCreatePass&&(uy(e,n),hS(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function qQ(n){return 0!=(8&n.flags)}(t)&&RI(e,t,fe(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function KQ(n){return 0!=(16&n.flags)}(t)&&RI(e,t,fe(),t.stylesWithoutHost,!1),C}function Ne(n,t,e,i){return w(n,t,e,i),C(),Ne}function to(){return fe()}function Kp(n){return!!n&&"function"==typeof n.then}const LI=function YL(n){return!!n&&"function"==typeof n.subscribe};function H(n,t,e,i){const s=fe(),r=Kt(),o=_s();return function QL(n,t,e,i,s,r,o){const a=ay(i),c=n.firstCreatePass&&AL(n),u=t[ki],d=NL(t);let h=!0;if(3&i.type||o){const g=Tr(i,t),m=o?o(g):g,b=d.length,_=o?v=>o(bs(v[i.index])):i.index;let y=null;if(!o&&a&&(y=function Lne(n,t,e,i){const s=n.cleanup;if(null!=s)for(let r=0;r<s.length-1;r+=2){const o=s[r];if(o===e&&s[r+1]===i){const a=t[Kd],l=s[r+2];return a.length>l?a[l]:null}"string"==typeof o&&(r+=2)}return null}(n,t,s,i.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=r,y.__ngLastListenerFn__=r,h=!1;else{r=e$(i,t,u,r,!1);const v=e.listen(m,s,r);d.push(r,v),c&&c.push(s,_,b,b+1)}}else r=e$(i,t,u,r,!1);const f=i.outputs;let p;if(h&&null!==f&&(p=f[s])){const g=p.length;if(g)for(let m=0;m<g;m+=2){const x=t[p[m]][p[m+1]].subscribe(r),S=d.length;d.push(r,x),c&&c.push(s,i.index,S,-(S+1))}}}(r,s,s[kt],o,n,t,i),H}function JL(n,t,e,i){try{return Qr(6,t,e),!1!==e(i)}catch(s){return PL(n,s),!1}finally{Qr(7,t,e)}}function e$(n,t,e,i,s){return function r(o){if(o===Function)return i;Fy(n.componentOffset>-1?ur(n.index,t):t);let l=JL(t,e,i,o),c=r.__ngNextListenerFn__;for(;c;)l=JL(t,e,c,o)&&l,c=c.__ngNextListenerFn__;return s&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Ge(n=1){return function LQ(n){return(gt.lFrame.contextLView=function $Q(n,t){for(;n>0;)t=t[Xd],n--;return t}(n,gt.lFrame.contextLView))[ki]}(n)}function $ne(n,t){let e=null;const i=function ute(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(!(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const r=t[s];if("*"!==r){if(null===i?aL(n,r,!0):fte(i,r))return s}else e=s}return e}function $I(n){const t=fe()[Ds][Ts];if(!t.projection){const i=t.projection=Rp(n?n.length:1,null),s=i.slice();let r=t.child;for(;null!==r;){const o=n?$ne(r,n):0;null!==o&&(s[o]?s[o].projectionNext=r:i[o]=r,s[o]=r),r=r.next}}}function Xp(n,t=0,e){const i=fe(),s=Kt(),r=gh(s,zn+n,16,null,e||null);null===r.projection&&(r.projection=t),gS(),32!=(32&r.flags)&&function QJ(n,t,e){NF(t[kt],0,t,e,xF(n,e,t),IF(e.parent||t[Ts],e,t))}(s,i,r)}function Eh(n,t,e){return BI(n,"",t,"",e),Eh}function BI(n,t,e,i,s){const r=fe(),o=_h(r,t,e,i);return o!==bt&&Ar(Kt(),ri(),r,n,o,r[kt],s,!1),BI}function Uy(n,t){return n<<17|t<<2}function Ql(n){return n>>17&32767}function VI(n){return 2|n}function Cu(n){return(131068&n)>>2}function zI(n,t){return-131069&n|t<<2}function UI(n){return 1|n}function c$(n,t,e,i,s){const r=n[e+1],o=null===t;let a=i?Ql(r):Cu(r),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];Hne(n[a],t)&&(l=!0,n[a+1]=i?UI(u):VI(u)),a=i?Ql(u):Cu(u)}l&&(n[e+1]=i?VI(r):UI(r))}function Hne(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&oh(n,t)>=0}const Ki={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function u$(n){return n.substring(Ki.key,Ki.keyEnd)}function d$(n,t){const e=Ki.textEnd;return e===t?-1:(t=Ki.keyEnd=function Kne(n,t,e){for(;t<e&&n.charCodeAt(t)>32;)t++;return t}(n,Ki.key=t,e),kh(n,t,e))}function kh(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function Wy(n,t,e){return Oo(n,t,e,!1),Wy}function Zs(n,t){return Oo(n,t,null,!0),Zs}function _a(n,t){for(let e=function Gne(n){return function f$(n){Ki.key=0,Ki.keyEnd=0,Ki.value=0,Ki.valueEnd=0,Ki.textEnd=n.length}(n),d$(n,kh(n,0,Ki.textEnd))}(t);e>=0;e=d$(t,e))Dr(n,u$(t),!0)}function Oo(n,t,e,i){const s=fe(),r=Kt(),o=sl(2);r.firstUpdatePass&&b$(r,n,o,i),t!==bt&&As(s,o,t)&&y$(r,r.data[Ys()],s,s[kt],n,s[o+1]=function oie(n,t){return null==n||""===n||("string"==typeof t?n+=t:"object"==typeof n&&(n=An(Nr(n)))),n}(t,e),i,o)}function g$(n,t){return t>=n.expandoStartIndex}function b$(n,t,e,i){const s=n.data;if(null===s[e+1]){const r=s[Ys()],o=g$(n,e);x$(r,i)&&null===t&&!o&&(t=!1),t=function Jne(n,t,e,i){const s=function _S(n){const t=gt.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let r=i?t.residualClasses:t.residualStyles;if(null===s)0===(i?t.classBindings:t.styleBindings)&&(e=Yp(e=WI(null,n,t,e,i),t.attrs,i),r=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=WI(s,n,t,e,i),null===r){let l=function eie(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==Cu(i))return n[Ql(i)]}(n,t,i);void 0!==l&&Array.isArray(l)&&(l=WI(null,n,t,l[1],i),l=Yp(l,t.attrs,i),function tie(n,t,e,i){n[Ql(e?t.classBindings:t.styleBindings)]=i}(n,t,i,l))}else r=function nie(n,t,e){let i;const s=t.directiveEnd;for(let r=1+t.directiveStylingLast;r<s;r++)i=Yp(i,n[r].hostAttrs,e);return Yp(i,t.attrs,e)}(n,t,i)}return void 0!==r&&(i?t.residualClasses=r:t.residualStyles=r),e}(s,r,t,i),function Une(n,t,e,i,s,r){let o=r?t.classBindings:t.styleBindings,a=Ql(o),l=Cu(o);n[i]=e;let u,c=!1;if(Array.isArray(e)?(u=e[1],(null===u||oh(e,u)>0)&&(c=!0)):u=e,s)if(0!==l){const h=Ql(n[a+1]);n[i+1]=Uy(h,a),0!==h&&(n[h+1]=zI(n[h+1],i)),n[a+1]=function Vne(n,t){return 131071&n|t<<17}(n[a+1],i)}else n[i+1]=Uy(a,0),0!==a&&(n[a+1]=zI(n[a+1],i)),a=i;else n[i+1]=Uy(l,0),0===a?a=i:n[l+1]=zI(n[l+1],i),l=i;c&&(n[i+1]=VI(n[i+1])),c$(n,u,i,!0),c$(n,u,i,!1),function Wne(n,t,e,i,s){const r=s?n.residualClasses:n.residualStyles;null!=r&&"string"==typeof t&&oh(r,t)>=0&&(e[i+1]=UI(e[i+1]))}(t,u,n,i,r),o=Uy(a,l),r?t.classBindings=o:t.styleBindings=o}(s,r,t,e,o,i)}}function WI(n,t,e,i,s){let r=null;const o=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<o&&(r=t[a],i=Yp(i,r.hostAttrs,s),r!==n);)a++;return null!==n&&(e.directiveStylingLast=a),i}function Yp(n,t,e){const i=e?1:2;let s=-1;if(null!==t)for(let r=0;r<t.length;r++){const o=t[r];"number"==typeof o?s=o:s===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Dr(n,o,!!e||t[++r]))}return void 0===n?null:n}function y$(n,t,e,i,s,r,o,a){if(!(3&t.type))return;const l=n.data,c=l[a+1],u=function zne(n){return 1==(1&n)}(c)?v$(l,t,e,s,Cu(c),o):void 0;Hy(u)||(Hy(r)||function Bne(n){return 2==(2&n)}(c)&&(r=v$(l,null,e,s,a,o)),function eee(n,t,e,i,s){if(t)s?n.addClass(e,i):n.removeClass(e,i);else{let r=-1===i.indexOf("-")?void 0:dr.DashCase;null==s?n.removeStyle(e,i,r):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),r|=dr.Important),n.setStyle(e,i,s,r))}}(i,o,ly(Ys(),e),s,r))}function v$(n,t,e,i,s,r){const o=null===t;let a;for(;s>0;){const l=n[s],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=e[s+1];h===bt&&(h=d?on:void 0);let f=d?MS(h,i):u===i?h:void 0;if(c&&!Hy(f)&&(f=MS(l,i)),Hy(f)&&(a=f,o))return a;const p=n[s+1];s=o?Ql(p):Cu(p)}if(null!==t){let l=r?t.residualClasses:t.residualStyles;null!=l&&(a=MS(l,i))}return a}function Hy(n){return void 0!==n}function x$(n,t){return 0!=(n.flags&(t?8:16))}function I(n,t=""){const e=fe(),i=Kt(),s=n+zn,r=i.firstCreatePass?gh(i,s,1,t,null):i.data[s],o=e[s]=function jS(n,t){return n.createText(t)}(e[kt],t);wy(i,e,o,r),da(r,!1)}function ot(n){return ln("",n,""),ot}function ln(n,t,e){const i=fe(),s=_h(i,n,t,e);return s!==bt&&cl(i,Ys(),s),ln}function HI(n,t,e,i,s){const r=fe(),o=function yh(n,t,e,i,s,r){const a=xu(n,il(),e,s);return sl(2),a?t+mt(e)+i+mt(s)+r:bt}(r,n,t,e,i,s);return o!==bt&&cl(r,Ys(),o),HI}function jy(n,t,e,i,s,r,o){const a=fe(),l=function vh(n,t,e,i,s,r,o,a){const c=zy(n,il(),e,s,o);return sl(3),c?t+mt(e)+i+mt(s)+r+mt(o)+a:bt}(a,n,t,e,i,s,r,o);return l!==bt&&cl(a,Ys(),l),jy}function jI(n,t,e,i,s,r,o,a,l){const c=fe(),u=xh(c,n,t,e,i,s,r,o,a,l);return u!==bt&&cl(c,Ys(),u),jI}function k$(n,t,e){!function Fo(n,t,e,i){const s=Kt(),r=sl(2);s.firstUpdatePass&&b$(s,null,r,i);const o=fe();if(e!==bt&&As(o,r,e)){const a=s.data[Ys()];if(x$(a,i)&&!g$(s,r)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(e=tS(l,e||"")),RI(s,a,o,e,i)}else!function rie(n,t,e,i,s,r,o,a){s===bt&&(s=on);let l=0,c=0,u=0<s.length?s[0]:null,d=0<r.length?r[0]:null;for(;null!==u||null!==d;){const h=l<s.length?s[l+1]:void 0,f=c<r.length?r[c+1]:void 0;let g,p=null;u===d?(l+=2,c+=2,h!==f&&(p=d,g=f)):null===d||null!==u&&u<d?(l+=2,p=u):(c+=2,p=d,g=f),null!==p&&y$(n,t,e,i,p,g,o,a),u=l<s.length?s[l]:null,d=c<r.length?r[c]:null}}(s,a,o,o[kt],o[r+1],o[r+1]=function iie(n,t,e){if(null==e||""===e)return on;const i=[],s=Nr(e);if(Array.isArray(s))for(let r=0;r<s.length;r++)n(i,s[r],!0);else if("object"==typeof s)for(const r in s)s.hasOwnProperty(r)&&n(i,r,s[r]);else"string"==typeof s&&t(i,s);return i}(n,t,e),i,r)}}(Dr,_a,_h(fe(),n,t,e),!0)}const wu=void 0;var Iie=["en",[["a","p"],["AM","PM"],wu],[["AM","PM"],wu,wu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wu,"{1} 'at' {0}",wu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Sie(n){const e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Th={};function Qs(n){const t=function Eie(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=V$(t);if(e)return e;const i=t.split("-")[0];if(e=V$(i),e)return e;if("en"===i)return Iie;throw new re(701,!1)}function V$(n){return n in Th||(Th[n]=Vn.ng&&Vn.ng.common&&Vn.ng.common.locales&&Vn.ng.common.locales[n]),Th[n]}var Re=(()=>((Re=Re||{})[Re.LocaleId=0]="LocaleId",Re[Re.DayPeriodsFormat=1]="DayPeriodsFormat",Re[Re.DayPeriodsStandalone=2]="DayPeriodsStandalone",Re[Re.DaysFormat=3]="DaysFormat",Re[Re.DaysStandalone=4]="DaysStandalone",Re[Re.MonthsFormat=5]="MonthsFormat",Re[Re.MonthsStandalone=6]="MonthsStandalone",Re[Re.Eras=7]="Eras",Re[Re.FirstDayOfWeek=8]="FirstDayOfWeek",Re[Re.WeekendRange=9]="WeekendRange",Re[Re.DateFormat=10]="DateFormat",Re[Re.TimeFormat=11]="TimeFormat",Re[Re.DateTimeFormat=12]="DateTimeFormat",Re[Re.NumberSymbols=13]="NumberSymbols",Re[Re.NumberFormats=14]="NumberFormats",Re[Re.CurrencyCode=15]="CurrencyCode",Re[Re.CurrencySymbol=16]="CurrencySymbol",Re[Re.CurrencyName=17]="CurrencyName",Re[Re.Currencies=18]="Currencies",Re[Re.Directionality=19]="Directionality",Re[Re.PluralCase=20]="PluralCase",Re[Re.ExtraData=21]="ExtraData",Re))();const Dh="en-US";let z$=Dh;function KI(n,t,e,i,s){if(n=nt(n),Array.isArray(n))for(let r=0;r<n.length;r++)KI(n[r],t,e,i,s);else{const r=Kt(),o=fe();let a=yu(n)?n:nt(n.provide),l=eL(n);const c=_s(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(yu(n)||!n.multi){const f=new Dp(l,s,ie),p=YI(a,t,s?u:u+h,d);-1===p?(TS(gy(c,o),r,a),XI(r,n,t.length),t.push(a),c.directiveStart++,c.directiveEnd++,s&&(c.providerIndexes+=1048576),e.push(f),o.push(f)):(e[p]=f,o[p]=f)}else{const f=YI(a,t,u+h,d),p=YI(a,t,u,u+h),m=p>=0&&e[p];if(s&&!m||!s&&!(f>=0&&e[f])){TS(gy(c,o),r,a);const b=function wse(n,t,e,i,s){const r=new Dp(n,e,ie);return r.multi=[],r.index=t,r.componentProviders=0,hB(r,s,i&&!e),r}(s?Cse:xse,e.length,s,i,l);!s&&m&&(e[p].providerFactory=b),XI(r,n,t.length,0),t.push(a),c.directiveStart++,c.directiveEnd++,s&&(c.providerIndexes+=1048576),e.push(b),o.push(b)}else XI(r,n,f>-1?f:p,hB(e[s?p:f],l,!s&&i));!s&&i&&m&&e[p].componentProviders++}}}function XI(n,t,e,i){const s=yu(t),r=function Oee(n){return!!n.useClass}(t);if(s||r){const l=(r?nt(t.useClass):t).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const u=c.indexOf(e);-1===u?c.push(e,[i,l]):c[u+1].push(i,l)}else c.push(e,l)}}}function hB(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function YI(n,t,e,i){for(let s=e;s<i;s++)if(t[s]===n)return s;return-1}function xse(n,t,e,i){return ZI(this.multi,[])}function Cse(n,t,e,i){const s=this.multi;let r;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=mu(e,e[Le],this.providerFactory.index,i);r=a.slice(0,o),ZI(s,r);for(let l=o;l<a.length;l++)r.push(a[l])}else r=[],ZI(s,r);return r}function ZI(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function pn(n,t=[]){return e=>{e.providersResolver=(i,s)=>function vse(n,t,e){const i=Kt();if(i.firstCreatePass){const s=Mo(n);KI(e,i.data,i.blueprint,s,!0),KI(t,i.data,i.blueprint,s,!1)}}(i,s?s(n):n,t)}}class Nh{}class fB{}class pB extends Nh{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new RL(this);const i=Ir(t);this._bootstrapComponents=ll(i.bootstrap),this._r3Injector=pL(t,e,[{provide:Nh,useValue:this},{provide:Up,useValue:this.componentFactoryResolver}],An(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class QI extends fB{constructor(t){super(),this.moduleType=t}create(t){return new pB(this.moduleType,t)}}class Ise extends Nh{constructor(t,e,i){super(),this.componentFactoryResolver=new RL(this),this.instance=null;const s=new JF([...t,{provide:Nh,useValue:this},{provide:Up,useValue:this.componentFactoryResolver}],e||Ay(),i,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function Yy(n,t,e=null){return new Ise(n,t,e).injector}let Ese=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const i=XF(0,e.type),s=i.length>0?Yy([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Pe({token:n,providedIn:"environment",factory:()=>new n(me(pa))}),n})();function mB(n){n.getStandaloneInjector=t=>t.get(Ese).getOrCreateStandaloneInjector(n)}function no(n,t,e){const i=Xs()+n,s=fe();return s[i]===bt?ga(s,i,e?t.call(e):t()):function qp(n,t){return n[t]}(s,i)}function CB(n,t,e,i,s,r){return function IB(n,t,e,i,s,r,o,a){const l=t+e;return zy(n,l,s,r,o)?ga(n,l+3,a?i.call(a,s,r,o):i(s,r,o)):nm(n,l+3)}(fe(),Xs(),n,t,e,i,s,r)}function nm(n,t){const e=n[t];return e===bt?void 0:e}function oi(n,t){const e=Kt();let i;const s=n+zn;e.firstCreatePass?(i=function Wse(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[s]=i,i.onDestroy&&(e.destroyHooks??(e.destroyHooks=[])).push(s,i.onDestroy)):i=e.data[s];const r=i.factory||(i.factory=fu(i.type)),o=Zr(ie);try{const a=my(!1),l=r();return my(a),function Pne(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,fe(),s,l),l}finally{Zr(o)}}function TB(n,t,e){const i=n+zn,s=fe(),r=Qd(s,i);return im(s,i)?function wB(n,t,e,i,s,r){const o=t+e;return As(n,o,s)?ga(n,o+1,r?i.call(r,s):i(s)):nm(n,o+1)}(s,Xs(),t,r.transform,e,r):r.transform(e)}function bi(n,t,e,i){const s=n+zn,r=fe(),o=Qd(r,s);return im(r,s)?function SB(n,t,e,i,s,r,o){const a=t+e;return xu(n,a,s,r)?ga(n,a+2,o?i.call(o,s,r):i(s,r)):nm(n,a+2)}(r,Xs(),t,o.transform,e,i,o):o.transform(e,i)}function im(n,t){return n[Le].data[t].pure}function eE(n){return t=>{setTimeout(n,void 0,t)}}const Yt=class qse extends Ut{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let s=t,r=e||(()=>null),o=i;if(t&&"object"==typeof t){const l=t;s=l.next?.bind(l),r=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(r=eE(r),s&&(s=eE(s)),o&&(o=eE(o)));const a=super.subscribe({next:s,error:r,complete:o});return t instanceof G&&t.add(a),a}};function Kse(){return this._results[Symbol.iterator]()}class tE{get changes(){return this._changes||(this._changes=new Yt)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=tE.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=Kse)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const s=function Jr(n){return n.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function sJ(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let s=n[i],r=t[i];if(e&&(s=e(s),r=e(r)),r!==s)return!1}return!0}(i._results,s,e))&&(i._results=s,i.length=s.length,i.last=s[this.length-1],i.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Lo=(()=>{class n{}return n.__NG_ELEMENT_ID__=Zse,n})();const Xse=Lo,Yse=class extends Xse{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t,e){const i=this._declarationTContainer.tView,s=Py(this._declarationLView,i,t,16,null,i.declTNode,null,null,null,null,e||null);s[Ip]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[ua];return null!==o&&(s[ua]=o.createEmbeddedView(i)),xI(i,s,t),new jp(s)}};function Zse(){return Zy(_s(),fe())}function Zy(n,t){return 4&n.type?new Yse(t,n,fh(n,t)):null}let so=(()=>{class n{}return n.__NG_ELEMENT_ID__=Qse,n})();function Qse(){return AB(_s(),fe())}const Jse=so,DB=class extends Jse{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return fh(this._hostTNode,this._hostLView)}get injector(){return new th(this._hostTNode,this._hostLView)}get parentInjector(){const t=kS(this._hostTNode,this._hostLView);if($O(t)){const e=py(t,this._hostLView),i=fy(t);return new th(e[Le].data[i+8],e)}return new th(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=NB(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-Ks}createEmbeddedView(t,e,i){let s,r;"number"==typeof i?s=i:null!=i&&(s=i.index,r=i.injector);const o=t.createEmbeddedView(e||{},r);return this.insert(o,s),o}createComponent(t,e,i,s,r){const o=t&&!function Pp(n){return"function"==typeof n}(t);let a;if(o)a=e;else{const d=e||{};a=d.index,i=d.injector,s=d.projectableNodes,r=d.environmentInjector||d.ngModuleRef}const l=o?t:new Gp(fn(t)),c=i||this.parentInjector;if(!r&&null==l.ngModule){const h=(o?c:this.parentInjector).get(pa,null);h&&(r=h)}const u=l.create(c,s,void 0,r);return this.insert(u.hostView,a),u}insert(t,e){const i=t._lView,s=i[Le];if(function EQ(n){return Ao(n[pi])}(i)){const u=this.indexOf(t);if(-1!==u)this.detach(u);else{const d=i[pi],h=new DB(d,d[Ts],d[pi]);h.detach(h.indexOf(t))}}const r=this._adjustIndex(e),o=this._lContainer;!function GJ(n,t,e,i){const s=Ks+i,r=e.length;i>0&&(e[s-1][No]=t),i<r-Ks?(t[No]=e[s],YO(e,Ks+i,t)):(e.push(t),t[No]=null),t[pi]=e;const o=t[Ip];null!==o&&e!==o&&function qJ(n,t){const e=n[Zd];t[Ds]!==t[pi][pi][Ds]&&(n[hO]=!0),null===e?n[Zd]=[t]:e.push(t)}(o,t);const a=t[ua];null!==a&&a.insertView(n),t[wt]|=64}(s,i,o,r);const a=YS(r,o),l=i[kt],c=Cy(l,o[ry]);return null!==c&&function WJ(n,t,e,i,s,r){i[nl]=s,i[Ts]=t,Bp(n,i,e,1,s,r)}(s,o[Ts],l,i,c,a),t.attachToViewContainerRef(),YO(nE(o),r,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=NB(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=qS(this._lContainer,e);i&&(_y(nE(this._lContainer),e),vF(i[Le],i))}detach(t){const e=this._adjustIndex(t,-1),i=qS(this._lContainer,e);return i&&null!=_y(nE(this._lContainer),e)?new jp(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function NB(n){return n[oy]}function nE(n){return n[oy]||(n[oy]=[])}function AB(n,t){let e;const i=t[n.index];if(Ao(i))e=i;else{let s;if(8&n.type)s=bs(i);else{const r=t[kt];s=r.createComment("");const o=Tr(n,t);bu(r,Cy(r,o),s,function ZJ(n,t){return n.nextSibling(t)}(r,o),!1)}t[n.index]=e=DL(i,t,s,n),Oy(t,e)}return new DB(e,n,t)}class iE{constructor(t){this.queryList=t,this.matches=null}clone(){return new iE(this.queryList)}setDirty(){this.queryList.setDirty()}}class sE{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let r=0;r<i;r++){const o=e.getByIndex(r);s.push(this.queries[o.indexInDeclarationView].clone())}return new sE(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==LB(t,e).matches&&this.queries[e].setDirty()}}class MB{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class rE{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const s=null!==e?e.length:0,r=this.getByIndex(i).embeddedTView(t,s);r&&(r.indexInDeclarationView=i,null!==e?e.push(r):e=[r])}return null!==e?new rE(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class oE{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new oE(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let s=0;s<i.length;s++){const r=i[s];this.matchTNodeWithReadOption(t,e,ere(e,r)),this.matchTNodeWithReadOption(t,e,by(e,t,r,!1,!1))}else i===Lo?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,by(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const s=this.metadata.read;if(null!==s)if(s===Ri||s===so||s===Lo&&4&e.type)this.addMatch(e.index,-2);else{const r=by(e,t,s,!1,!1);null!==r&&this.addMatch(e.index,r)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function ere(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function nre(n,t,e,i){return-1===e?function tre(n,t){return 11&n.type?fh(n,t):4&n.type?Zy(n,t):null}(t,n):-2===e?function ire(n,t,e){return e===Ri?fh(t,n):e===Lo?Zy(t,n):e===so?AB(t,n):void 0}(n,t,i):mu(n,n[Le],e,t)}function PB(n,t,e,i){const s=t[ua].queries[i];if(null===s.matches){const r=n.data,o=e.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:nre(t,r[c],o[l+1],e.metadata.read))}s.matches=a}return s.matches}function aE(n,t,e,i){const s=n.queries.getByIndex(e),r=s.matches;if(null!==r){const o=PB(n,t,s,e);for(let a=0;a<r.length;a+=2){const l=r[a];if(l>0)i.push(o[a/2]);else{const c=r[a+1],u=t[-l];for(let d=Ks;d<u.length;d++){const h=u[d];h[Ip]===h[pi]&&aE(h[Le],h,c,i)}if(null!==u[Zd]){const d=u[Zd];for(let h=0;h<d.length;h++){const f=d[h];aE(f[Le],f,c,i)}}}}}return i}function Ah(n){const t=fe(),e=Kt(),i=TO();yS(i+1);const s=LB(e,i);if(n.dirty&&function IQ(n){return 4==(4&n[wt])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const r=s.crossesNgTemplate?aE(e,t,i,[]):PB(e,t,s,i);n.reset(r,Gee),n.notifyOnChanges()}return!0}return!1}function sm(n,t,e,i){const s=Kt();if(s.firstCreatePass){const r=_s();FB(s,new MB(t,e,i),r.index),function rre(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(s,n),2==(2&e)&&(s.staticContentQueries=!0)}OB(s,fe(),e)}function Mh(){return function sre(n,t){return n[ua].queries[t].queryList}(fe(),TO())}function OB(n,t,e){const i=new tE(4==(4&e));SL(n,t,i,i.destroy),null===t[ua]&&(t[ua]=new sE),t[ua].queries.push(new iE(i))}function FB(n,t,e){null===n.queries&&(n.queries=new rE),n.queries.track(new oE(t,e))}function LB(n,t){return n.queries.getByIndex(t)}function Jy(...n){}const e0=new Ce("Application Initializer");let t0=(()=>{class n{constructor(e){this.appInits=e,this.resolve=Jy,this.reject=Jy,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,s)=>{this.resolve=i,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const r=this.appInits[s]();if(Kp(r))e.push(r);else if(LI(r)){const o=new Promise((a,l)=>{r.subscribe({complete:a,error:l})});e.push(o)}}Promise.all(e).then(()=>{i()}).catch(s=>{this.reject(s)}),0===e.length&&i(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(me(e0,8))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const om=new Ce("AppId",{providedIn:"root",factory:function t3(){return`${fE()}${fE()}${fE()}`}});function fE(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const n3=new Ce("Platform Initializer"),n0=new Ce("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),s0=new Ce("AnimationModuleType");let Ere=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ya=new Ce("LocaleId",{providedIn:"root",factory:()=>ht(ya,it.Optional|it.SkipSelf)||function kre(){return typeof $localize<"u"&&$localize.locale||Dh}()});class Dre{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let s3=(()=>{class n{compileModuleSync(e){return new QI(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const i=this.compileModuleSync(e),r=ll(Ir(e).declarations).reduce((o,a)=>{const l=fn(a);return l&&o.push(new Gp(l)),o},[]);return new Dre(i,r)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Mre=(()=>Promise.resolve(0))();function pE(n){typeof Zone>"u"?Mre.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Zt{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yt(!1),this.onMicrotaskEmpty=new Yt(!1),this.onStable=new Yt(!1),this.onError=new Yt(!1),typeof Zone>"u")throw new re(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&e,s.shouldCoalesceRunChangeDetection=i,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function Pre(){let n=Vn.requestAnimationFrame,t=Vn.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Fre(n){const t=()=>{!function Ore(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Vn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,gE(n),n.isCheckStableRunning=!0,mE(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),gE(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,s,r,o,a)=>{try{return a3(n),e.invokeTask(s,r,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===r.type||n.shouldCoalesceRunChangeDetection)&&t(),l3(n)}},onInvoke:(e,i,s,r,o,a,l)=>{try{return a3(n),e.invoke(s,r,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&t(),l3(n)}},onHasTask:(e,i,s,r)=>{e.hasTask(s,r),i===s&&("microTask"==r.change?(n._hasPendingMicrotasks=r.microTask,gE(n),mE(n)):"macroTask"==r.change&&(n.hasPendingMacrotasks=r.macroTask))},onHandleError:(e,i,s,r)=>(e.handleError(s,r),n.runOutsideAngular(()=>n.onError.emit(r)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Zt.isInAngularZone())throw new re(909,!1)}static assertNotInAngularZone(){if(Zt.isInAngularZone())throw new re(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,s){const r=this._inner,o=r.scheduleEventTask("NgZoneEvent: "+s,t,Rre,Jy,Jy);try{return r.runTask(o,e,i)}finally{r.cancelTask(o)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const Rre={};function mE(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function gE(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function a3(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function l3(n){n._nesting--,mE(n)}class Lre{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Yt,this.onMicrotaskEmpty=new Yt,this.onStable=new Yt,this.onError=new Yt}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,s){return t.apply(e,i)}}const c3=new Ce(""),r0=new Ce("");let yE,bE=(()=>{class n{constructor(e,i,s){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,yE||(function $re(n){yE=n}(s),s.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Zt.assertNotInAngularZone(),pE(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())pE(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,s){let r=-1;i&&i>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==r),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:s})}whenStable(e,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(me(Zt),me(_E),me(r0))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})(),_E=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return yE?.findTestabilityInTree(this,e,i)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ul=!1;let Jl=null;const u3=new Ce("AllowMultipleToken"),vE=new Ce("PlatformDestroyListeners"),d3=new Ce("appBootstrapListener");class h3{constructor(t,e){this.name=t,this.token=e}}function p3(n,t,e=[]){const i=`Platform: ${t}`,s=new Ce(i);return(r=[])=>{let o=xE();if(!o||o.injector.get(u3,!1)){const a=[...e,...r,{provide:s,useValue:!0}];n?n(a):function zre(n){if(Jl&&!Jl.get(u3,!1))throw new re(400,!1);Jl=n;const t=n.get(g3);(function f3(n){const t=n.get(n3,null);t&&t.forEach(e=>e())})(n)}(function m3(n=[],t){return Ro.create({name:t,providers:[{provide:lI,useValue:"platform"},{provide:vE,useValue:new Set([()=>Jl=null])},...n]})}(a,i))}return function Wre(n){const t=xE();if(!t)throw new re(401,!1);return t}()}}function xE(){return Jl?.get(g3)??null}let g3=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const s=function _3(n,t){let e;return e="noop"===n?new Lre:("zone.js"===n?void 0:n)||new Zt(t),e}(i?.ngZone,function b3(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),r=[{provide:Zt,useValue:s}];return s.run(()=>{const o=Ro.create({providers:r,parent:this.injector,name:e.moduleType.name}),a=e.create(o),l=a.injector.get(al,null);if(!l)throw new re(402,!1);return s.runOutsideAngular(()=>{const c=s.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{o0(this._modules,a),c.unsubscribe()})}),function y3(n,t,e){try{const i=e();return Kp(i)?i.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(l,s,()=>{const c=a.injector.get(t0);return c.runInitializers(),c.donePromise.then(()=>(function U$(n){Yr(n,"Expected localeId to be defined"),"string"==typeof n&&(z$=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get(ya,Dh)||Dh),this._moduleDoBootstrap(a),a))})})}bootstrapModule(e,i=[]){const s=v3({},i);return function Bre(n,t,e){const i=new QI(e);return Promise.resolve(i)}(0,0,e).then(r=>this.bootstrapModuleFactory(r,s))}_moduleDoBootstrap(e){const i=e.injector.get(am);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new re(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new re(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(vE,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(me(Ro))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function v3(n,t){return Array.isArray(t)?t.reduce(v3,n):{...n,...t}}let am=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(e,i,s){this._zone=e,this._injector=i,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const r=new dt(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new dt(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{Zt.assertNotInAngularZone(),pE(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{Zt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=q_(r,o.pipe(JR()))}bootstrap(e,i){const s=e instanceof tL;if(!this._injector.get(t0).done){!s&&function qd(n){const t=fn(n)||ks(n)||cr(n);return null!==t&&t.standalone}(e);throw new re(405,ul)}let o;o=s?e:this._injector.get(Up).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const a=function Vre(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Nh),c=o.create(Ro.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(c3,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),o0(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new re(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;o0(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(d3,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>o0(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new re(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(me(Zt),me(pa),me(al))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function o0(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let Su=(()=>{class n{}return n.__NG_ELEMENT_ID__=jre,n})();function jre(n){return function Gre(n,t,e){if(kp(n)&&!e){const i=ur(n.index,t);return new jp(i,i)}return 47&n.type?new jp(t[Ds],t):null}(_s(),fe(),16==(16&n))}class I3{constructor(){}supports(t){return Vy(t)}create(t){return new Qre(t)}}const Zre=(n,t)=>t;class Qre{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Zre}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,s=0,r=null;for(;e||i;){const o=!i||e&&e.currentIndex<k3(i,s,r)?e:i,a=k3(o,s,r),l=o.currentIndex;if(o===i)s--,i=i._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{r||(r=[]);const c=a-s,u=l-s;if(c!=u){for(let h=0;h<c;h++){const f=h<r.length?r[h]:r[h]=0,p=f+h;u<=p&&p<c&&(r[h]=f+1)}r[o.previousIndex]=u-c}}a!==l&&t(o,a,l)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Vy(t))throw new re(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,r,o,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)r=t[a],o=this._trackByFn(a,r),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,r,o,a)),Object.is(e.item,r)||this._addIdentityChange(e,r)):(e=this._mismatch(e,r,o,a),i=!0),e=e._next}else s=0,function Dne(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Symbol.iterator]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,a=>{o=this._trackByFn(s,a),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,a,o,s)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,o,s),i=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,s){let r;return null===t?r=this._itTail:(r=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,s)):t=this._addAfter(new Jre(e,i),r,s),t}_verifyReinsertion(t,e,i,s){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==r?t=this._reinsertAfter(r,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,r=t._nextRemoved;return null===s?this._removalsHead=r:s._nextRemoved=r,null===r?this._removalsTail=s:r._prevRemoved=s,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new E3),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new E3),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Jre{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class eoe{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class E3{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new eoe,this.map.set(e,i)),i.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function k3(n,t,e){const i=n.previousIndex;if(null===i)return i;let s=0;return e&&i<e.length&&(s=e[i]),i+t+s}class T3{constructor(){}supports(t){return t instanceof Map||PI(t)}create(){return new toe}}class toe{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||PI(t)))throw new re(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(s,i);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const r=s._prev,o=s._next;return r&&(r._next=o),o&&(o._prev=r),s._next=null,s._prev=null,s}const i=new noe(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class noe{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function D3(){return new c0([new I3])}let c0=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(null!=i){const s=i.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||D3()),deps:[[n,new ah,new Zl]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(null!=i)return i;throw new re(901,!1)}}return n.\u0275prov=Pe({token:n,providedIn:"root",factory:D3}),n})();function N3(){return new lm([new T3])}let lm=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(i){const s=i.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||N3()),deps:[[n,new ah,new Zl]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(i)return i;throw new re(901,!1)}}return n.\u0275prov=Pe({token:n,providedIn:"root",factory:N3}),n})();const roe=p3(null,"core",[]);let ooe=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(me(am))},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({}),n})();function Oh(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let EE=null;function dl(){return EE}class coe{}const Jt=new Ce("DocumentToken");let kE=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(){return function uoe(){return me(A3)}()},providedIn:"platform"}),n})();const doe=new Ce("Location Initialized");let A3=(()=>{class n extends kE{constructor(e){super(),this._doc=e,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return dl().getBaseHref(this._doc)}onPopState(e){const i=dl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=dl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,s){M3()?this._history.pushState(e,i,s):this._location.hash=s}replaceState(e,i,s){M3()?this._history.replaceState(e,i,s):this._location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(me(Jt))},n.\u0275prov=Pe({token:n,factory:function(){return function hoe(){return new A3(me(Jt))}()},providedIn:"platform"}),n})();function M3(){return!!window.history.pushState}function TE(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function P3(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function hl(n){return n&&"?"!==n[0]?"?"+n:n}let Eu=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(){return ht(O3)},providedIn:"root"}),n})();const R3=new Ce("appBaseHref");let O3=(()=>{class n extends Eu{constructor(e,i){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??ht(Jt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return TE(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+hl(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${i}${s}`:i}pushState(e,i,s,r){const o=this.prepareExternalUrl(s+hl(r));this._platformLocation.pushState(e,i,o)}replaceState(e,i,s,r){const o=this.prepareExternalUrl(s+hl(r));this._platformLocation.replaceState(e,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(me(kE),me(R3,8))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),foe=(()=>{class n extends Eu{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=TE(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,s,r){let o=this.prepareExternalUrl(s+hl(r));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,i,o)}replaceState(e,i,s,r){let o=this.prepareExternalUrl(s+hl(r));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(me(kE),me(R3,8))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})(),DE=(()=>{class n{constructor(e){this._subject=new Yt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._basePath=function goe(n){if(new RegExp("^(https?:)?//").test(n)){const[,e]=n.split(/\/\/[^\/]+/);return e}return n}(P3(F3(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+hl(i))}normalize(e){return n.stripTrailingSlash(function moe(n,t){if(!n||!t.startsWith(n))return t;const e=t.substring(n.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,F3(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",s=null){this._locationStrategy.pushState(s,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hl(i)),s)}replaceState(e,i="",s=null){this._locationStrategy.replaceState(s,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hl(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(s=>s(e,i))}subscribe(e,i,s){return this._subject.subscribe({next:e,error:i,complete:s})}}return n.normalizeQueryParams=hl,n.joinWithSlash=TE,n.stripTrailingSlash=P3,n.\u0275fac=function(e){return new(e||n)(me(Eu))},n.\u0275prov=Pe({token:n,factory:function(){return function poe(){return new DE(me(Eu))}()},providedIn:"root"}),n})();function F3(n){return n.replace(/\/index.html$/,"")}var fr=(()=>((fr=fr||{})[fr.Decimal=0]="Decimal",fr[fr.Percent=1]="Percent",fr[fr.Currency=2]="Currency",fr[fr.Scientific=3]="Scientific",fr))(),et=(()=>((et=et||{})[et.Decimal=0]="Decimal",et[et.Group=1]="Group",et[et.List=2]="List",et[et.PercentSign=3]="PercentSign",et[et.PlusSign=4]="PlusSign",et[et.MinusSign=5]="MinusSign",et[et.Exponential=6]="Exponential",et[et.SuperscriptingExponent=7]="SuperscriptingExponent",et[et.PerMille=8]="PerMille",et[et.Infinity=9]="Infinity",et[et.NaN=10]="NaN",et[et.TimeSeparator=11]="TimeSeparator",et[et.CurrencyDecimal=12]="CurrencyDecimal",et[et.CurrencyGroup=13]="CurrencyGroup",et))();function ro(n,t){const e=Qs(n),i=e[Re.NumberSymbols][t];if(typeof i>"u"){if(t===et.CurrencyDecimal)return e[Re.NumberSymbols][et.Decimal];if(t===et.CurrencyGroup)return e[Re.NumberSymbols][et.Group]}return i}const Uoe=/^(\d+)?\.((\d+)(-(\d+))?)?$/,U3=22,_0=".",um="0",Woe=";",Hoe=",",RE="#";function LE(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function j3(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[s,r]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(s.trim()===t)return decodeURIComponent(r)}return null}const BE=/\s+/,G3=[];let VE=(()=>{class n{constructor(e,i,s,r){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=s,this._renderer=r,this.initialClasses=G3,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(BE):G3}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(BE):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,Boolean(e[i]));this._applyStateDiff()}_updateState(e,i){const s=this.stateMap.get(e);void 0!==s?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],s=e[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(BE).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(ie(c0),ie(lm),ie(Ri),ie(ol))},n.\u0275dir=Ze({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class eae{constructor(t,e,i,s){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ku=(()=>{class n{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,s){this._viewContainer=e,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((s,r,o)=>{if(null==s.previousIndex)i.createEmbeddedView(this._template,new eae(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===r?void 0:r);else if(null!==r){const a=i.get(r);i.move(a,o),X3(a,s)}});for(let s=0,r=i.length;s<r;s++){const a=i.get(s).context;a.index=s,a.count=r,a.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{X3(i.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(ie(so),ie(Lo),ie(c0))},n.\u0275dir=Ze({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function X3(n,t){n.context.$implicit=t.item}let pl=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new nae,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Y3("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Y3("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(ie(so),ie(Lo))},n.\u0275dir=Ze({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class nae{constructor(){this.$implicit=null,this.ngIf=null}}function Y3(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${An(t)}'.`)}let Q3=(()=>{class n{constructor(e,i,s){this._ngEl=e,this._differs=i,this._renderer=s,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[s,r]=e.split("."),o=-1===s.indexOf("-")?void 0:dr.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,s,r?`${i}${r}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,s,o)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(ie(Ri),ie(lm),ie(ol))},n.\u0275dir=Ze({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),n})();function Vo(n,t){return new re(2100,!1)}const hae=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g;let J3=(()=>{class n{transform(e){if(null==e)return null;if("string"!=typeof e)throw Vo();return e.replace(hae,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=lr({name:"titlecase",type:n,pure:!0,standalone:!0}),n})(),tV=(()=>{class n{constructor(e){this._locale=e}transform(e,i,s){if(!function WE(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function Koe(n,t,e){return function OE(n,t,e,i,s,r,o=!1){let a="",l=!1;if(isFinite(n)){let c=function Yoe(n){let i,s,r,o,a,t=Math.abs(n)+"",e=0;for((s=t.indexOf(_0))>-1&&(t=t.replace(_0,"")),(r=t.search(/e/i))>0?(s<0&&(s=r),s+=+t.slice(r+1),t=t.substring(0,r)):s<0&&(s=t.length),r=0;t.charAt(r)===um;r++);if(r===(a=t.length))i=[0],s=1;else{for(a--;t.charAt(a)===um;)a--;for(s-=r,i=[],o=0;r<=a;r++,o++)i[o]=Number(t.charAt(r))}return s>U3&&(i=i.splice(0,U3-1),e=s-1,s=1),{digits:i,exponent:e,integerLen:s}}(n);o&&(c=function Xoe(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(c));let u=t.minInt,d=t.minFrac,h=t.maxFrac;if(r){const _=r.match(Uoe);if(null===_)throw new Error(`${r} is not a valid digit info`);const y=_[1],v=_[3],x=_[5];null!=y&&(u=LE(y)),null!=v&&(d=LE(v)),null!=x?h=LE(x):null!=v&&d>h&&(h=d)}!function Zoe(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let i=n.digits,s=i.length-n.integerLen;const r=Math.min(Math.max(t,s),e);let o=r+n.integerLen,a=i[o];if(o>0){i.splice(Math.max(n.integerLen,o));for(let d=o;d<i.length;d++)i[d]=0}else{s=Math.max(0,s),n.integerLen=1,i.length=Math.max(1,o=r+1),i[0]=0;for(let d=1;d<o;d++)i[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[o-1]++;for(;s<Math.max(0,r);s++)i.push(0);let l=0!==r;const c=t+n.integerLen,u=i.reduceRight(function(d,h,f,p){return p[f]=(h+=d)<10?h:h-10,l&&(0===p[f]&&f>=c?p.pop():l=!1),h>=10?1:0},0);u&&(i.unshift(u),n.integerLen++)}(c,d,h);let f=c.digits,p=c.integerLen;const g=c.exponent;let m=[];for(l=f.every(_=>!_);p<u;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?m=f.splice(p,f.length):(m=f,f=[0]);const b=[];for(f.length>=t.lgSize&&b.unshift(f.splice(-t.lgSize,f.length).join(""));f.length>t.gSize;)b.unshift(f.splice(-t.gSize,f.length).join(""));f.length&&b.unshift(f.join("")),a=b.join(ro(e,i)),m.length&&(a+=ro(e,s)+m.join("")),g&&(a+=ro(e,et.Exponential)+"+"+g)}else a=ro(e,et.Infinity);return a=n<0&&!l?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf,a}(n,function FE(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(Woe),s=i[0],r=i[1],o=-1!==s.indexOf(_0)?s.split(_0):[s.substring(0,s.lastIndexOf(um)+1),s.substring(s.lastIndexOf(um)+1)],a=o[0],l=o[1]||"";e.posPre=a.substring(0,a.indexOf(RE));for(let u=0;u<l.length;u++){const d=l.charAt(u);d===um?e.minFrac=e.maxFrac=u+1:d===RE?e.maxFrac=u+1:e.posSuf+=d}const c=a.split(Hoe);if(e.gSize=c[1]?c[1].length:0,e.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,r){const u=s.length-e.posPre.length-e.posSuf.length,d=r.indexOf(RE);e.negPre=r.substring(0,d).replace(/'/g,""),e.negSuf=r.slice(d+u).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function NE(n,t){return Qs(n)[Re.NumberFormats][t]}(t,fr.Decimal),ro(t,et.MinusSign)),t,et.Group,et.Decimal,e)}(function HE(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,i)}catch(r){throw Vo()}}}return n.\u0275fac=function(e){return new(e||n)(ie(ya,16))},n.\u0275pipe=lr({name:"number",type:n,pure:!0,standalone:!0}),n})();let jE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({}),n})();const nV="browser";let Nae=(()=>{class n{}return n.\u0275prov=Pe({token:n,providedIn:"root",factory:()=>new Aae(me(Jt),window)}),n})();class Aae{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function Mae(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=i.currentNode;for(;s;){const r=s.shadowRoot;if(r){const o=r.getElementById(t)||r.querySelector(`[name="${t}"]`);if(o)return o}s=i.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(i-r[0],s-r[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=iV(this.window.history)||iV(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function iV(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class sV{}class rle extends coe{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class KE extends rle{static makeCurrent(){!function loe(n){EE||(EE=n)}(new KE)}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function ole(){return hm=hm||document.querySelector("base"),hm?hm.getAttribute("href"):null}();return null==e?null:function ale(n){x0=x0||document.createElement("a"),x0.setAttribute("href",n);const t=x0.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){hm=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return j3(document.cookie,t)}}let x0,hm=null;const cV=new Ce("TRANSITION_ID"),cle=[{provide:e0,useFactory:function lle(n,t,e){return()=>{e.get(t0).donePromise.then(()=>{const i=dl(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let r=0;r<s.length;r++)i.remove(s[r])})}},deps:[cV,Jt,Ro],multi:!0}];let dle=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();const C0=new Ce("EventManagerPlugins");let w0=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(s=>{s.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,s){return this._findPluginFor(i).addEventListener(e,i,s)}addGlobalEventListener(e,i,s){return this._findPluginFor(i).addGlobalEventListener(e,i,s)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const s=this._plugins;for(let r=0;r<s.length;r++){const o=s[r];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(me(C0),me(Zt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();class uV{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const s=dl().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,i)}}let dV=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(e){}onStyleAdded(e){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(e,i){const s=this.usageCount;let r=s.get(e)??0;return r+=i,r>0?s.set(e,r):s.delete(e),r}ngOnDestroy(){for(const e of this.getAllStyles())this.onStyleRemoved(e);this.usageCount.clear()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})(),fm=(()=>{class n extends dV{constructor(e){super(),this.doc=e,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.forEach(r=>r.remove()),i.delete(e)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}addStyleToHost(e,i){const s=this.doc.createElement("style");s.textContent=i,e.appendChild(s);const r=this.styleRef.get(i);r?r.push(s):this.styleRef.set(i,[s])}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return n.\u0275fac=function(e){return new(e||n)(me(Jt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();const XE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},YE=/%COMP%/g,pV=new Ce("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function mV(n,t){return t.flat(100).map(e=>e.replace(YE,n))}function gV(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let S0=(()=>{class n{constructor(e,i,s,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestory=r,this.rendererByCompId=new Map,this.defaultRenderer=new ZE(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;const s=this.getOrCreateRenderer(e,i);return s instanceof yV?s.applyToHost(e):s instanceof QE&&s.applyStyles(),s}getOrCreateRenderer(e,i){const s=this.rendererByCompId;let r=s.get(i.id);if(!r){const o=this.eventManager,a=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(i.encapsulation){case Do.Emulated:r=new yV(o,a,i,this.appId,l);break;case Do.ShadowDom:return new _le(o,a,e,i);default:r=new QE(o,a,i,l)}r.onDestroy=()=>s.delete(i.id),s.set(i.id,r)}return r}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(me(w0),me(fm),me(om),me(pV))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();class ZE{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(XE[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(_V(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(_V(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,s){if(s){e=s+":"+e;const r=XE[s];r?t.setAttributeNS(r,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const s=XE[i];s?t.removeAttributeNS(s,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,s){s&(dr.DashCase|dr.Important)?t.style.setProperty(e,i,s&dr.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&dr.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,gV(i)):this.eventManager.addEventListener(t,e,gV(i))}}function _V(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class _le extends ZE{constructor(t,e,i,s){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=mV(s.id,s.styles);for(const o of r){const a=document.createElement("style");a.textContent=o,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class QE extends ZE{constructor(t,e,i,s,r=i.id){super(t),this.sharedStylesHost=e,this.removeStylesOnCompDestory=s,this.rendererUsageCount=0,this.styles=mV(r,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class yV extends QE{constructor(t,e,i,s,r){const o=s+"-"+i.id;super(t,e,i,r,o),this.contentAttr=function mle(n){return"_ngcontent-%COMP%".replace(YE,n)}(o),this.hostAttr=function gle(n){return"_nghost-%COMP%".replace(YE,n)}(o)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}let yle=(()=>{class n extends uV{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,s){return e.addEventListener(i,s,!1),()=>this.removeEventListener(e,i,s)}removeEventListener(e,i,s){return e.removeEventListener(i,s)}}return n.\u0275fac=function(e){return new(e||n)(me(Jt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();const vV=["alt","control","meta","shift"],vle={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},xle={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Cle=(()=>{class n extends uV{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,s){const r=n.parseEventName(i),o=n.eventCallback(r.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>dl().onAndCancel(e,r.domEventName,o))}static parseEventName(e){const i=e.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const r=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),vV.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=r,0!=i.length||0===r.length)return null;const l={};return l.domEventName=s,l.fullKey=o,l}static matchEventFullKeyCode(e,i){let s=vle[e.key]||e.key,r="";return i.indexOf("code.")>-1&&(s=e.code,r="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),vV.forEach(o=>{o!==s&&(0,xle[o])(e)&&(r+=o+".")}),r+=s,r===i)}static eventCallback(e,i,s){return r=>{n.matchEventFullKeyCode(r,e)&&s.runGuarded(()=>i(r))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(me(Jt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();const Ele=p3(roe,"browser",[{provide:n0,useValue:nV},{provide:n3,useValue:function wle(){KE.makeCurrent()},multi:!0},{provide:Jt,useFactory:function Ile(){return function ree(n){eI=n}(document),document},deps:[]}]),wV=new Ce(""),SV=[{provide:r0,useClass:class ule{addToWindow(t){Vn.getAngularTestability=(i,s=!0)=>{const r=t.findTestabilityInTree(i,s);if(null==r)throw new Error("Could not find testability for element.");return r},Vn.getAllAngularTestabilities=()=>t.getAllTestabilities(),Vn.getAllAngularRootElements=()=>t.getAllRootElements(),Vn.frameworkStabilizers||(Vn.frameworkStabilizers=[]),Vn.frameworkStabilizers.push(i=>{const s=Vn.getAllAngularTestabilities();let r=s.length,o=!1;const a=function(l){o=o||l,r--,0==r&&i(o)};s.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?dl().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:c3,useClass:bE,deps:[Zt,_E,r0]},{provide:bE,useClass:bE,deps:[Zt,_E,r0]}],IV=[{provide:lI,useValue:"root"},{provide:al,useFactory:function Sle(){return new al},deps:[]},{provide:C0,useClass:yle,multi:!0,deps:[Jt,Zt,n0]},{provide:C0,useClass:Cle,multi:!0,deps:[Jt]},{provide:S0,useClass:S0,deps:[w0,fm,om,pV]},{provide:Wp,useExisting:S0},{provide:dV,useExisting:fm},{provide:fm,useClass:fm,deps:[Jt]},{provide:w0,useClass:w0,deps:[C0,Zt]},{provide:sV,useClass:dle,deps:[]},[]];let EV=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:om,useValue:e.appId},{provide:cV,useExisting:om},cle]}}}return n.\u0275fac=function(e){return new(e||n)(me(wV,12))},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({providers:[...IV,...SV],imports:[jE,ooe]}),n})(),kV=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(me(Jt))},n.\u0275prov=Pe({token:n,factory:function(e){let i=null;return i=e?new e:function Tle(){return new kV(me(Jt))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let tk=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(e){let i=null;return i=e?new(e||n):me(NV),i},providedIn:"root"}),n})(),NV=(()=>{class n extends tk{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case an.NONE:return i;case an.HTML:return fa(i,"HTML")?Nr(i):WF(this._doc,String(i)).toString();case an.STYLE:return fa(i,"Style")?Nr(i):i;case an.SCRIPT:if(fa(i,"Script"))return Nr(i);throw new Error("unsafe value used in a script context");case an.URL:return fa(i,"URL")?Nr(i):ky(String(i));case an.RESOURCE_URL:if(fa(i,"ResourceURL"))return Nr(i);throw new Error(`unsafe value used in a resource URL context (see ${K_})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${K_})`)}}bypassSecurityTrustHtml(e){return function hee(n){return new oee(n)}(e)}bypassSecurityTrustStyle(e){return function fee(n){return new aee(n)}(e)}bypassSecurityTrustScript(e){return function pee(n){return new lee(n)}(e)}bypassSecurityTrustUrl(e){return function mee(n){return new cee(n)}(e)}bypassSecurityTrustResourceUrl(e){return function gee(n){return new uee(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(me(Jt))},n.\u0275prov=Pe({token:n,factory:function(e){let i=null;return i=e?new e:function Ple(n){return new NV(n.get(Jt))}(me(Ro)),i},providedIn:"root"}),n})();function Ke(...n){return Pi(n,yp(n))}class ao extends Ut{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}const pm=Qe(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:Rle}=Array,{getPrototypeOf:Ole,prototype:Fle,keys:Lle}=Object;function AV(n){if(1===n.length){const t=n[0];if(Rle(t))return{args:t,keys:null};if(function $le(n){return n&&"object"==typeof n&&Ole(n)===Fle}(t)){const e=Lle(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:Ble}=Array;function nk(n){return lt(t=>function Vle(n,t){return Ble(t)?n(...t):n(t)}(n,t))}function MV(n,t){return n.reduce((e,i,s)=>(e[i]=t[s],e),{})}function ik(...n){const t=yp(n),e=XR(n),{args:i,keys:s}=AV(n);if(0===i.length)return Pi([],t);const r=new dt(function zle(n,t,e=$n){return i=>{PV(t,()=>{const{length:s}=n,r=new Array(s);let o=s,a=s;for(let l=0;l<s;l++)PV(t,()=>{const c=Pi(n[l],t);let u=!1;c.subscribe(Yn(i,d=>{r[l]=d,u||(u=!0,a--),a||i.next(e(r.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,t,s?o=>MV(s,o):$n));return e?r.pipe(nk(e)):r}function PV(n,t,e){n?Qa(e,n,t):t()}function I0(...n){return function Ule(){return jd(1)}()(Pi(n,yp(n)))}function RV(n){return new dt(t=>{qs(n()).subscribe(t)})}function Fh(n,t){const e=Fe(n)?n:()=>n,i=s=>s.error(e());return new dt(t?s=>t.schedule(i,0,s):i)}function sk(){return fi((n,t)=>{let e=null;n._refCount++;const i=Yn(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,r=e;e=null,s&&(!r||s===r)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}class OV extends dt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,OR(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new G;const e=this.getSubject();t.add(this.source.subscribe(Yn(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=G.EMPTY)}return t}refCount(){return sk()(this)}}function zo(n,t){return fi((e,i)=>{let s=null,r=0,o=!1;const a=()=>o&&!s&&i.complete();e.subscribe(Yn(i,l=>{s?.unsubscribe();let c=0;const u=r++;qs(n(l,u)).subscribe(s=Yn(i,d=>i.next(t?t(l,d,u,c++):d),()=>{s=null,a()}))},()=>{o=!0,a()}))})}function va(n){return n<=0?()=>la:fi((t,e)=>{let i=0;t.subscribe(Yn(e,s=>{++i<=n&&(e.next(s),n<=i&&e.complete())}))})}function mm(...n){const t=yp(n);return fi((e,i)=>{(t?I0(n,e,t):I0(n,e)).subscribe(i)})}function Uo(n,t){return fi((e,i)=>{let s=0;e.subscribe(Yn(i,r=>n.call(t,r,s++)&&i.next(r)))})}function E0(n){return fi((t,e)=>{let i=!1;t.subscribe(Yn(e,s=>{i=!0,e.next(s)},()=>{i||e.next(n),e.complete()}))})}function FV(n=Wle){return fi((t,e)=>{let i=!1;t.subscribe(Yn(e,s=>{i=!0,e.next(s)},()=>i?e.complete():e.error(n())))})}function Wle(){return new pm}function tc(n,t){const e=arguments.length>=2;return i=>i.pipe(n?Uo((s,r)=>n(s,r,i)):$n,va(1),e?E0(t):FV(()=>new pm))}function nc(n,t){return Fe(t)?as(n,t,1):as(n,1)}function Li(n,t,e){const i=Fe(n)||t||e?{next:n,error:t,complete:e}:n;return i?fi((s,r)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;s.subscribe(Yn(r,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),r.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),r.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),r.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):$n}function ml(n){return fi((t,e)=>{let r,i=null,s=!1;i=t.subscribe(Yn(e,void 0,void 0,o=>{r=qs(n(o,ml(n)(t))),i?(i.unsubscribe(),i=null,r.subscribe(e)):s=!0})),s&&(i.unsubscribe(),i=null,r.subscribe(e))})}function LV(n,t){return fi(function Hle(n,t,e,i,s){return(r,o)=>{let a=e,l=t,c=0;r.subscribe(Yn(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},s&&(()=>{a&&o.next(l),o.complete()})))}}(n,t,arguments.length>=2,!0))}function rk(n){return n<=0?()=>la:fi((t,e)=>{let i=[];t.subscribe(Yn(e,s=>{i.push(s),n<i.length&&i.shift()},()=>{for(const s of i)e.next(s);e.complete()},void 0,()=>{i=null}))})}function $V(n,t){const e=arguments.length>=2;return i=>i.pipe(n?Uo((s,r)=>n(s,r,i)):$n,rk(1),e?E0(t):FV(()=>new pm))}function k0(n){return fi((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const vt="primary",gm=Symbol("RouteTitle");class qle{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Lh(n){return new qle(n)}function Kle(n,t,e){const i=e.path.split("/");if(i.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||i.length<n.length))return null;const s={};for(let r=0;r<i.length;r++){const o=i[r],a=n[r];if(o.startsWith(":"))s[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:s}}function xa(n,t){const e=n?Object.keys(n):void 0,i=t?Object.keys(t):void 0;if(!e||!i||e.length!=i.length)return!1;let s;for(let r=0;r<e.length;r++)if(s=e[r],!BV(n[s],t[s]))return!1;return!0}function BV(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),i=[...t].sort();return e.every((s,r)=>i[r]===s)}return n===t}function VV(n){return Array.prototype.concat.apply([],n)}function zV(n){return n.length>0?n[n.length-1]:null}function ys(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function ic(n){return LI(n)?n:Kp(n)?Pi(Promise.resolve(n)):Ke(n)}const T0=!1,Yle={exact:function HV(n,t,e){if(!Tu(n.segments,t.segments)||!D0(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!n.children[i]||!HV(n.children[i],t.children[i],e))return!1;return!0},subset:jV},UV={exact:function Zle(n,t){return xa(n,t)},subset:function Qle(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>BV(n[e],t[e]))},ignored:()=>!0};function WV(n,t,e){return Yle[e.paths](n.root,t.root,e.matrixParams)&&UV[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function jV(n,t,e){return GV(n,t,t.segments,e)}function GV(n,t,e,i){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!Tu(s,e)||t.hasChildren()||!D0(s,e,i))}if(n.segments.length===e.length){if(!Tu(n.segments,e)||!D0(n.segments,e,i))return!1;for(const s in t.children)if(!n.children[s]||!jV(n.children[s],t.children[s],i))return!1;return!0}{const s=e.slice(0,n.segments.length),r=e.slice(n.segments.length);return!!(Tu(n.segments,s)&&D0(n.segments,s,i)&&n.children[vt])&&GV(n.children[vt],t,r,i)}}function D0(n,t,e){return t.every((i,s)=>UV[e](n[s].parameters,i.parameters))}class sc{constructor(t=new At([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lh(this.queryParams)),this._queryParamMap}toString(){return tce.serialize(this)}}class At{constructor(t,e){this.segments=t,this.children=e,this.parent=null,ys(e,(i,s)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return N0(this)}}class bm{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Lh(this.parameters)),this._parameterMap}toString(){return XV(this)}}function Tu(n,t){return n.length===t.length&&n.every((e,i)=>e.path===t[i].path)}let _m=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(){return new ok},providedIn:"root"}),n})();class ok{parse(t){const e=new uce(t);return new sc(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${ym(t.root,!0)}`,i=function sce(n){const t=Object.keys(n).map(e=>{const i=n[e];return Array.isArray(i)?i.map(s=>`${A0(e)}=${A0(s)}`).join("&"):`${A0(e)}=${A0(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${i}${"string"==typeof t.fragment?`#${function nce(n){return encodeURI(n)}(t.fragment)}`:""}`}}const tce=new ok;function N0(n){return n.segments.map(t=>XV(t)).join("/")}function ym(n,t){if(!n.hasChildren())return N0(n);if(t){const e=n.children[vt]?ym(n.children[vt],!1):"",i=[];return ys(n.children,(s,r)=>{r!==vt&&i.push(`${r}:${ym(s,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function ece(n,t){let e=[];return ys(n.children,(i,s)=>{s===vt&&(e=e.concat(t(i,s)))}),ys(n.children,(i,s)=>{s!==vt&&(e=e.concat(t(i,s)))}),e}(n,(i,s)=>s===vt?[ym(n.children[vt],!1)]:[`${s}:${ym(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[vt]?`${N0(n)}/${e[0]}`:`${N0(n)}/(${e.join("//")})`}}function qV(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function A0(n){return qV(n).replace(/%3B/gi,";")}function ak(n){return qV(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function M0(n){return decodeURIComponent(n)}function KV(n){return M0(n.replace(/\+/g,"%20"))}function XV(n){return`${ak(n.path)}${function ice(n){return Object.keys(n).map(t=>`;${ak(t)}=${ak(n[t])}`).join("")}(n.parameters)}`}const rce=/^[^\/()?;=#]+/;function P0(n){const t=n.match(rce);return t?t[0]:""}const oce=/^[^=?&#]+/,lce=/^[^&#]+/;class uce{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new At([],{}):new At([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[vt]=new At(t,e)),i}parseSegment(){const t=P0(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new re(4009,T0);return this.capture(t),new bm(M0(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=P0(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const s=P0(this.remaining);s&&(i=s,this.capture(i))}t[M0(e)]=M0(i)}parseQueryParam(t){const e=function ace(n){const t=n.match(oce);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const o=function cce(n){const t=n.match(lce);return t?t[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const s=KV(e),r=KV(i);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(r)}else t[s]=r}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=P0(this.remaining),s=this.remaining[i.length];if("/"!==s&&")"!==s&&";"!==s)throw new re(4010,T0);let r;i.indexOf(":")>-1?(r=i.slice(0,i.indexOf(":")),this.capture(r),this.capture(":")):t&&(r=vt);const o=this.parseChildren();e[r]=1===Object.keys(o).length?o[vt]:new At([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new re(4011,T0)}}function lk(n){return n.segments.length>0?new At([],{[vt]:n}):n}function R0(n){const t={};for(const i of Object.keys(n.children)){const r=R0(n.children[i]);(r.segments.length>0||r.hasChildren())&&(t[i]=r)}return function dce(n){if(1===n.numberOfChildren&&n.children[vt]){const t=n.children[vt];return new At(n.segments.concat(t.segments),t.children)}return n}(new At(n.segments,t))}function Du(n){return n instanceof sc}const ck=!1;function hce(n,t,e,i,s){if(0===e.length)return $h(t.root,t.root,t.root,i,s);const r=function ez(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new JV(!0,0,n);let t=0,e=!1;const i=n.reduce((s,r,o)=>{if("object"==typeof r&&null!=r){if(r.outlets){const a={};return ys(r.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...s,{outlets:a}]}if(r.segmentPath)return[...s,r.segmentPath]}return"string"!=typeof r?[...s,r]:0===o?(r.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?e=!0:".."===a?t++:""!=a&&s.push(a))}),s):[...s,r]},[]);return new JV(e,t,i)}(e);return r.toRoot()?$h(t.root,t.root,new At([],{}),i,s):function o(l){const c=function pce(n,t,e,i){if(n.isAbsolute)return new Bh(t.root,!0,0);if(-1===i)return new Bh(e,e===t.root,0);return function tz(n,t,e){let i=n,s=t,r=e;for(;r>s;){if(r-=s,i=i.parent,!i)throw new re(4005,ck&&"Invalid number of '../'");s=i.segments.length}return new Bh(i,!1,s-r)}(e,i+(vm(n.commands[0])?0:1),n.numberOfDoubleDots)}(r,t,n.snapshot?._urlSegment,l),u=c.processChildren?Vh(c.segmentGroup,c.index,r.commands):uk(c.segmentGroup,c.index,r.commands);return $h(t.root,c.segmentGroup,u,i,s)}(n.snapshot?._lastPathIndex)}function vm(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function xm(n){return"object"==typeof n&&null!=n&&n.outlets}function $h(n,t,e,i,s){let o,r={};i&&ys(i,(l,c)=>{r[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===t?e:QV(n,t,e);const a=lk(R0(o));return new sc(a,r,s)}function QV(n,t,e){const i={};return ys(n.children,(s,r)=>{i[r]=s===t?e:QV(s,t,e)}),new At(n.segments,i)}class JV{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&vm(i[0]))throw new re(4003,ck&&"Root segment cannot have matrix parameters");const s=i.find(xm);if(s&&s!==zV(i))throw new re(4004,ck&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Bh{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function uk(n,t,e){if(n||(n=new At([],{})),0===n.segments.length&&n.hasChildren())return Vh(n,t,e);const i=function gce(n,t,e){let i=0,s=t;const r={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(i>=e.length)return r;const o=n.segments[s],a=e[i];if(xm(a))break;const l=`${a}`,c=i<e.length-1?e[i+1]:null;if(s>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!iz(l,c,o))return r;i+=2}else{if(!iz(l,{},o))return r;i++}s++}return{match:!0,pathIndex:s,commandIndex:i}}(n,t,e),s=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const r=new At(n.segments.slice(0,i.pathIndex),{});return r.children[vt]=new At(n.segments.slice(i.pathIndex),n.children),Vh(r,0,s)}return i.match&&0===s.length?new At(n.segments,{}):i.match&&!n.hasChildren()?dk(n,t,e):i.match?Vh(n,0,s):dk(n,t,e)}function Vh(n,t,e){if(0===e.length)return new At(n.segments,{});{const i=function mce(n){return xm(n[0])?n[0].outlets:{[vt]:n}}(e),s={};if(!i[vt]&&n.children[vt]&&1===n.numberOfChildren&&0===n.children[vt].segments.length){const r=Vh(n.children[vt],t,e);return new At(n.segments,r.children)}return ys(i,(r,o)=>{"string"==typeof r&&(r=[r]),null!==r&&(s[o]=uk(n.children[o],t,r))}),ys(n.children,(r,o)=>{void 0===i[o]&&(s[o]=r)}),new At(n.segments,s)}}function dk(n,t,e){const i=n.segments.slice(0,t);let s=0;for(;s<e.length;){const r=e[s];if(xm(r)){const l=bce(r.outlets);return new At(i,l)}if(0===s&&vm(e[0])){i.push(new bm(n.segments[t].path,nz(e[0]))),s++;continue}const o=xm(r)?r.outlets[vt]:`${r}`,a=s<e.length-1?e[s+1]:null;o&&a&&vm(a)?(i.push(new bm(o,nz(a))),s+=2):(i.push(new bm(o,{})),s++)}return new At(i,{})}function bce(n){const t={};return ys(n,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[i]=dk(new At([],{}),0,e))}),t}function nz(n){const t={};return ys(n,(e,i)=>t[i]=`${e}`),t}function iz(n,t,e){return n==e.path&&xa(t,e.parameters)}const Cm="imperative";class Ca{constructor(t,e){this.id=t,this.url=e}}class hk extends Ca{constructor(t,e,i="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=i,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Nu extends Ca{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class O0 extends Ca{constructor(t,e,i,s){super(t,e),this.reason=i,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class F0 extends Ca{constructor(t,e,i,s){super(t,e),this.reason=i,this.code=s,this.type=16}}class fk extends Ca{constructor(t,e,i,s){super(t,e),this.error=i,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class _ce extends Ca{constructor(t,e,i,s){super(t,e),this.urlAfterRedirects=i,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yce extends Ca{constructor(t,e,i,s){super(t,e),this.urlAfterRedirects=i,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vce extends Ca{constructor(t,e,i,s,r){super(t,e),this.urlAfterRedirects=i,this.state=s,this.shouldActivate=r,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class xce extends Ca{constructor(t,e,i,s){super(t,e),this.urlAfterRedirects=i,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cce extends Ca{constructor(t,e,i,s){super(t,e),this.urlAfterRedirects=i,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wce{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Sce{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Ice{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ece{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kce{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Tce{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sz{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let Ace=(()=>{class n{createUrlTree(e,i,s,r,o,a){return hce(e||i.root,s,r,o,a)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})(),Pce=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(t){return Ace.\u0275fac(t)},providedIn:"root"}),n})();class rz{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=pk(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){const e=pk(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=mk(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return mk(t,this._root).map(e=>e.value)}}function pk(n,t){if(n===t.value)return t;for(const e of t.children){const i=pk(n,e);if(i)return i}return null}function mk(n,t){if(n===t.value)return[t];for(const e of t.children){const i=mk(n,e);if(i.length)return i.unshift(t),i}return[]}class gl{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function zh(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class oz extends rz{constructor(t,e){super(t),this.snapshot=e,gk(this,t)}toString(){return this.snapshot.toString()}}function az(n,t){const e=function Rce(n,t){const o=new L0([],{},{},"",{},vt,t,null,n.root,-1,{});return new cz("",new gl(o,[]))}(n,t),i=new ao([new bm("",{})]),s=new ao({}),r=new ao({}),o=new ao({}),a=new ao(""),l=new Uh(i,s,o,a,r,vt,t,e.root);return l.snapshot=e.root,new oz(new gl(l,[]),e)}class Uh{constructor(t,e,i,s,r,o,a,l){this.url=t,this.params=e,this.queryParams=i,this.fragment=s,this.data=r,this.outlet=o,this.component=a,this.title=this.data?.pipe(lt(c=>c[gm]))??Ke(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(lt(t=>Lh(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(lt(t=>Lh(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function lz(n,t="emptyOnly"){const e=n.pathFromRoot;let i=0;if("always"!==t)for(i=e.length-1;i>=1;){const s=e[i],r=e[i-1];if(s.routeConfig&&""===s.routeConfig.path)i--;else{if(r.component)break;i--}}return function Oce(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(i))}class L0{get title(){return this.data?.[gm]}constructor(t,e,i,s,r,o,a,l,c,u,d){this.url=t,this.params=e,this.queryParams=i,this.fragment=s,this.data=r,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Lh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class cz extends rz{constructor(t,e){super(e),this.url=t,gk(this,e)}toString(){return uz(this._root)}}function gk(n,t){t.value._routerState=n,t.children.forEach(e=>gk(n,e))}function uz(n){const t=n.children.length>0?` { ${n.children.map(uz).join(", ")} } `:"";return`${n.value}${t}`}function bk(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,xa(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),xa(t.params,e.params)||n.params.next(e.params),function Xle(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!xa(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),xa(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function _k(n,t){const e=xa(n.params,t.params)&&function Jle(n,t){return Tu(n,t)&&n.every((e,i)=>xa(e.parameters,t[i].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||_k(n.parent,t.parent))}function wm(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=t.value;const s=function Lce(n,t,e){return t.children.map(i=>{for(const s of e.children)if(n.shouldReuseRoute(i.value,s.value.snapshot))return wm(n,i,s);return wm(n,i)})}(n,t,e);return new gl(i,s)}{if(n.shouldAttach(t.value)){const r=n.retrieve(t.value);if(null!==r){const o=r.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(a=>wm(n,a)),o}}const i=function $ce(n){return new Uh(new ao(n.url),new ao(n.params),new ao(n.queryParams),new ao(n.fragment),new ao(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(r=>wm(n,r));return new gl(i,s)}}const yk="ngNavigationCancelingError";function dz(n,t){const{redirectTo:e,navigationBehaviorOptions:i}=Du(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=hz(!1,0,t);return s.url=e,s.navigationBehaviorOptions=i,s}function hz(n,t,e){const i=new Error("NavigationCancelingError: "+(n||""));return i[yk]=!0,i.cancellationCode=t,e&&(i.url=e),i}function fz(n){return pz(n)&&Du(n.url)}function pz(n){return n&&n[yk]}class Bce{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Sm,this.attachRef=null}}let Sm=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const s=this.getOrCreateContext(e);s.outlet=i,this.contexts.set(e,s)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new Bce,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $0=!1;let vk=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=vt,this.activateEvents=new Yt,this.deactivateEvents=new Yt,this.attachEvents=new Yt,this.detachEvents=new Yt,this.parentContexts=ht(Sm),this.location=ht(so),this.changeDetector=ht(Su),this.environmentInjector=ht(pa)}ngOnChanges(e){if(e.name){const{firstChange:i,previousValue:s}=e.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new re(4012,$0);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new re(4012,$0);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new re(4012,$0);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new re(4013,$0);this._activatedRoute=e;const s=this.location,o=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new Vce(e,a,s.injector);if(i&&function zce(n){return!!n.resolveComponentFactory}(i)){const c=i.resolveComponentFactory(o);this.activated=s.createComponent(c,s.length,l)}else this.activated=s.createComponent(o,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[kr]}),n})();class Vce{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===Uh?this.route:t===Sm?this.childContexts:this.parent.get(t,e)}}let xk=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["ng-component"]],standalone:!0,features:[mB],decls:1,vars:0,template:function(e,i){1&e&&Ne(0,"router-outlet")},dependencies:[vk],encapsulation:2}),n})();function mz(n,t){return n.providers&&!n._injector&&(n._injector=Yy(n.providers,t,`Route: ${n.path}`)),n._injector??t}function wk(n){const t=n.children&&n.children.map(wk),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==vt&&(e.component=xk),e}function lo(n){return n.outlet||vt}function gz(n,t){const e=n.filter(i=>lo(i)===t);return e.push(...n.filter(i=>lo(i)!==t)),e}function Im(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Gce{constructor(t,e,i,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=s}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),bk(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const s=zh(e);t.children.forEach(r=>{const o=r.value.outlet;this.deactivateRoutes(r,s[o],i),delete s[o]}),ys(s,(r,o)=>{this.deactivateRouteAndItsChildren(r,i)})}deactivateRoutes(t,e,i){const s=t.value,r=e?e.value:null;if(s===r)if(s.component){const o=i.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,i);else r&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet),s=i&&t.value.component?i.children:e,r=zh(t);for(const o of Object.keys(r))this.deactivateRouteAndItsChildren(r[o],s);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:a})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),s=i&&t.value.component?i.children:e,r=zh(t);for(const o of Object.keys(r))this.deactivateRouteAndItsChildren(r[o],s);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(t,e,i){const s=zh(e);t.children.forEach(r=>{this.activateRoutes(r,s[r.value.outlet],i),this.forwardEvent(new Tce(r.value.snapshot))}),t.children.length&&this.forwardEvent(new Ece(t.value.snapshot))}activateRoutes(t,e,i){const s=t.value,r=e?e.value:null;if(bk(s),s===r)if(s.component){const o=i.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,i);else if(s.component){const o=i.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const a=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),bk(a.route.value),this.activateChildRoutes(t,null,o.children)}else{const a=Im(s.snapshot),l=a?.get(Up)??null;o.attachRef=null,o.route=s,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,i)}}class bz{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class B0{constructor(t,e){this.component=t,this.route=e}}function qce(n,t,e){const i=n._root;return Em(i,t?t._root:null,e,[i.value])}function Wh(n,t){const e=Symbol(),i=t.get(n,e);return i===e?"function"!=typeof n||function JZ(n){return null!==Z_(n)}(n)?t.get(n):n:i}function Em(n,t,e,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const r=zh(t);return n.children.forEach(o=>{(function Xce(n,t,e,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const r=n.value,o=t?t.value:null,a=e?e.getContext(n.value.outlet):null;if(o&&r.routeConfig===o.routeConfig){const l=function Yce(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!Tu(n.url,t.url);case"pathParamsOrQueryParamsChange":return!Tu(n.url,t.url)||!xa(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!_k(n,t)||!xa(n.queryParams,t.queryParams);default:return!_k(n,t)}}(o,r,r.routeConfig.runGuardsAndResolvers);l?s.canActivateChecks.push(new bz(i)):(r.data=o.data,r._resolvedData=o._resolvedData),Em(n,t,r.component?a?a.children:null:e,i,s),l&&a&&a.outlet&&a.outlet.isActivated&&s.canDeactivateChecks.push(new B0(a.outlet.component,o))}else o&&km(t,a,s),s.canActivateChecks.push(new bz(i)),Em(n,null,r.component?a?a.children:null:e,i,s)})(o,r[o.value.outlet],e,i.concat([o.value]),s),delete r[o.value.outlet]}),ys(r,(o,a)=>km(o,e.getContext(a),s)),s}function km(n,t,e){const i=zh(n),s=n.value;ys(i,(r,o)=>{km(r,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new B0(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function Tm(n){return"function"==typeof n}function Sk(n){return n instanceof pm||"EmptyError"===n?.name}const V0=Symbol("INITIAL_VALUE");function Hh(){return zo(n=>ik(n.map(t=>t.pipe(va(1),mm(V0)))).pipe(lt(t=>{for(const e of t)if(!0!==e){if(e===V0)return V0;if(!1===e||e instanceof sc)return e}return!0}),Uo(t=>t!==V0),va(1)))}function _z(n){return function hi(...n){return Gs(n)}(Li(t=>{if(Du(t))throw dz(0,t)}),lt(t=>!0===t))}const Ik={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function yz(n,t,e,i,s){const r=Ek(n,t,e);return r.matched?function fue(n,t,e,i){const s=t.canMatch;return s&&0!==s.length?Ke(s.map(o=>{const a=Wh(o,n);return ic(function nue(n){return n&&Tm(n.canMatch)}(a)?a.canMatch(t,e):n.runInContext(()=>a(t,e)))})).pipe(Hh(),_z()):Ke(!0)}(i=mz(t,i),t,e).pipe(lt(o=>!0===o?r:{...Ik})):Ke(r)}function Ek(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...Ik}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||Kle)(e,n,t);if(!s)return{...Ik};const r={};ys(s.posParams,(a,l)=>{r[l]=a.path});const o=s.consumed.length>0?{...r,...s.consumed[s.consumed.length-1].parameters}:r;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function z0(n,t,e,i){if(e.length>0&&function gue(n,t,e){return e.some(i=>U0(n,t,i)&&lo(i)!==vt)}(n,e,i)){const r=new At(t,function mue(n,t,e,i){const s={};s[vt]=i,i._sourceSegment=n,i._segmentIndexShift=t.length;for(const r of e)if(""===r.path&&lo(r)!==vt){const o=new At([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[lo(r)]=o}return s}(n,t,i,new At(e,n.children)));return r._sourceSegment=n,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:[]}}if(0===e.length&&function bue(n,t,e){return e.some(i=>U0(n,t,i))}(n,e,i)){const r=new At(n.segments,function pue(n,t,e,i,s){const r={};for(const o of i)if(U0(n,e,o)&&!s[lo(o)]){const a=new At([],{});a._sourceSegment=n,a._segmentIndexShift=t.length,r[lo(o)]=a}return{...s,...r}}(n,t,e,i,n.children));return r._sourceSegment=n,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:e}}const s=new At(n.segments,n.children);return s._sourceSegment=n,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:e}}function U0(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function vz(n,t,e,i){return!!(lo(n)===i||i!==vt&&U0(t,e,n))&&("**"===n.path||Ek(t,n,e).matched)}function xz(n,t,e){return 0===t.length&&!n.children[e]}const W0=!1;class H0{constructor(t){this.segmentGroup=t||null}}class Cz{constructor(t){this.urlTree=t}}function Dm(n){return Fh(new H0(n))}function wz(n){return Fh(new Cz(n))}class xue{constructor(t,e,i,s,r){this.injector=t,this.configLoader=e,this.urlSerializer=i,this.urlTree=s,this.config=r,this.allowRedirects=!0}apply(){const t=z0(this.urlTree.root,[],[],this.config).segmentGroup,e=new At(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,vt).pipe(lt(r=>this.createUrlTree(R0(r),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ml(r=>{if(r instanceof Cz)return this.allowRedirects=!1,this.match(r.urlTree);throw r instanceof H0?this.noMatchError(r):r}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,vt).pipe(lt(s=>this.createUrlTree(R0(s),t.queryParams,t.fragment))).pipe(ml(s=>{throw s instanceof H0?this.noMatchError(s):s}))}noMatchError(t){return new re(4002,W0)}createUrlTree(t,e,i){const s=lk(t);return new sc(s,e,i)}expandSegmentGroup(t,e,i,s){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,e,i).pipe(lt(r=>new At([],r))):this.expandSegment(t,i,e,i.segments,s,!0)}expandChildren(t,e,i){const s=[];for(const r of Object.keys(i.children))"primary"===r?s.unshift(r):s.push(r);return Pi(s).pipe(nc(r=>{const o=i.children[r],a=gz(e,r);return this.expandSegmentGroup(t,a,o,r).pipe(lt(l=>({segment:l,outlet:r})))}),LV((r,o)=>(r[o.outlet]=o.segment,r),{}),$V())}expandSegment(t,e,i,s,r,o){return Pi(i).pipe(nc(a=>this.expandSegmentAgainstRoute(t,e,i,a,s,r,o).pipe(ml(c=>{if(c instanceof H0)return Ke(null);throw c}))),tc(a=>!!a),ml((a,l)=>{if(Sk(a))return xz(e,s,r)?Ke(new At([],{})):Dm(e);throw a}))}expandSegmentAgainstRoute(t,e,i,s,r,o,a){return vz(s,e,r,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,r,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,i,s,r,o):Dm(e):Dm(e)}expandSegmentAgainstRouteUsingRedirect(t,e,i,s,r,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,s,r,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,s){const r=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?wz(r):this.lineralizeSegments(i,r).pipe(as(o=>{const a=new At(o,{});return this.expandSegment(t,a,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,s,r,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=Ek(e,s,r);if(!a)return Dm(e);const d=this.applyRedirectCommands(l,s.redirectTo,u);return s.redirectTo.startsWith("/")?wz(d):this.lineralizeSegments(s,d).pipe(as(h=>this.expandSegment(t,e,i,h.concat(c),o,!1)))}matchSegmentAgainstRoute(t,e,i,s,r){return"**"===i.path?(t=mz(i,t),i.loadChildren?(i._loadedRoutes?Ke({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(t,i)).pipe(lt(a=>(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,new At(s,{})))):Ke(new At(s,{}))):yz(e,i,s,t).pipe(zo(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(t=i._injector??t,i,s).pipe(as(u=>{const d=u.injector??t,h=u.routes,{segmentGroup:f,slicedSegments:p}=z0(e,a,l,h),g=new At(f.segments,f.children);if(0===p.length&&g.hasChildren())return this.expandChildren(d,h,g).pipe(lt(y=>new At(a,y)));if(0===h.length&&0===p.length)return Ke(new At(a,{}));const m=lo(i)===r;return this.expandSegment(d,g,h,p,m?vt:r,!0).pipe(lt(_=>new At(a.concat(_.segments),_.children)))})):Dm(e)))}getChildConfig(t,e,i){return e.children?Ke({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Ke({routes:e._loadedRoutes,injector:e._loadedInjector}):function hue(n,t,e,i){const s=t.canLoad;return void 0===s||0===s.length?Ke(!0):Ke(s.map(o=>{const a=Wh(o,n);return ic(function Qce(n){return n&&Tm(n.canLoad)}(a)?a.canLoad(t,e):n.runInContext(()=>a(t,e)))})).pipe(Hh(),_z())}(t,e,i).pipe(as(s=>s?this.configLoader.loadChildren(t,e).pipe(Li(r=>{e._loadedRoutes=r.routes,e._loadedInjector=r.injector})):function yue(n){return Fh(hz(W0,3))}())):Ke({routes:[],injector:t})}lineralizeSegments(t,e){let i=[],s=e.root;for(;;){if(i=i.concat(s.segments),0===s.numberOfChildren)return Ke(i);if(s.numberOfChildren>1||!s.children[vt])return t.redirectTo,Fh(new re(4e3,W0));s=s.children[vt]}}applyRedirectCommands(t,e,i){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreateUrlTree(t,e,i,s){const r=this.createSegmentGroup(t,e.root,i,s);return new sc(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return ys(t,(s,r)=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=e[a]}else i[r]=s}),i}createSegmentGroup(t,e,i,s){const r=this.createSegments(t,e.segments,i,s);let o={};return ys(e.children,(a,l)=>{o[l]=this.createSegmentGroup(t,a,i,s)}),new At(r,o)}createSegments(t,e,i,s){return e.map(r=>r.path.startsWith(":")?this.findPosParam(t,r,s):this.findOrReturn(r,i))}findPosParam(t,e,i){const s=i[e.path.substring(1)];if(!s)throw new re(4001,W0);return s}findOrReturn(t,e){let i=0;for(const s of e){if(s.path===t.path)return e.splice(i),s;i++}return t}}class wue{}class Eue{constructor(t,e,i,s,r,o,a){this.injector=t,this.rootComponentType=e,this.config=i,this.urlTree=s,this.url=r,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const t=z0(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,vt).pipe(lt(e=>{if(null===e)return null;const i=new L0([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},vt,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new gl(i,e),r=new cz(this.url,s);return this.inheritParamsAndData(r._root),r}))}inheritParamsAndData(t){const e=t.value,i=lz(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,i,s){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,e,i):this.processSegment(t,e,i,i.segments,s)}processChildren(t,e,i){return Pi(Object.keys(i.children)).pipe(nc(s=>{const r=i.children[s],o=gz(e,s);return this.processSegmentGroup(t,o,r,s)}),LV((s,r)=>s&&r?(s.push(...r),s):null),function jle(n,t=!1){return fi((e,i)=>{let s=0;e.subscribe(Yn(i,r=>{const o=n(r,s++);(o||t)&&i.next(r),!o&&i.complete()}))})}(s=>null!==s),E0(null),$V(),lt(s=>{if(null===s)return null;const r=Iz(s);return function kue(n){n.sort((t,e)=>t.value.outlet===vt?-1:e.value.outlet===vt?1:t.value.outlet.localeCompare(e.value.outlet))}(r),r}))}processSegment(t,e,i,s,r){return Pi(e).pipe(nc(o=>this.processSegmentAgainstRoute(o._injector??t,o,i,s,r)),tc(o=>!!o),ml(o=>{if(Sk(o))return xz(i,s,r)?Ke([]):Ke(null);throw o}))}processSegmentAgainstRoute(t,e,i,s,r){if(e.redirectTo||!vz(e,i,s,r))return Ke(null);let o;if("**"===e.path){const a=s.length>0?zV(s).parameters:{},l=kz(i)+s.length;o=Ke({snapshot:new L0(s,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Tz(e),lo(e),e.component??e._loadedComponent??null,e,Ez(i),l,Dz(e)),consumedSegments:[],remainingSegments:[]})}else o=yz(i,e,s,t).pipe(lt(({matched:a,consumedSegments:l,remainingSegments:c,parameters:u})=>{if(!a)return null;const d=kz(i)+l.length;return{snapshot:new L0(l,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Tz(e),lo(e),e.component??e._loadedComponent??null,e,Ez(i),d,Dz(e)),consumedSegments:l,remainingSegments:c}}));return o.pipe(zo(a=>{if(null===a)return Ke(null);const{snapshot:l,consumedSegments:c,remainingSegments:u}=a;t=e._injector??t;const d=e._loadedInjector??t,h=function Tue(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:f,slicedSegments:p}=z0(i,c,u,h.filter(m=>void 0===m.redirectTo));if(0===p.length&&f.hasChildren())return this.processChildren(d,h,f).pipe(lt(m=>null===m?null:[new gl(l,m)]));if(0===h.length&&0===p.length)return Ke([new gl(l,[])]);const g=lo(e)===r;return this.processSegment(d,h,f,p,g?vt:r).pipe(lt(m=>null===m?null:[new gl(l,m)]))}))}}function Due(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Iz(n){const t=[],e=new Set;for(const i of n){if(!Due(i)){t.push(i);continue}const s=t.find(r=>i.value.routeConfig===r.value.routeConfig);void 0!==s?(s.children.push(...i.children),e.add(s)):t.push(i)}for(const i of e){const s=Iz(i.children);t.push(new gl(i.value,s))}return t.filter(i=>!e.has(i))}function Ez(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function kz(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function Tz(n){return n.data||{}}function Dz(n){return n.resolve||{}}function Nz(n){return"string"==typeof n.title||null===n.title}function kk(n){return zo(t=>{const e=n(t);return e?Pi(e).pipe(lt(()=>t)):Ke(t)})}const jh=new Ce("ROUTES");let Tk=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ht(s3)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Ke(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=ic(e.loadComponent()).pipe(lt(Mz),Li(r=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=r}),k0(()=>{this.componentLoaders.delete(e)})),s=new OV(i,()=>new Ut).pipe(sk());return this.componentLoaders.set(e,s),s}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ke({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const r=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(lt(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(e).injector,c=VV(l.get(jh,[],it.Self|it.Optional)));return{routes:c.map(wk),injector:l}}),k0(()=>{this.childrenLoaders.delete(i)})),o=new OV(r,()=>new Ut).pipe(sk());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(e){return ic(e()).pipe(lt(Mz),as(i=>i instanceof fB||Array.isArray(i)?Ke(i):Pi(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Mz(n){return function Lue(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let G0=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ut,this.configLoader=ht(Tk),this.environmentInjector=ht(pa),this.urlSerializer=ht(_m),this.rootContexts=ht(Sm),this.navigationId=0,this.afterPreactivation=()=>Ke(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new Sce(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new wce(s))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:i})}setupNavigations(e){return this.transitions=new ao({id:0,targetPageId:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Cm,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Uo(i=>0!==i.id),lt(i=>({...i,extractedUrl:e.urlHandlingStrategy.extract(i.rawUrl)})),zo(i=>{let s=!1,r=!1;return Ke(i).pipe(Li(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),zo(o=>{const a=e.browserUrlTree.toString(),l=!e.navigated||o.extractedUrl.toString()!==a||a!==e.currentUrlTree.toString();if(!l&&"reload"!==(o.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const u="";return this.events.next(new F0(o.id,e.serializeUrl(i.rawUrl),u,0)),e.rawUrlTree=o.rawUrl,o.resolve(null),la}if(e.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return Pz(o.source)&&(e.browserUrlTree=o.extractedUrl),Ke(o).pipe(zo(u=>{const d=this.transitions?.getValue();return this.events.next(new hk(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),d!==this.transitions?.getValue()?la:Promise.resolve(u)}),function Cue(n,t,e,i){return zo(s=>function vue(n,t,e,i,s){return new xue(n,t,e,i,s).apply()}(n,t,e,s.extractedUrl,i).pipe(lt(r=>({...s,urlAfterRedirects:r}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,e.config),Li(u=>{this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},i.urlAfterRedirects=u.urlAfterRedirects}),function Aue(n,t,e,i,s){return as(r=>function Iue(n,t,e,i,s,r,o="emptyOnly"){return new Eue(n,t,e,i,s,o,r).recognize().pipe(zo(a=>null===a?function Sue(n){return new dt(t=>t.error(n))}(new wue):Ke(a)))}(n,t,e,r.urlAfterRedirects,i.serialize(r.urlAfterRedirects),i,s).pipe(lt(o=>({...r,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),Li(u=>{if(i.targetSnapshot=u.targetSnapshot,"eager"===e.urlUpdateStrategy){if(!u.extras.skipLocationChange){const h=e.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);e.setBrowserUrl(h,u)}e.browserUrlTree=u.urlAfterRedirects}const d=new _ce(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(l&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:u,extractedUrl:d,source:h,restoredState:f,extras:p}=o,g=new hk(u,this.urlSerializer.serialize(d),h,f);this.events.next(g);const m=az(d,this.rootComponentType).snapshot;return Ke(i={...o,targetSnapshot:m,urlAfterRedirects:d,extras:{...p,skipLocationChange:!1,replaceUrl:!1}})}{const u="";return this.events.next(new F0(o.id,e.serializeUrl(i.extractedUrl),u,1)),e.rawUrlTree=o.rawUrl,o.resolve(null),la}}),Li(o=>{const a=new yce(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),lt(o=>i={...o,guards:qce(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function sue(n,t){return as(e=>{const{targetSnapshot:i,currentSnapshot:s,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return 0===o.length&&0===r.length?Ke({...e,guardsResult:!0}):function rue(n,t,e,i){return Pi(n).pipe(as(s=>function due(n,t,e,i,s){const r=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return r&&0!==r.length?Ke(r.map(a=>{const l=Im(t)??s,c=Wh(a,l);return ic(function tue(n){return n&&Tm(n.canDeactivate)}(c)?c.canDeactivate(n,t,e,i):l.runInContext(()=>c(n,t,e,i))).pipe(tc())})).pipe(Hh()):Ke(!0)}(s.component,s.route,e,t,i)),tc(s=>!0!==s,!0))}(o,i,s,n).pipe(as(a=>a&&function Zce(n){return"boolean"==typeof n}(a)?function oue(n,t,e,i){return Pi(t).pipe(nc(s=>I0(function lue(n,t){return null!==n&&t&&t(new Ice(n)),Ke(!0)}(s.route.parent,i),function aue(n,t){return null!==n&&t&&t(new kce(n)),Ke(!0)}(s.route,i),function uue(n,t,e){const i=t[t.length-1],r=t.slice(0,t.length-1).reverse().map(o=>function Kce(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>RV(()=>Ke(o.guards.map(l=>{const c=Im(o.node)??e,u=Wh(l,c);return ic(function eue(n){return n&&Tm(n.canActivateChild)}(u)?u.canActivateChild(i,n):c.runInContext(()=>u(i,n))).pipe(tc())})).pipe(Hh())));return Ke(r).pipe(Hh())}(n,s.path,e),function cue(n,t,e){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return Ke(!0);const s=i.map(r=>RV(()=>{const o=Im(t)??e,a=Wh(r,o);return ic(function Jce(n){return n&&Tm(n.canActivate)}(a)?a.canActivate(t,n):o.runInContext(()=>a(t,n))).pipe(tc())}));return Ke(s).pipe(Hh())}(n,s.route,e))),tc(s=>!0!==s,!0))}(i,r,n,t):Ke(a)),lt(a=>({...e,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),Li(o=>{if(i.guardsResult=o.guardsResult,Du(o.guardsResult))throw dz(0,o.guardsResult);const a=new vce(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),Uo(o=>!!o.guardsResult||(e.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),kk(o=>{if(o.guards.canActivateChecks.length)return Ke(o).pipe(Li(a=>{const l=new xce(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),zo(a=>{let l=!1;return Ke(a).pipe(function Mue(n,t){return as(e=>{const{targetSnapshot:i,guards:{canActivateChecks:s}}=e;if(!s.length)return Ke(e);let r=0;return Pi(s).pipe(nc(o=>function Pue(n,t,e,i){const s=n.routeConfig,r=n._resolve;return void 0!==s?.title&&!Nz(s)&&(r[gm]=s.title),function Rue(n,t,e,i){const s=function Oue(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Ke({});const r={};return Pi(s).pipe(as(o=>function Fue(n,t,e,i){const s=Im(t)??i,r=Wh(n,s);return ic(r.resolve?r.resolve(t,e):s.runInContext(()=>r(t,e)))}(n[o],t,e,i).pipe(tc(),Li(a=>{r[o]=a}))),rk(1),function Gle(n){return lt(()=>n)}(r),ml(o=>Sk(o)?la:Fh(o)))}(r,n,t,i).pipe(lt(o=>(n._resolvedData=o,n.data=lz(n,e).resolve,s&&Nz(s)&&(n.data[gm]=s.title),null)))}(o.route,i,n,t)),Li(()=>r++),rk(1),as(o=>r===s.length?Ke(e):la))})}(e.paramsInheritanceStrategy,this.environmentInjector),Li({next:()=>l=!0,complete:()=>{l||(e.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),Li(a=>{const l=new Cce(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),kk(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(Li(u=>{l.component=u}),lt(()=>{})));for(const u of l.children)c.push(...a(u));return c};return ik(a(o.targetSnapshot.root)).pipe(E0(),va(1))}),kk(()=>this.afterPreactivation()),lt(o=>{const a=function Fce(n,t,e){const i=wm(n,t._root,e?e._root:void 0);return new oz(i,t)}(e.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return i={...o,targetRouterState:a}}),Li(o=>{e.currentUrlTree=o.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),e.routerState=o.targetRouterState,"deferred"===e.urlUpdateStrategy&&(o.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,o),e.browserUrlTree=o.urlAfterRedirects)}),((n,t,e)=>lt(i=>(new Gce(t,i.targetRouterState,i.currentRouterState,e).activate(n),i)))(this.rootContexts,e.routeReuseStrategy,o=>this.events.next(o)),va(1),Li({next:o=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new Nu(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{s=!0}}),k0(()=>{s||r||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),ml(o=>{if(r=!0,pz(o)){fz(o)||(e.navigated=!0,e.restoreHistory(i,!0));const a=new O0(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),fz(o)){const l=e.urlHandlingStrategy.merge(o.url,e.rawUrlTree),c={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||Pz(i.source)};e.scheduleNavigation(l,Cm,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{e.restoreHistory(i,!0);const a=new fk(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);this.events.next(a);try{i.resolve(e.errorHandler(o))}catch(l){i.reject(l)}}return la}))}))}cancelNavigationTransition(e,i,s){const r=new O0(e.id,this.urlSerializer.serialize(e.extractedUrl),i,s);this.events.next(r),e.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Pz(n){return n!==Cm}let Rz=(()=>{class n{buildTitle(e){let i,s=e.root;for(;void 0!==s;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(r=>r.outlet===vt);return i}getResolvedTitleForRoute(e){return e.data[gm]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(){return ht($ue)},providedIn:"root"}),n})(),$ue=(()=>{class n extends Rz{constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(e){return new(e||n)(me(kV))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Bue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(){return ht(zue)},providedIn:"root"}),n})();class Vue{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let zue=(()=>{class n extends Vue{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const q0=new Ce("",{providedIn:"root",factory:()=>({})});let Wue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:function(){return ht(Hue)},providedIn:"root"}),n})(),Hue=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function jue(n){throw n}function Gue(n,t,e){return t.parse("/")}const que={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Kue={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let pr=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ht(Ere),this.isNgZoneEnabled=!1,this.options=ht(q0,{optional:!0})||{},this.errorHandler=this.options.errorHandler||jue,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Gue,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ht(Wue),this.routeReuseStrategy=ht(Bue),this.urlCreationStrategy=ht(Pce),this.titleStrategy=ht(Rz),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=VV(ht(jh,{optional:!0})??[]),this.navigationTransitions=ht(G0),this.urlSerializer=ht(_m),this.location=ht(DE),this.isNgZoneEnabled=ht(Zt)instanceof Zt&&Zt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new sc,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=az(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId??0},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Cm,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,i,e.state)},0)}))}navigateToSyncWithBrowser(e,i,s){const r={replaceUrl:!0},o=s?.navigationId?s:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(r.state=l)}const a=this.parseUrl(e);this.scheduleNavigation(a,i,o,r)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(e){this.config=e.map(wk),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,i={}){const{relativeTo:s,queryParams:r,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...r};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=r||null}return null!==u&&(u=this.removeEmptyProps(u)),this.urlCreationStrategy.createUrlTree(s,this.routerState,this.currentUrlTree,e,u,c??null)}navigateByUrl(e,i={skipLocationChange:!1}){const s=Du(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(r,Cm,null,i)}navigate(e,i={skipLocationChange:!1}){return function Xue(n){for(let t=0;t<n.length;t++){const e=n[t];if(null==e)throw new re(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return i}isActive(e,i){let s;if(s=!0===i?{...que}:!1===i?{...Kue}:i,Du(e))return WV(this.currentUrlTree,e,s);const r=this.parseUrl(e);return WV(this.currentUrlTree,r,s)}removeEmptyProps(e){return Object.keys(e).reduce((i,s)=>{const r=e[s];return null!=r&&(i[s]=r),i},{})}scheduleNavigation(e,i,s,r,o){if(this.disposed)return Promise.resolve(!1);let a,l,c,u;return o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h}),u="computed"===this.canceledNavigationResolution?s&&s.\u0275routerPageId?s.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:u,source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:r,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(e,i){const s=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(s,"",o)}else{const r={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.go(s,"",r)}}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-(this.browserPageId??this.currentPageId);0!==r?this.location.historyGo(r):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),K0=(()=>{class n{constructor(e,i,s,r,o,a){this.router=e,this.route=i,this.tabIndexAttribute=s,this.renderer=r,this.el=o,this.locationStrategy=a,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Ut;const l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=e.events.subscribe(c=>{c instanceof Nu&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=Oh(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Oh(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Oh(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,i,s,r,o){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||i||s||r||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:function jF(n,t,e){return function Aee(n,t){return"src"===t&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===t&&("base"===n||"link"===n)?HF:dh}(t,e)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,i){const s=this.renderer,r=this.el.nativeElement;null!==i?s.setAttribute(r,e,i):s.removeAttribute(r,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(ie(pr),ie(Uh),Ap("tabindex"),ie(ol),ie(Ri),ie(Eu))},n.\u0275dir=Ze({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(e,i){1&e&&H("click",function(r){return i.onClick(r.button,r.ctrlKey,r.shiftKey,r.altKey,r.metaKey)}),2&e&&Mr("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[kr]}),n})();class Oz{}let Que=(()=>{class n{constructor(e,i,s,r,o){this.router=e,this.injector=s,this.preloadingStrategy=r,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Uo(e=>e instanceof Nu),nc(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const s=[];for(const r of i){r.providers&&!r._injector&&(r._injector=Yy(r.providers,e,`Route: ${r.path}`));const o=r._injector??e,a=r._loadedInjector??o;(r.loadChildren&&!r._loadedRoutes&&void 0===r.canLoad||r.loadComponent&&!r._loadedComponent)&&s.push(this.preloadConfig(o,r)),(r.children||r._loadedRoutes)&&s.push(this.processRoutes(a,r.children??r._loadedRoutes))}return Pi(s).pipe(jd())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let s;s=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):Ke(null);const r=s.pipe(as(o=>null===o?Ke(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return i.loadComponent&&!i._loadedComponent?Pi([r,this.loader.loadComponent(i)]).pipe(jd()):r})}}return n.\u0275fac=function(e){return new(e||n)(me(pr),me(s3),me(pa),me(Oz),me(Tk))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Nk=new Ce("");let Fz=(()=>{class n{constructor(e,i,s,r,o={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=s,this.zone=r,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof hk?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Nu&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof sz&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new sz(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(e){yI()},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();var Pr=(()=>((Pr=Pr||{})[Pr.COMPLETE=0]="COMPLETE",Pr[Pr.FAILED=1]="FAILED",Pr[Pr.REDIRECTING=2]="REDIRECTING",Pr))();const Gh=!1;function rc(n,t){return{\u0275kind:n,\u0275providers:t}}const Ak=new Ce("",{providedIn:"root",factory:()=>!1});function $z(){const n=ht(Ro);return t=>{const e=n.get(am);if(t!==e.components[0])return;const i=n.get(pr),s=n.get(Bz);1===n.get(Mk)&&i.initialNavigation(),n.get(Vz,null,it.Optional)?.setUpPreloading(),n.get(Nk,null,it.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}const Bz=new Ce(Gh?"bootstrap done indicator":"",{factory:()=>new Ut}),Mk=new Ce(Gh?"initial navigation":"",{providedIn:"root",factory:()=>1});function ide(){let n=[];return n=Gh?[{provide:Dy,multi:!0,useFactory:()=>{const t=ht(pr);return()=>t.events.subscribe(e=>{console.group?.(`Router Event: ${e.constructor.name}`),console.log(function Dce(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(e)),console.log(e),console.groupEnd?.()})}}]:[],rc(1,n)}const Vz=new Ce(Gh?"router preloader":"");function sde(n){return rc(0,[{provide:Vz,useExisting:Que},{provide:Oz,useExisting:n}])}const Nm=!1,zz=new Ce(Nm?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),rde=[DE,{provide:_m,useClass:ok},pr,Sm,{provide:Uh,useFactory:function Lz(n){return n.routerState.root},deps:[pr]},Tk,Nm?{provide:Ak,useValue:!0}:[]];function ode(){return new h3("Router",pr)}let Uz=(()=>{class n{constructor(e){}static forRoot(e,i){return{ngModule:n,providers:[rde,Nm&&i?.enableTracing?ide().\u0275providers:[],{provide:jh,multi:!0,useValue:e},{provide:zz,useFactory:ude,deps:[[pr,new Zl,new ah]]},{provide:q0,useValue:i||{}},i?.useHash?{provide:Eu,useClass:foe}:{provide:Eu,useClass:O3},{provide:Nk,useFactory:()=>{const n=ht(Nae),t=ht(Zt),e=ht(q0),i=ht(G0),s=ht(_m);return e.scrollOffset&&n.setOffset(e.scrollOffset),new Fz(s,i,n,t,e)}},i?.preloadingStrategy?sde(i.preloadingStrategy).\u0275providers:[],{provide:h3,multi:!0,useFactory:ode},i?.initialNavigation?dde(i):[],[{provide:Wz,useFactory:$z},{provide:d3,multi:!0,useExisting:Wz}]]}}static forChild(e){return{ngModule:n,providers:[{provide:jh,multi:!0,useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)(me(zz,8))},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[xk]}),n})();function ude(n){if(Nm&&n)throw new re(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function dde(n){return["disabled"===n.initialNavigation?rc(3,[{provide:e0,multi:!0,useFactory:()=>{const t=ht(pr);return()=>{t.setUpLocationChangeListener()}}},{provide:Mk,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?rc(2,[{provide:Mk,useValue:0},{provide:e0,multi:!0,deps:[Ro],useFactory:t=>{const e=t.get(doe,Promise.resolve());return()=>e.then(()=>new Promise(i=>{const s=t.get(pr),r=t.get(Bz);(function Jue(n,t){n.events.pipe(Uo(e=>e instanceof Nu||e instanceof O0||e instanceof fk||e instanceof F0),lt(e=>e instanceof Nu||e instanceof F0?Pr.COMPLETE:e instanceof O0&&(0===e.code||1===e.code)?Pr.REDIRECTING:Pr.FAILED),Uo(e=>e!==Pr.REDIRECTING),va(1)).subscribe(()=>{t()})})(s,()=>{i(!0)}),t.get(G0).afterPreactivation=()=>(i(!0),r.closed?Ke(void 0):r),s.initialNavigation()}))}}]).\u0275providers:[]]}const Wz=new Ce(Nm?"Router Initializer":"");class X0{}class Pk{}class bl{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const s=e.slice(0,i),r=s.toLowerCase(),o=e.slice(i+1).trim();this.maybeSetNormalizedName(s,r),this.headers.has(r)?this.headers.get(r).push(o):this.headers.set(r,[o])}})}:()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{let s;if(s="string"==typeof i?[i]:"number"==typeof i?[i.toString()]:i.map(r=>r.toString()),s.length>0){const r=e.toLowerCase();this.headers.set(r,s),this.maybeSetNormalizedName(e,r)}})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof bl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new bl;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof bl?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...i),this.headers.set(e,s);break;case"d":const r=t.value;if(r){let o=this.headers.get(e);if(!o)return;o=o.filter(a=>-1===r.indexOf(a)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class fde{encodeKey(t){return Hz(t)}encodeValue(t){return Hz(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const mde=/%(\d[a-f0-9])/gi,gde={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Hz(n){return encodeURIComponent(n).replace(mde,(t,e)=>gde[e]??t)}function Y0(n){return`${n}`}class oc{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new fde,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function pde(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const r=s.indexOf("="),[o,a]=-1==r?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,r)),t.decodeValue(s.slice(r+1))],l=e.get(o)||[];l.push(a),e.set(o,l)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e],s=Array.isArray(i)?i.map(Y0):[Y0(i)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(i=>{const s=t[i];Array.isArray(s)?s.forEach(r=>{e.push({param:i,value:r,op:"a"})}):e.push({param:i,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new oc({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Y0(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const s=i.indexOf(Y0(t.value));-1!==s&&i.splice(s,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class bde{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function jz(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Gz(n){return typeof Blob<"u"&&n instanceof Blob}function qz(n){return typeof FormData<"u"&&n instanceof FormData}class Am{constructor(t,e,i,s){let r;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function _de(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==i?i:null,r=s):r=i,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.context&&(this.context=r.context),r.params&&(this.params=r.params)),this.headers||(this.headers=new bl),this.context||(this.context=new bde),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const a=e.indexOf("?");this.urlWithParams=e+(-1===a?"?":a<e.length-1?"&":"")+o}}else this.params=new oc,this.urlWithParams=e}serializeBody(){return null===this.body?null:jz(this.body)||Gz(this.body)||qz(this.body)||function yde(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof oc?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||qz(this.body)?null:Gz(this.body)?this.body.type||null:jz(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof oc?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,s=t.responseType||this.responseType,r=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let l=t.headers||this.headers,c=t.params||this.params;const u=t.context??this.context;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce((d,h)=>d.set(h,t.setHeaders[h]),l)),t.setParams&&(c=Object.keys(t.setParams).reduce((d,h)=>d.set(h,t.setParams[h]),c)),new Am(e,i,r,{params:c,headers:l,context:u,reportProgress:a,responseType:s,withCredentials:o})}}var $i=(()=>(($i=$i||{})[$i.Sent=0]="Sent",$i[$i.UploadProgress=1]="UploadProgress",$i[$i.ResponseHeader=2]="ResponseHeader",$i[$i.DownloadProgress=3]="DownloadProgress",$i[$i.Response=4]="Response",$i[$i.User=5]="User",$i))();class Rk{constructor(t,e=200,i="OK"){this.headers=t.headers||new bl,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class Ok extends Rk{constructor(t={}){super(t),this.type=$i.ResponseHeader}clone(t={}){return new Ok({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Z0 extends Rk{constructor(t={}){super(t),this.type=$i.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Z0({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Kz extends Rk{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function Fk(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let Q0=(()=>{class n{constructor(e){this.handler=e}request(e,i,s={}){let r;if(e instanceof Am)r=e;else{let l,c;l=s.headers instanceof bl?s.headers:new bl(s.headers),s.params&&(c=s.params instanceof oc?s.params:new oc({fromObject:s.params})),r=new Am(e,i,void 0!==s.body?s.body:null,{headers:l,context:s.context,params:c,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Ke(r).pipe(nc(l=>this.handler.handle(l)));if(e instanceof Am||"events"===s.observe)return o;const a=o.pipe(Uo(l=>l instanceof Z0));switch(s.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return a.pipe(lt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(lt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(lt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(lt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new oc).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,s={}){return this.request("PATCH",e,Fk(s,i))}post(e,i,s={}){return this.request("POST",e,Fk(s,i))}put(e,i,s={}){return this.request("PUT",e,Fk(s,i))}}return n.\u0275fac=function(e){return new(e||n)(me(X0))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();function Xz(n,t){return t(n)}function vde(n,t){return(e,i)=>t.intercept(e,{handle:s=>n(s,i)})}const Cde=new Ce("HTTP_INTERCEPTORS"),Mm=new Ce("HTTP_INTERCEPTOR_FNS");function wde(){let n=null;return(t,e)=>(null===n&&(n=(ht(Cde,{optional:!0})??[]).reduceRight(vde,Xz)),n(t,e))}let Yz=(()=>{class n extends X0{constructor(e,i){super(),this.backend=e,this.injector=i,this.chain=null}handle(e){if(null===this.chain){const i=Array.from(new Set(this.injector.get(Mm)));this.chain=i.reduceRight((s,r)=>function xde(n,t,e){return(i,s)=>e.runInContext(()=>t(i,r=>n(r,s)))}(s,r,this.injector),Xz)}return this.chain(e,i=>this.backend.handle(i))}}return n.\u0275fac=function(e){return new(e||n)(me(Pk),me(pa))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();const kde=/^\)\]\}',?\n/;let Qz=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new dt(i=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((f,p)=>s.setRequestHeader(f,p.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const f=e.detectContentTypeHeader();null!==f&&s.setRequestHeader("Content-Type",f)}if(e.responseType){const f=e.responseType.toLowerCase();s.responseType="json"!==f?f:"text"}const r=e.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const f=s.statusText||"OK",p=new bl(s.getAllResponseHeaders()),g=function Tde(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new Ok({headers:p,status:s.status,statusText:f,url:g}),o},l=()=>{let{headers:f,status:p,statusText:g,url:m}=a(),b=null;204!==p&&(b=typeof s.response>"u"?s.responseText:s.response),0===p&&(p=b?200:0);let _=p>=200&&p<300;if("json"===e.responseType&&"string"==typeof b){const y=b;b=b.replace(kde,"");try{b=""!==b?JSON.parse(b):null}catch(v){b=y,_&&(_=!1,b={error:v,text:b})}}_?(i.next(new Z0({body:b,headers:f,status:p,statusText:g,url:m||void 0})),i.complete()):i.error(new Kz({error:b,headers:f,status:p,statusText:g,url:m||void 0}))},c=f=>{const{url:p}=a(),g=new Kz({error:f,status:s.status||0,statusText:s.statusText||"Unknown Error",url:p||void 0});i.error(g)};let u=!1;const d=f=>{u||(i.next(a()),u=!0);let p={type:$i.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),"text"===e.responseType&&s.responseText&&(p.partialText=s.responseText),i.next(p)},h=f=>{let p={type:$i.UploadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),i.next(p)};return s.addEventListener("load",l),s.addEventListener("error",c),s.addEventListener("timeout",c),s.addEventListener("abort",c),e.reportProgress&&(s.addEventListener("progress",d),null!==r&&s.upload&&s.upload.addEventListener("progress",h)),s.send(r),i.next({type:$i.Sent}),()=>{s.removeEventListener("error",c),s.removeEventListener("abort",c),s.removeEventListener("load",l),s.removeEventListener("timeout",c),e.reportProgress&&(s.removeEventListener("progress",d),null!==r&&s.upload&&s.upload.removeEventListener("progress",h)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(me(sV))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();const Lk=new Ce("XSRF_ENABLED"),Jz=new Ce("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),e4=new Ce("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class t4{}let Ade=(()=>{class n{constructor(e,i,s){this.doc=e,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=j3(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(me(Jt),me(n0),me(Jz))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();function Mde(n,t){const e=n.url.toLowerCase();if(!ht(Lk)||"GET"===n.method||"HEAD"===n.method||e.startsWith("http://")||e.startsWith("https://"))return t(n);const i=ht(t4).getToken(),s=ht(e4);return null!=i&&!n.headers.has(s)&&(n=n.clone({headers:n.headers.set(s,i)})),t(n)}var Ni=(()=>((Ni=Ni||{})[Ni.Interceptors=0]="Interceptors",Ni[Ni.LegacyInterceptors=1]="LegacyInterceptors",Ni[Ni.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Ni[Ni.NoXsrfProtection=3]="NoXsrfProtection",Ni[Ni.JsonpSupport=4]="JsonpSupport",Ni[Ni.RequestsMadeViaParent=5]="RequestsMadeViaParent",Ni))();function qh(n,t){return{\u0275kind:n,\u0275providers:t}}function Pde(...n){const t=[Q0,Qz,Yz,{provide:X0,useExisting:Yz},{provide:Pk,useExisting:Qz},{provide:Mm,useValue:Mde,multi:!0},{provide:Lk,useValue:!0},{provide:t4,useClass:Ade}];for(const e of n)t.push(...e.\u0275providers);return function Mee(n){return{\u0275providers:n}}(t)}const n4=new Ce("LEGACY_INTERCEPTOR_FN");let $k,s4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({providers:[Pde(qh(Ni.LegacyInterceptors,[{provide:n4,useFactory:wde},{provide:Mm,useExisting:n4,multi:!0}]))]}),n})(),r4=(()=>{class n{constructor(e){this.http=e,this.APIUrl="https://localhost:7197/api",this.predictAPIURL="https://raceappplan.azurewebsites.net"}getValues(){return this.http.get(this.APIUrl)}insertValues(e){return this.http.post(this.APIUrl,e)}simulateStint(e){return this.http.post(`${this.predictAPIURL}/api/simulate-stint`,e)}getVehicleIdsByRaceSession(e){return this.http.post(`${this.predictAPIURL}/api/get-vehicles`,e)}getLapNumbersByRaceSessionAndVehicleId(e){return this.http.post(`${this.predictAPIURL}/api/get-laps`,e)}getFinalResultsByTrackAndRaceSession(e){return this.http.post(`${this.predictAPIURL}/api/get-final-results`,e)}predictNewRaceSession(e){return this.http.post(`${this.predictAPIURL}/api/predict-new-session`,e)}}return n.\u0275fac=function(e){return new(e||n)(me(Q0))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ode=(()=>{class n{constructor(e){this.service=e,this.tempValues=[]}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(ie(r4))},n.\u0275cmp=Zn({type:n,selectors:[["app-main-compon"]],decls:21,vars:0,consts:[["title","Click to go to my LinkedIn!",1,"s1"],["href","https://www.linkedin.com/in/sam-brey-291041261/","target","_blank"],["title","Click to see my project's YoutTube video!",1,"a1"],["href","https://youtu.be/21nEexaQpsk","target","_blank"],["title","Click to see this website code!",1,"m1"],["href","https://github.com/SammySaysSo/mywebsitecode","target","_blank"],["title","Click to see my love!",1,"s2"],["href","assets/SamAndLeah.jpg","target","_blank"],["title","Click to go to my PC parts!",1,"a2"],["href","http://pcpartpicker.com/user/SammySaysSo/saved/#view=MTZgnQ","target","_blank"],["title","Click to go to my MCU project!",1,"y2"],["href","https://github.com/SammySaysSo/MicrocontrollerFinalProject","target","_blank"],["title","Click for a cat!",1,"s3"],["href","assets/CatPun.png","target","_blank"]],template:function(e,i){1&e&&(w(0,"h2",0)(1,"a",1),I(2,"S"),C()(),w(3,"h2",2)(4,"a",3),I(5,"A"),C()(),w(6,"h2",4)(7,"a",5),I(8,"M"),C()(),w(9,"h2",6)(10,"a",7),I(11,"B"),C()(),w(12,"h2",8)(13,"a",9),I(14,"R"),C()(),w(15,"h2",10)(16,"a",11),I(17,"E"),C()(),w(18,"h2",12)(19,"a",13),I(20,"Y"),C()())},styles:["*[_ngcontent-%COMP%]{transition:.75s;height:20px}h2[_ngcontent-%COMP%]{font-size:15vw}a[_ngcontent-%COMP%]{text-decoration:none;color:inherit}a[_ngcontent-%COMP%]:hover{cursor:pointer}*[_ngcontent-%COMP%]:hover{color:#32cd32;z-index:1;cursor:default}.s1[_ngcontent-%COMP%]{display:block;position:absolute;animation:_ngcontent-%COMP%_moveS1 5s linear,test 6s infinite;animation-fill-mode:forwards}.a1[_ngcontent-%COMP%]{display:block;position:absolute;animation:_ngcontent-%COMP%_moveA1 5s linear,test 5s infinite;animation-fill-mode:forwards}.m1[_ngcontent-%COMP%]{display:block;position:absolute;animation:_ngcontent-%COMP%_moveM1 5s linear,test 4s infinite;animation-fill-mode:forwards}.s2[_ngcontent-%COMP%]{display:block;position:absolute;animation:_ngcontent-%COMP%_moveS2 5s linear,test 6s infinite;animation-fill-mode:forwards}.a2[_ngcontent-%COMP%]{display:block;position:absolute;animation:_ngcontent-%COMP%_moveA2 5s linear,test 5s infinite;animation-fill-mode:forwards}.y2[_ngcontent-%COMP%]{display:block;position:absolute;animation:_ngcontent-%COMP%_moveY2 5s linear,test 4s infinite;animation-fill-mode:forwards}.s3[_ngcontent-%COMP%]{display:block;position:absolute;animation:_ngcontent-%COMP%_moveS3 5s linear,test 3s infinite;animation-fill-mode:forwards}@keyframes _ngcontent-%COMP%_moveS1{0%{top:75%;left:90%;transform:rotate(0)}to{top:35%;left:27%;transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_moveA1{0%{top:20%;left:80%;transform:rotate(0)}to{top:35%;left:35%;transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_moveM1{0%{top:25%;left:2%;transform:rotate(0)}to{top:35%;left:44%;transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_moveS2{0%{top:50%;left:2%;transform:rotate(0)}to{top:59%;left:27%;transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_moveA2{0%{top:20%;left:35%;transform:rotate(0)}to{top:59%;left:35%;transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_moveY2{0%{top:20%;left:50%;transform:rotate(0)}to{top:59%;left:46%;transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_moveS3{0%{top:75%;left:55%;transform:rotate(0)}to{top:59%;left:57%;transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_test{0%{transform:rotateX(0)}to{transform:rotateX(360deg)}}"]}),n})();try{$k=typeof Intl<"u"&&Intl.v8BreakIterator}catch{$k=!1}let Pm,Bk,ac=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function Dae(n){return n===nV}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!$k)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(e){return new(e||n)(me(n0))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function lc(n){return function Fde(){if(null==Pm&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Pm=!0}))}finally{Pm=Pm||!1}return Pm}()?n:!!n.capture}function Vk(n){if(function Lde(){if(null==Bk){const n=typeof document<"u"?document.head:null;Bk=!(!n||!n.createShadowRoot&&!n.attachShadow)}return Bk}()){const t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function wa(n){return n.composedPath?n.composedPath()[0]:n.target}function a4(n){return Uo((t,e)=>n<=e)}function jde(n,t){return n===t}function Xh(n){return fi((t,e)=>{qs(n).subscribe(Yn(e,()=>e.complete(),un)),!e.closed&&t.subscribe(e)})}function Wo(n){return null!=n&&"false"!=`${n}`}function zk(n){return Array.isArray(n)?n:[n]}function Yi(n){return n instanceof Ri?n.nativeElement:n}class qde extends G{constructor(t,e){super()}schedule(t,e=0){return this}}const ev={setInterval(n,t,...e){const{delegate:i}=ev;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=ev;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class Uk extends qde{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const s=this.id,r=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(r,s,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,i=0){return ev.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&ev.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,i=!1;try{this.work(t)}catch(r){i=!0,s=r||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Oe(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const c4={now:()=>(c4.delegate||Date).now(),delegate:void 0};class Rm{constructor(t,e=Rm.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}Rm.now=c4.now;class Wk extends Rm{constructor(t,e=Rm.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const tv=new Wk(Uk),Kde=tv,u4=new Set;let Yh,Yde=(()=>{class n{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Qde}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function Zde(n){if(!u4.has(n))try{Yh||(Yh=document.createElement("style"),Yh.setAttribute("type","text/css"),document.head.appendChild(Yh)),Yh.sheet&&(Yh.sheet.insertRule(`@media ${n} {body{ }}`,0),u4.add(n))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return n.\u0275fac=function(e){return new(e||n)(me(ac))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Qde(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let Jde=(()=>{class n{constructor(e,i){this._mediaMatcher=e,this._zone=i,this._queries=new Map,this._destroySubject=new Ut}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return d4(zk(e)).some(s=>this._registerQuery(s).mql.matches)}observe(e){let r=ik(d4(zk(e)).map(o=>this._registerQuery(o).observable));return r=I0(r.pipe(va(1)),r.pipe(a4(1),function Xde(n,t=tv){return fi((e,i)=>{let s=null,r=null,o=null;const a=()=>{if(s){s.unsubscribe(),s=null;const c=r;r=null,i.next(c)}};function l(){const c=o+n,u=t.now();if(u<c)return s=this.schedule(void 0,c-u),void i.add(s);a()}e.subscribe(Yn(i,c=>{r=c,o=t.now(),s||(s=t.schedule(l,n),i.add(s))},()=>{a(),i.complete()},void 0,()=>{r=s=null}))})}(0))),r.pipe(lt(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const i=this._mediaMatcher.matchMedia(e),r={observable:new dt(o=>{const a=l=>this._zone.run(()=>o.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(mm(i),lt(({matches:o})=>({query:e,matches:o})),Xh(this._destroySubject)),mql:i};return this._queries.set(e,r),r}}return n.\u0275fac=function(e){return new(e||n)(me(Yde),me(Zt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function d4(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}function Hk(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function jk(n){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const ahe=new Ce("cdk-input-modality-detector-options"),lhe={ignoreKeys:[18,17,224,91,16]},Zh=lc({passive:!0,capture:!0});let che=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(e,i,s,r){this._platform=e,this._mostRecentTarget=null,this._modality=new ao(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=wa(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(Hk(o)?"keyboard":"mouse"),this._mostRecentTarget=wa(o))},this._onTouchstart=o=>{jk(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=wa(o))},this._options={...lhe,...r},this.modalityDetected=this._modality.pipe(a4(1)),this.modalityChanged=this.modalityDetected.pipe(function Hde(n,t=$n){return n=n??jde,fi((e,i)=>{let s,r=!0;e.subscribe(Yn(i,o=>{const a=t(o);(r||!n(s,a))&&(r=!1,s=a,i.next(o))}))})}()),e.isBrowser&&i.runOutsideAngular(()=>{s.addEventListener("keydown",this._onKeydown,Zh),s.addEventListener("mousedown",this._onMousedown,Zh),s.addEventListener("touchstart",this._onTouchstart,Zh)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Zh),document.removeEventListener("mousedown",this._onMousedown,Zh),document.removeEventListener("touchstart",this._onTouchstart,Zh))}}return n.\u0275fac=function(e){return new(e||n)(me(ac),me(Zt),me(Jt),me(ahe,8))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const dhe=new Ce("cdk-focus-monitor-default-options"),nv=lc({passive:!0,capture:!0});let hhe=(()=>{class n{constructor(e,i,s,r,o){this._ngZone=e,this._platform=i,this._inputModalityDetector=s,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ut,this._rootNodeFocusAndBlurListener=a=>{for(let c=wa(a);c;c=c.parentElement)"focus"===a.type?this._onFocus(a,c):this._onBlur(a,c)},this._document=r,this._detectionMode=o?.detectionMode||0}monitor(e,i=!1){const s=Yi(e);if(!this._platform.isBrowser||1!==s.nodeType)return Ke(null);const r=Vk(s)||this._getDocument(),o=this._elementInfo.get(s);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new Ut,rootNode:r};return this._elementInfo.set(s,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(e){const i=Yi(e),s=this._elementInfo.get(i);s&&(s.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(s))}focusVia(e,i,s){const r=Yi(e);r===this._getDocument().activeElement?this._getClosestElementsInfo(r).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof r.focus&&r.focus(s))}ngOnDestroy(){this._elementInfo.forEach((e,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,i){e.classList.toggle("cdk-focused",!!i),e.classList.toggle("cdk-touch-focused","touch"===i),e.classList.toggle("cdk-keyboard-focused","keyboard"===i),e.classList.toggle("cdk-mouse-focused","mouse"===i),e.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(e,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,i){const s=this._elementInfo.get(i),r=wa(e);!s||!s.checkChildren&&i!==r||this._originChanged(i,this._getFocusOrigin(r),s)}_onBlur(e,i){const s=this._elementInfo.get(i);!s||s.checkChildren&&e.relatedTarget instanceof Node&&i.contains(e.relatedTarget)||(this._setClasses(i),this._emitOrigin(s,null))}_emitOrigin(e,i){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(i))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const i=e.rootNode,s=this._rootNodeFocusListenerCount.get(i)||0;s||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,nv),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,nv)}),this._rootNodeFocusListenerCount.set(i,s+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Xh(this._stopInputModalityDetector)).subscribe(r=>{this._setOrigin(r,!0)}))}_removeGlobalListeners(e){const i=e.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const s=this._rootNodeFocusListenerCount.get(i);s>1?this._rootNodeFocusListenerCount.set(i,s-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,nv),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,nv),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,i,s){this._setClasses(e,i),this._emitOrigin(s,i),this._lastFocusOrigin=i}_getClosestElementsInfo(e){const i=[];return this._elementInfo.forEach((s,r)=>{(r===e||s.checkChildren&&r.contains(e))&&i.push([r,s])}),i}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:i,mostRecentModality:s}=this._inputModalityDetector;if("mouse"!==s||!i||i===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const r=e.labels;if(r)for(let o=0;o<r.length;o++)if(r[o].contains(i))return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)(me(Zt),me(ac),me(che),me(Jt,8),me(dhe,8))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const g4="cdk-high-contrast-black-on-white",b4="cdk-high-contrast-white-on-black",Gk="cdk-high-contrast-active";let fhe=(()=>{class n{constructor(e,i){this._platform=e,this._document=i,this._breakpointSubscription=ht(Jde).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const i=this._document.defaultView||window,s=i&&i.getComputedStyle?i.getComputedStyle(e):null,r=(s&&s.backgroundColor||"").replace(/ /g,"");switch(e.remove(),r){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(Gk,g4,b4),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?e.add(Gk,g4):2===i&&e.add(Gk,b4)}}}return n.\u0275fac=function(e){return new(e||n)(me(ac),me(Jt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const phe=new Ce("cdk-dir-doc",{providedIn:"root",factory:function mhe(){return ht(Jt)}}),ghe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let _4=(()=>{class n{constructor(e){this.value="ltr",this.change=new Yt,e&&(this.value=function bhe(n){const t=n?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?ghe.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(e){return new(e||n)(me(phe,8))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),y4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({}),n})();const yhe=new Ce("mat-sanity-checks",{providedIn:"root",factory:function _he(){return!0}});let Sa=(()=>{class n{constructor(e,i,s){this._sanityChecks=i,this._document=s,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!function $de(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return n.\u0275fac=function(e){return new(e||n)(me(fhe),me(yhe,8),me(Jt))},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[y4,y4]}),n})();function vhe(n){return class extends n{get disabled(){return this._disabled}set disabled(t){this._disabled=Wo(t)}constructor(...t){super(...t),this._disabled=!1}}}function C4(n,t){return class extends n{get color(){return this._color}set color(e){const i=e||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...e){super(...e),this.defaultColor=t,this.color=t}}}function xhe(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Wo(t)}constructor(...t){super(...t),this._disableRipple=!1}}}class whe{constructor(t,e,i,s=!1){this._renderer=t,this.element=e,this.config=i,this._animationForciblyDisabledThroughCss=s,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const w4=lc({passive:!0,capture:!0});class She{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const e=wa(t);e&&this._events.get(t.type)?.forEach((i,s)=>{(s===e||s.contains(e))&&i.forEach(r=>r.handleEvent(t))})}}addHandler(t,e,i,s){const r=this._events.get(e);if(r){const o=r.get(i);o?o.add(s):r.set(i,new Set([s]))}else this._events.set(e,new Map([[i,new Set([s])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,w4)})}removeHandler(t,e,i){const s=this._events.get(t);if(!s)return;const r=s.get(e);r&&(r.delete(i),0===r.size&&s.delete(e),0===s.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,w4)))}}const S4={enterDuration:225,exitDuration:150},I4=lc({passive:!0,capture:!0}),E4=["mousedown","touchstart"],k4=["mouseup","mouseleave","touchend","touchcancel"];class Fm{constructor(t,e,i,s){this._target=t,this._ngZone=e,this._platform=s,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,s.isBrowser&&(this._containerElement=Yi(i))}fadeInRipple(t,e,i={}){const s=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),r={...S4,...i.animation};i.centered&&(t=s.left+s.width/2,e=s.top+s.height/2);const o=i.radius||function Ehe(n,t,e){const i=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),s=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(i*i+s*s)}(t,e,s),a=t-s.left,l=e-s.top,c=r.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u);const d=window.getComputedStyle(u),f=d.transitionDuration,p="none"===d.transitionProperty||"0s"===f||"0s, 0s"===f||0===s.width&&0===s.height,g=new whe(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",g.state=0,i.persistent||(this._mostRecentTransientRipple=g);let m=null;return!p&&(c||r.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const b=()=>this._finishRippleTransition(g),_=()=>this._destroyRipple(g);u.addEventListener("transitionend",b),u.addEventListener("transitioncancel",_),m={onTransitionEnd:b,onTransitionCancel:_}}),this._activeRipples.set(g,m),(p||!c)&&this._finishRippleTransition(g),g}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,i={...S4,...t.config.animation};e.style.transitionDuration=`${i.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=Yi(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,E4.forEach(i=>{Fm._eventManager.addHandler(this._ngZone,i,e,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{k4.forEach(e=>{this._triggerElement.addEventListener(e,this,I4)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:i}=t.config;t.state=1,!i&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=Hk(t),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!i&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!jk(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let i=0;i<e.length;i++)this.fadeInRipple(e[i].clientX,e[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(E4.forEach(e=>Fm._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&k4.forEach(e=>t.removeEventListener(e,this,I4)))}}Fm._eventManager=new She;const khe=new Ce("mat-ripple-global-options");let T4=(()=>{class n{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,i,s,r,o){this._elementRef=e,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new Fm(this,i,e,s)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,i=0,s){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,i,{...this.rippleConfig,...s}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return n.\u0275fac=function(e){return new(e||n)(ie(Ri),ie(Zt),ie(ac),ie(khe,8),ie(s0,8))},n.\u0275dir=Ze({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,i){2&e&&Zs("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),The=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[Sa,Sa]}),n})();const Dhe=["mat-button",""],Nhe=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Ahe=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Mhe=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],Phe=C4(vhe(xhe(class{constructor(n){this._elementRef=n}})));let Rhe=(()=>{class n extends Phe{constructor(e,i,s,r){super(e),this._platform=i,this._ngZone=s,this._animationMode=r,this._focusMonitor=ht(hhe),this._isFab=!1;const o=e.nativeElement.classList;for(const a of Mhe)this._hasHostAttributes(a.selector)&&a.mdcClasses.forEach(l=>{o.add(l)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",i){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...e){return e.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return n.\u0275fac=function(e){yI()},n.\u0275dir=Ze({type:n,viewQuery:function(e,i){if(1&e&&function RB(n,t,e){const i=Kt();i.firstCreatePass&&(FB(i,new MB(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),OB(i,fe(),t)}(T4,5),2&e){let s;Ah(s=Mh())&&(i.ripple=s.first)}},features:[$t]}),n})(),co=(()=>{class n extends Rhe{constructor(e,i,s,r){super(e,i,s,r)}}return n.\u0275fac=function(e){return new(e||n)(ie(Ri),ie(ac),ie(Zt),ie(s0,8))},n.\u0275cmp=Zn({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(e,i){2&e&&(Mr("disabled",i.disabled||null),Zs("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[$t],attrs:Dhe,ngContentSelectors:Ahe,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,i){1&e&&($I(Nhe),Ne(0,"span",0),Xp(1),w(2,"span",1),Xp(3,1),C(),Xp(4,2),Ne(5,"span",2)(6,"span",3)(7,"span",4)),2&e&&(Zs("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab),W(6),oe("matRippleDisabled",i._isRippleDisabled())("matRippleTrigger",i._elementRef.nativeElement))},dependencies:[T4],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),Lhe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[Sa,The,Sa]}),n})(),Qh=(()=>{class n{constructor(e){this.route=e,this.routerTextOfEachProject=["projOne","projTwo","projThree","projFour","projFive"]}loopThroughProjects(e){this.route.navigate([this.routerTextOfEachProject[e]])}}return n.\u0275fac=function(e){return new(e||n)(ie(pr))},n.\u0275cmp=Zn({type:n,selectors:[["app-proj"]],decls:32,vars:0,consts:[["mat-raised-button","",3,"click"],["mat-raised-button","","id","a1",3,"click"],["id","outer"],[1,"inner"],["id","b"]],template:function(e,i){1&e&&(w(0,"button",0),H("click",function(){return i.loopThroughProjects(4)}),I(1,"Click for projects!"),C(),w(2,"button",1),H("click",function(){return i.loopThroughProjects(0)}),I(3,"Click for projects!"),C(),Ne(4,"br")(5,"br")(6,"br"),w(7,"div",2)(8,"div",3)(9,"h1",4),I(10,"P"),C()(),w(11,"div",3)(12,"h1",4),I(13,"R"),C()(),w(14,"div",3)(15,"h1",4),I(16,"O"),C()(),w(17,"div",3)(18,"h1",4),I(19,"J"),C()(),w(20,"div",3)(21,"h1",4),I(22,"E"),C()(),w(23,"div",3)(24,"h1",4),I(25,"C"),C()(),w(26,"div",3)(27,"h1",4),I(28,"T"),C()(),w(29,"div",3)(30,"h1",4),I(31,"S"),C()()())},dependencies:[co],styles:["#a1[_ngcontent-%COMP%]{float:right}#b[_ngcontent-%COMP%]{font-size:8vw;margin-top:2vw;color:red;position:relative;animation:_ngcontent-%COMP%_bRotate 5s linear infinite alternate}#outer[_ngcontent-%COMP%]{width:100%;text-align:center}.inner[_ngcontent-%COMP%]{margin-left:2%;margin-right:2%;display:inline-block}@keyframes _ngcontent-%COMP%_bRotate{0%{color:red;transform:rotate(0)}25%{color:#ff0;transform:rotate(100deg)}50%{color:#00f;transform:rotate(250deg)}75%{color:green;transform:rotate(300deg)}to{color:red;transform:rotate(360deg)}}"]}),n})(),$he=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-experience"]],decls:225,vars:0,consts:[[1,"education"],["href","https://www.linkedin.com/in/sam-brey-291041261/","target","_blank"],[1,"skills"],[1,"skill"],[1,"skill-name"],[1,"skill-bar"],["per","B+",1,"skill-per",2,"max-width","85%"],["per","A",1,"skill-per",2,"max-width","95%"],["per","B-",1,"skill-per",2,"max-width","75%"],["per","A-",1,"skill-per",2,"max-width","90%"],["per","B-",1,"skill-per",2,"max-width","80%"],["per","C",1,"skill-per",2,"max-width","70%"]],template:function(e,i){1&e&&(w(0,"h2",0)(1,"a",1),I(2,"Click here to go to my LinkedIn Profile"),C()(),w(3,"h2",0)(4,"b"),I(5,"EDUCATION"),C()(),w(6,"ul")(7,"li")(8,"b"),I(9,"Bachelor of Science in Computer Science & Engineering"),C(),w(10,"i"),I(11," Spring 2025"),C()(),w(12,"li")(13,"b"),I(14,"Minor in Mathematicas"),C(),w(15,"i"),I(16," Spring 2025"),C()(),w(17,"li"),I(18,"Graduated Engineering with Honors & Summa Cum Laude at University of Louisville"),w(19,"i"),I(20," GPA 3.98/4.00"),C()(),w(21,"li"),I(22,"Got accepted into "),w(23,"b"),I(24,"Vanderbilt, PennState, and UofL"),C(),I(25," for Master of Engineering in Computer Science and Engineering"),w(26,"i"),I(27," Expected Spring 2026"),C()()(),Ne(28,"br"),w(29,"h2",0)(30,"b"),I(31,"WORK EXPERIENCE"),C()(),w(32,"ul")(33,"li")(34,"u"),I(35,"UPS IT Internship(Summer 2025):"),C(),I(36," TBD"),C(),w(37,"li")(38,"u"),I(39,"The Rawlings Group(3 rotational semesters):"),C(),I(40," Co-op/intern for application development. Worked on web apps and led many projects for the company and directors, created a full stack web app, worked in an real app dev team with senior application developers, and worked on a 100+ million dollar application while working with the company's clients"),C(),w(41,"li")(42,"u"),I(43,"Teacher Assitant and Grader:"),C(),I(44," Grade calculus I, II, III, & Differential Equations while working with professors at University of Louisville, J.B. Speed School of Engineering "),w(45,"i"),I(46,"January 2022 - present"),C()(),w(47,"li")(48,"u"),I(49,"GE(General Electric) Appliances:"),C(),I(50," Worked on the line as a team building home appliances "),w(51,"i"),I(52,"May 2021 - August 2021"),C()(),w(53,"li")(54,"u"),I(55,"Other:"),C(),I(56," CSAA & Provisional volleyball official "),w(57,"i"),I(58,"present"),C()()(),Ne(59,"br"),w(60,"h2",0)(61,"b"),I(62,"SKILLS"),C()(),w(63,"div",2)(64,"div",3)(65,"div",4)(66,"u"),I(67,"HTML & CSS & SCSS"),C()(),w(68,"div",5),Ne(69,"div",6),C()(),w(70,"div",3)(71,"div",4)(72,"u"),I(73,"Javascript & Typescript"),C()(),w(74,"div",5),Ne(75,"div",7),C()(),w(76,"div",3)(77,"div",4)(78,"u"),I(79,"C#"),C()(),w(80,"div",5),Ne(81,"div",6),C()()(),Ne(82,"br"),w(83,"div",2)(84,"div",3)(85,"div",4)(86,"u"),I(87,"C/C++"),C()(),w(88,"div",5),Ne(89,"div",8),C()(),w(90,"div",3)(91,"div",4)(92,"u"),I(93,"Python & Java"),C()(),w(94,"div",5),Ne(95,"div",6),C()(),w(96,"div",3)(97,"div",4)(98,"u"),I(99,"SQL"),C()(),w(100,"div",5),Ne(101,"div",9),C()()(),Ne(102,"br"),w(103,"div",2)(104,"div",3)(105,"div",4)(106,"u"),I(107,"Embedded Systems & Algorithms"),C()(),w(108,"div",5),Ne(109,"div",6),C()(),w(110,"div",3)(111,"div",4)(112,"u"),I(113,"Angular & Github"),C()(),w(114,"div",5),Ne(115,"div",9),C()(),w(116,"div",3)(117,"div",4)(118,"u"),I(119,"Assembler & Arduino"),C()(),w(120,"div",5),Ne(121,"div",10),C()()(),Ne(122,"br"),w(123,"div",2)(124,"div",3)(125,"div",4)(126,"u"),I(127,"Data & Discrete Structures"),C()(),w(128,"div",5),Ne(129,"div",9),C()(),w(130,"div",3)(131,"div",4)(132,"u"),I(133,"Microcontrollers & Logic Design"),C()(),w(134,"div",5),Ne(135,"div",6),C()(),w(136,"div",3)(137,"div",4)(138,"u"),I(139,".NET"),C()(),w(140,"div",5),Ne(141,"div",11),C()()(),Ne(142,"br"),w(143,"div",2)(144,"div",3)(145,"div",4)(146,"u"),I(147,"Teamwork & Communication"),C()(),w(148,"div",5),Ne(149,"div",7),C()(),w(150,"div",3)(151,"div",4)(152,"u"),I(153,"Problem Solving"),C()(),w(154,"div",5),Ne(155,"div",7),C()(),w(156,"div",3)(157,"div",4)(158,"u"),I(159,"Adaptability"),C()(),w(160,"div",5),Ne(161,"div",7),C()()(),Ne(162,"br"),w(163,"h2",0)(164,"b"),I(165,"APPLIED EXPERIENCE"),C()(),w(166,"ul")(167,"li")(168,"u"),I(169,"C#:"),C(),I(170," Created a functional API for a full stack web application"),C(),w(171,"li")(172,"u"),I(173,"Javascript/Typescript:"),C(),I(174," Created frontend UI for web application(Linking to API & using HTML, CSS, & SCSS)"),C(),w(175,"li")(176,"u"),I(177,"Python:"),C(),I(178," Made multiple games with advanced object oriented programming(Space Invader, Snake, and Finish the Song)"),C(),w(179,"li")(180,"u"),I(181,"SQL:"),C(),I(182," Made stored procedures in SQL Server Management Studio that links with the API using Dapper that uses with web applications. Made immense migration scripts from my internship"),C(),w(183,"li")(184,"u"),I(185,"C/Ardunio:"),C(),I(186," Created a fully functioning sensor where I ahd to put all the parts together myself ~ soldering ~ and create all the software by hand using the datasheets"),C()(),Ne(187,"br"),w(188,"h2",0)(189,"b"),I(190,"ACTIVITIES/HONORS"),C()(),w(191,"ul")(192,"li"),I(193,"Dean list and scholar for University of Louisville "),w(194,"i"),I(195,"Multiple Semesters"),C()(),w(196,"li"),I(197,"President for University of Louisville Men's Club Volleyball"),C(),w(198,"li"),I(199,"Played in national tournaments in Club indoor and sand volleyball"),C(),w(200,"li"),I(201,"Volunteer at Catholic Charities of Louisville and Red Cross Home Fire Campaign"),C(),w(202,"li"),I(203,"Tutored peers for free in calculus & computer science and captain of multiple sand volleyball leagues"),C(),w(204,"li"),I(205,"Tau Beta Pi Engineering Honor Society Member"),C()(),Ne(206,"br"),w(207,"h2",0)(208,"b"),I(209,"OTHER APPLIED SCIENCES"),C()(),w(210,"ul")(211,"li"),I(212,"High School Diploma ~ DeSales HighSchool "),w(213,"i"),I(214,"Graduated 2021"),C()(),w(215,"li"),I(216,"Jefferson Community and Technical College ~ AP & DC High School class "),w(217,"i"),I(218,"Took 2020-2021"),C(),I(219," GPA 4.0/4.0"),C(),w(220,"li"),I(221,"Eastern Kentucky University ~ AP & DC High School class "),w(222,"i"),I(223,"Took 2021"),C(),I(224," GPA 4.0/4.0"),C()())},styles:[".education[_ngcontent-%COMP%]{animation:picAppearStart .5s linear;text-align:center}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}*[_ngcontent-%COMP%]{margin:0;padding:0;font-family:Ubuntu,sans-serif;box-sizing:border-box}body[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:#111}.skill[_ngcontent-%COMP%]{display:inline-block;width:30%;max-width:100%;padding:0 20px}.skills[_ngcontent-%COMP%]{display:block;margin-right:auto;width:90%;margin-left:10%}.skill-name[_ngcontent-%COMP%]{font-size:.85em;font-weight:700;color:red;text-transform:uppercase;margin:20px 0}.skill-bar[_ngcontent-%COMP%]{height:18px;background:#282828;border-radius:3px}.skill-per[_ngcontent-%COMP%]{height:18px;background:#d13639;border-radius:3px;position:relative;animation:_ngcontent-%COMP%_fillBars 2.5s 1}.skill-per[_ngcontent-%COMP%]:before{content:attr(per);position:absolute;background:#ff0000;border-radius:5px;font-size:18px;height:18px;right:0;transform:translate(50%)}.skill-per[_ngcontent-%COMP%]:after{visibility:hidden;display:none}u[_ngcontent-%COMP%]{text-underline-offset:5px}ul[_ngcontent-%COMP%]{list-style-position:inside;width:80%;margin-left:5%;list-style-type:none}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#0f1213;font-size:large;padding:5px;margin-left:35px}@keyframes _ngcontent-%COMP%_fillBars{0%{width:0}to{width:100%}}"]}),n})(),Bhe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-time-line"]],decls:126,vars:0,consts:[[1,"allTimeLine"],["id","a1",1,"yearText"],["id","a2",1,"monthText"],["id","a3",1,"textTimeLine2"],["src","assets/fts/ftsStart.png","alt","ftsLogo",1,"image",2,"width","100px","height","100px"],["id","a4",1,"middleLine"],["id","a5",1,"middleLine"],["id","b1",1,"monthText"],["id","a6"],[1,"textTimeLine1"],["id","a7",1,"middleLine"],["id","a8",1,"yearText"],["id","a9",1,"monthText"],["id","a10"],["id","a11",1,"middleLine"],["id","a12",1,"middleLine"],["id","a13",1,"textTimeLine2"],["src","assets/General_Electric_logo.png","alt","General_Electric_logo",1,"image",2,"width","100px","height","100px"],["id","a14",1,"middleLine"],["id","a15",1,"middleLine"],["id","a16",1,"monthText"],["id","a17",1,"textTimeLine2"],["src","assets/UofLLogo.png","alt","UofL_logo",1,"image",2,"width","100px","height","100px"],["id","a18",1,"middleLine"],["id","a19",1,"yearText"],["id","a20",1,"monthText"],["id","a21"],["id","a22",1,"middleLine"],["id","a23",1,"middleLine"],["id","a24",1,"monthText"],["id","a25"],["id","a26",1,"middleLine"],["id","a27",1,"yearText"],["id","a28",1,"monthText"],["id","a29",1,"textTimeLine1"],["href","https://pcpartpicker.com/user/SammySaysSo/saved/MTZgnQ","target","_blank",1,"textTimeLine1"],["id","a30",1,"middleLine"],["id","a31",1,"middleLine"],["id","a32",1,"textTimeLine2"],["src","assets/rawlingsLogo.jpg","alt","rawlingsLogo",1,"image",2,"width","100px","height","100px"],["id","a33",1,"middleLine"],["id","a34",1,"middleLine"],["id","a35",1,"monthText"],["id","a36"],["id","a37",1,"middleLine"],["id","a38",1,"middleLine"],["id","a39",1,"monthText"],["id","a40",1,"textTimeLine2"],["id","a41",1,"middleLine"],["id","a42",1,"yearText"],["id","a43",1,"monthText"],["id","a44"],["id","a45",1,"middleLine"],["id","a46",1,"middleLine"],["id","a47",1,"monthText"],["id","a48",1,"textTimeLine2"]],template:function(e,i){1&e&&(w(0,"div",0)(1,"h2",1),I(2," 2020 "),C(),w(3,"h4",2),I(4," February "),C(),w(5,"p",3),I(6," Created my own orignial finish the song game, or FTS for short. Created this game as my final project for Eastern Kentucky University when I was in high school. "),Ne(7,"img",4),C(),w(8,"p",5),I(9,"|"),C(),w(10,"p",6),I(11,"|"),C(),w(12,"h4",7),I(13," November "),C(),w(14,"div",8)(15,"p",9),I(16," Created a copy of snake. Learning more advanced object oriented programming and wanted to create a game from it. Learning from youtube and added some of my own touches to the game. Used as a learning technique for me. "),C()(),w(17,"p",10),I(18,"|"),C(),Ne(19,"br")(20,"br"),w(21,"h2",11),I(22," 2021 "),C(),w(23,"h4",12),I(24," May "),C(),w(25,"div",13)(26,"p",9),I(27," Graduated high school, finished dual credit classes within highschool at Jefferson Community and Technical College and Eastern Kentucky University. "),C()(),w(28,"p",14),I(29,"|"),C(),w(30,"p",15),I(31,"|"),C(),w(32,"p",16),I(33," May-August. General Electric summer job between the time of graduating high school and starting college. Worked in the factory as a line worker. Doing a variety of tasks as wiring, working as a team, etc... "),Ne(34,"img",17),C(),w(35,"p",18),I(36,"|"),C(),w(37,"p",19),I(38,"|"),C(),w(39,"h4",20),I(40," August "),C(),w(41,"p",21),I(42," Started College at University of Louisville, to get Computer Science and Engineering degree. Joined the Men's Club Volleyball Team. "),Ne(43,"img",22),C(),w(44,"p",23),I(45,"|"),C(),Ne(46,"br")(47,"br"),w(48,"h2",24),I(49," 2022 "),C(),w(50,"h4",25),I(51," January "),C(),w(52,"div",26)(53,"p",9),I(54," January-present. Was picked to become a teacher assistant for calculus program. Grading hundreds of calc 1, calc 2, and calc 3 papers. As well as working with professors and other graders. "),C()(),w(55,"p",27),I(56,"|"),C(),w(57,"p",28),I(58,"|"),C(),w(59,"h4",29),I(60," September "),C(),w(61,"div",30)(62,"p",9),I(63," Created a minature copy of Space Invader. Learning from the techniques from Youtube, added a lot of my own ideas to the game. Different menus, enemies, health, boss, etc... "),C()(),w(64,"p",31),I(65,"|"),C(),Ne(66,"br")(67,"br"),w(68,"h2",32),I(69," 2023 "),C(),w(70,"h4",33),I(71," January "),C(),w(72,"p",34),I(73," I researched and build my own PC. Self taught from no knowledge at all. Learned everything all on Youtube. "),w(74,"a",35),I(75,"Click to see the PC parts that I use"),C()(),w(76,"p",36),I(77,"|"),C(),w(78,"p",37),I(79,"|"),C(),w(80,"p",38),I(81," January-May. Co-op/intern at a company called The Rawlings Group. Was part of the App Dev team. Worked with my own full stack web application. Worked on many projects and applications for the company. Learned about SSMS, APIs, Angular, c#, typescript, javascript, git, SQL, and so so much more. "),Ne(82,"img",39),C(),w(83,"p",40),I(84,"|"),C(),w(85,"p",41),I(86,"|"),C(),w(87,"h4",42),I(88," Summer "),C(),w(89,"div",43)(90,"p",9),I(91," Summer classes for my CSE degree - Sophmore Year. Developed as a team leader a python GUI app that visualize and analysing wearable sensor data: can load and visualize given data in CSV format(Synchronize UI graphs, data query, visual panels, and data navigation). "),C()(),w(92,"p",44),I(93,"|"),C(),w(94,"p",45),I(95,"|"),C(),w(96,"h4",46),I(97," Fall "),C(),w(98,"p",47),I(99," August-December. Second rotation for Co-op/intern at The Rawlings Group. Worked on upgrading software for multiple applications that over 1000+ people use today. Added my own custom filters to a large data table(155,000 assets) to boost efficiency ten fold. Helped directors and managers to add more application tabs to a full database backed application. "),Ne(100,"img",39),C(),w(101,"p",48),I(102,"|"),C(),Ne(103,"br")(104,"br"),w(105,"h2",49),I(106," 2024 "),C(),w(107,"h4",50),I(108," Spring "),C(),w(109,"div",51)(110,"p",9),I(111," Got voted president of the University of Louisville Men's club volleyball team by over 40+ people where I run three teams and coordinate with my executive committee and Louisville to travel and play across the nation(got 9th in nationals ~ over 550 teams participated). Worked hands on in embedded systems and developed my own Microcontroller using Assembler, C language, and Microchip IDE to develop my own sensor LCD detector as a final project as a team lead. "),C()(),w(112,"p",52),I(113,"|"),C(),w(114,"p",53),I(115,"|"),C(),w(116,"h4",54),I(117," Summer "),C(),w(118,"p",55),I(119," Third rotation for Co-op/intern at The Rawlings Group. Got placed on a real team where I helped developed an application that handles hundred of million dollars for the company. Got real team experience and more responsibility on proper code handling. "),Ne(120,"img",39),C(),Ne(121,"br")(122,"br")(123,"br")(124,"br")(125,"br"),C())},styles:[".allTimeLine[_ngcontent-%COMP%]{margin-top:15px;text-align:center}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}.yearText[_ngcontent-%COMP%]{font-size:70px}.monthText[_ngcontent-%COMP%]{font-size:20px}.textFormat[_ngcontent-%COMP%]{display:inline-block}.middleLine[_ngcontent-%COMP%]{font-size:40px}.textTimeLine1[_ngcontent-%COMP%]{position:relative;display:inline-block;max-width:80%;font-size:16px;padding-top:30px;padding-bottom:30px;z-index:0;animation:_ngcontent-%COMP%_mymove 5s infinite}.textTimeLine2[_ngcontent-%COMP%]{position:relative;display:inline-block;max-width:80%;font-size:16px;padding-top:30px;padding-bottom:30px;z-index:0;text-shadow:20px 20px 6px #000000}.image[_ngcontent-%COMP%]{position:absolute;z-index:-1;top:-15px;opacity:.5;animation:_ngcontent-%COMP%_picMove 5s infinite}#a1[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart .5s linear}#a2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1s linear}#a3[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1.5s linear}#a4[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 2s linear}#a5[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 2.5s linear}#b1[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 2.75s linear}#a6[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 3s linear}#a7[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 3.5s linear}#a8[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 4s linear}#a9[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 4.5s linear}#a10[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 5s linear}#a11[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 5.5s linear}#a12[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 6s linear}#a13[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 6.5s linear}#a14[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 7s linear}#a15[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 7.5s linear}#a16[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 8s linear}#a17[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 8.5s linear}#a18[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 9s linear}#a19[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 9.5s linear}#a20[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 10s linear}#a21[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 10.5s linear}#a22[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 11s linear}#a23[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 11.5s linear}#a24[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 12s linear}#a25[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 12.5s linear}#a26[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 13s linear}#a27[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 13.5s linear}#a28[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 14s linear}#a29[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 14.5s linear}#a30[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 15s linear}#a31[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 15.5s linear}#a32[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 16s linear}#a33[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 16.5s linear}#a34[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 17s linear}#a35[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 17.5s linear}#a36[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 18s linear}#a37[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 18.5s linear}#a38[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 19s linear}#a39[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 19.5s linear}#a40[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 20s linear}#a41[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 20.5s linear}#a42[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 21s linear}#a43[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 21.5s linear}#a44[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 22s linear}#a45[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 22.5s linear}#a46[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 23s linear}#a47[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 23.5s linear}#a48[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 24s linear}@keyframes _ngcontent-%COMP%_mymove{50%{text-shadow:20px 40px 4px rgb(0,0,0)}}@keyframes _ngcontent-%COMP%_picMove{0%{left:92%}50%{left:0%}to{left:92%}}@keyframes _ngcontent-%COMP%_picAppearStart{0%{opacity:0}50%{opacity:0}to{opacity:1}}"]}),n})();function D4(n,t,e,i,s,r,o){try{var a=n[r](o),l=a.value}catch(c){return void e(c)}a.done?t(l):Promise.resolve(l).then(i,s)}function Q(n){return function(){var t=this,e=arguments;return new Promise(function(i,s){var r=n.apply(t,e);function o(l){D4(r,i,s,o,a,"next",l)}function a(l){D4(r,i,s,o,a,"throw",l)}o(void 0)})}}const qk={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},we=function(n,t){if(!n)throw Jh(t)},Jh=function(n){return new Error("Firebase Database ("+qk.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)},N4=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&i+1<n.length&&56320==(64512&n.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++i)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},Kk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const r=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0;let h=(15&a)<<2|c>>6,f=63&c;l||(f=64,o||(h=64)),i.push(e[r>>2],e[(3&r)<<4|a>>4],e[h],e[f])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(N4(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,i=0;for(;e<n.length;){const s=n[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=n[e++];t[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const l=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(1023&l))}else{const r=n[e++],o=n[e++];t[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const r=e[n.charAt(s++)],a=s<n.length?e[n.charAt(s)]:0;++s;const c=s<n.length?e[n.charAt(s)]:64;++s;const d=s<n.length?e[n.charAt(s)]:64;if(++s,null==r||null==a||null==c||null==d)throw new zhe;i.push(r<<2|a>>4),64!==c&&(i.push(a<<4&240|c>>2),64!==d&&i.push(c<<6&192|d))}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class zhe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const A4=function(n){const t=N4(n);return Kk.encodeByteArray(t,!0)},iv=function(n){return A4(n).replace(/\./g,"")},Xk=function(n){try{return Kk.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Uhe(n){return M4(void 0,n)}function M4(n,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===n&&(n={});break;case Array:n=[];break;default:return t}for(const e in t)!t.hasOwnProperty(e)||!Whe(e)||(n[e]=M4(n[e],t[e]));return n}function Whe(n){return"__proto__"!==n}const sv=()=>{try{return function Hhe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Xk(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},Xhe=n=>{const t=(n=>{var t,e;return null===(e=null===(t=sv())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]})(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),i]:[t.substring(0,e),i]},P4=()=>{var n;return null===(n=sv())||void 0===n?void 0:n.config};class Lm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,i))}}}function R4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(function rv(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}())}function _l(){return!0===qk.NODE_CLIENT||!0===qk.NODE_ADMIN}class $m extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,$m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,O4.prototype.create)}}class O4{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?function ife(n,t){return n.replace(sfe,(e,i)=>{const s=t[i];return null!=s?String(s):`<${i}?>`})}(r,i):"Error";return new $m(s,`${this.serviceName}: ${o} (${s}).`,i)}}const sfe=/\{\$([^}]+)}/g;function Bm(n){return JSON.parse(n)}function Zi(n){return JSON.stringify(n)}const ov=function(n){let t={},e={},i={},s="";try{const r=n.split(".");t=Bm(Xk(r[0])||""),e=Bm(Xk(r[1])||""),s=r[2],i=e.d||{},delete e.d}catch{}return{header:t,claims:e,data:i,signature:s}};function yl(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function ef(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]}function F4(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function av(n,t,e){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=t.call(e,n[s],s,n));return i}function Yk(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const s of e){if(!i.includes(s))return!1;const r=n[s],o=t[s];if(L4(r)&&L4(o)){if(!Yk(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!e.includes(s))return!1;return!0}function L4(n){return null!==n&&"object"==typeof n}class lfe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const i=this.W_;if("string"==typeof t)for(let d=0;d<16;d++)i[d]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let d=0;d<16;d++)i[d]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let d=16;d<80;d++){const h=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=4294967295&(h<<1|h>>>31)}let c,u,s=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4];for(let d=0;d<80;d++){d<40?d<20?(c=a^r&(o^a),u=1518500249):(c=r^o^a,u=1859775393):d<60?(c=r&o|a&(r|o),u=2400959708):(c=r^o^a,u=3395469782);const h=(s<<5|s>>>27)+c+l+u+i[d]&4294967295;l=a,a=o,o=4294967295&(r<<30|r>>>2),r=s,s=h}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const i=e-this.blockSize;let s=0;const r=this.buf_;let o=this.inbuf_;for(;s<e;){if(0===o)for(;s<=i;)this.compress_(t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[o]=t.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(r),o=0;break}}else for(;s<e;)if(r[o]=t[s],++o,++s,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=255&e,e/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let r=24;r>=0;r-=8)t[i]=this.chain_[s]>>r&255,++i;return t}}function nf(n,t){return`${n} failed: ${t} argument `}const lv=function(n){let t=0;for(let e=0;e<n.length;e++){const i=n.charCodeAt(e);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,e++):t+=3}return t};function sf(n){return n&&n._delegate?n._delegate:n}class Vm{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Mu="[DEFAULT]";class bfe{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new Lm;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(s)return null;throw r}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function yfe(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Mu})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=Mu){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return Q(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...e.filter(i=>"_delete"in i).map(i=>i._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=Mu){return this.instances.has(t)}getOptions(t=Mu){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[r,o]of this.instancesDeferred.entries())i===this.normalizeInstanceIdentifier(r)&&o.resolve(s);return s}onInit(t,e){var i;const s=this.normalizeInstanceIdentifier(e),r=null!==(i=this.onInitCallbacks.get(s))&&void 0!==i?i:new Set;r.add(t),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&t(o,s),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===Mu?void 0:n),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}var n;return i||null}normalizeInstanceIdentifier(t=Mu){return this.component?this.component.multipleInstances?t:Mu:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class vfe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new bfe(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const Qk=[];var Cn=(()=>{return(n=Cn||(Cn={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",Cn;var n})();const $4={debug:Cn.DEBUG,verbose:Cn.VERBOSE,info:Cn.INFO,warn:Cn.WARN,error:Cn.ERROR,silent:Cn.SILENT},xfe=Cn.INFO,Cfe={[Cn.DEBUG]:"log",[Cn.VERBOSE]:"log",[Cn.INFO]:"info",[Cn.WARN]:"warn",[Cn.ERROR]:"error"},wfe=(n,t,...e)=>{if(t<n.logLevel)return;const i=(new Date).toISOString(),s=Cfe[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${i}]  ${n.name}:`,...e)};class B4{constructor(t){this.name=t,this._logLevel=xfe,this._logHandler=wfe,this._userLogHandler=null,Qk.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Cn))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?$4[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Cn.DEBUG,...t),this._logHandler(this,Cn.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Cn.VERBOSE,...t),this._logHandler(this,Cn.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Cn.INFO,...t),this._logHandler(this,Cn.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Cn.WARN,...t),this._logHandler(this,Cn.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Cn.ERROR,...t),this._logHandler(this,Cn.ERROR,...t)}}const Sfe=(n,t)=>t.some(e=>n instanceof e);let V4,z4;const U4=new WeakMap,Jk=new WeakMap,W4=new WeakMap,eT=new WeakMap,tT=new WeakMap;let nT={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return Jk.get(n);if("objectStoreNames"===t)return n.objectStoreNames||W4.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return cc(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function Afe(n){return"function"==typeof n?function Nfe(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Efe(){return z4||(z4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(iT(this),t),cc(U4.get(this))}:function(...t){return cc(n.apply(iT(this),t))}:function(t,...e){const i=n.call(iT(this),t,...e);return W4.set(i,t.sort?t.sort():[t]),cc(i)}}(n):(n instanceof IDBTransaction&&function Tfe(n){if(Jk.has(n))return;const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{e(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});Jk.set(n,t)}(n),Sfe(n,function Ife(){return V4||(V4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,nT):n)}function cc(n){if(n instanceof IDBRequest)return function kfe(n){const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{e(cc(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&U4.set(e,n)}).catch(()=>{}),tT.set(t,n),t}(n);if(eT.has(n))return eT.get(n);const t=Afe(n);return t!==n&&(eT.set(n,t),tT.set(t,n)),t}const iT=n=>tT.get(n),Pfe=["get","getKey","getAll","getAllKeys","count"],Rfe=["put","add","delete","clear"],sT=new Map;function H4(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(sT.get(t))return sT.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,s=Rfe.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!Pfe.includes(e))return;const r=function(){var o=Q(function*(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return i&&(u=u.index(l.shift())),(yield Promise.all([u[e](...l),s&&c.done]))[0]});return function(l){return o.apply(this,arguments)}}();return sT.set(t,r),r}!function Dfe(n){nT=n(nT)}(n=>({...n,get:(t,e,i)=>H4(t,e)||n.get(t,e,i),has:(t,e)=>!!H4(t,e)||n.has(t,e)}));class Ofe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Ffe(n){return"VERSION"===n.getComponent()?.type}(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}return null}).filter(e=>e).join(" ")}}const cv="@firebase/app",rT="0.10.13",vl=new B4("@firebase/app"),uv="[DEFAULT]",upe={[cv]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai-preview":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},Pu=new Map,zm=new Map,Um=new Map;function j4(n,t){try{n.container.addComponent(t)}catch(e){vl.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function dv(n){const t=n.name;if(Um.has(t))return vl.debug(`There were multiple attempts to register component ${t}.`),!1;Um.set(t,n);for(const e of Pu.values())j4(e,n);for(const e of zm.values())j4(e,n);return!0}const uo=new O4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class fpe{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Vm("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw uo.create("app-deleted",{appName:this._name})}}function rf(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:uv,automaticDataCollectionEnabled:!1},t),s=i.name;if("string"!=typeof s||!s)throw uo.create("bad-app-name",{appName:String(s)});if(e||(e=P4()),!e)throw uo.create("no-options");const r=Pu.get(s);if(r){if(Yk(e,r.options)&&Yk(i,r.config))return r;throw uo.create("duplicate-app",{appName:s})}const o=new vfe(s);for(const l of Um.values())o.addComponent(l);const a=new fpe(e,i,o);return Pu.set(s,a),a}function Ru(n,t,e){var i;let s=null!==(i=upe[n])&&void 0!==i?i:n;e&&(s+=`-${e}`);const r=s.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${t}":`];return r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void vl.warn(a.join(" "))}dv(new Vm(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const _pe="firebase-heartbeat-database",ype=1,Wm="firebase-heartbeat-store";let aT=null;function q4(){return aT||(aT=function Mfe(n,t,{blocked:e,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,t),a=cc(o);return i&&o.addEventListener("upgradeneeded",l=>{i(cc(o.result),l.oldVersion,l.newVersion,cc(o.transaction),l)}),e&&o.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}(_pe,ype,{upgrade:(n,t)=>{if(0===t)try{n.createObjectStore(Wm)}catch(e){console.warn(e)}}}).catch(n=>{throw uo.create("idb-open",{originalErrorMessage:n.message})})),aT}function lT(){return(lT=Q(function*(n){try{const e=(yield q4()).transaction(Wm),i=yield e.objectStore(Wm).get(X4(n));return yield e.done,i}catch(t){if(t instanceof $m)vl.warn(t.message);else{const e=uo.create("idb-get",{originalErrorMessage:t?.message});vl.warn(e.message)}}})).apply(this,arguments)}function K4(n,t){return cT.apply(this,arguments)}function cT(){return(cT=Q(function*(n,t){try{const i=(yield q4()).transaction(Wm,"readwrite");yield i.objectStore(Wm).put(t,X4(n)),yield i.done}catch(e){if(e instanceof $m)vl.warn(e.message);else{const i=uo.create("idb-set",{originalErrorMessage:e?.message});vl.warn(i.message)}}})).apply(this,arguments)}function X4(n){return`${n.name}!${n.options.appId}`}class wpe{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Ipe(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){var t=this;return Q(function*(){var e,i;try{const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Y4();return null==(null===(e=t._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(t._heartbeatsCache=yield t._heartbeatsCachePromise,null==(null===(i=t._heartbeatsCache)||void 0===i?void 0:i.heartbeats))||t._heartbeatsCache.lastSentHeartbeatDate===o||t._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(t._heartbeatsCache.heartbeats.push({date:o,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=2592e6}),t._storage.overwrite(t._heartbeatsCache))}catch(s){vl.warn(s)}})()}getHeartbeatsHeader(){var t=this;return Q(function*(){var e;try{if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null==(null===(e=t._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===t._heartbeatsCache.heartbeats.length)return"";const i=Y4(),{heartbeatsToSend:s,unsentEntries:r}=function Spe(n,t=1024){const e=[];let i=n.slice();for(const s of n){const r=e.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),Z4(e)>t){r.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Z4(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}(t._heartbeatsCache.heartbeats),o=iv(JSON.stringify({version:2,heartbeats:s}));return t._heartbeatsCache.lastSentHeartbeatDate=i,r.length>0?(t._heartbeatsCache.heartbeats=r,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),o}catch(i){return vl.warn(i),""}})()}}function Y4(){return(new Date).toISOString().substring(0,10)}class Ipe{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Q(function*(){return!!function efe(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function tfe(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var r;t((null===(r=s.error)||void 0===r?void 0:r.message)||"")}}catch(e){t(e)}})}().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return Q(function*(){if(yield t._canUseIndexedDBPromise){const i=yield function vpe(n){return lT.apply(this,arguments)}(t.app);return i?.heartbeats?i:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(t){var e=this;return Q(function*(){var i;if(yield e._canUseIndexedDBPromise){const r=yield e.read();return K4(e.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return Q(function*(){var i;if(yield e._canUseIndexedDBPromise){const r=yield e.read();return K4(e.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}})()}}function Z4(n){return iv(JSON.stringify({version:2,heartbeats:n})).length}!function Epe(n){dv(new Vm("platform-logger",t=>new Ofe(t),"PRIVATE")),dv(new Vm("heartbeat",t=>new wpe(t),"PRIVATE")),Ru(cv,rT,n),Ru(cv,rT,"esm2017"),Ru("fire-js","")}(""),Ru("firebase","10.14.1","app");const Q4="@firebase/database";let uT="";class Dpe{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Zi(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:Bm(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class Npe{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return yl(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const tU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const t=window[n];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Dpe(t)}}catch{}return new Npe},Ou=tU("localStorage"),dT=tU("sessionStorage"),af=new B4("@firebase/database"),nU=function(){let n=1;return function(){return n++}}(),iU=function(n){const t=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const r=s-55296;i++,we(i<n.length,"Surrogate pair missing trail surrogate."),s=65536+(r<<10)+(n.charCodeAt(i)-56320)}s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):s<65536?(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t}(n),e=new lfe;e.update(t);const i=e.digest();return Kk.encodeByteArray(i)},Hm=function(...n){let t="";for(let e=0;e<n.length;e++){const i=n[e];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=Hm.apply(null,i):t+="object"==typeof i?Zi(i):i,t+=" "}return t};let Fu=null,sU=!0;const ls=function(...n){if(!0===sU&&(sU=!1,null===Fu&&!0===dT.get("logging_enabled")&&function(n,t){we(!t||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(af.logLevel=Cn.VERBOSE,Fu=af.log.bind(af),t&&dT.set("logging_enabled",!0)):"function"==typeof n?Fu=n:(Fu=null,dT.remove("logging_enabled"))}(!0)),Fu){const t=Hm.apply(null,n);Fu(t)}},jm=function(n){return function(...t){ls(n,...t)}},hT=function(...n){const t="FIREBASE INTERNAL ERROR: "+Hm(...n);af.error(t)},Ia=function(...n){const t=`FIREBASE FATAL ERROR: ${Hm(...n)}`;throw af.error(t),new Error(t)},Ms=function(...n){const t="FIREBASE WARNING: "+Hm(...n);af.warn(t)},hv=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},uc="[MIN_NAME]",xl="[MAX_NAME]",Lu=function(n,t){if(n===t)return 0;if(n===uc||t===xl)return-1;if(t===uc||n===xl)return 1;{const e=lU(n),i=lU(t);return null!==e?null!==i?e-i==0?n.length-t.length:e-i:-1:null!==i?1:n<t?-1:1}},Ppe=function(n,t){return n===t?0:n<t?-1:1},Gm=function(n,t){if(t&&n in t)return t[n];throw new Error("Missing required key ("+n+") in object: "+Zi(t))},fT=function(n){if("object"!=typeof n||null===n)return Zi(n);const t=[];for(const i in n)t.push(i);t.sort();let e="{";for(let i=0;i<t.length;i++)0!==i&&(e+=","),e+=Zi(t[i]),e+=":",e+=fT(n[t[i]]);return e+="}",e},oU=function(n,t){const e=n.length;if(e<=t)return[n];const i=[];for(let s=0;s<e;s+=t)i.push(n.substring(s,s+t>e?e:s+t));return i};function cs(n,t){for(const e in n)n.hasOwnProperty(e)&&t(e,n[e])}const aU=function(n){we(!hv(n),"Invalid JSON number");const i=1023;let s,r,o,a,l;0===n?(r=0,o=0,s=1/n==-1/0?1:0):(s=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),r=a+i,o=Math.round(n*Math.pow(2,52-a)-Math.pow(2,52))):(r=0,o=Math.round(n/Math.pow(2,-1074))));const c=[];for(l=52;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=11;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);1===h.length&&(h="0"+h),d+=h}return d.toLowerCase()},Lpe=new RegExp("^-?(0*)\\d{1,10}$"),lU=function(n){if(Lpe.test(n)){const t=Number(n);if(t>=-2147483648&&t<=2147483647)return t}return null},lf=function(n){try{n()}catch(t){setTimeout(()=>{throw Ms("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},Vpe=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qm=function(n,t){const e=setTimeout(n,t);return"number"==typeof e&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):"object"==typeof e&&e.unref&&e.unref(),e};class zpe{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(i=>this.appCheck=i)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((e,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){Ms(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Upe{constructor(t,e,i){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&"auth/token-not-initialized"===e.code?(ls("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ms(t)}}let Km=(()=>{class n{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const fU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,gU="websocket",bU="long_polling";class mT{constructor(t,e,i,s,r=!1,o="",a=!1,l=!1){this.secure=e,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ou.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Ou.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function _U(n,t,e){let i;if(we("string"==typeof t,"typeof type must == string"),we("object"==typeof e,"typeof params must == object"),t===gU)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(t!==bU)throw new Error("Unknown connection type: "+t);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Wpe(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(e.ns=n.namespace);const s=[];return cs(e,(r,o)=>{s.push(r+"="+o)}),i+s.join("&")}class Hpe{constructor(){this.counters_={}}incrementCounter(t,e=1){yl(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return Uhe(this.counters_)}}const gT={},bT={};function _T(n){const t=n.toString();return gT[t]||(gT[t]=new Hpe),gT[t]}class Gpe{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&lf(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class dc{constructor(t,e,i,s,r,o,a){this.connId=t,this.repoInfo=e,this.applicationId=i,this.appCheckToken=s,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=jm(t),this.stats_=_T(e),this.urlFn=l=>(this.appCheckToken&&(l.ac=this.appCheckToken),_U(e,bU,l))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Gpe(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if(_l()||"complete"===document.readyState)n();else{let t=!1;const e=function(){document.body?t||(t=!0,n()):setTimeout(e,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&e()}),window.attachEvent("onload",e))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new yT((...r)=>{const[o,a,l,c,u]=r;if(this.incrementIncomingBytes_(r),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=l;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&fU.test(location.hostname)&&(i.r="f");const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){dc.forceAllow_=!0}static forceDisallow(){dc.forceDisallow_=!0}static isAvailable(){return!(_l()||!dc.forceAllow_&&(dc.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=Zi(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const i=A4(e),s=oU(i,1840);for(let r=0;r<s.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[r]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if(_l())return;this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=t,i.pw=e,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=Zi(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class yT{constructor(t,e,i,s){if(this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,_l())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=nU(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=yT.createIFrame_();let r="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ls("frame writing exception"),a.stack&&ls(a.stack),ls(a)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||ls("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const o=this.pendingSegs.shift();i=i+"&seg"+s+"="+o.seg+"&ts"+s+"="+o.ts+"&d"+s+"="+o.d,s++}return e+=i,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,i){this.pendingSegs.push({seg:t,ts:e,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const i=()=>{this.outstandingRequests.delete(e),this.newRequest_()},s=setTimeout(i,Math.floor(25e3));this.addTag(t,()=>{clearTimeout(s),i()})}addTag(t,e){_l()?this.doNodeLongPoll(t,e):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||"loaded"===s||"complete"===s)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=()=>{ls("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let pv=null;typeof MozWebSocket<"u"?pv=MozWebSocket:typeof WebSocket<"u"&&(pv=WebSocket);let cf=(()=>{class n{constructor(e,i,s,r,o,a,l){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=jm(this.connId),this.stats_=_T(i),this.connURL=n.connectionURL_(i,a,l,r,s),this.nodeAdmin=i.nodeAdmin}static connectionURL_(e,i,s,r,o){const a={v:"5"};return!_l()&&typeof location<"u"&&location.hostname&&fU.test(location.hostname)&&(a.r="f"),i&&(a.s=i),s&&(a.ls=s),r&&(a.ac=r),o&&(a.p=o),_U(e,gU,a)}open(e,i){this.onDisconnect=i,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ou.set("previous_websocket_failure",!0);try{let s;if(_l()){s={headers:{"User-Agent":`Firebase/5/${uT}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(s.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(s.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(s.proxy={origin:a})}this.mySock=new pv(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;return r&&this.log_(r),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const s=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&null!==pv&&!n.forceDisallow_}static previouslyFailed(){return Ou.isInMemoryStorage||!0===Ou.get("previous_websocket_failure")}markConnectionHealthy(){Ou.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const s=Bm(i);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(we(null===this.frames,"We already have a frame buffer"),e.length<=6){const i=Number(e);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const i=e.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const s=this.extractFrameCount_(i);null!==s&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const i=Zi(e);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const s=oU(i,16384);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),IU=(()=>{class n{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[dc,cf]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const i=cf&&cf.isAvailable();let s=i&&!cf.previouslyFailed();if(e.webSocketOnly&&(i||Ms("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[cf];else{const r=this.transports_=[];for(const o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&r.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class MU{constructor(t,e,i,s,r,o,a,l,c,u){this.id=t,this.repoInfo_=e,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=jm("c:"+this.id+":"),this.transportManager_=new IU(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,i)},Math.floor(0));const s=t.healthyTimeout||0;s>0&&(this.healthyTimeout_=qm(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){this.sendData_({t:"d",d:t})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=Gm("t",t),i=Gm("d",t);if("c"===e)this.onSecondaryControl_(i);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=Gm("t",t),i=Gm("d",t);"c"===e?this.onControl_(i):"d"===e&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=Gm("t",t);if("d"in t){const i=t.d;if("h"===e){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(i):"r"===e?this.onReset_(i):"e"===e?hT("Server Error: "+i):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):hT("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,i=t.v,s=t.h;this.sessionId=t.s,this.repoInfo_.host=s,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==i&&Ms("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,i),qm(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qm(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ou.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class PU{put(t,e,i,s){}merge(t,e,i,s){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,i){}onDisconnectMerge(t,e,i){}onDisconnectCancel(t,e){}reportStats(t){}}class RU{constructor(t){this.allowedEvents_=t,this.listeners_={},we(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,e)}}on(t,e,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:i});const s=this.getInitialEvent(t);s&&e.apply(i,s)}off(t,e,i){this.validateEventType_(t);const s=this.listeners_[t]||[];for(let r=0;r<s.length;r++)if(s[r].callback===e&&(!i||i===s[r].context))return void s.splice(r,1)}validateEventType_(t){we(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}class mv extends RU{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!R4()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new mv}getInitialEvent(t){return we("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}const OU=32,FU=768;class mn{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function en(){return new mn("")}function Mt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function hc(n){return n.pieces_.length-n.pieceNum_}function In(n){let t=n.pieceNum_;return t<n.pieces_.length&&t++,new mn(n.pieces_,t)}function xT(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Xm(n,t=0){return n.pieces_.slice(n.pieceNum_+t)}function LU(n){if(n.pieceNum_>=n.pieces_.length)return null;const t=[];for(let e=n.pieceNum_;e<n.pieces_.length-1;e++)t.push(n.pieces_[e]);return new mn(t,0)}function Jn(n,t){const e=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)e.push(n.pieces_[i]);if(t instanceof mn)for(let i=t.pieceNum_;i<t.pieces_.length;i++)e.push(t.pieces_[i]);else{const i=t.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&e.push(i[s])}return new mn(e,0)}function Pt(n){return n.pieceNum_>=n.pieces_.length}function er(n,t){const e=Mt(n),i=Mt(t);if(null===e)return t;if(e===i)return er(In(n),In(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+n+")")}function CT(n,t){if(hc(n)!==hc(t))return!1;for(let e=n.pieceNum_,i=t.pieceNum_;e<=n.pieces_.length;e++,i++)if(n.pieces_[e]!==t.pieces_[i])return!1;return!0}function ho(n,t){let e=n.pieceNum_,i=t.pieceNum_;if(hc(n)>hc(t))return!1;for(;e<n.pieces_.length;){if(n.pieces_[e]!==t.pieces_[i])return!1;++e,++i}return!0}class mme{constructor(t,e){this.errorPrefix_=e,this.parts_=Xm(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=lv(this.parts_[i]);$U(this)}}function $U(n){if(n.byteLength_>FU)throw new Error(n.errorPrefix_+"has a key path longer than "+FU+" bytes ("+n.byteLength_+").");if(n.parts_.length>OU)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+OU+") or object contains a cycle "+$u(n))}function $u(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class wT extends RU{constructor(){let t,e;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new wT}getInitialEvent(t){return we("visible"===t,"Unknown event type: "+t),[this.visible_]}}const Ym=1e3;let bv,Bu=(()=>{class n extends PU{constructor(e,i,s,r,o,a,l,c){if(super(),this.repoInfo_=e,this.applicationId_=i,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=n.nextPersistentConnectionId_++,this.log_=jm("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ym,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!_l())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");wT.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&mv.getInstance().on("online",this.onOnline_,this)}sendRequest(e,i,s){const r=++this.requestNumber_,o={r,a:e,b:i};this.log_(Zi(o)),we(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const i=new Lm,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const l=a.d;"ok"===a.s?i.resolve(l):i.reject(l)}};return this.outstandingGets_.push(r),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(e,i,s,r){this.initConnection_();const o=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),we(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),we(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const l={onComplete:r,hashFn:i,query:e,tag:s};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const i=this.outstandingGets_[e];this.sendRequest("g",i.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(s)})}sendListen_(e){const i=e.query,s=i._path.toString(),r=i._queryIdentifier;this.log_("Listen on "+s+" for "+r);const o={p:s};e.tag&&(o.q=i._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,l=>{const c=l.d,u=l.s;n.warnOnListenWarnings_(c,i),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",l),"ok"!==u&&this.removeListen_(s,r),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,i){if(e&&"object"==typeof e&&yl(e,"w")){const s=ef(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();Ms(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(n){const t=ov(n).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,i=function(n){const e=ov(n).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(e)?"auth":"gauth",s={cred:e};null===this.authOverride_?s.noauth=!0:"object"==typeof this.authOverride_&&(s.authvar=this.authOverride_),this.sendRequest(i,s,r=>{const o=r.s,a=r.d||"error";this.authToken_===e&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const i=e.s,s=e.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,s)})}unlisten(e,i){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),we(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,i)}sendUnlisten_(e,i,s,r){this.log_("Unlisten on "+e+" for "+i);const o={p:e};r&&(o.q=s,o.t=r),this.sendRequest("n",o)}onDisconnectPut(e,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,i,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:i,onComplete:s})}onDisconnectMerge(e,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,i,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:i,onComplete:s})}onDisconnectCancel(e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(e,i,s,r){const o={p:i,d:s};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,a=>{r&&setTimeout(()=>{r(a.s,a.d)},Math.floor(0))})}put(e,i,s,r){this.putInternal("p",e,i,s,r)}merge(e,i,s,r){this.putInternal("m",e,i,s,r)}putInternal(e,i,s,r,o){this.initConnection_();const a={p:i,d:s};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(e){const i=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(i,s,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(o.s,o.d)})}reportStats(e){if(this.connected_){const i={c:e};this.log_("reportStats",i),this.sendRequest("s",i,s=>{"ok"!==s.s&&this.log_("reportStats","Error sending stats: "+s.d)})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Zi(e));const i=e.r,s=this.requestCBHash_[i];s&&(delete this.requestCBHash_[i],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,i){this.log_("handleServerMessage",e,i),"d"===e?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===e?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===e?this.onListenRevoked_(i.p,i.q):"ac"===e?this.onAuthRevoked_(i.s,i.d):"apc"===e?this.onAppCheckRevoked_(i.s,i.d):"sd"===e?this.onSecurityDebugPacket_(i):hT("Unrecognized action received from server: "+Zi(e)+"\nAre you using the latest client?")}onReady_(e,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){we(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ym,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ym,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ym),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let i=Math.max(0,this.reconnectDelay_-e);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var e=this;return Q(function*(){if(e.shouldReconnect_()){e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null;const i=e.onDataMessage_.bind(e),s=e.onReady_.bind(e),r=e.onRealtimeDisconnect_.bind(e),o=e.id+":"+n.nextConnectionId_++,a=e.lastSessionId;let l=!1,c=null;const u=function(){c?c.close():(l=!0,r())};e.realtime_={close:u,sendRequest:function(f){we(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(f)}};const h=e.forceTokenRefresh_;e.forceTokenRefresh_=!1;try{const[f,p]=yield Promise.all([e.authTokenProvider_.getToken(h),e.appCheckTokenProvider_.getToken(h)]);l?ls("getToken() completed but was canceled"):(ls("getToken() completed. Creating connection."),e.authToken_=f&&f.accessToken,e.appCheckToken_=p&&p.token,c=new MU(o,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,i,s,r,g=>{Ms(g+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},a))}catch(f){e.log_("Failed to get token: "+f),l||(e.repoInfo_.nodeAdmin&&Ms(f),u())}}})()}interrupt(e){ls("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ls("Resuming connection for reason: "+e),delete this.interruptReasons_[e],F4(this.interruptReasons_)&&(this.reconnectDelay_=Ym,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const i=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const i=this.outstandingPuts_[e];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,i){let s;s=i?i.map(o=>fT(o)).join("$"):"default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,i){const s=new mn(e).toString();let r;if(this.listens.has(s)){const o=this.listens.get(s);r=o.get(i),o.delete(i),0===o.size&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,i){ls("Auth token revoked: "+e+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,i){ls("App check token revoked: "+e+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const i of e.values())this.sendListen_(i);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let i="js";_l()&&(i=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+i+"."+uT.replace(/\./g,"-")]=1,R4()?e["framework.cordova"]=1:function Jhe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=mv.getInstance().currentlyOnline();return F4(this.interruptReasons_)&&e}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class Ot{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new Ot(t,e)}}class gv{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const i=new Ot(uc,t),s=new Ot(uc,e);return 0!==this.compare(i,s)}minPost(){return Ot.MIN}}class zU extends gv{static get __EMPTY_NODE(){return bv}static set __EMPTY_NODE(t){bv=t}compare(t,e){return Lu(t.name,e.name)}isDefinedOn(t){throw Jh("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return Ot.MIN}maxPost(){return new Ot(xl,bv)}makePost(t,e){return we("string"==typeof t,"KeyIndex indexValue must always be a string."),new Ot(t,bv)}toString(){return".key"}}const Ea=new zU;class _v{constructor(t,e,i,s,r=null){this.isReverse_=s,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(o=e?i(t.key,e):1,s&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}let IT,Ho=(()=>{class n{constructor(e,i,s,r,o){this.key=e,this.value=i,this.color=s??n.RED,this.left=r??mr.EMPTY_NODE,this.right=o??mr.EMPTY_NODE}copy(e,i,s,r,o){return new n(e??this.key,i??this.value,s??this.color,r??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,s){let r=this;const o=s(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,i,s),null):0===o?r.copy(null,i,null,null,null):r.copy(null,null,null,null,r.right.insert(e,i,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return mr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,i){let s,r;if(s=this,i(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,i),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),0===i(e,s.key)){if(s.right.isEmpty())return mr.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,i))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class mr{constructor(t,e=mr.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new mr(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,Ho.BLACK,null,null))}remove(t){return new mr(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Ho.BLACK,null,null))}get(t){let e,i=this.root_;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),0===e)return i.value;e<0?i=i.left:e>0&&(i=i.right)}return null}getPredecessorKey(t){let e,i=this.root_,s=null;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),0===e){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}e<0?i=i.left:e>0&&(s=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new _v(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new _v(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new _v(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new _v(this.root_,null,this.comparator_,!0,t)}}function wme(n,t){return Lu(n.name,t.name)}function ST(n,t){return Lu(n,t)}mr.EMPTY_NODE=new class Cme{copy(t,e,i,s,r){return this}insert(t,e,i){return new Ho(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const UU=function(n){return"number"==typeof n?"number:"+aU(n):"string:"+n},WU=function(n){if(n.isLeafNode()){const t=n.val();we("string"==typeof t||"number"==typeof t||"object"==typeof t&&yl(t,".sv"),"Priority must be a string or number.")}else we(n===IT||n.isEmpty(),"priority of unexpected type.");we(n===IT||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let HU,jU,GU,uf=(()=>{class n{constructor(e,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=i,this.lazyHash_=null,we(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),WU(this.priorityNode_)}static set __childrenNodeConstructor(e){HU=e}static get __childrenNodeConstructor(){return HU}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new n(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Pt(e)?this:".priority"===Mt(e)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,i){return null}updateImmediateChild(e,i){return".priority"===e?this.updatePriority(i):i.isEmpty()&&".priority"!==e?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,i).updatePriority(this.priorityNode_)}updateChild(e,i){const s=Mt(e);return null===s?i:i.isEmpty()&&".priority"!==s?this:(we(".priority"!==s||1===hc(e),".priority must be the last token in a path"),this.updateImmediateChild(s,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(In(e),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,i){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+UU(this.priorityNode_.val())+":");const i=typeof this.value_;e+=i+":",e+="number"===i?aU(this.value_):this.value_,this.lazyHash_=iU(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===n.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof n.__childrenNodeConstructor?-1:(we(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const i=typeof e.value_,s=typeof this.value_,r=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(s);return we(r>=0,"Unknown leaf type: "+i),we(o>=0,"Unknown leaf type: "+s),r===o?"object"===s?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Rn=new class kme extends gv{compare(t,e){const i=t.node.getPriority(),s=e.node.getPriority(),r=i.compareTo(s);return 0===r?Lu(t.name,e.name):r}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return Ot.MIN}maxPost(){return new Ot(xl,new uf("[PRIORITY-POST]",GU))}makePost(t,e){const i=jU(t);return new Ot(e,new uf("[PRIORITY-POST]",i))}toString(){return".priority"}},Tme=Math.log(2);class Dme{constructor(t){this.count=parseInt(Math.log(t+1)/Tme,10),this.current_=this.count-1;const s=(r=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=t+1&s}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const yv=function(n,t,e,i){n.sort(t);const s=function(l,c){const u=c-l;let d,h;if(0===u)return null;if(1===u)return d=n[l],h=e?e(d):d,new Ho(h,d.node,Ho.BLACK,null,null);{const f=parseInt(u/2,10)+l,p=s(l,f),g=s(f+1,c);return d=n[f],h=e?e(d):d,new Ho(h,d.node,Ho.BLACK,p,g)}},a=function(l){let c=null,u=null,d=n.length;const h=function(p,g){const m=d-p,b=d;d-=p;const _=s(m+1,b),y=n[m],v=e?e(y):y;f(new Ho(v,y.node,g,null,_))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){const g=l.nextBitIsOne(),m=Math.pow(2,l.count-(p+1));g?h(m,Ho.BLACK):(h(m,Ho.BLACK),h(m,Ho.RED))}return u}(new Dme(n.length));return new mr(i||t,a)};let ET;const df={};class Cl{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return we(df&&Rn,"ChildrenNode.ts has not been loaded"),ET=ET||new Cl({".priority":df},{".priority":Rn}),ET}get(t){const e=ef(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof mr?e:null}hasIndex(t){return yl(this.indexSet_,t.toString())}addIndex(t,e){we(t!==Ea,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const r=e.getIterator(Ot.Wrap);let a,o=r.getNext();for(;o;)s=s||t.isDefinedOn(o.node),i.push(o),o=r.getNext();a=s?yv(i,t.getCompare()):df;const l=t.toString(),c=Object.assign({},this.indexSet_);c[l]=t;const u=Object.assign({},this.indexes_);return u[l]=a,new Cl(u,c)}addToIndexes(t,e){const i=av(this.indexes_,(s,r)=>{const o=ef(this.indexSet_,r);if(we(o,"Missing index implementation for "+r),s===df){if(o.isDefinedOn(t.node)){const a=[],l=e.getIterator(Ot.Wrap);let c=l.getNext();for(;c;)c.name!==t.name&&a.push(c),c=l.getNext();return a.push(t),yv(a,o.getCompare())}return df}{const a=e.get(t.name);let l=s;return a&&(l=l.remove(new Ot(t.name,a))),l.insert(t,t.node)}});return new Cl(i,this.indexSet_)}removeFromIndexes(t,e){const i=av(this.indexes_,s=>{if(s===df)return s;{const r=e.get(t.name);return r?s.remove(new Ot(t.name,r)):s}});return new Cl(i,this.indexSet_)}}let Zm,xt=(()=>{class n{constructor(e,i,s){this.children_=e,this.priorityNode_=i,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&WU(this.priorityNode_),this.children_.isEmpty()&&we(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Zm||(Zm=new n(new mr(ST),null,Cl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Zm}updatePriority(e){return this.children_.isEmpty()?this:new n(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const i=this.children_.get(e);return null===i?Zm:i}}getChild(e){const i=Mt(e);return null===i?this:this.getImmediateChild(i).getChild(In(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,i){if(we(i,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(i);{const s=new Ot(e,i);let r,o;i.isEmpty()?(r=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,i),o=this.indexMap_.addToIndexes(s,this.children_));const a=r.isEmpty()?Zm:this.priorityNode_;return new n(r,a,o)}}updateChild(e,i){const s=Mt(e);if(null===s)return i;{we(".priority"!==Mt(e)||1===hc(e),".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(In(e),i);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const i={};let s=0,r=0,o=!0;if(this.forEachChild(Rn,(a,l)=>{i[a]=l.val(e),s++,o&&n.INTEGER_REGEXP_.test(a)?r=Math.max(r,Number(a)):o=!1}),!e&&o&&r<2*s){const a=[];for(const l in i)a[l]=i[l];return a}return e&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+UU(this.getPriority().val())+":"),this.forEachChild(Rn,(i,s)=>{const r=s.hash();""!==r&&(e+=":"+i+":"+r)}),this.lazyHash_=""===e?"":iU(e)}return this.lazyHash_}getPredecessorChildName(e,i,s){const r=this.resolveIndex_(s);if(r){const o=r.getPredecessorKey(new Ot(e,i));return o?o.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const i=this.resolveIndex_(e);if(i){const s=i.minKey();return s&&s.name}return this.children_.minKey()}getFirstChild(e){const i=this.getFirstChildName(e);return i?new Ot(i,this.children_.get(i)):null}getLastChildName(e){const i=this.resolveIndex_(e);if(i){const s=i.maxKey();return s&&s.name}return this.children_.maxKey()}getLastChild(e){const i=this.getLastChildName(e);return i?new Ot(i,this.children_.get(i)):null}forEachChild(e,i){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>i(r.name,r.node)):this.children_.inorderTraversal(i)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,i){const s=this.resolveIndex_(i);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Ot.Wrap);let o=r.peek();for(;null!=o&&i.compare(o,e)<0;)r.getNext(),o=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,i){const s=this.resolveIndex_(i);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Ot.Wrap);let o=r.peek();for(;null!=o&&i.compare(o,e)>0;)r.getNext(),o=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Qm?-1:0}withIndex(e){if(e===Ea||this.indexMap_.hasIndex(e))return this;{const i=this.indexMap_.addIndex(e,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(e){return e===Ea||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const i=e;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const s=this.getIterator(Rn),r=i.getIterator(Rn);let o=s.getNext(),a=r.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=s.getNext(),a=r.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(e){return e===Ea?null:this.indexMap_.get(e.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Qm=new class Nme extends xt{constructor(){super(new mr(ST),xt.EMPTY_NODE,Cl.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return xt.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Ot,{MIN:{value:new Ot(uc,xt.EMPTY_NODE)},MAX:{value:new Ot(xl,Qm)}}),zU.__EMPTY_NODE=xt.EMPTY_NODE,uf.__childrenNodeConstructor=xt,function Sme(n){IT=n}(Qm),function Eme(n){GU=n}(Qm);const Ame=!0;function li(n,t=null){if(null===n)return xt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(t=n[".priority"]),we(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new uf(n,li(t));if(n instanceof Array||!Ame){let e=xt.EMPTY_NODE;return cs(n,(i,s)=>{if(yl(n,i)&&"."!==i.substring(0,1)){const r=li(s);(r.isLeafNode()||!r.isEmpty())&&(e=e.updateImmediateChild(i,r))}}),e.updatePriority(li(t))}{const e=[];let i=!1;if(cs(n,(o,a)=>{if("."!==o.substring(0,1)){const l=li(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),e.push(new Ot(o,l)))}}),0===e.length)return xt.EMPTY_NODE;const r=yv(e,wme,o=>o.name,ST);if(i){const o=yv(e,Rn.getCompare());return new xt(r,li(t),new Cl({".priority":o},{".priority":Rn}))}return new xt(r,li(t),Cl.Default)}}!function Ime(n){jU=n}(li);class kT extends gv{constructor(t){super(),this.indexPath_=t,we(!Pt(t)&&".priority"!==Mt(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const i=this.extractChild(t.node),s=this.extractChild(e.node),r=i.compareTo(s);return 0===r?Lu(t.name,e.name):r}makePost(t,e){const i=li(t),s=xt.EMPTY_NODE.updateChild(this.indexPath_,i);return new Ot(e,s)}maxPost(){const t=xt.EMPTY_NODE.updateChild(this.indexPath_,Qm);return new Ot(xl,t)}toString(){return Xm(this.indexPath_,0).join("/")}}const TT=new class Mme extends gv{compare(t,e){const i=t.node.compareTo(e.node);return 0===i?Lu(t.name,e.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return Ot.MIN}maxPost(){return Ot.MAX}makePost(t,e){const i=li(t);return new Ot(e,i)}toString(){return".value"}};function qU(n){return{type:"value",snapshotNode:n}}function hf(n,t){return{type:"child_added",snapshotNode:t,childName:n}}function Jm(n,t){return{type:"child_removed",snapshotNode:t,childName:n}}function eg(n,t,e){return{type:"child_changed",snapshotNode:t,childName:n,oldSnap:e}}class DT{constructor(t){this.index_=t}updateChild(t,e,i,s,r,o){we(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(e);return a.getChild(s).equals(i.getChild(s))&&a.isEmpty()===i.isEmpty()||(null!=o&&(i.isEmpty()?t.hasChild(e)?o.trackChildChange(Jm(e,a)):we(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(hf(e,i)):o.trackChildChange(eg(e,i,a))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(e,i).withIndex(this.index_)}updateFullNode(t,e,i){return null!=i&&(t.isLeafNode()||t.forEachChild(Rn,(s,r)=>{e.hasChild(s)||i.trackChildChange(Jm(s,r))}),e.isLeafNode()||e.forEachChild(Rn,(s,r)=>{if(t.hasChild(s)){const o=t.getImmediateChild(s);o.equals(r)||i.trackChildChange(eg(s,r,o))}else i.trackChildChange(hf(s,r))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?xt.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class tg{constructor(t){this.indexedFilter_=new DT(t.getIndex()),this.index_=t.getIndex(),this.startPost_=tg.getStartPost_(t),this.endPost_=tg.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,i=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&i}updateChild(t,e,i,s,r,o){return this.matches(new Ot(e,i))||(i=xt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,i,s,r,o)}updateFullNode(t,e,i){e.isLeafNode()&&(e=xt.EMPTY_NODE);let s=e.withIndex(this.index_);s=s.updatePriority(xt.EMPTY_NODE);const r=this;return e.forEachChild(Rn,(o,a)=>{r.matches(new Ot(o,a))||(s=s.updateImmediateChild(o,xt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,s,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class Rme{constructor(t){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=e=>{const i=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new tg(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,i,s,r,o){return this.rangedFilter_.matches(new Ot(e,i))||(i=xt.EMPTY_NODE),t.getImmediateChild(e).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,i,s,r,o):this.fullLimitUpdateChild_(t,e,i,r,o)}updateFullNode(t,e,i){let s;if(e.isLeafNode()||e.isEmpty())s=xt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let r;s=xt.EMPTY_NODE.withIndex(this.index_),r=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;s=s.updateImmediateChild(a.name,a.node),o++}}}else{let r;s=e.withIndex(this.index_),s=s.updatePriority(xt.EMPTY_NODE),r=this.reverse_?s.getReverseIterator(this.index_):s.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:s=s.updateImmediateChild(a.name,xt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,s,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,i,s,r){let o;if(this.reverse_){const d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();const a=t;we(a.numChildren()===this.limit_,"");const l=new Ot(e,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(e)){const d=a.getImmediateChild(e);let h=s.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=h&&(h.name===e||a.hasChild(h.name));)h=s.getChildAfterChild(this.index_,h,this.reverse_);const f=null==h?1:o(h,l);if(u&&!i.isEmpty()&&f>=0)return r?.trackChildChange(eg(e,i,d)),a.updateImmediateChild(e,i);{r?.trackChildChange(Jm(e,d));const g=a.updateImmediateChild(e,xt.EMPTY_NODE);return null!=h&&this.rangedFilter_.matches(h)?(r?.trackChildChange(hf(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}return i.isEmpty()?t:u&&o(c,l)>=0?(null!=r&&(r.trackChildChange(Jm(c.name,c.node)),r.trackChildChange(hf(e,i))),a.updateImmediateChild(e,i).updateImmediateChild(c.name,xt.EMPTY_NODE)):t}}class NT{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Rn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return we(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return we(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:uc}hasEnd(){return this.endSet_}getIndexEndValue(){return we(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return we(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return we(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Rn}copy(){const t=new NT;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function KU(n){const t={};if(n.isDefault())return t;let e;if(n.index_===Rn?e="$priority":n.index_===TT?e="$value":n.index_===Ea?e="$key":(we(n.index_ instanceof kT,"Unrecognized index type!"),e=n.index_.toString()),t.orderBy=Zi(e),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";t[i]=Zi(n.indexStartValue_),n.startNameSet_&&(t[i]+=","+Zi(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";t[i]=Zi(n.indexEndValue_),n.endNameSet_&&(t[i]+=","+Zi(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?t.limitToFirst=n.limit_:t.limitToLast=n.limit_),t}function XU(n){const t={};if(n.startSet_&&(t.sp=n.indexStartValue_,n.startNameSet_&&(t.sn=n.indexStartName_),t.sin=!n.startAfterSet_),n.endSet_&&(t.ep=n.indexEndValue_,n.endNameSet_&&(t.en=n.indexEndName_),t.ein=!n.endBeforeSet_),n.limitSet_){t.l=n.limit_;let e=n.viewFrom_;""===e&&(e=n.isViewFromLeft()?"l":"r"),t.vf=e}return n.index_!==Rn&&(t.i=n.index_.toString()),t}class xv extends PU{constructor(t,e,i,s){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=jm("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:(we(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,i,s){const r=t._path.toString();this.log_("Listen called for "+r+" "+t._queryIdentifier);const o=xv.getListenId_(t,i),a={};this.listens_[o]=a;const l=KU(t._queryParams);this.restRequest_(r+".json",l,(c,u)=>{let d=u;if(404===c&&(d=null,c=null),null===c&&this.onDataUpdate_(r,d,!1,i),ef(this.listens_,o)===a){let h;h=c?401===c?"permission_denied":"rest_error:"+c:"ok",s(h,null)}})}unlisten(t,e){const i=xv.getListenId_(t,e);delete this.listens_[i]}get(t){const e=KU(t._queryParams),i=t._path.toString(),s=new Lm;return this.restRequest_(i+".json",e,(r,o)=>{let a=o;404===r&&(a=null,r=null),null===r?(this.onDataUpdate_(i,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(t){}restRequest_(t,e={},i){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,r])=>{s&&s.accessToken&&(e.auth=s.accessToken),r&&r.token&&(e.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+function afe(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}(e);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Bm(a.responseText)}catch{Ms("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else 401!==a.status&&404!==a.status&&Ms("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}class Vme{constructor(){this.rootNode_=xt.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function Cv(){return{value:null,children:new Map}}function ff(n,t,e){if(Pt(t))n.value=e,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(t,e);else{const i=Mt(t);n.children.has(i)||n.children.set(i,Cv()),ff(n.children.get(i),t=In(t),e)}}function RT(n,t,e){null!==n.value?e(t,n.value):function zme(n,t){n.children.forEach((e,i)=>{t(i,e)})}(n,(i,s)=>{RT(s,new mn(t.toString()+"/"+i),e)})}class Ume{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&cs(this.last_,(i,s)=>{e[i]=e[i]-s}),this.last_=t,e}}class jme{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ume(t);const i=1e4+2e4*Math.random();qm(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),e={};let i=!1;cs(t,(s,r)=>{r>0&&yl(this.statsToReport_,s)&&(e[s]=r,i=!0)}),i&&this.server_.reportStats(e),qm(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var fo=(()=>{return(n=fo||(fo={}))[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",fo;var n})();function LT(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class wv{constructor(t,e,i){this.path=t,this.affectedTree=e,this.revert=i,this.type=fo.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(Pt(this.path)){if(null!=this.affectedTree.value)return we(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new mn(t));return new wv(en(),e,this.revert)}}return we(Mt(this.path)===t,"operationForChild called for unrelated child."),new wv(In(this.path),this.affectedTree,this.revert)}}class ng{constructor(t,e){this.source=t,this.path=e,this.type=fo.LISTEN_COMPLETE}operationForChild(t){return Pt(this.path)?new ng(this.source,en()):new ng(this.source,In(this.path))}}class Vu{constructor(t,e,i){this.source=t,this.path=e,this.snap=i,this.type=fo.OVERWRITE}operationForChild(t){return Pt(this.path)?new Vu(this.source,en(),this.snap.getImmediateChild(t)):new Vu(this.source,In(this.path),this.snap)}}class pf{constructor(t,e,i){this.source=t,this.path=e,this.children=i,this.type=fo.MERGE}operationForChild(t){if(Pt(this.path)){const e=this.children.subtree(new mn(t));return e.isEmpty()?null:e.value?new Vu(this.source,en(),e.value):new pf(this.source,en(),e)}return we(Mt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new pf(this.source,In(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class fc{constructor(t,e,i){this.node_=t,this.fullyInitialized_=e,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Pt(t))return this.isFullyInitialized()&&!this.filtered_;const e=Mt(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class Gme{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function ig(n,t,e,i,s,r){const o=i.filter(a=>a.type===e);o.sort((a,l)=>function Xme(n,t,e){if(null==t.childName||null==e.childName)throw Jh("Should only compare child_ events.");const i=new Ot(t.childName,t.snapshotNode),s=new Ot(e.childName,e.snapshotNode);return n.index_.compare(i,s)}(n,a,l)),o.forEach(a=>{const l=function Kme(n,t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,n.index_)),t}(n,a,r);s.forEach(c=>{c.respondsTo(a.type)&&t.push(c.createEvent(l,n.query_))})})}function Sv(n,t){return{eventCache:n,serverCache:t}}function sg(n,t,e,i){return Sv(new fc(t,e,i),n.serverCache)}function ZU(n,t,e,i){return Sv(n.eventCache,new fc(t,e,i))}function Iv(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function zu(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let $T;class On{constructor(t,e=(()=>($T||($T=new mr(Ppe)),$T))()){this.value=t,this.children=e}static fromObject(t){let e=new On(null);return cs(t,(i,s)=>{e=e.set(new mn(i),s)}),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:en(),value:this.value};if(Pt(t))return null;{const i=Mt(t),s=this.children.get(i);if(null!==s){const r=s.findRootMostMatchingPathAndValue(In(t),e);return null!=r?{path:Jn(new mn(i),r.path),value:r.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Pt(t))return this;{const e=Mt(t),i=this.children.get(e);return null!==i?i.subtree(In(t)):new On(null)}}set(t,e){if(Pt(t))return new On(e,this.children);{const i=Mt(t),r=(this.children.get(i)||new On(null)).set(In(t),e),o=this.children.insert(i,r);return new On(this.value,o)}}remove(t){if(Pt(t))return this.children.isEmpty()?new On(null):new On(null,this.children);{const e=Mt(t),i=this.children.get(e);if(i){const s=i.remove(In(t));let r;return r=s.isEmpty()?this.children.remove(e):this.children.insert(e,s),null===this.value&&r.isEmpty()?new On(null):new On(this.value,r)}return this}}get(t){if(Pt(t))return this.value;{const e=Mt(t),i=this.children.get(e);return i?i.get(In(t)):null}}setTree(t,e){if(Pt(t))return e;{const i=Mt(t),r=(this.children.get(i)||new On(null)).setTree(In(t),e);let o;return o=r.isEmpty()?this.children.remove(i):this.children.insert(i,r),new On(this.value,o)}}fold(t){return this.fold_(en(),t)}fold_(t,e){const i={};return this.children.inorderTraversal((s,r)=>{i[s]=r.fold_(Jn(t,s),e)}),e(t,this.value,i)}findOnPath(t,e){return this.findOnPath_(t,en(),e)}findOnPath_(t,e,i){const s=!!this.value&&i(e,this.value);if(s)return s;if(Pt(t))return null;{const r=Mt(t),o=this.children.get(r);return o?o.findOnPath_(In(t),Jn(e,r),i):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,en(),e)}foreachOnPath_(t,e,i){if(Pt(t))return this;{this.value&&i(e,this.value);const s=Mt(t),r=this.children.get(s);return r?r.foreachOnPath_(In(t),Jn(e,s),i):new On(null)}}foreach(t){this.foreach_(en(),t)}foreach_(t,e){this.children.inorderTraversal((i,s)=>{s.foreach_(Jn(t,i),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,i)=>{i.value&&t(e,i.value)})}}class jo{constructor(t){this.writeTree_=t}static empty(){return new jo(new On(null))}}function rg(n,t,e){if(Pt(t))return new jo(new On(e));{const i=n.writeTree_.findRootMostValueAndPath(t);if(null!=i){const s=i.path;let r=i.value;const o=er(s,t);return r=r.updateChild(o,e),new jo(n.writeTree_.set(s,r))}{const s=new On(e),r=n.writeTree_.setTree(t,s);return new jo(r)}}}function BT(n,t,e){let i=n;return cs(e,(s,r)=>{i=rg(i,Jn(t,s),r)}),i}function QU(n,t){if(Pt(t))return jo.empty();{const e=n.writeTree_.setTree(t,new On(null));return new jo(e)}}function VT(n,t){return null!=Uu(n,t)}function Uu(n,t){const e=n.writeTree_.findRootMostValueAndPath(t);return null!=e?n.writeTree_.get(e.path).getChild(er(e.path,t)):null}function JU(n){const t=[],e=n.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(Rn,(i,s)=>{t.push(new Ot(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{null!=s.value&&t.push(new Ot(i,s.value))}),t}function pc(n,t){if(Pt(t))return n;{const e=Uu(n,t);return new jo(null!=e?new On(e):n.writeTree_.subtree(t))}}function zT(n){return n.writeTree_.isEmpty()}function mf(n,t){return e5(en(),n.writeTree_,t)}function e5(n,t,e){if(null!=t.value)return e.updateChild(n,t.value);{let i=null;return t.children.inorderTraversal((s,r)=>{".priority"===s?(we(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):e=e5(Jn(n,s),r,e)}),!e.getChild(n).isEmpty()&&null!==i&&(e=e.updateChild(Jn(n,".priority"),i)),e}}function Ev(n,t){return r5(t,n)}function tge(n,t){if(n.snap)return ho(n.path,t);for(const e in n.children)if(n.children.hasOwnProperty(e)&&ho(Jn(n.path,e),t))return!0;return!1}function ige(n){return n.visible}function t5(n,t,e){let i=jo.empty();for(let s=0;s<n.length;++s){const r=n[s];if(t(r)){const o=r.path;let a;if(r.snap)ho(e,o)?(a=er(e,o),i=rg(i,a,r.snap)):ho(o,e)&&(a=er(o,e),i=rg(i,en(),r.snap.getChild(a)));else{if(!r.children)throw Jh("WriteRecord should have .snap or .children");if(ho(e,o))a=er(e,o),i=BT(i,a,r.children);else if(ho(o,e))if(a=er(o,e),Pt(a))i=BT(i,en(),r.children);else{const l=ef(r.children,Mt(a));if(l){const c=l.getChild(In(a));i=rg(i,en(),c)}}}}}return i}function n5(n,t,e,i,s){if(i||s){const r=pc(n.visibleWrites,t);return!s&&zT(r)?e:s||null!=e||VT(r,en())?mf(t5(n.allWrites,function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(ho(c.path,t)||ho(t,c.path))},t),e||xt.EMPTY_NODE):null}{const r=Uu(n.visibleWrites,t);if(null!=r)return r;{const o=pc(n.visibleWrites,t);return zT(o)?e:null!=e||VT(o,en())?mf(o,e||xt.EMPTY_NODE):null}}}function kv(n,t,e,i){return n5(n.writeTree,n.treePath,t,e,i)}function UT(n,t){return function sge(n,t,e){let i=xt.EMPTY_NODE;const s=Uu(n.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild(Rn,(r,o)=>{i=i.updateImmediateChild(r,o)}),i;if(e){const r=pc(n.visibleWrites,t);return e.forEachChild(Rn,(o,a)=>{const l=mf(pc(r,new mn(o)),a);i=i.updateImmediateChild(o,l)}),JU(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}return JU(pc(n.visibleWrites,t)).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}(n.writeTree,n.treePath,t)}function i5(n,t,e,i){return function rge(n,t,e,i,s){we(i||s,"Either existingEventSnap or existingServerSnap must exist");const r=Jn(t,e);if(VT(n.visibleWrites,r))return null;{const o=pc(n.visibleWrites,r);return zT(o)?s.getChild(e):mf(o,s.getChild(e))}}(n.writeTree,n.treePath,t,e,i)}function Tv(n,t){return function age(n,t){return Uu(n.visibleWrites,t)}(n.writeTree,Jn(n.treePath,t))}function WT(n,t,e){return function oge(n,t,e,i){const s=Jn(t,e),r=Uu(n.visibleWrites,s);return null!=r?r:i.isCompleteForChild(e)?mf(pc(n.visibleWrites,s),i.getNode().getImmediateChild(e)):null}(n.writeTree,n.treePath,t,e)}function s5(n,t){return r5(Jn(n.treePath,t),n.writeTree)}function r5(n,t){return{treePath:n,writeTree:t}}class dge{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,i=t.childName;we("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),we(".priority"!==i,"Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const r=s.type;if("child_added"===e&&"child_removed"===r)this.changeMap.set(i,eg(i,t.snapshotNode,s.snapshotNode));else if("child_removed"===e&&"child_added"===r)this.changeMap.delete(i);else if("child_removed"===e&&"child_changed"===r)this.changeMap.set(i,Jm(i,s.oldSnap));else if("child_changed"===e&&"child_added"===r)this.changeMap.set(i,hf(i,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==r)throw Jh("Illegal combination of changes: "+t+" occurred after "+s);this.changeMap.set(i,eg(i,t.snapshotNode,s.oldSnap))}}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}const o5=new class hge{getCompleteChild(t){return null}getChildAfterChild(t,e,i){return null}};class HT{constructor(t,e,i=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=i}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const i=null!=this.optCompleteServerCache_?new fc(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return WT(this.writes_,t,i)}}getChildAfterChild(t,e,i){const s=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:zu(this.viewCache_),r=function uge(n,t,e,i,s,r){return function lge(n,t,e,i,s,r,o){let a;const l=pc(n.visibleWrites,t),c=Uu(l,en());if(null!=c)a=c;else{if(null==e)return[];a=mf(l,e)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const u=[],d=o.getCompare(),h=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let f=h.getNext();for(;f&&u.length<s;)0!==d(f,i)&&u.push(f),f=h.getNext();return u}}(n.writeTree,n.treePath,t,e,i,s,r)}(this.writes_,s,e,1,i,t);return 0===r.length?null:r[0]}}function a5(n,t,e,i,s,r){const o=t.eventCache;if(null!=Tv(i,e))return t;{let a,l;if(Pt(e))if(we(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const c=zu(t),d=UT(i,c instanceof xt?c:xt.EMPTY_NODE);a=n.filter.updateFullNode(t.eventCache.getNode(),d,r)}else{const c=kv(i,zu(t));a=n.filter.updateFullNode(t.eventCache.getNode(),c,r)}else{const c=Mt(e);if(".priority"===c){we(1===hc(e),"Can't have a priority with additional path components");const u=o.getNode();l=t.serverCache.getNode();const d=i5(i,e,u,l);a=null!=d?n.filter.updatePriority(u,d):o.getNode()}else{const u=In(e);let d;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const h=i5(i,e,o.getNode(),l);d=null!=h?o.getNode().getImmediateChild(c).updateChild(u,h):o.getNode().getImmediateChild(c)}else d=WT(i,c,t.serverCache);a=null!=d?n.filter.updateChild(o.getNode(),c,d,u,s,r):o.getNode()}}return sg(t,a,o.isFullyInitialized()||Pt(e),n.filter.filtersNodes())}}function Dv(n,t,e,i,s,r,o,a){const l=t.serverCache;let c;const u=o?n.filter:n.filter.getIndexedFilter();if(Pt(e))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const f=l.getNode().updateChild(e,i);c=u.updateFullNode(l.getNode(),f,null)}else{const f=Mt(e);if(!l.isCompleteForPath(e)&&hc(e)>1)return t;const p=In(e),m=l.getNode().getImmediateChild(f).updateChild(p,i);c=".priority"===f?u.updatePriority(l.getNode(),m):u.updateChild(l.getNode(),f,m,p,o5,null)}const d=ZU(t,c,l.isFullyInitialized()||Pt(e),u.filtersNodes());return a5(n,d,e,s,new HT(s,d,r),a)}function jT(n,t,e,i,s,r,o){const a=t.eventCache;let l,c;const u=new HT(s,t,r);if(Pt(e))c=n.filter.updateFullNode(t.eventCache.getNode(),i,o),l=sg(t,c,!0,n.filter.filtersNodes());else{const d=Mt(e);if(".priority"===d)c=n.filter.updatePriority(t.eventCache.getNode(),i),l=sg(t,c,a.isFullyInitialized(),a.isFiltered());else{const h=In(e),f=a.getNode().getImmediateChild(d);let p;if(Pt(h))p=i;else{const g=u.getCompleteChild(d);p=null!=g?".priority"===xT(h)&&g.getChild(LU(h)).isEmpty()?g:g.updateChild(h,i):xt.EMPTY_NODE}l=f.equals(p)?t:sg(t,n.filter.updateChild(a.getNode(),d,p,h,u,o),a.isFullyInitialized(),n.filter.filtersNodes())}}return l}function l5(n,t){return n.eventCache.isCompleteForChild(t)}function c5(n,t,e){return e.foreach((i,s)=>{t=t.updateChild(i,s)}),t}function GT(n,t,e,i,s,r,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=Pt(e)?i:new On(null).setTree(e,i);const u=t.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){const p=c5(0,t.serverCache.getNode().getImmediateChild(d),h);l=Dv(n,l,new mn(d),p,s,r,o,a)}}),c.children.inorderTraversal((d,h)=>{const f=!t.serverCache.isCompleteForChild(d)&&null===h.value;if(!u.hasChild(d)&&!f){const g=c5(0,t.serverCache.getNode().getImmediateChild(d),h);l=Dv(n,l,new mn(d),g,s,r,o,a)}}),l}class xge{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new DT(i.getIndex()),r=function Ome(n){return n.loadsAllData()?new DT(n.getIndex()):n.hasLimit()?new Rme(n):new tg(n)}(i);this.processor_=function fge(n){return{filter:n}}(r);const o=e.serverCache,a=e.eventCache,l=s.updateFullNode(xt.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(xt.EMPTY_NODE,a.getNode(),null),u=new fc(l,o.isFullyInitialized(),s.filtersNodes()),d=new fc(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=Sv(d,u),this.eventGenerator_=new Gme(this.query_)}get query(){return this.query_}}function Sge(n,t){const e=zu(n.viewCache_);return e&&(n.query._queryParams.loadsAllData()||!Pt(t)&&!e.getImmediateChild(Mt(t)).isEmpty())?e.getChild(t):null}function u5(n){return 0===n.eventRegistrations_.length}function d5(n,t,e){const i=[];if(e){we(null==t,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(e,s);o&&i.push(o)})}if(t){let s=[];for(let r=0;r<n.eventRegistrations_.length;++r){const o=n.eventRegistrations_[r];if(o.matches(t)){if(t.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(r+1));break}}else s.push(o)}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function h5(n,t,e,i){t.type===fo.MERGE&&null!==t.source.queryId&&(we(zu(n.viewCache_),"We should always have a full cache before handling merges"),we(Iv(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,r=function mge(n,t,e,i,s){const r=new dge;let o,a;if(e.type===fo.OVERWRITE){const c=e;c.source.fromUser?o=jT(n,t,c.path,c.snap,i,s,r):(we(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!Pt(c.path),o=Dv(n,t,c.path,c.snap,i,s,a,r))}else if(e.type===fo.MERGE){const c=e;c.source.fromUser?o=function bge(n,t,e,i,s,r,o){let a=t;return i.foreach((l,c)=>{const u=Jn(e,l);l5(t,Mt(u))&&(a=jT(n,a,u,c,s,r,o))}),i.foreach((l,c)=>{const u=Jn(e,l);l5(t,Mt(u))||(a=jT(n,a,u,c,s,r,o))}),a}(n,t,c.path,c.children,i,s,r):(we(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=GT(n,t,c.path,c.children,i,s,a,r))}else if(e.type===fo.ACK_USER_WRITE){const c=e;o=c.revert?function vge(n,t,e,i,s,r){let o;if(null!=Tv(i,e))return t;{const a=new HT(i,t,s),l=t.eventCache.getNode();let c;if(Pt(e)||".priority"===Mt(e)){let u;if(t.serverCache.isFullyInitialized())u=kv(i,zu(t));else{const d=t.serverCache.getNode();we(d instanceof xt,"serverChildren would be complete if leaf node"),u=UT(i,d)}c=n.filter.updateFullNode(l,u,r)}else{const u=Mt(e);let d=WT(i,u,t.serverCache);null==d&&t.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),c=null!=d?n.filter.updateChild(l,u,d,In(e),a,r):t.eventCache.getNode().hasChild(u)?n.filter.updateChild(l,u,xt.EMPTY_NODE,In(e),a,r):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=kv(i,zu(t)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,r)))}return o=t.serverCache.isFullyInitialized()||null!=Tv(i,en()),sg(t,c,o,n.filter.filtersNodes())}}(n,t,c.path,i,s,r):function _ge(n,t,e,i,s,r,o){if(null!=Tv(s,e))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=i.value){if(Pt(e)&&l.isFullyInitialized()||l.isCompleteForPath(e))return Dv(n,t,e,l.getNode().getChild(e),s,r,a,o);if(Pt(e)){let c=new On(null);return l.getNode().forEachChild(Ea,(u,d)=>{c=c.set(new mn(u),d)}),GT(n,t,e,c,s,r,a,o)}return t}{let c=new On(null);return i.foreach((u,d)=>{const h=Jn(e,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),GT(n,t,e,c,s,r,a,o)}}(n,t,c.path,c.affectedTree,i,s,r)}else{if(e.type!==fo.LISTEN_COMPLETE)throw Jh("Unknown operation type: "+e.type);o=function yge(n,t,e,i,s){const r=t.serverCache;return a5(n,ZU(t,r.getNode(),r.isFullyInitialized()||Pt(e),r.isFiltered()),e,i,o5,s)}(n,t,e.path,i,r)}const l=r.getChanges();return function gge(n,t,e){const i=t.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=Iv(n);(e.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&e.push(qU(Iv(t)))}}(t,o,l),{viewCache:o,changes:l}}(n.processor_,s,t,e,i);return function pge(n,t){we(t.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),we(t.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,r.viewCache),we(r.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=r.viewCache,f5(n,r.changes,r.viewCache.eventCache.getNode(),null)}function f5(n,t,e,i){return function qme(n,t,e,i){const s=[],r=[];return t.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(function Pme(n,t){return{type:"child_moved",snapshotNode:t,childName:n}}(o.childName,o.snapshotNode))}),ig(n,s,"child_removed",t,i,e),ig(n,s,"child_added",t,i,e),ig(n,s,"child_moved",r,i,e),ig(n,s,"child_changed",t,i,e),ig(n,s,"value",t,i,e),s}(n.eventGenerator_,t,e,i?[i]:n.eventRegistrations_)}let Nv,Mv;class p5{constructor(){this.views=new Map}}function qT(n,t,e,i){const s=t.source.queryId;if(null!==s){const r=n.views.get(s);return we(null!=r,"SyncTree gave us an op for an invalid query."),h5(r,t,e,i)}{let r=[];for(const o of n.views.values())r=r.concat(h5(o,t,e,i));return r}}function m5(n,t,e,i,s){const o=n.views.get(t._queryIdentifier);if(!o){let a=kv(e,s?i:null),l=!1;a?l=!0:i instanceof xt?(a=UT(e,i),l=!1):(a=xt.EMPTY_NODE,l=!1);const c=Sv(new fc(a,l,!1),new fc(i,s,!1));return new xge(t,c)}return o}function g5(n){const t=[];for(const e of n.views.values())e.query._queryParams.loadsAllData()||t.push(e);return t}function mc(n,t){let e=null;for(const i of n.views.values())e=e||Sge(i,t);return e}function b5(n,t){return t._queryParams.loadsAllData()?Av(n):n.views.get(t._queryIdentifier)}function _5(n,t){return null!=b5(n,t)}function gc(n){return null!=Av(n)}function Av(n){for(const t of n.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Rge=1;class y5{constructor(t){this.listenProvider_=t,this.syncPointTree_=new On(null),this.pendingWriteTree_=function cge(){return{visibleWrites:jo.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function KT(n,t,e,i,s){return function Zme(n,t,e,i,s){we(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===s&&(s=!0),n.allWrites.push({path:t,snap:e,writeId:i,visible:s}),s&&(n.visibleWrites=rg(n.visibleWrites,t,e)),n.lastWriteId=i}(n.pendingWriteTree_,t,e,i,s),s?gf(n,new Vu({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,e)):[]}function bc(n,t,e=!1){const i=function Jme(n,t){for(let e=0;e<n.allWrites.length;e++){const i=n.allWrites[e];if(i.writeId===t)return i}return null}(n.pendingWriteTree_,t);if(function ege(n,t){const e=n.allWrites.findIndex(a=>a.writeId===t);we(e>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[e];n.allWrites.splice(e,1);let s=i.visible,r=!1,o=n.allWrites.length-1;for(;s&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=e&&tge(a,i.path)?s=!1:ho(i.path,a.path)&&(r=!0)),o--}return!!s&&(r?(function nge(n){n.visibleWrites=t5(n.allWrites,ige,en()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=QU(n.visibleWrites,i.path):cs(i.children,l=>{n.visibleWrites=QU(n.visibleWrites,Jn(i.path,l))}),!0))}(n.pendingWriteTree_,t)){let r=new On(null);return null!=i.snap?r=r.set(en(),!0):cs(i.children,o=>{r=r.set(new mn(o),!0)}),gf(n,new wv(i.path,r,e))}return[]}function og(n,t,e){return gf(n,new Vu({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,e))}function Pv(n,t,e,i,s=!1){const r=t._path,o=n.syncPointTree_.get(r);let a=[];if(o&&("default"===t._queryIdentifier||_5(o,t))){const l=function Age(n,t,e,i){const s=t._queryIdentifier,r=[];let o=[];const a=gc(n);if("default"===s)for(const[l,c]of n.views.entries())o=o.concat(d5(c,e,i)),u5(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=n.views.get(s);l&&(o=o.concat(d5(l,e,i)),u5(l)&&(n.views.delete(s),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!gc(n)&&r.push(new(function Tge(){return we(Nv,"Reference.ts has not been loaded"),Nv}())(t._repo,t._path)),{removed:r,events:o}}(o,t,e,i);(function Dge(n){return 0===n.views.size})(o)&&(n.syncPointTree_=n.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!s){const u=-1!==c.findIndex(h=>h._queryParams.loadsAllData()),d=n.syncPointTree_.findOnPath(r,(h,f)=>gc(f));if(u&&!d){const h=n.syncPointTree_.subtree(r);if(!h.isEmpty()){const f=function zge(n){return n.fold((t,e,i)=>{if(e&&gc(e))return[Av(e)];{let s=[];return e&&(s=g5(e)),cs(i,(r,o)=>{s=s.concat(o)}),s}})}(h);for(let p=0;p<f.length;++p){const g=f[p],m=g.query,b=w5(n,g);n.listenProvider_.startListening(lg(m),ag(n,m),b.hashFn,b.onComplete)}}}!d&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(lg(t),null):c.forEach(h=>{const f=n.queryToTagMap.get(Ov(h));n.listenProvider_.stopListening(lg(h),f)}))}!function Uge(n,t){for(let e=0;e<t.length;++e){const i=t[e];if(!i._queryParams.loadsAllData()){const s=Ov(i),r=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(r)}}}(n,c)}return a}function v5(n,t,e,i){const s=YT(n,i);if(null!=s){const r=ZT(s),o=r.path,a=r.queryId,l=er(o,t);return QT(n,o,new Vu(LT(a),l,e))}return[]}function XT(n,t,e,i=!1){const s=t._path;let r=null,o=!1;n.syncPointTree_.foreachOnPath(s,(h,f)=>{const p=er(h,s);r=r||mc(f,p),o=o||gc(f)});let l,a=n.syncPointTree_.get(s);a?(o=o||gc(a),r=r||mc(a,en())):(a=new p5,n.syncPointTree_=n.syncPointTree_.set(s,a)),null!=r?l=!0:(l=!1,r=xt.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((f,p)=>{const g=mc(p,en());g&&(r=r.updateImmediateChild(f,g))}));const c=_5(a,t);if(!c&&!t._queryParams.loadsAllData()){const h=Ov(t);we(!n.queryToTagMap.has(h),"View does not exist, but we have a tag");const f=function Wge(){return Rge++}();n.queryToTagMap.set(h,f),n.tagToQueryMap.set(f,h)}let d=function Nge(n,t,e,i,s,r){const o=m5(n,t,i,s,r);return n.views.has(t._queryIdentifier)||n.views.set(t._queryIdentifier,o),function Ige(n,t){n.eventRegistrations_.push(t)}(o,e),function Ege(n,t){const e=n.viewCache_.eventCache,i=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(Rn,(r,o)=>{i.push(hf(r,o))}),e.isFullyInitialized()&&i.push(qU(e.getNode())),f5(n,i,e.getNode(),t)}(o,e)}(a,t,e,Ev(n.pendingWriteTree_,s),r,l);if(!c&&!o&&!i){const h=b5(a,t);d=d.concat(function Hge(n,t,e){const i=t._path,s=ag(n,t),r=w5(n,e),o=n.listenProvider_.startListening(lg(t),s,r.hashFn,r.onComplete),a=n.syncPointTree_.subtree(i);if(s)we(!gc(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,d)=>{if(!Pt(c)&&u&&gc(u))return[Av(u).query];{let h=[];return u&&(h=h.concat(g5(u).map(f=>f.query))),cs(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<l.length;++c){const u=l[c];n.listenProvider_.stopListening(lg(u),ag(n,u))}}return o}(n,t,h))}return d}function Rv(n,t,e){const s=n.pendingWriteTree_,r=n.syncPointTree_.findOnPath(t,(o,a)=>{const c=mc(a,er(o,t));if(c)return c});return n5(s,t,r,e,!0)}function gf(n,t){return x5(t,n.syncPointTree_,null,Ev(n.pendingWriteTree_,en()))}function x5(n,t,e,i){if(Pt(n.path))return C5(n,t,e,i);{const s=t.get(en());null==e&&null!=s&&(e=mc(s,en()));let r=[];const o=Mt(n.path),a=n.operationForChild(o),l=t.children.get(o);if(l&&a){const c=e?e.getImmediateChild(o):null,u=s5(i,o);r=r.concat(x5(a,l,c,u))}return s&&(r=r.concat(qT(s,n,i,e))),r}}function C5(n,t,e,i){const s=t.get(en());null==e&&null!=s&&(e=mc(s,en()));let r=[];return t.children.inorderTraversal((o,a)=>{const l=e?e.getImmediateChild(o):null,c=s5(i,o),u=n.operationForChild(o);u&&(r=r.concat(C5(u,a,l,c)))}),s&&(r=r.concat(qT(s,n,i,e))),r}function w5(n,t){const e=t.query,i=ag(n,e);return{hashFn:()=>(function Cge(n){return n.viewCache_.serverCache.getNode()}(t)||xt.EMPTY_NODE).hash(),onComplete:s=>{if("ok"===s)return i?function $ge(n,t,e){const i=YT(n,e);if(i){const s=ZT(i),r=s.path,o=s.queryId,a=er(r,t);return QT(n,r,new ng(LT(o),a))}return[]}(n,e._path,i):function Lge(n,t){return gf(n,new ng({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(n,e._path);{const r=function Fpe(n,t){let e="Unknown Error";"too_big"===n?e="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?e="Client doesn't have permission to access the desired data.":"unavailable"===n&&(e="The service is unavailable");const i=new Error(n+" at "+t._path.toString()+": "+e);return i.code=n.toUpperCase(),i}(s,e);return Pv(n,e,null,r)}}}}function ag(n,t){const e=Ov(t);return n.queryToTagMap.get(e)}function Ov(n){return n._path.toString()+"$"+n._queryIdentifier}function YT(n,t){return n.tagToQueryMap.get(t)}function ZT(n){const t=n.indexOf("$");return we(-1!==t&&t<n.length-1,"Bad queryKey."),{queryId:n.substr(t+1),path:new mn(n.substr(0,t))}}function QT(n,t,e){const i=n.syncPointTree_.get(t);return we(i,"Missing sync point for query tag that we're tracking"),qT(i,e,Ev(n.pendingWriteTree_,t),null)}function lg(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function Pge(){return we(Mv,"Reference.ts has not been loaded"),Mv}())(n._repo,n._path):n}class JT{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new JT(e)}node(){return this.node_}}class eD{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=Jn(this.path_,t);return new eD(this.syncTree_,e)}node(){return Rv(this.syncTree_,this.path_)}}const jge=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},S5=function(n,t,e){return n&&"object"==typeof n?(we(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Gge(n[".sv"],t,e):"object"==typeof n[".sv"]?qge(n[".sv"],t):void we(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Gge=function(n,t,e){if("timestamp"===n)return e.timestamp;we(!1,"Unexpected server value: "+n)},qge=function(n,t,e){n.hasOwnProperty("increment")||we(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&we(!1,"Unexpected increment value: "+i);const s=t.node();if(we(null!==s&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const o=s.getValue();return"number"!=typeof o?i:o+i},I5=function(n,t,e,i){return nD(t,new eD(e,n),i)},tD=function(n,t,e){return nD(n,new JT(t),e)};function nD(n,t,e){const i=n.getPriority().val(),s=S5(i,t.getImmediateChild(".priority"),e);let r;if(n.isLeafNode()){const o=n,a=S5(o.getValue(),t,e);return a!==o.getValue()||s!==o.getPriority().val()?new uf(a,li(s)):n}{const o=n;return r=o,s!==o.getPriority().val()&&(r=r.updatePriority(new uf(s))),o.forEachChild(Rn,(a,l)=>{const c=nD(l,t.getImmediateChild(a),e);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}class iD{constructor(t="",e=null,i={children:{},childCount:0}){this.name=t,this.parent=e,this.node=i}}function Fv(n,t){let e=t instanceof mn?t:new mn(t),i=n,s=Mt(e);for(;null!==s;){const r=ef(i.node.children,s)||{children:{},childCount:0};i=new iD(s,i,r),e=In(e),s=Mt(e)}return i}function Wu(n){return n.node.value}function sD(n,t){n.node.value=t,rD(n)}function E5(n){return n.node.childCount>0}function Lv(n,t){cs(n.node.children,(e,i)=>{t(new iD(e,n,i))})}function k5(n,t,e,i){e&&!i&&t(n),Lv(n,s=>{k5(s,t,!0,i)}),e&&i&&t(n)}function cg(n){return new mn(null===n.parent?n.name:cg(n.parent)+"/"+n.name)}function rD(n){null!==n.parent&&function Yge(n,t,e){const i=function Kge(n){return void 0===Wu(n)&&!E5(n)}(e),s=yl(n.node.children,t);i&&s?(delete n.node.children[t],n.node.childCount--,rD(n)):!i&&!s&&(n.node.children[t]=e.node,n.node.childCount++,rD(n))}(n.parent,n.name,n)}const Zge=/[\[\].#$\/\u0000-\u001F\u007F]/,Qge=/[\[\].#$\u0000-\u001F\u007F]/,oD=10485760,$v=function(n){return"string"==typeof n&&0!==n.length&&!Zge.test(n)},T5=function(n){return"string"==typeof n&&0!==n.length&&!Qge.test(n)},ka=function(n,t,e,i){i&&void 0===t||dg(nf(n,"value"),t,e)},dg=function(n,t,e){const i=e instanceof mn?new mme(e,n):e;if(void 0===t)throw new Error(n+"contains undefined "+$u(i));if("function"==typeof t)throw new Error(n+"contains a function "+$u(i)+" with contents = "+t.toString());if(hv(t))throw new Error(n+"contains "+t.toString()+" "+$u(i));if("string"==typeof t&&t.length>oD/3&&lv(t)>oD)throw new Error(n+"contains a string greater than "+oD+" utf8 bytes "+$u(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let s=!1,r=!1;if(cs(t,(o,a)=>{if(".value"===o)s=!0;else if(".priority"!==o&&".sv"!==o&&(r=!0,!$v(o)))throw new Error(n+" contains an invalid key ("+o+") "+$u(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function gme(n,t){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(t),n.byteLength_+=lv(t),$U(n)})(i,o),dg(n,a,i),function bme(n){const t=n.parts_.pop();n.byteLength_-=lv(t),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),s&&r)throw new Error(n+' contains ".value" child '+$u(i)+" in addition to actual children.")}},lD=function(n,t,e,i){if(!(i&&void 0===e||T5(e)))throw new Error(nf(n,t)+'was an invalid path = "'+e+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},tbe=function(n,t,e,i){e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),lD(n,t,e,i)},Ta=function(n,t){if(".info"===Mt(t))throw new Error(n+" failed = Can't modify data under /.info/")},N5=function(n,t){const e=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!$v(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==e.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),T5(n)}(e))throw new Error(nf(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class nbe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Bv(n,t){let e=null;for(let i=0;i<t.length;i++){const s=t[i],r=s.getPath();null!==e&&!CT(r,e.path)&&(n.eventLists_.push(e),e=null),null===e&&(e={events:[],path:r}),e.events.push(s)}e&&n.eventLists_.push(e)}function Rr(n,t,e){Bv(n,e),function M5(n,t){n.recursionDepth_++;let e=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];s&&(t(s.path)?(ibe(n.eventLists_[i]),n.eventLists_[i]=null):e=!1)}e&&(n.eventLists_=[]),n.recursionDepth_--}(n,i=>ho(i,t)||ho(t,i))}function ibe(n){for(let t=0;t<n.events.length;t++){const e=n.events[t];if(null!==e){n.events[t]=null;const i=e.getEventRunner();Fu&&ls("event: "+e.toString()),lf(i)}}}const P5="repo_interrupt",sbe=25;class rbe{constructor(t,e,i,s){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new nbe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Cv(),this.transactionQueueTree_=new iD,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function R5(n){const e=n.infoData_.getNode(new mn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function fg(n){return jge({timestamp:R5(n)})}function O5(n,t,e,i,s){n.dataUpdateCount++;const r=new mn(t);e=n.interceptServerDataCallback_?n.interceptServerDataCallback_(t,e):e;let o=[];if(s)if(i){const l=av(e,c=>li(c));o=function Bge(n,t,e,i){const s=YT(n,i);if(s){const r=ZT(s),o=r.path,a=r.queryId,l=er(o,t),c=On.fromObject(e);return QT(n,o,new pf(LT(a),l,c))}return[]}(n.serverSyncTree_,r,l,s)}else{const l=li(e);o=v5(n.serverSyncTree_,r,l,s)}else if(i){const l=av(e,c=>li(c));o=function Fge(n,t,e){const i=On.fromObject(e);return gf(n,new pf({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(n.serverSyncTree_,r,l)}else{const l=li(e);o=og(n.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=_f(n,r)),Rr(n.eventQueue_,a,o)}function F5(n,t){cD(n,"connected",t),!1===t&&function ube(n){bf(n,"onDisconnectEvents");const t=fg(n),e=Cv();RT(n.onDisconnect_,en(),(s,r)=>{const o=I5(s,r,n.serverSyncTree_,t);ff(e,s,o)});let i=[];RT(e,en(),(s,r)=>{i=i.concat(og(n.serverSyncTree_,s,r));const o=fD(n,s);_f(n,o)}),n.onDisconnect_=Cv(),Rr(n.eventQueue_,en(),i)}(n)}function cD(n,t,e){const i=new mn("/.info/"+t),s=li(e);n.infoData_.updateSnapshot(i,s);const r=og(n.infoSyncTree_,i,s);Rr(n.eventQueue_,i,r)}function Vv(n){return n.nextWriteId_++}function uD(n,t,e,i,s){bf(n,"set",{path:t.toString(),value:e,priority:i});const r=fg(n),o=li(e,i),a=Rv(n.serverSyncTree_,t),l=tD(o,a,r),c=Vv(n),u=KT(n.serverSyncTree_,t,l,c,!0);Bv(n.eventQueue_,u),n.server_.put(t.toString(),o.val(!0),(h,f)=>{const p="ok"===h;p||Ms("set at "+t+" failed: "+h);const g=bc(n.serverSyncTree_,c,!p);Rr(n.eventQueue_,t,g),function _c(n,t,e,i){t&&lf(()=>{if("ok"===e)t(null);else{const s=(e||"error").toUpperCase();let r=s;i&&(r+=": "+i);const o=new Error(r);o.code=s,t(o)}})}(0,s,h,f)});const d=fD(n,t);_f(n,d),Rr(n.eventQueue_,d,[])}function bf(n,...t){let e="";n.persistentConnection_&&(e=n.persistentConnection_.id+":"),ls(e,...t)}function hD(n,t,e){return Rv(n.serverSyncTree_,t,e)||xt.EMPTY_NODE}function zv(n,t=n.transactionQueueTree_){if(t||Uv(n,t),Wu(t)){const e=V5(n,t);we(e.length>0,"Sending zero length transaction queue"),e.every(s=>0===s.status)&&function bbe(n,t,e){const i=e.map(c=>c.currentWriteId),s=hD(n,t,i);let r=s;const o=s.hash();for(let c=0;c<e.length;c++){const u=e[c];we(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=er(t,u.path);r=r.updateChild(d,u.currentOutputSnapshotRaw)}const a=r.val(!0),l=t;n.server_.put(l.toString(),a,c=>{bf(n,"transaction put response",{path:l.toString(),status:c});let u=[];if("ok"===c){const d=[];for(let h=0;h<e.length;h++)e[h].status=2,u=u.concat(bc(n.serverSyncTree_,e[h].currentWriteId)),e[h].onComplete&&d.push(()=>e[h].onComplete(null,!0,e[h].currentOutputSnapshotResolved)),e[h].unwatcher();Uv(n,Fv(n.transactionQueueTree_,t)),zv(n,n.transactionQueueTree_),Rr(n.eventQueue_,t,u);for(let h=0;h<d.length;h++)lf(d[h])}else{if("datastale"===c)for(let d=0;d<e.length;d++)e[d].status=3===e[d].status?4:0;else{Ms("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<e.length;d++)e[d].status=4,e[d].abortReason=c}_f(n,t)}},o)}(n,cg(t),e)}else E5(t)&&Lv(t,e=>{zv(n,e)})}function _f(n,t){const e=B5(n,t),i=cg(e);return function _be(n,t,e){if(0===t.length)return;const i=[];let s=[];const o=t.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<t.length;a++){const l=t[a],c=er(e,l.path);let d,u=!1;if(we(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)u=!0,d=l.abortReason,s=s.concat(bc(n.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=sbe)u=!0,d="maxretry",s=s.concat(bc(n.serverSyncTree_,l.currentWriteId,!0));else{const h=hD(n,l.path,o);l.currentInputSnapshot=h;const f=t[a].update(h.val());if(void 0!==f){dg("transaction failed: Data returned ",f,l.path);let p=li(f);"object"==typeof f&&null!=f&&yl(f,".priority")||(p=p.updatePriority(h.getPriority()));const m=l.currentWriteId,b=fg(n),_=tD(p,h,b);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=_,l.currentWriteId=Vv(n),o.splice(o.indexOf(m),1),s=s.concat(KT(n.serverSyncTree_,l.path,_,l.currentWriteId,l.applyLocally)),s=s.concat(bc(n.serverSyncTree_,m,!0))}else u=!0,d="nodata",s=s.concat(bc(n.serverSyncTree_,l.currentWriteId,!0))}Rr(n.eventQueue_,e,s),s=[],u&&(t[a].status=2,setTimeout(t[a].unwatcher,Math.floor(0)),t[a].onComplete&&i.push("nodata"===d?()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot):()=>t[a].onComplete(new Error(d),!1,null)))}Uv(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)lf(i[a]);zv(n,n.transactionQueueTree_)}(n,V5(n,e),i),i}function B5(n,t){let e,i=n.transactionQueueTree_;for(e=Mt(t);null!==e&&void 0===Wu(i);)i=Fv(i,e),e=Mt(t=In(t));return i}function V5(n,t){const e=[];return z5(n,t,e),e.sort((i,s)=>i.order-s.order),e}function z5(n,t,e){const i=Wu(t);if(i)for(let s=0;s<i.length;s++)e.push(i[s]);Lv(t,s=>{z5(n,s,e)})}function Uv(n,t){const e=Wu(t);if(e){let i=0;for(let s=0;s<e.length;s++)2!==e[s].status&&(e[i]=e[s],i++);e.length=i,sD(t,e.length>0?e:void 0)}Lv(t,i=>{Uv(n,i)})}function fD(n,t){const e=cg(B5(n,t)),i=Fv(n.transactionQueueTree_,t);return function Xge(n,t,e){let i=e?n:n.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,s=>{pD(n,s)}),pD(n,i),k5(i,s=>{pD(n,s)}),e}function pD(n,t){const e=Wu(t);if(e){const i=[];let s=[],r=-1;for(let o=0;o<e.length;o++)3===e[o].status||(1===e[o].status?(we(r===o-1,"All SENT items should be at beginning of queue."),r=o,e[o].status=3,e[o].abortReason="set"):(we(0===e[o].status,"Unexpected transaction status in abort"),e[o].unwatcher(),s=s.concat(bc(n.serverSyncTree_,e[o].currentWriteId,!0)),e[o].onComplete&&i.push(e[o].onComplete.bind(null,new Error("set"),!1,null))));-1===r?sD(t,void 0):e.length=r+1,Rr(n.eventQueue_,cg(t),s);for(let o=0;o<i.length;o++)lf(i[o])}}const mD=function(n,t){const e=xbe(n),i=e.namespace;return"firebase.com"===e.domain&&Ia(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==e.domain&&Ia("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Ms("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new mT(e.host,e.secure,i,"ws"===e.scheme||"wss"===e.scheme,t,"",i!==e.subdomain),path:new mn(e.pathString)}},xbe=function(n){let t="",e="",i="",s="",r="",o=!0,a="https",l=443;if("string"==typeof n){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");-1===u&&(u=n.length);let d=n.indexOf("?");-1===d&&(d=n.length),t=n.substring(0,Math.min(u,d)),u<d&&(s=function ybe(n){let t="";const e=n.split("/");for(let i=0;i<e.length;i++)if(e[i].length>0){let s=e[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}t+="/"+s}return t}(n.substring(u,d)));const h=function vbe(n){const t={};"?"===n.charAt(0)&&(n=n.substring(1));for(const e of n.split("&")){if(0===e.length)continue;const i=e.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Ms(`Invalid query segment '${e}' in query '${n}'`)}return t}(n.substring(Math.min(n.length,d)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())e="localhost";else if(f.split(".").length<=2)e=f;else{const p=t.indexOf(".");i=t.substring(0,p).toLowerCase(),e=t.substring(p+1),r=i}"ns"in h&&(r=h.ns)}return{host:t,port:l,domain:e,subdomain:i,secure:o,scheme:a,pathString:s,namespace:r}};class W5{constructor(t,e,i,s){this.eventType=t,this.eventRegistration=e,this.snapshot=i,this.prevName=s}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Zi(this.snapshot.exportVal())}}class H5{constructor(t,e,i){this.eventRegistration=t,this.error=e,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class gD{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return we(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class Or{constructor(t,e,i,s){this._repo=t,this._path=e,this._queryParams=i,this._orderByCalled=s}get key(){return Pt(this._path)?null:xT(this._path)}get ref(){return new Go(this._repo,this._path)}get _queryIdentifier(){const t=XU(this._queryParams),e=fT(t);return"{}"===e?"default":e}get _queryObject(){return XU(this._queryParams)}isEqual(t){if(!((t=sf(t))instanceof Or))return!1;const e=this._repo===t._repo,i=CT(this._path,t._path);return e&&i&&this._queryIdentifier===t._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function fme(n){let t="";for(let e=n.pieceNum_;e<n.pieces_.length;e++)""!==n.pieces_[e]&&(t+="/"+encodeURIComponent(String(n.pieces_[e])));return t||"/"}(this._path)}}class Go extends Or{constructor(t,e){super(t,e,new NT,!1)}get parent(){const t=LU(this._path);return null===t?null:new Go(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class Hu{constructor(t,e,i){this._node=t,this.ref=e,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new mn(t),i=Fr(this.ref,t);return new Hu(this._node.getChild(e),i,Rn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(i,s)=>t(new Hu(s,Fr(this.ref,i),Rn)))}hasChild(t){const e=new mn(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function _i(n,t){return(n=sf(n))._checkNotDeleted("ref"),void 0!==t?Fr(n._root,t):n._root}function Fr(n,t){return null===Mt((n=sf(n))._path)?tbe("child","path",t,!1):lD("child","path",t,!1),new Go(n._repo,Jn(n._path,t))}function us(n,t){n=sf(n),Ta("set",n._path),ka("set",t,n._path,!1);const e=new Lm;return uD(n._repo,n._path,t,null,e.wrapCallback(()=>{})),e.promise}function vc(n){n=sf(n);const t=new gD(()=>{}),e=new pg(t);return function lbe(n,t,e){const i=function Vge(n,t){const e=t._path;let i=null;n.syncPointTree_.foreachOnPath(e,(c,u)=>{const d=er(c,e);i=i||mc(u,d)});let s=n.syncPointTree_.get(e);s?i=i||mc(s,en()):(s=new p5,n.syncPointTree_=n.syncPointTree_.set(e,s));const r=null!=i,o=r?new fc(i,!0,!1):null;return function wge(n){return Iv(n.viewCache_)}(m5(s,t,Ev(n.pendingWriteTree_,t._path),r?o.getNode():xt.EMPTY_NODE,r))}(n.serverSyncTree_,t);return null!=i?Promise.resolve(i):n.server_.get(t).then(s=>{const r=li(s).withIndex(t._queryParams.getIndex());let o;if(XT(n.serverSyncTree_,t,e,!0),t._queryParams.loadsAllData())o=og(n.serverSyncTree_,t._path,r);else{const a=ag(n.serverSyncTree_,t);o=v5(n.serverSyncTree_,t._path,r,a)}return Rr(n.eventQueue_,t._path,o),Pv(n.serverSyncTree_,t,e,null,!0),r},s=>(bf(n,"get for query "+Zi(t)+" failed: "+s),Promise.reject(new Error(s))))}(n._repo,n,e).then(i=>new Hu(i,new Go(n._repo,n._path),n._queryParams.getIndex()))}class pg{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const i=e._queryParams.getIndex();return new W5("value",this,new Hu(t.snapshotNode,new Go(e._repo,e._path),i))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new H5(this,t,e):null}matches(t){return t instanceof pg&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}(function kge(n){we(!Nv,"__referenceConstructor has already been defined"),Nv=n})(Go),function Mge(n){we(!Mv,"__referenceConstructor has already been defined"),Mv=n}(Go);const Obe="FIREBASE_DATABASE_EMULATOR_HOST",bD={};let q5=!1;class Vbe{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function obe(n,t,e){if(n.stats_=_T(n.repoInfo_),n.forceRestClient_||Vpe())n.server_=new xv(n.repoInfo_,(i,s,r,o)=>{O5(n,i,s,r,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>F5(n,!0),0);else{if(typeof e<"u"&&null!==e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Zi(e)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Bu(n.repoInfo_,t,(i,s,r,o)=>{O5(n,i,s,r,o)},i=>{F5(n,i)},i=>{!function abe(n,t){cs(t,(e,i)=>{cD(n,e,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,e),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function jpe(n,t){const e=n.toString();return bT[e]||(bT[e]=t()),bT[e]}(n.repoInfo_,()=>new jme(n.stats_,n.server_)),n.infoData_=new Vme,n.infoSyncTree_=new y5({startListening:(i,s,r,o)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=og(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),cD(n,"connected",!1),n.serverSyncTree_=new y5({startListening:(i,s,r,o)=>(n.server_.listen(i,r,s,(a,l)=>{const c=o(a,l);Rr(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Go(this._repo,en())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Lbe(n,t){const e=bD[t];(!e||e[n.key]!==n)&&Ia(`Database ${t}(${n.repoInfo_}) has already been deleted.`),function $5(n){n.persistentConnection_&&n.persistentConnection_.interrupt(P5)}(n),delete e[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&Ia("Cannot call "+t+" on a deleted database.")}}function Da(n=function gpe(n=uv){const t=Pu.get(n);if(!t&&n===uv&&P4())return rf();if(!t)throw uo.create("no-app",{appName:n});return t}(),t){const e=function G4(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}(n,"database").getImmediate({identifier:t});if(!e._instanceStarted){const i=Xhe("database");i&&function zbe(n,t,e,i={}){(n=sf(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Ia("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let r;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Ia('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new Km(Km.OWNER);else if(i.mockUserToken){const o="string"==typeof i.mockUserToken?i.mockUserToken:function Yhe(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i=t||"demo-project",s=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},n);return[iv(JSON.stringify({alg:"none",type:"JWT"})),iv(JSON.stringify(o)),""].join(".")}(i.mockUserToken,n.app.options.projectId);r=new Km(o)}!function Fbe(n,t,e,i){n.repoInfo_=new mT(`${t}:${e}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(s,t,e,r)}(e,...i)}return e}function Y5(...n){const t=XR(n),{args:e,keys:i}=AV(n),s=new dt(r=>{const{length:o}=e;if(!o)return void r.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;qs(e[u]).subscribe(Yn(r,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||r.next(i?MV(i,a):a),r.complete())}))}});return t?s.pipe(nk(t)):s}Bu.prototype.simpleListen=function(n,t){this.sendRequest("q",{p:n},t)},Bu.prototype.echo=function(n,t){this.sendRequest("echo",{d:n},t)},function Ube(n){(function eU(n){uT=n})("10.14.1"),dv(new Vm("database",(t,{instanceIdentifier:e})=>function K5(n,t,e,i,s){let r=i||n.options.databaseURL;void 0===r&&(n.options.projectId||Ia("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ls("Using default host for project ",n.options.projectId),r=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l,c,o=mD(r,s),a=o.repoInfo;typeof process<"u"&&process.env&&(c=process.env[Obe]),c?(l=!0,r=`http://${c}?ns=${a.namespace}`,o=mD(r,s),a=o.repoInfo):l=!o.repoInfo.secure;const u=s&&l?new Km(Km.OWNER):new Upe(n.name,n.options,t);N5("Invalid Firebase Database URL",o),Pt(o.path)||Ia("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function $be(n,t,e,i){let s=bD[t.name];s||(s={},bD[t.name]=s);let r=s[n.toURLString()];return r&&Ia("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new rbe(n,q5,e,i),s[n.toURLString()]=r,r}(a,n,u,new zpe(n.name,e));return new Vbe(d,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e),"PUBLIC").setMultipleInstances(!0)),Ru(Q4,"1.0.8",n),Ru(Q4,"1.0.8","esm2017")}();let Z5=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(ie(ol),ie(Ri))},n.\u0275dir=Ze({type:n}),n})(),ju=(()=>{class n extends Z5{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275dir=Ze({type:n,features:[$t]}),n})();const Na=new Ce("NgValueAccessor"),Gbe={provide:Na,useExisting:Mn(()=>gg),multi:!0},Kbe=new Ce("CompositionEventMode");let gg=(()=>{class n extends Z5{constructor(e,i,s){super(e,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function qbe(){const n=dl()?dl().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(ie(ol),ie(Ri),ie(Kbe,8))},n.\u0275dir=Ze({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&H("input",function(r){return i._handleInput(r.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(r){return i._compositionEnd(r.target.value)})},features:[pn([Gbe]),$t]}),n})();const Xbe=!1;function xc(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}const Ps=new Ce("NgValidators"),Cc=new Ce("NgAsyncValidators");function Gv(n){return null}function lW(n){return null!=n}function cW(n){const t=Kp(n)?Pi(n):n;if(Xbe&&!LI(t)){let e="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(e+=" Are you using a synchronous validator where an async validator is expected?"),new re(-1101,e)}return t}function uW(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function dW(n,t){return t.map(e=>e(n))}function hW(n){return n.map(t=>function Zbe(n){return!n.validate}(t)?t:e=>t.validate(e))}function _D(n){return null!=n?function fW(n){if(!n)return null;const t=n.filter(lW);return 0==t.length?null:function(e){return uW(dW(e,t))}}(hW(n)):null}function yD(n){return null!=n?function pW(n){if(!n)return null;const t=n.filter(lW);return 0==t.length?null:function(e){return Y5(dW(e,t).map(cW)).pipe(lt(uW))}}(hW(n)):null}function mW(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function vD(n){return n?Array.isArray(n)?n:[n]:[]}function qv(n,t){return Array.isArray(n)?n.includes(t):n===t}function _W(n,t){const e=vD(t);return vD(n).forEach(s=>{qv(e,s)||e.push(s)}),e}function yW(n,t){return vD(t).filter(e=>!qv(n,e))}class vW{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=_D(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=yD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class tr extends vW{get formDirective(){return null}get path(){return null}}class wc extends vW{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class xW{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let xD=(()=>{class n extends xW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(ie(wc,2))},n.\u0275dir=Ze({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&Zs("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[$t]}),n})(),Kv=(()=>{class n extends xW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(ie(tr,10))},n.\u0275dir=Ze({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&Zs("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[$t]}),n})();function CW(n,t){return n?`with name: '${t}'`:`at index: ${t}`}const SD=!1,bg="VALID",Yv="INVALID",yf="PENDING",_g="DISABLED";function ID(n){return(Zv(n)?n.validators:n)||null}function ED(n,t){return(Zv(t)?t.asyncValidators:n)||null}function Zv(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class IW{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===bg}get invalid(){return this.status===Yv}get pending(){return this.status==yf}get disabled(){return this.status===_g}get enabled(){return this.status!==_g}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(_W(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(_W(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(yW(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(yW(t,this._rawAsyncValidators))}hasValidator(t){return qv(this._rawValidators,t)}hasAsyncValidator(t){return qv(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=yf,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=_g,this.errors=null,this._forEachChild(i=>{i.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=bg,this._forEachChild(i=>{i.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===bg||this.status===yf)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?_g:bg}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=yf,this._hasOwnPendingAsyncValidator=!0;const e=cW(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,s)=>i&&i._find(s),this)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Yt,this.statusChanges=new Yt}_calculateStatus(){return this._allControlsDisabled()?_g:this.errors?Yv:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yf)?yf:this._anyControlsHaveStatus(Yv)?Yv:bg}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Zv(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function s_e(n){return Array.isArray(n)?_D(n):n||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function r_e(n){return Array.isArray(n)?yD(n):n||null}(this._rawAsyncValidators)}}class kD extends IW{constructor(t,e,i){super(ID(e),ED(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){(function SW(n,t,e){n._forEachChild((i,s)=>{if(void 0===e[s])throw new re(1002,SD?function i_e(n,t){return`Must supply a value for form control ${CW(n,t)}`}(t,s):"")})})(this,!0,t),Object.keys(t).forEach(i=>{(function wW(n,t,e){const i=n.controls;if(!(t?Object.keys(i):i).length)throw new re(1e3,SD?function t_e(n){return`\n    There are no form controls registered with this ${n?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(t):"");if(!i[e])throw new re(1001,SD?function n_e(n,t){return`Cannot find form control ${CW(n,t)}`}(t,e):"")})(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(i=>{const s=this.controls[i];s&&s.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,s)=>{i.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,s)=>((i.enabled||this.disabled)&&(e[s]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((s,r)=>{i=e(i,s,r)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}const Gu=new Ce("CallSetDisabledState",{providedIn:"root",factory:()=>yg}),yg="always";function vg(n,t,e=yg){TD(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(n.disabled),function l_e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&EW(n,t)})}(n,t),function u_e(n,t){const e=(i,s)=>{t.valueAccessor.writeValue(i),s&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function c_e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&EW(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function a_e(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function ex(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function TD(n,t){const e=function gW(n){return n._rawValidators}(n);null!==t.validator?n.setValidators(mW(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=function bW(n){return n._rawAsyncValidators}(n);null!==t.asyncValidator?n.setAsyncValidators(mW(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const s=()=>n.updateValueAndValidity();ex(t._rawValidators,s),ex(t._rawAsyncValidators,s)}function EW(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}const m_e={provide:tr,useExisting:Mn(()=>vf)},xg=(()=>Promise.resolve())();let vf=(()=>{class n extends tr{constructor(e,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Yt,this.form=new kD({},_D(e),yD(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){xg.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),vg(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){xg.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){xg.then(()=>{const i=this._findContainer(e.path),s=new kD({});(function kW(n,t){TD(n,t)})(s,e),i.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){xg.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){xg.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function TW(n,t){n._syncPendingControls(),t.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(ie(Ps,10),ie(Cc,10),ie(Gu,8))},n.\u0275dir=Ze({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&H("submit",function(r){return i.onSubmit(r)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pn([m_e]),$t]}),n})();function DW(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function NW(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const AW=class extends IW{constructor(t=null,e,i){super(ID(e),ED(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Zv(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=NW(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){DW(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){DW(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){NW(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},__e={provide:wc,useExisting:Mn(()=>nx)},RW=(()=>Promise.resolve())();let nx=(()=>{class n extends wc{constructor(e,i,s,r,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new AW,this._registered=!1,this.update=new Yt,this._parent=e,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=function AD(n,t){if(!t)return null;let e,i,s;return Array.isArray(t),t.forEach(r=>{r.constructor===gg?e=r:function f_e(n){return Object.getPrototypeOf(n.constructor)===ju}(r)?i=r:s=r}),s||i||e||null}(0,r)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function ND(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){vg(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){RW.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,s=0!==i&&Oh(i);RW.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function Qv(n,t){return[...t.path,n]}(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(ie(tr,9),ie(Ps,10),ie(Cc,10),ie(Na,10),ie(Su,8),ie(Gu,8))},n.\u0275dir=Ze({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[pn([__e]),$t,kr]}),n})(),ix=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const y_e={provide:Na,useExisting:Mn(()=>MD),multi:!0};let MD=(()=>{class n extends ju{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275dir=Ze({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&H("input",function(r){return i.onChange(r.target.value)})("blur",function(){return i.onTouched()})},features:[pn([y_e]),$t]}),n})(),OW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({}),n})();const PD=new Ce("NgModelWithFormControlWarning"),T_e={provide:Na,useExisting:Mn(()=>sx),multi:!0};function zW(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let sx=(()=>{class n extends ju{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=zW(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function D_e(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275dir=Ze({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&H("change",function(r){return i.onChange(r.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[pn([T_e]),$t]}),n})(),UW=(()=>{class n{constructor(e,i,s){this._element=e,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(zW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(ie(Ri),ie(ol),ie(sx,9))},n.\u0275dir=Ze({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const N_e={provide:Na,useExisting:Mn(()=>LD),multi:!0};function WW(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let LD=(()=>{class n extends ju{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const s=e.map(r=>this._getOptionId(r));i=(r,o)=>{r._setSelected(s.indexOf(o.toString())>-1)}}else i=(s,r)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const s=[],r=i.selectedOptions;if(void 0!==r){const o=r;for(let a=0;a<o.length;a++){const c=this._getOptionValue(o[a].value);s.push(c)}}else{const o=i.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const c=this._getOptionValue(l.value);s.push(c)}}}this.value=s,e(s)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function A_e(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275dir=Ze({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&H("change",function(r){return i.onChange(r.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[pn([N_e]),$t]}),n})(),HW=(()=>{class n{constructor(e,i,s){this._element=e,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(WW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(WW(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(ie(Ri),ie(ol),ie(LD,9))},n.\u0275dir=Ze({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let qu=(()=>{class n{constructor(){this._validator=Gv}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Gv,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,features:[kr]}),n})();const P_e={provide:Ps,useExisting:Mn(()=>$D),multi:!0};let $D=(()=>{class n extends qu{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>function GW(n){return"number"==typeof n?n:parseFloat(n)}(e),this.createValidator=e=>function eW(n){return t=>{if(xc(t.value)||xc(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275dir=Ze({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Mr("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[pn([P_e]),$t]}),n})();const $_e={provide:Ps,useExisting:Mn(()=>VD),multi:!0};let VD=(()=>{class n extends qu{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function jW(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>function oW(n){return t=>function J5(n){return null!=n&&"number"==typeof n.length}(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275dir=Ze({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Mr("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[pn([$_e]),$t]}),n})(),QW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[OW]}),n})(),z_e=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:Gu,useValue:e.callSetDisabledState??yg}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[QW]}),n})(),U_e=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:PD,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Gu,useValue:e.callSetDisabledState??yg}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[QW]}),n})();const W_e=["*"];let rx;function Cg(n){return function H_e(){if(void 0===rx&&(rx=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(rx=n.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return rx}()?.createHTML(n)||n}function JW(n){return Error(`Unable to find icon with the name "${n}"`)}function eH(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function tH(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class Ku{constructor(t,e,i){this.url=t,this.svgText=e,this.options=i}}let ox=(()=>{class n{constructor(e,i,s,r){this._httpClient=e,this._sanitizer=i,this._errorHandler=r,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=s}addSvgIcon(e,i,s){return this.addSvgIconInNamespace("",e,i,s)}addSvgIconLiteral(e,i,s){return this.addSvgIconLiteralInNamespace("",e,i,s)}addSvgIconInNamespace(e,i,s,r){return this._addSvgIconConfig(e,i,new Ku(s,null,r))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,i,s,r){const o=this._sanitizer.sanitize(an.HTML,s);if(!o)throw tH(s);const a=Cg(o);return this._addSvgIconConfig(e,i,new Ku("",a,r))}addSvgIconSet(e,i){return this.addSvgIconSetInNamespace("",e,i)}addSvgIconSetLiteral(e,i){return this.addSvgIconSetLiteralInNamespace("",e,i)}addSvgIconSetInNamespace(e,i,s){return this._addSvgIconSetConfig(e,new Ku(i,null,s))}addSvgIconSetLiteralInNamespace(e,i,s){const r=this._sanitizer.sanitize(an.HTML,i);if(!r)throw tH(i);const o=Cg(r);return this._addSvgIconSetConfig(e,new Ku("",o,s))}registerFontClassAlias(e,i=e){return this._fontCssClassesByAlias.set(e,i),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const i=this._sanitizer.sanitize(an.RESOURCE_URL,e);if(!i)throw eH(e);const s=this._cachedIconsByUrl.get(i);return s?Ke(ax(s)):this._loadSvgIconFromConfig(new Ku(e,null)).pipe(Li(r=>this._cachedIconsByUrl.set(i,r)),lt(r=>ax(r)))}getNamedSvgIcon(e,i=""){const s=nH(i,e);let r=this._svgIconConfigs.get(s);if(r)return this._getSvgFromConfig(r);if(r=this._getIconConfigFromResolvers(i,e),r)return this._svgIconConfigs.set(s,r),this._getSvgFromConfig(r);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(e,o):Fh(JW(s))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Ke(ax(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(lt(i=>ax(i)))}_getSvgFromIconSetConfigs(e,i){const s=this._extractIconWithNameFromAnySet(e,i);return s?Ke(s):Y5(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(ml(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(an.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),Ke(null)})))).pipe(lt(()=>{const o=this._extractIconWithNameFromAnySet(e,i);if(!o)throw JW(e);return o}))}_extractIconWithNameFromAnySet(e,i){for(let s=i.length-1;s>=0;s--){const r=i[s];if(r.svgText&&r.svgText.toString().indexOf(e)>-1){const o=this._svgElementFromConfig(r),a=this._extractSvgIconFromSet(o,e,r.options);if(a)return a}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Li(i=>e.svgText=i),lt(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Ke(null):this._fetchIcon(e).pipe(Li(i=>e.svgText=i))}_extractSvgIconFromSet(e,i,s){const r=e.querySelector(`[id="${i}"]`);if(!r)return null;const o=r.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,s);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),s);const a=this._svgElementFromString(Cg("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,s)}_svgElementFromString(e){const i=this._document.createElement("DIV");i.innerHTML=e;const s=i.querySelector("svg");if(!s)throw Error("<svg> tag not found");return s}_toSvgElement(e){const i=this._svgElementFromString(Cg("<svg></svg>")),s=e.attributes;for(let r=0;r<s.length;r++){const{name:o,value:a}=s[r];"id"!==o&&i.setAttribute(o,a)}for(let r=0;r<e.childNodes.length;r++)e.childNodes[r].nodeType===this._document.ELEMENT_NODE&&i.appendChild(e.childNodes[r].cloneNode(!0));return i}_setSvgAttributes(e,i){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),i&&i.viewBox&&e.setAttribute("viewBox",i.viewBox),e}_fetchIcon(e){const{url:i,options:s}=e,r=s?.withCredentials??!1;if(!this._httpClient)throw function j_e(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const o=this._sanitizer.sanitize(an.RESOURCE_URL,i);if(!o)throw eH(i);const a=this._inProgressUrlFetches.get(o);if(a)return a;const l=this._httpClient.get(o,{responseType:"text",withCredentials:r}).pipe(lt(c=>Cg(c)),k0(()=>this._inProgressUrlFetches.delete(o)),JR());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(e,i,s){return this._svgIconConfigs.set(nH(e,i),s),this}_addSvgIconSetConfig(e,i){const s=this._iconSetConfigs.get(e);return s?s.push(i):this._iconSetConfigs.set(e,[i]),this}_svgElementFromConfig(e){if(!e.svgElement){const i=this._svgElementFromString(e.svgText);this._setSvgAttributes(i,e.options),e.svgElement=i}return e.svgElement}_getIconConfigFromResolvers(e,i){for(let s=0;s<this._resolvers.length;s++){const r=this._resolvers[s](i,e);if(r)return q_e(r)?new Ku(r.url,null,r.options):new Ku(r,null)}}}return n.\u0275fac=function(e){return new(e||n)(me(Q0,8),me(tk),me(Jt,8),me(al))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ax(n){return n.cloneNode(!0)}function nH(n,t){return n+":"+t}function q_e(n){return!(!n.url||!n.options)}const K_e=C4(class{constructor(n){this._elementRef=n}}),X_e=new Ce("MAT_ICON_DEFAULT_OPTIONS"),Y_e=new Ce("mat-icon-location",{providedIn:"root",factory:function Z_e(){const n=ht(Jt),t=n?n.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),iH=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Q_e=iH.map(n=>`[${n}]`).join(", "),J_e=/^url\(['"]?#(.*?)['"]?\)$/;let sH=(()=>{class n extends K_e{get inline(){return this._inline}set inline(e){this._inline=Wo(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const i=this._cleanupFontValue(e);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const i=this._cleanupFontValue(e);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(e,i,s,r,o,a){super(e),this._iconRegistry=i,this._location=r,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=G.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),s||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];const i=e.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let i=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const s=e.childNodes[i];(1!==s.nodeType||"svg"===s.nodeName.toLowerCase())&&s.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(s=>s.length>0);this._previousFontSetClass.forEach(s=>e.classList.remove(s)),i.forEach(s=>e.classList.add(s)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const i=this._elementsWithExternalReferences;i&&i.forEach((s,r)=>{s.forEach(o=>{r.setAttribute(o.name,`url('${e}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(e){const i=e.querySelectorAll(Q_e),s=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<i.length;r++)iH.forEach(o=>{const a=i[r],l=a.getAttribute(o),c=l?l.match(J_e):null;if(c){let u=s.get(a);u||(u=[],s.set(a,u)),u.push({name:o,value:c[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[i,s]=this._splitIconName(e);i&&(this._svgNamespace=i),s&&(this._svgName=s),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(s,i).pipe(va(1)).subscribe(r=>this._setSvgElement(r),r=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${s}! ${r.message}`))})}}}return n.\u0275fac=function(e){return new(e||n)(ie(Ri),ie(ox),Ap("aria-hidden"),ie(Y_e),ie(al),ie(X_e,8))},n.\u0275cmp=Zn({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,i){2&e&&(Mr("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),Zs("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[$t],ngContentSelectors:W_e,decls:1,vars:0,template:function(e,i){1&e&&($I(),Xp(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),eye=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[Sa,Sa]}),n})();function tye(n,t){if(1&n&&(w(0,"div")(1,"h4")(2,"b"),I(3),C()()()),2&n){const e=Ge();W(3),ot(e.whoWins)}}let nye=(()=>{class n{constructor(){this.b1=" ",this.b2=" ",this.b3=" ",this.b4=" ",this.b5=" ",this.b6=" ",this.b7=" ",this.b8=" ",this.b9=" ",this.turn=!0,this.winner=!1,this.whoWins=" ",this.randNum=0,this.flag=!1,this.firebaseConfig={apiKey:"AIzaSyAqm7ooUgqpyKCWH3fPM1yzyANdWmFsGH4",authDomain:"fir-mywebsite.firebaseapp.com",databaseURL:"https://fir-mywebsite-default-rtdb.firebaseio.com",projectId:"fir-mywebsite",storageBucket:"fir-mywebsite.appspot.com",messagingSenderId:"271679200792",appId:"1:271679200792:web:807031f3f43102c9a2ad6d",measurementId:"G-8JCVNF7W86"},this.app=rf(this.firebaseConfig),this.regexp=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}submitForm(){var e=this;return Q(function*(){var i=e.getInputVal("name"),s=e.getInputVal("company"),r=e.getInputVal("email"),o=e.getInputVal("phone"),a=e.getInputVal("message");null==i||""==i||null==r||""==r?e.setSpecificTypeAlert(".alert3"):e.regexp.test(r)?(e.saveMessage(i,s,r,o,a),e.setSpecificTypeAlert(".alert2"),yield new Promise(l=>setTimeout(l,3e3)),e.setSpecificTypeAlert(".alert"),document.getElementById("contactForm").reset()):e.setSpecificTypeAlert(".alert4")})()}setSpecificTypeAlert(e){document.querySelector(e).style.display="block",setTimeout(function(){document.querySelector(e).style.display="none"},2e3)}getInputVal(e){return document.getElementById(e).value}getRandomInt(e){return Math.floor(Math.random()*e)}saveMessage(e,i,s,r,o){us(_i(Da(),this.getRandomInt(1e14).toString()+e),{name:e,company:i,email:s,phone:r,message:o})}winCheck(){"X"==this.b1&&"X"==this.b2&&"X"==this.b3||"X"==this.b4&&"X"==this.b5&&"X"==this.b6||"X"==this.b7&&"X"==this.b8&&"X"==this.b9||"X"==this.b1&&"X"==this.b4&&"X"==this.b7||"X"==this.b2&&"X"==this.b5&&"X"==this.b8||"X"==this.b3&&"X"==this.b6&&"X"==this.b9||"X"==this.b1&&"X"==this.b5&&"X"==this.b9||"X"==this.b3&&"X"==this.b5&&"X"==this.b7?(this.winner=!0,this.whoWins="X has won!"):"O"==this.b1&&"O"==this.b2&&"O"==this.b3||"O"==this.b4&&"O"==this.b5&&"O"==this.b6||"O"==this.b7&&"O"==this.b8&&"O"==this.b9||"O"==this.b1&&"O"==this.b4&&"O"==this.b7||"O"==this.b2&&"O"==this.b5&&"O"==this.b8||"O"==this.b3&&"O"==this.b6&&"O"==this.b9||"O"==this.b1&&"O"==this.b5&&"O"==this.b9||"O"==this.b3&&"O"==this.b5&&"O"==this.b7?(this.winner=!0,this.whoWins="O has won!"):" "!=this.b1&&" "!=this.b2&&" "!=this.b3&&" "!=this.b4&&" "!=this.b5&&" "!=this.b6&&" "!=this.b7&&" "!=this.b8&&" "!=this.b9&&(this.winner=!0,this.whoWins="CAT!")}reset(){this.b1=" ",this.b2=" ",this.b3=" ",this.b4=" ",this.b5=" ",this.b6=" ",this.b7=" ",this.b8=" ",this.b9=" ",this.turn=!0,this.winner=!1,this.whoWins=" ",document.getElementById("but1").disabled=!1,document.getElementById("but2").disabled=!1,document.getElementById("but3").disabled=!1,document.getElementById("but4").disabled=!1,document.getElementById("but5").disabled=!1,document.getElementById("but6").disabled=!1,document.getElementById("but7").disabled=!1,document.getElementById("but8").disabled=!1,document.getElementById("but9").disabled=!1}runAI(){if(!this.winner){for(;!this.flag;)this.randNum=Math.floor(9*Math.random())+1,1==this.randNum&&" "==this.b1?(this.checkBox1(),this.flag=!0):2==this.randNum&&" "==this.b2?(this.checkBox2(),this.flag=!0):3==this.randNum&&" "==this.b3?(this.checkBox3(),this.flag=!0):4==this.randNum&&" "==this.b4?(this.checkBox4(),this.flag=!0):5==this.randNum&&" "==this.b5?(this.checkBox5(),this.flag=!0):6==this.randNum&&" "==this.b6?(this.checkBox6(),this.flag=!0):7==this.randNum&&" "==this.b7?(this.checkBox7(),this.flag=!0):8==this.randNum&&" "==this.b8?(this.checkBox8(),this.flag=!0):9==this.randNum&&" "==this.b9&&(this.checkBox9(),this.flag=!0);this.flag=!1}}checkBox1(){this.winner||" "==this.b1&&(this.turn?(this.b1="X",this.turn=!1):(this.b1="O",this.turn=!0),document.getElementById("but1").disabled=!0)}checkBox2(){this.winner||" "==this.b2&&(this.turn?(this.b2="X",this.turn=!1):(this.b2="O",this.turn=!0),document.getElementById("but2").disabled=!0)}checkBox3(){this.winner||" "==this.b3&&(this.turn?(this.b3="X",this.turn=!1):(this.b3="O",this.turn=!0),document.getElementById("but3").disabled=!0)}checkBox4(){this.winner||" "==this.b4&&(this.turn?(this.b4="X",this.turn=!1):(this.b4="O",this.turn=!0),document.getElementById("but4").disabled=!0)}checkBox5(){this.winner||" "==this.b5&&(this.turn?(this.b5="X",this.turn=!1):(this.b5="O",this.turn=!0),document.getElementById("but5").disabled=!0)}checkBox6(){this.winner||" "==this.b6&&(this.turn?(this.b6="X",this.turn=!1):(this.b6="O",this.turn=!0),document.getElementById("but6").disabled=!0)}checkBox7(){this.winner||" "==this.b7&&(this.turn?(this.b7="X",this.turn=!1):(this.b7="O",this.turn=!0),document.getElementById("but7").disabled=!0)}checkBox8(){this.winner||" "==this.b8&&(this.turn?(this.b8="X",this.turn=!1):(this.b8="O",this.turn=!0),document.getElementById("but8").disabled=!0)}checkBox9(){this.winner||" "==this.b9&&(this.turn?(this.b9="X",this.turn=!1):(this.b9="O",this.turn=!0),document.getElementById("but9").disabled=!0)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-contact"]],decls:76,vars:10,consts:[[1,"container"],[1,"wrapper"],[1,"company-info"],["fontIcon","place"],["fontIcon","link"],["href","https://www.linkedin.com/in/sam-brey-291041261/","target","_blank"],["fontIcon","label_important"],[1,"contact"],[1,"alert"],[1,"alert2"],[1,"alert3"],[1,"alert4"],["id","contactForm"],["type","text","name","name","id","name","required",""],["type","text","name","company","id","company"],["for","email"],["type","email","name","email","id","email","required",""],["type","text","name","phone","id","phone"],[1,"full"],["name","message","rows","5","id","message"],["type","submit",3,"click"],[1,"allInputs"],[1,"test"],["id","but1","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but2","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but3","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but4","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but5","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but6","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but7","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but8","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],["id","but9","mat-raised-button","","color","primary",1,"inGameButton",3,"click"],[4,"ngIf"],["mat-raised-button","","color","primary",1,"resetButton",3,"click"]],template:function(e,i){1&e&&(w(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),I(4,"Complete form to send me a message!"),C(),w(5,"ul")(6,"li"),Ne(7,"mat-icon",3),I(8," United States"),C(),w(9,"li"),Ne(10,"mat-icon",4),w(11,"a",5),I(12," LinkedIn"),C()(),w(13,"li"),Ne(14,"mat-icon",6),I(15," * = required"),C()()(),w(16,"div",7)(17,"div",8),I(18,"Your message has been sent"),C(),w(19,"div",9),I(20,"Sending your message..."),C(),w(21,"div",10),I(22,"Missing required input"),C(),w(23,"div",11),I(24,"Invalid Email Input"),C(),w(25,"form",12)(26,"p")(27,"label"),I(28,"Name*"),C(),Ne(29,"input",13),C(),w(30,"p")(31,"label"),I(32,"Company"),C(),Ne(33,"input",14),C(),w(34,"p")(35,"label",15),I(36,"Email Address*"),C(),Ne(37,"input",16),C(),w(38,"p")(39,"label"),I(40,"Phone Number"),C(),Ne(41,"input",17),C(),w(42,"p",18)(43,"label"),I(44,"Message"),C(),Ne(45,"textarea",19),C(),w(46,"p",18)(47,"button",20),H("click",function(){return i.submitForm()}),I(48,"Submit"),C()()()()()(),w(49,"h3"),I(50,"I didn't know what else to put here is enjoy a game of Tic-Tac-Toe against a super smart AI"),C(),w(51,"div",21)(52,"div",22)(53,"button",23),H("click",function(){return i.checkBox1(),i.winCheck(),i.runAI(),i.winCheck()}),I(54),C(),w(55,"button",24),H("click",function(){return i.checkBox2(),i.winCheck(),i.runAI(),i.winCheck()}),I(56),C(),w(57,"button",25),H("click",function(){return i.checkBox3(),i.winCheck(),i.runAI(),i.winCheck()}),I(58),C()(),w(59,"div",22)(60,"button",26),H("click",function(){return i.checkBox4(),i.winCheck(),i.runAI(),i.winCheck()}),I(61),C(),w(62,"button",27),H("click",function(){return i.checkBox5(),i.winCheck(),i.runAI(),i.winCheck()}),I(63),C(),w(64,"button",28),H("click",function(){return i.checkBox6(),i.winCheck(),i.runAI(),i.winCheck()}),I(65),C()(),w(66,"div",22)(67,"button",29),H("click",function(){return i.checkBox7(),i.winCheck(),i.runAI(),i.winCheck()}),I(68),C(),w(69,"button",30),H("click",function(){return i.checkBox8(),i.winCheck(),i.runAI(),i.winCheck()}),I(70),C(),w(71,"button",31),H("click",function(){return i.checkBox9(),i.winCheck(),i.runAI(),i.winCheck()}),I(72),C()(),ze(73,tye,4,1,"div",32),w(74,"button",33),H("click",function(){return i.reset()}),I(75,"Reset"),C()()),2&e&&(W(54),ot(i.b1),W(2),ot(i.b2),W(2),ot(i.b3),W(3),ot(i.b4),W(2),ot(i.b5),W(2),ot(i.b6),W(3),ot(i.b7),W(2),ot(i.b8),W(2),ot(i.b9),W(1),oe("ngIf",i.winner))},dependencies:[pl,co,ix,Kv,vf,sH],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box}body[_ngcontent-%COMP%]{background:#92bde7;color:#485e74;line-height:1.6;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;padding:1em}.container[_ngcontent-%COMP%]{max-width:1170px;margin-left:auto;margin-right:auto;padding:1em}ul[_ngcontent-%COMP%]{list-style:none;padding:0}.brand[_ngcontent-%COMP%]{text-align:center}.brand[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff}.wrapper[_ngcontent-%COMP%]{box-shadow:0 0 20px #485e74b3}.wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1em}.company-info[_ngcontent-%COMP%]{background:#c9e6ff}.company-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .company-info[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{text-align:center;margin:0 0 1rem}.contact[_ngcontent-%COMP%]{background:#f9feff}.contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-gap:20px}.contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block}.contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .full[_ngcontent-%COMP%]{grid-column:1 / 3}.contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:1em;border:1px solid #c9e6ff}.contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#c9e6ff;border:0;text-transform:uppercase}.contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .contact[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{background:#92bde7;color:#fff;outline:0;transition:background-color 2s ease-out}.alert[_ngcontent-%COMP%]{text-align:center;padding:10px;background:#79c879;color:#fff;margin-bottom:10px;display:none}.alert2[_ngcontent-%COMP%]{text-align:center;padding:10px;background:#04b0ff;color:#fff;margin-bottom:10px;display:none}.alert3[_ngcontent-%COMP%], .alert4[_ngcontent-%COMP%]{text-align:center;padding:10px;background:#ff0000;color:#fff;margin-bottom:10px;display:none}@media (min-width:700px){.wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr}.wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:2em}.company-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .company-info[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .brand[_ngcontent-%COMP%]{text-align:left}}h2[_ngcontent-%COMP%], .allInputs[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center}li[_ngcontent-%COMP%]{margin-top:10%}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}.test[_ngcontent-%COMP%]{position:relative;max-width:100%}.inGameButton[_ngcontent-%COMP%]{width:30%;height:25%;margin:5px;border:1px solid gray;border-radius:6px;font-size:70px;text-align:center;padding-bottom:100px;padding-top:100px;color:#0ff}.resetButton[_ngcontent-%COMP%]{width:150px;padding-bottom:50px;padding-top:50px}h4[_ngcontent-%COMP%]{font-size:50px;margin-top:5px}"]}),n})();function iye(n,t){1&n&&(w(0,"h3"),I(1,"Search not possible. Walls block the path"),C())}let sye=(()=>{class n{constructor(){this.h1=!1,this.h2=!1,this.h3=!1,this.h4=!1,this.startButtonCounter=0,this.endButtonCounter=0,this.startButtonPlace=0,this.endButtonPlace=0,this.found=!1,this.notPossible=!1,this.endPathFound=!1,this.allButtons=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],this.tempYellowSquares=[],this.tempCountYellowStart=0,this.tempCountYellowEnd=0,this.allWallSquares=[],this.tempEndPath=[],this.prioDoublePositive=!1,this.prioPositiveNegative=!1,this.prioNegativePositive=!1,this.prioDoubleNegative=!1,this.leftOnly=!1,this.rightOnly=!1,this.upOnly=!1,this.downOnly=!1}ngOnInit(){for(let e=0;e<this.allButtons.length;e++)document.getElementById("b"+this.allButtons[e]).style.backgroundColor="white"}h1Pressed(){this.h1=!0,this.h2=!1,this.h3=!1,this.h4=!1,document.getElementById("h1").style.backgroundColor="darkblue",document.getElementById("h2").style.backgroundColor="blue",document.getElementById("h3").style.backgroundColor="blue",document.getElementById("h4").style.backgroundColor="blue"}h2Pressed(){this.h1=!1,this.h2=!0,this.h3=!1,this.h4=!1,document.getElementById("h1").style.backgroundColor="blue",document.getElementById("h2").style.backgroundColor="darkblue",document.getElementById("h3").style.backgroundColor="blue",document.getElementById("h4").style.backgroundColor="blue"}h3Pressed(){this.h1=!1,this.h2=!1,this.h3=!0,this.h4=!1,document.getElementById("h1").style.backgroundColor="blue",document.getElementById("h2").style.backgroundColor="blue",document.getElementById("h3").style.backgroundColor="darkblue",document.getElementById("h4").style.backgroundColor="blue"}h4Pressed(){this.h1=!1,this.h2=!1,this.h3=!1,this.h4=!0,document.getElementById("h1").style.backgroundColor="blue",document.getElementById("h2").style.backgroundColor="blue",document.getElementById("h3").style.backgroundColor="blue",document.getElementById("h4").style.backgroundColor="darkblue",this.search()}h5Pressed(){this.h1=!1,this.h2=!1,this.h3=!1,this.h4=!1,this.allWallSquares=[],this.notPossible=!1,this.endPathFound=!1,this.startButtonCounter=0,this.endButtonCounter=0,this.startButtonPlace=0,this.endButtonPlace=0,this.found=!1,this.tempCountYellowEnd=0,this.tempYellowSquares=[],this.tempCountYellowStart=0,this.tempCountYellowEnd=0,this.allWallSquares=[],this.tempEndPath=[],this.prioDoubleNegative=!1,this.prioDoublePositive=!1,this.prioNegativePositive=!1,this.prioPositiveNegative=!1,this.leftOnly=!1,this.rightOnly=!1,this.upOnly=!1,this.downOnly=!1,document.getElementById("h1").style.backgroundColor="blue",document.getElementById("h2").style.backgroundColor="blue",document.getElementById("h3").style.backgroundColor="blue",document.getElementById("h4").style.backgroundColor="blue",document.getElementById("h5").style.backgroundColor="blue";for(let e=0;e<this.allButtons.length;e++)document.getElementById("b"+this.allButtons[e]).style.backgroundColor="white"}search(){var e=this;return Q(function*(){for(let i=0;i<e.allButtons.length;i++)"darkgreen"==document.getElementById("b"+e.allButtons[i]).style.backgroundColor&&(e.startButtonPlace=i,e.startButtonPlace+=1),"red"==document.getElementById("b"+e.allButtons[i]).style.backgroundColor&&(e.endButtonPlace=i,e.endButtonPlace+=1),"black"==document.getElementById("b"+e.allButtons[i]).style.backgroundColor&&e.allWallSquares.push(i+1);for(e.found=e.firstSearchOutcome(),yield new Promise(i=>setTimeout(i,500)),e.found||(e.secondSearchOutcome(),e.found=e.checkIfEndNextToYellow()),yield new Promise(i=>setTimeout(i,500));!e.found;){e.tempYellowSquares=[];for(let i=0;i<e.allButtons.length;i++)"yellow"==document.getElementById("b"+e.allButtons[i]).style.backgroundColor&&(e.tempYellowSquares.push(e.allButtons[i]),e.tempCountYellowStart+=1);if(e.tempCountYellowStart>e.tempCountYellowEnd){for(let i=0;i<e.tempYellowSquares.length;i++)e.placingYellowOnThirdSearch(e.tempYellowSquares[i]);e.tempCountYellowEnd=e.tempCountYellowStart,e.tempCountYellowStart=0,e.found=e.checkIfEndNextToYellow()}else e.found=!0,e.notPossible=!0;yield new Promise(i=>setTimeout(i,500))}if(!e.notPossible){let i=e.endButtonPlace%10,s=(e.endButtonPlace-e.endButtonPlace%10)/10+1,r=e.startButtonPlace%10,o=(e.startButtonPlace-e.startButtonPlace%10)/10+1;r-i==0&&o-s>0?e.upOnly=!0:r-i==0&&o-s<0?e.downOnly=!0:r-i>0&&o-s==0?e.rightOnly=!0:r-i<0&&o-s==0?e.leftOnly=!0:r-i>=0&&o-s>=0?e.prioDoublePositive=!0:r-i<=0&&o-s<=0?e.prioDoubleNegative=!0:r-i>=0&&o-s<=0?e.prioPositiveNegative=!0:r-i<=0&&o-s>=0&&(e.prioNegativePositive=!0);let a=e.getNextPossibleYellow(e.endButtonPlace),l=0;for(;!e.endPathFound;)-2==a?e.endPathFound=!0:-1==a?(a=e.getNextPossibleYellow(e.endButtonPlace),e.tempEndPath=[],e.tempEndPath.push(a)):(e.tempEndPath.push(a),s=(a-a%10)/10+1,i=a%10!=0?a%10:10,r-i==0&&o-s>0?(e.prioDoubleNegative=!1,e.prioDoublePositive=!1,e.prioNegativePositive=!1,e.prioPositiveNegative=!1,e.upOnly=!1,e.downOnly=!0,e.leftOnly=!1,e.rightOnly=!1):r-i==0&&o-s<0?(e.prioDoubleNegative=!1,e.prioDoublePositive=!1,e.prioNegativePositive=!1,e.prioPositiveNegative=!1,e.upOnly=!0,e.downOnly=!1,e.leftOnly=!1,e.rightOnly=!1):r-i>0&&o-s==0?(e.prioDoubleNegative=!1,e.prioDoublePositive=!1,e.prioNegativePositive=!1,e.prioPositiveNegative=!1,e.upOnly=!1,e.downOnly=!1,e.leftOnly=!1,e.rightOnly=!0):r-i<0&&o-s==0?(e.prioDoubleNegative=!1,e.prioDoublePositive=!1,e.prioNegativePositive=!1,e.prioPositiveNegative=!1,e.upOnly=!1,e.downOnly=!1,e.leftOnly=!0,e.rightOnly=!1):r-i>=0&&o-s>=0?(e.prioDoubleNegative=!1,e.prioDoublePositive=!0,e.prioNegativePositive=!1,e.prioPositiveNegative=!1,e.upOnly=!1,e.downOnly=!1,e.leftOnly=!1,e.rightOnly=!1):r-i<=0&&o-s<=0?(e.prioDoubleNegative=!0,e.prioDoublePositive=!1,e.prioNegativePositive=!1,e.prioPositiveNegative=!1,e.upOnly=!1,e.downOnly=!1,e.leftOnly=!1,e.rightOnly=!1):r-i>=0&&o-s<=0?(e.prioDoubleNegative=!1,e.prioDoublePositive=!1,e.prioNegativePositive=!1,e.prioPositiveNegative=!0,e.upOnly=!1,e.downOnly=!1,e.leftOnly=!1,e.rightOnly=!1):r-i<=0&&o-s>=0&&(e.prioDoubleNegative=!1,e.prioDoublePositive=!1,e.prioNegativePositive=!0,e.prioPositiveNegative=!1,e.upOnly=!1,e.downOnly=!1,e.leftOnly=!1,e.rightOnly=!1),a=e.getNextMainPoint(a)),l++;for(let c=0;c<e.allButtons.length;c++)document.getElementById("b"+e.allButtons[c]).style.backgroundColor="white";document.getElementById("b"+e.startButtonPlace).style.backgroundColor="darkgreen",document.getElementById("b"+e.endButtonPlace).style.backgroundColor="red";for(let c=0;c<e.allWallSquares.length;c++)document.getElementById("b"+e.allWallSquares[c]).style.backgroundColor="black";for(let c=0;c<e.tempEndPath.length;c++)document.getElementById("b"+e.tempEndPath[c]).style.backgroundColor="yellow",yield new Promise(u=>setTimeout(u,400))}})()}getNextMainPoint(e){let i=!1,s=!1,r=!1,o=!1;if((e+1)%10!=1&&"darkgreen"==document.getElementById("b"+(e+1)).style.backgroundColor||e%10!=1&&"darkgreen"==document.getElementById("b"+(e-1)).style.backgroundColor||e-10>0&&"darkgreen"==document.getElementById("b"+(e-10)).style.backgroundColor||e+10<101&&"darkgreen"==document.getElementById("b"+(e+10)).style.backgroundColor)return-2;if(this.upOnly){for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10;for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1;for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10}else if(this.downOnly){for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10;for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1;for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10}else if(this.leftOnly){for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1;for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10;for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10}else if(this.rightOnly){for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10;for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1;for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10}else if(this.prioDoublePositive){for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10;for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1;for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10}else if(this.prioDoubleNegative){for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10;for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1;for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10}else if(this.prioNegativePositive){for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10;for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1;for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10}else if(this.prioPositiveNegative){for(let a=0;a<this.tempEndPath.length;a++)(e+1)%10!=1&&e+1==this.tempEndPath[a]&&(i=!0);if(!i&&(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor)return e+1;for(let a=0;a<this.tempEndPath.length;a++)e+10<101&&e+10==this.tempEndPath[a]&&(r=!0);if(!r&&e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor)return e+10;for(let a=0;a<this.tempEndPath.length;a++)e-10>0&&e-10==this.tempEndPath[a]&&(o=!0);if(!o&&e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor)return e-10;for(let a=0;a<this.tempEndPath.length;a++)e%10!=1&&e-1==this.tempEndPath[a]&&(s=!0);if(!s&&e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor)return e-1}return document.getElementById("b"+e).style.backgroundColor="white",-1}getNextPossibleYellow(e){return(e+1)%10!=1&&"yellow"==document.getElementById("b"+(e+1)).style.backgroundColor?e+1:e%10!=1&&"yellow"==document.getElementById("b"+(e-1)).style.backgroundColor?e-1:e-10>0&&"yellow"==document.getElementById("b"+(e-10)).style.backgroundColor?e-10:e+10<101&&"yellow"==document.getElementById("b"+(e+10)).style.backgroundColor?e+10:(e+1)%10!=1&&"darkgreen"==document.getElementById("b"+(e+1)).style.backgroundColor||e%10!=1&&"darkgreen"==document.getElementById("b"+(e-1)).style.backgroundColor||e-10>0&&"darkgreen"==document.getElementById("b"+(e-10)).style.backgroundColor||e+10<101&&"darkgreen"==document.getElementById("b"+(e+10)).style.backgroundColor?-2:-1}placingYellowOnThirdSearch(e){(e+1)%10!=1&&"white"==document.getElementById("b"+(e+1)).style.backgroundColor&&"black"!=document.getElementById("b"+(e+1)).style.backgroundColor&&(document.getElementById("b"+(e+1)).style.backgroundColor="yellow"),e%10!=1&&"white"==document.getElementById("b"+(e-1)).style.backgroundColor&&"black"!=document.getElementById("b"+(e-1)).style.backgroundColor&&(document.getElementById("b"+(e-1)).style.backgroundColor="yellow"),e-10>0&&"white"==document.getElementById("b"+(e-10)).style.backgroundColor&&"black"!=document.getElementById("b"+(e-10)).style.backgroundColor&&(document.getElementById("b"+(e-10)).style.backgroundColor="yellow"),e+10<101&&"white"==document.getElementById("b"+(e+10)).style.backgroundColor&&"black"!=document.getElementById("b"+(e+10)).style.backgroundColor&&(document.getElementById("b"+(e+10)).style.backgroundColor="yellow")}checkIfEndNextToYellow(){return(this.endButtonPlace+1)%10!=1&&"yellow"==document.getElementById("b"+(this.endButtonPlace+1)).style.backgroundColor||this.endButtonPlace%10!=1&&"yellow"==document.getElementById("b"+(this.endButtonPlace-1)).style.backgroundColor||this.endButtonPlace-10>0&&"yellow"==document.getElementById("b"+(this.endButtonPlace-10)).style.backgroundColor||this.endButtonPlace+10<101&&"yellow"==document.getElementById("b"+(this.endButtonPlace+10)).style.backgroundColor}secondSearchOutcome(){(this.startButtonPlace+1)%10!=1&&"black"!=document.getElementById("b"+(this.startButtonPlace+1)).style.backgroundColor&&(document.getElementById("b"+(this.startButtonPlace+1)).style.backgroundColor="yellow"),this.startButtonPlace%10!=1&&"black"!=document.getElementById("b"+(this.startButtonPlace-1)).style.backgroundColor&&(document.getElementById("b"+(this.startButtonPlace-1)).style.backgroundColor="yellow"),this.startButtonPlace-10>0&&"black"!=document.getElementById("b"+(this.startButtonPlace-10)).style.backgroundColor&&(document.getElementById("b"+(this.startButtonPlace-10)).style.backgroundColor="yellow"),this.startButtonPlace+10<101&&"black"!=document.getElementById("b"+(this.startButtonPlace+10)).style.backgroundColor&&(document.getElementById("b"+(this.startButtonPlace+10)).style.backgroundColor="yellow")}firstSearchOutcome(){return(this.endButtonPlace+1)%10!=1&&"darkgreen"==document.getElementById("b"+(this.endButtonPlace+1)).style.backgroundColor||this.endButtonPlace%10!=1&&"darkgreen"==document.getElementById("b"+(this.endButtonPlace-1)).style.backgroundColor||this.endButtonPlace-10>0&&"darkgreen"==document.getElementById("b"+(this.endButtonPlace-10)).style.backgroundColor||this.endButtonPlace+10<101&&"darkgreen"==document.getElementById("b"+(this.endButtonPlace+10)).style.backgroundColor}btnPress1(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b1").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b1").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b1").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress2(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b2").style.backgroundColor="darkgreen",this.startButtonCounter+=1,this.startButtonCounter+=1),this.h2&&(document.getElementById("b2").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b2").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress3(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b3").style.backgroundColor="darkgreen",this.startButtonCounter+=1,this.startButtonCounter+=1),this.h2&&(document.getElementById("b3").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b3").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress4(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b4").style.backgroundColor="darkgreen",this.startButtonCounter+=1,this.startButtonCounter+=1),this.h2&&(document.getElementById("b4").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b4").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress5(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b5").style.backgroundColor="darkgreen",this.startButtonCounter+=1,this.startButtonCounter+=1),this.h2&&(document.getElementById("b5").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b5").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress6(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b6").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b6").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b6").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress7(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b7").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b7").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b7").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress8(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b8").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b8").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b8").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress9(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b9").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b9").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b9").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress10(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b10").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b10").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b10").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress11(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b11").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b11").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b11").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress12(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b12").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b12").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b12").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress13(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b13").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b13").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b13").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress14(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b14").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b14").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b14").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress15(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b15").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b15").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b15").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress16(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b16").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b16").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b16").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress17(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b17").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b17").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b17").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress18(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b18").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b18").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b18").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress19(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b19").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b19").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b19").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress20(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b20").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b20").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b20").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress21(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b21").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b21").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b21").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress22(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b22").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b22").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b22").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress23(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b23").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b23").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b23").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress24(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b24").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b24").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b24").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress25(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b25").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b25").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b25").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress26(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b26").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b26").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b26").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress27(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b27").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b27").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b27").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress28(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b28").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b28").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b28").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress29(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b29").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b29").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b29").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress30(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b30").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b30").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b30").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress31(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b31").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b31").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b31").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress32(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b32").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b32").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b32").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress33(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b33").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b33").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b33").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress34(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b34").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b34").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b34").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress35(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b35").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b35").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b35").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress36(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b36").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b36").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b36").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress37(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b37").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b37").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b37").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress38(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b38").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b38").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b38").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress39(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b39").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b39").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b39").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress40(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b40").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b40").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b40").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress41(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b41").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b41").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b41").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress42(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b42").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b42").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b42").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress43(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b43").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b43").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b43").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress44(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b44").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b44").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b44").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress45(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b45").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b45").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b45").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress46(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b46").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b46").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b46").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress47(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b47").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b47").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b47").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress48(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b48").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b48").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b48").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress49(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b49").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b49").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b49").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress50(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b50").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b50").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b50").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress51(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b51").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b51").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b51").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress52(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b52").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b52").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b52").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress53(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b53").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b53").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b53").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress54(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b54").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b54").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b54").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress55(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b55").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b55").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b55").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress56(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b56").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b56").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b56").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress57(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b57").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b57").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b57").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress58(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b58").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b58").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b58").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress59(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b59").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b59").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b59").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress60(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b60").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b60").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b60").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress61(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b61").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b61").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b61").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress62(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b62").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b62").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b62").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress63(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b63").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b63").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b63").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress64(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b64").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b64").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b64").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress65(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b65").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b65").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b65").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress66(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b66").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b66").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b66").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress67(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b67").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b67").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b67").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress68(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b68").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b68").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b68").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress69(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b69").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b69").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b69").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress70(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b70").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b70").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b70").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress71(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b71").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b71").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b71").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress72(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b72").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b72").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b72").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress73(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b73").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b73").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b73").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress74(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b74").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b74").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b74").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress75(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b75").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b75").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b75").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress76(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b76").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b76").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b76").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress77(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b77").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b77").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b77").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress78(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b78").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b78").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b78").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress79(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b79").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b79").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b79").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress80(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b80").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b80").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b80").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress81(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b81").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b81").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b81").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress82(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b82").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b82").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b82").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress83(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b83").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b83").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b83").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress84(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b84").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b84").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b84").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress85(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b85").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b85").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b85").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress86(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b86").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b86").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b86").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress87(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b87").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b87").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b87").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress88(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b88").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b88").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b88").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress89(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b89").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b89").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b89").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress90(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b90").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b90").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b90").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress91(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b91").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b91").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b91").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress92(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b92").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b92").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b92").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress93(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b93").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b93").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b93").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress94(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b94").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b94").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b94").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress95(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b95").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b95").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b95").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress96(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b96").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b96").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b96").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress97(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b97").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b97").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b97").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress98(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b98").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b98").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b98").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress99(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b99").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b99").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b99").style.backgroundColor="red",this.endButtonCounter+=1)}btnPress100(){this.h1&&0==this.startButtonCounter&&(document.getElementById("b100").style.backgroundColor="darkgreen",this.startButtonCounter+=1),this.h2&&(document.getElementById("b100").style.backgroundColor="black"),this.h3&&0==this.endButtonCounter&&(document.getElementById("b100").style.backgroundColor="red",this.endButtonCounter+=1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-current-project-one"]],decls:115,vars:1,consts:[[1,"headerButtons"],["id","h1","mat-raised-button","","color","primary",1,"placeButton",3,"click"],["id","h2","mat-raised-button","","color","primary",1,"placeButton",3,"click"],["id","h3","mat-raised-button","","color","primary",1,"placeButton",3,"click"],["id","h4","mat-raised-button","","color","primary",1,"placeButton",3,"click"],["id","h5","mat-raised-button","","color","primary",1,"placeButton",3,"click"],[1,"grid-container"],["id","b1",1,"grid-item",3,"click"],["id","b2",1,"grid-item",3,"click"],["id","b3",1,"grid-item",3,"click"],["id","b4",1,"grid-item",3,"click"],["id","b5",1,"grid-item",3,"click"],["id","b6",1,"grid-item",3,"click"],["id","b7",1,"grid-item",3,"click"],["id","b8",1,"grid-item",3,"click"],["id","b9",1,"grid-item",3,"click"],["id","b10",1,"grid-item",3,"click"],["id","b11",1,"grid-item",3,"click"],["id","b12",1,"grid-item",3,"click"],["id","b13",1,"grid-item",3,"click"],["id","b14",1,"grid-item",3,"click"],["id","b15",1,"grid-item",3,"click"],["id","b16",1,"grid-item",3,"click"],["id","b17",1,"grid-item",3,"click"],["id","b18",1,"grid-item",3,"click"],["id","b19",1,"grid-item",3,"click"],["id","b20",1,"grid-item",3,"click"],["id","b21",1,"grid-item",3,"click"],["id","b22",1,"grid-item",3,"click"],["id","b23",1,"grid-item",3,"click"],["id","b24",1,"grid-item",3,"click"],["id","b25",1,"grid-item",3,"click"],["id","b26",1,"grid-item",3,"click"],["id","b27",1,"grid-item",3,"click"],["id","b28",1,"grid-item",3,"click"],["id","b29",1,"grid-item",3,"click"],["id","b30",1,"grid-item",3,"click"],["id","b31",1,"grid-item",3,"click"],["id","b32",1,"grid-item",3,"click"],["id","b33",1,"grid-item",3,"click"],["id","b34",1,"grid-item",3,"click"],["id","b35",1,"grid-item",3,"click"],["id","b36",1,"grid-item",3,"click"],["id","b37",1,"grid-item",3,"click"],["id","b38",1,"grid-item",3,"click"],["id","b39",1,"grid-item",3,"click"],["id","b40",1,"grid-item",3,"click"],["id","b41",1,"grid-item",3,"click"],["id","b42",1,"grid-item",3,"click"],["id","b43",1,"grid-item",3,"click"],["id","b44",1,"grid-item",3,"click"],["id","b45",1,"grid-item",3,"click"],["id","b46",1,"grid-item",3,"click"],["id","b47",1,"grid-item",3,"click"],["id","b48",1,"grid-item",3,"click"],["id","b49",1,"grid-item",3,"click"],["id","b50",1,"grid-item",3,"click"],["id","b51",1,"grid-item",3,"click"],["id","b52",1,"grid-item",3,"click"],["id","b53",1,"grid-item",3,"click"],["id","b54",1,"grid-item",3,"click"],["id","b55",1,"grid-item",3,"click"],["id","b56",1,"grid-item",3,"click"],["id","b57",1,"grid-item",3,"click"],["id","b58",1,"grid-item",3,"click"],["id","b59",1,"grid-item",3,"click"],["id","b60",1,"grid-item",3,"click"],["id","b61",1,"grid-item",3,"click"],["id","b62",1,"grid-item",3,"click"],["id","b63",1,"grid-item",3,"click"],["id","b64",1,"grid-item",3,"click"],["id","b65",1,"grid-item",3,"click"],["id","b66",1,"grid-item",3,"click"],["id","b67",1,"grid-item",3,"click"],["id","b68",1,"grid-item",3,"click"],["id","b69",1,"grid-item",3,"click"],["id","b70",1,"grid-item",3,"click"],["id","b71",1,"grid-item",3,"click"],["id","b72",1,"grid-item",3,"click"],["id","b73",1,"grid-item",3,"click"],["id","b74",1,"grid-item",3,"click"],["id","b75",1,"grid-item",3,"click"],["id","b76",1,"grid-item",3,"click"],["id","b77",1,"grid-item",3,"click"],["id","b78",1,"grid-item",3,"click"],["id","b79",1,"grid-item",3,"click"],["id","b80",1,"grid-item",3,"click"],["id","b81",1,"grid-item",3,"click"],["id","b82",1,"grid-item",3,"click"],["id","b83",1,"grid-item",3,"click"],["id","b84",1,"grid-item",3,"click"],["id","b85",1,"grid-item",3,"click"],["id","b86",1,"grid-item",3,"click"],["id","b87",1,"grid-item",3,"click"],["id","b88",1,"grid-item",3,"click"],["id","b89",1,"grid-item",3,"click"],["id","b90",1,"grid-item",3,"click"],["id","b91",1,"grid-item",3,"click"],["id","b92",1,"grid-item",3,"click"],["id","b93",1,"grid-item",3,"click"],["id","b94",1,"grid-item",3,"click"],["id","b95",1,"grid-item",3,"click"],["id","b96",1,"grid-item",3,"click"],["id","b97",1,"grid-item",3,"click"],["id","b98",1,"grid-item",3,"click"],["id","b99",1,"grid-item",3,"click"],["id","b100",1,"grid-item",3,"click"],[4,"ngIf"]],template:function(e,i){1&e&&(w(0,"div",0)(1,"button",1),H("click",function(){return i.h1Pressed()}),I(2,"Place Start"),C(),w(3,"button",2),H("click",function(){return i.h2Pressed()}),I(4,"Place Wall"),C(),w(5,"button",3),H("click",function(){return i.h3Pressed()}),I(6,"Place End"),C(),w(7,"button",4),H("click",function(){return i.h4Pressed()}),I(8,"Begin Search"),C(),w(9,"button",5),H("click",function(){return i.h5Pressed()}),I(10,"Clear Board"),C()(),w(11,"div",6)(12,"button",7),H("click",function(){return i.btnPress1()}),C(),w(13,"button",8),H("click",function(){return i.btnPress2()}),C(),w(14,"button",9),H("click",function(){return i.btnPress3()}),C(),w(15,"button",10),H("click",function(){return i.btnPress4()}),C(),w(16,"button",11),H("click",function(){return i.btnPress5()}),C(),w(17,"button",12),H("click",function(){return i.btnPress6()}),C(),w(18,"button",13),H("click",function(){return i.btnPress7()}),C(),w(19,"button",14),H("click",function(){return i.btnPress8()}),C(),w(20,"button",15),H("click",function(){return i.btnPress9()}),C(),w(21,"button",16),H("click",function(){return i.btnPress10()}),C(),w(22,"button",17),H("click",function(){return i.btnPress11()}),C(),w(23,"button",18),H("click",function(){return i.btnPress12()}),C(),w(24,"button",19),H("click",function(){return i.btnPress13()}),C(),w(25,"button",20),H("click",function(){return i.btnPress14()}),C(),w(26,"button",21),H("click",function(){return i.btnPress15()}),C(),w(27,"button",22),H("click",function(){return i.btnPress16()}),C(),w(28,"button",23),H("click",function(){return i.btnPress17()}),C(),w(29,"button",24),H("click",function(){return i.btnPress18()}),C(),w(30,"button",25),H("click",function(){return i.btnPress19()}),C(),w(31,"button",26),H("click",function(){return i.btnPress20()}),C(),w(32,"button",27),H("click",function(){return i.btnPress21()}),C(),w(33,"button",28),H("click",function(){return i.btnPress22()}),C(),w(34,"button",29),H("click",function(){return i.btnPress23()}),C(),w(35,"button",30),H("click",function(){return i.btnPress24()}),C(),w(36,"button",31),H("click",function(){return i.btnPress25()}),C(),w(37,"button",32),H("click",function(){return i.btnPress26()}),C(),w(38,"button",33),H("click",function(){return i.btnPress27()}),C(),w(39,"button",34),H("click",function(){return i.btnPress28()}),C(),w(40,"button",35),H("click",function(){return i.btnPress29()}),C(),w(41,"button",36),H("click",function(){return i.btnPress30()}),C(),w(42,"button",37),H("click",function(){return i.btnPress31()}),C(),w(43,"button",38),H("click",function(){return i.btnPress32()}),C(),w(44,"button",39),H("click",function(){return i.btnPress33()}),C(),w(45,"button",40),H("click",function(){return i.btnPress34()}),C(),w(46,"button",41),H("click",function(){return i.btnPress35()}),C(),w(47,"button",42),H("click",function(){return i.btnPress36()}),C(),w(48,"button",43),H("click",function(){return i.btnPress37()}),C(),w(49,"button",44),H("click",function(){return i.btnPress38()}),C(),w(50,"button",45),H("click",function(){return i.btnPress39()}),C(),w(51,"button",46),H("click",function(){return i.btnPress40()}),C(),w(52,"button",47),H("click",function(){return i.btnPress41()}),C(),w(53,"button",48),H("click",function(){return i.btnPress42()}),C(),w(54,"button",49),H("click",function(){return i.btnPress43()}),C(),w(55,"button",50),H("click",function(){return i.btnPress44()}),C(),w(56,"button",51),H("click",function(){return i.btnPress45()}),C(),w(57,"button",52),H("click",function(){return i.btnPress46()}),C(),w(58,"button",53),H("click",function(){return i.btnPress47()}),C(),w(59,"button",54),H("click",function(){return i.btnPress48()}),C(),w(60,"button",55),H("click",function(){return i.btnPress49()}),C(),w(61,"button",56),H("click",function(){return i.btnPress50()}),C(),w(62,"button",57),H("click",function(){return i.btnPress51()}),C(),w(63,"button",58),H("click",function(){return i.btnPress52()}),C(),w(64,"button",59),H("click",function(){return i.btnPress53()}),C(),w(65,"button",60),H("click",function(){return i.btnPress54()}),C(),w(66,"button",61),H("click",function(){return i.btnPress55()}),C(),w(67,"button",62),H("click",function(){return i.btnPress56()}),C(),w(68,"button",63),H("click",function(){return i.btnPress57()}),C(),w(69,"button",64),H("click",function(){return i.btnPress58()}),C(),w(70,"button",65),H("click",function(){return i.btnPress59()}),C(),w(71,"button",66),H("click",function(){return i.btnPress60()}),C(),w(72,"button",67),H("click",function(){return i.btnPress61()}),C(),w(73,"button",68),H("click",function(){return i.btnPress62()}),C(),w(74,"button",69),H("click",function(){return i.btnPress63()}),C(),w(75,"button",70),H("click",function(){return i.btnPress64()}),C(),w(76,"button",71),H("click",function(){return i.btnPress65()}),C(),w(77,"button",72),H("click",function(){return i.btnPress66()}),C(),w(78,"button",73),H("click",function(){return i.btnPress67()}),C(),w(79,"button",74),H("click",function(){return i.btnPress68()}),C(),w(80,"button",75),H("click",function(){return i.btnPress69()}),C(),w(81,"button",76),H("click",function(){return i.btnPress70()}),C(),w(82,"button",77),H("click",function(){return i.btnPress71()}),C(),w(83,"button",78),H("click",function(){return i.btnPress72()}),C(),w(84,"button",79),H("click",function(){return i.btnPress73()}),C(),w(85,"button",80),H("click",function(){return i.btnPress74()}),C(),w(86,"button",81),H("click",function(){return i.btnPress75()}),C(),w(87,"button",82),H("click",function(){return i.btnPress76()}),C(),w(88,"button",83),H("click",function(){return i.btnPress77()}),C(),w(89,"button",84),H("click",function(){return i.btnPress78()}),C(),w(90,"button",85),H("click",function(){return i.btnPress79()}),C(),w(91,"button",86),H("click",function(){return i.btnPress80()}),C(),w(92,"button",87),H("click",function(){return i.btnPress81()}),C(),w(93,"button",88),H("click",function(){return i.btnPress82()}),C(),w(94,"button",89),H("click",function(){return i.btnPress83()}),C(),w(95,"button",90),H("click",function(){return i.btnPress84()}),C(),w(96,"button",91),H("click",function(){return i.btnPress85()}),C(),w(97,"button",92),H("click",function(){return i.btnPress86()}),C(),w(98,"button",93),H("click",function(){return i.btnPress87()}),C(),w(99,"button",94),H("click",function(){return i.btnPress88()}),C(),w(100,"button",95),H("click",function(){return i.btnPress89()}),C(),w(101,"button",96),H("click",function(){return i.btnPress90()}),C(),w(102,"button",97),H("click",function(){return i.btnPress91()}),C(),w(103,"button",98),H("click",function(){return i.btnPress92()}),C(),w(104,"button",99),H("click",function(){return i.btnPress93()}),C(),w(105,"button",100),H("click",function(){return i.btnPress94()}),C(),w(106,"button",101),H("click",function(){return i.btnPress95()}),C(),w(107,"button",102),H("click",function(){return i.btnPress96()}),C(),w(108,"button",103),H("click",function(){return i.btnPress97()}),C(),w(109,"button",104),H("click",function(){return i.btnPress98()}),C(),w(110,"button",105),H("click",function(){return i.btnPress99()}),C(),w(111,"button",106),H("click",function(){return i.btnPress100()}),C()(),w(112,"p"),I(113,"Place an start block and an end block. Then hit begin search. This will find the path to get from the start to the end. Place walls to get more complex pathing!"),C(),ze(114,iye,2,0,"h3",107)),2&e&&(W(114),oe("ngIf",i.notPossible))},dependencies:[pl,co],styles:[".grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto auto auto auto auto auto auto auto;background-color:#000;padding:10px}.grid-item[_ngcontent-%COMP%]{background-color:#fff;border:1px solid rgba(0,0,0,.8);font-size:30px;padding:20px;text-align:center}.grid-item[_ngcontent-%COMP%]:hover{background-color:#ff0}.headerButtons[_ngcontent-%COMP%]{position:relative;text-align:center;max-width:100%}.placeButton[_ngcontent-%COMP%]:hover{background-color:#00008b}.placeButton[_ngcontent-%COMP%]{width:15%;height:25%;padding:10px;margin:5px;background-color:#00f}h3[_ngcontent-%COMP%]{margin-top:5%;text-align:center;font-size:5vw;color:gold}p[_ngcontent-%COMP%]{margin-top:3%;font-size:20px;text-align:center}"]}),n})(),rye=(()=>{class n{constructor(){this.firstNaming="LLLLLLLLLLLLLLLLL"}lol(){this.firstNaming="it workssssssssssss"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-copy-web"]],decls:49,vars:1,consts:[[1,"mainHeader"],[1,"mainHeader1"],["href","https://www.airbnb.com/","target","_blank",1,"mainHeader2"],[1,"mainHeader3"],["href","https://www.airbnb.com/","target","_blank",1,"mainHeader4"],[1,"topHeader1"],["href","https://www.airbnb.com/","target","_blank"],["src","assets/airbnbLogo.png","alt","airBnbLogo",1,"airLogo",2,"width","40px","height","40px"],[1,"topHeader1Left"],[1,"topHeader1Middle"],[1,"topHeader1Buttons"],[1,"topHeader1Text"],[1,"topHeader1Lines"],[1,"topHeader1Text",3,"click"],[1,"searchBtn"],[1,"searchBtnIcon"],[1,"test"],[1,"topHeader1Right"],[1,"topHeader1RightIcon"],["href","https://www.airbnb.com/host/homes","target","_blank"],[1,"topHeader1RightRight"]],template:function(e,i){1&e&&(w(0,"header")(1,"div",0)(2,"p",1),I(3,"Disclaimer: I don't own anything on this. Just using this for a personal project."),C(),w(4,"a",2),I(5,"Learn more"),C(),w(6,"p",3),I(7,"|"),C(),w(8,"a",4),I(9,"Watch the Rooms film"),C()()(),w(10,"body")(11,"div",5)(12,"a",6),Ne(13,"img",7),w(14,"p",8)(15,"b"),I(16,"airbnb"),C()()(),w(17,"button",9)(18,"div",10)(19,"button",11)(20,"b"),I(21,"Anywhere"),C()(),w(22,"p",12),I(23,"|"),C(),w(24,"button",13),H("click",function(){return i.lol()}),w(25,"b"),I(26,"Any week"),C()(),w(27,"p",12),I(28,"|"),C(),w(29,"button",11),I(30,"Add guests"),C(),w(31,"button",14)(32,"mat-icon",15),I(33,"search"),C()()()(),w(34,"div",16)(35,"button",17)(36,"mat-icon",18),I(37,"language"),C()()(),w(38,"a",19)(39,"button",20),I(40,"Airbnb your home"),C()()(),Ne(41,"hr"),w(42,"p"),I(43),C(),w(44,"h1"),I(45,"THIS PROJECT IS STILL BEING BUILT"),C()(),w(46,"footer")(47,"p"),I(48,"footerrr"),C()()),2&e&&(W(43),ln("lol",i.firstNaming,""))},dependencies:[sH],styles:["header[_ngcontent-%COMP%]{height:35%!important;background-color:#f1e4e4}.mainHeader[_ngcontent-%COMP%]{display:inline-block;font-size:30px;width:100%;background-color:#f1e4e4;height:35%!important}.mainHeader1[_ngcontent-%COMP%]{font-size:16px;float:left;margin-top:1.5%;width:40%;background-color:#f1e4e4;height:40px}.mainHeader2[_ngcontent-%COMP%], .mainHeader3[_ngcontent-%COMP%], .mainHeader4[_ngcontent-%COMP%]{color:#b84f4f;font-size:15px;float:right;height:40px;margin-top:1.5%;background-color:#f1e4e4}.mainHeader2[_ngcontent-%COMP%]{margin-top:1.5%;margin-right:5%}.mainHeader3[_ngcontent-%COMP%]{margin-left:1%;margin-right:1%;font-size:1.5em;opacity:.2}.topHeader1[_ngcontent-%COMP%]{width:100%;text-align:center;position:sticky;top:0;padding-top:20px;height:20%!important}.topHeader1Left[_ngcontent-%COMP%]{display:inline-block;float:left;font-size:22px;margin-top:.5%;margin-left:.5%}.airLogo[_ngcontent-%COMP%]{margin-left:5.5%;float:left}b[_ngcontent-%COMP%]{color:#b84f4f}.topHeader1Middle[_ngcontent-%COMP%]{display:inline-block;background-color:#fff;border:none;width:400px;border:2px solid black;border-radius:50px;height:50px}.topHeader1Right[_ngcontent-%COMP%]{border:none;border-radius:40px}.topHeader1RightIcon[_ngcontent-%COMP%]{border-radius:100%}.topHeader1RightRight[_ngcontent-%COMP%]{display:inline-block;float:right;font-size:1em;margin-top:.1%;margin-left:2%;border:none;border-radius:40px}.test[_ngcontent-%COMP%]{display:inline-block;float:right;font-size:1em;margin-top:.1%;margin-left:1%;margin-right:5%;border-radius:40px}.topHeader1Right[_ngcontent-%COMP%]:hover, .topHeader1RightRight[_ngcontent-%COMP%]:hover, .topHeader1RightIcon[_ngcontent-%COMP%]:hover{background-color:#faebeb;cursor:pointer}.topHeader1Buttons[_ngcontent-%COMP%]{width:90%;display:inline;font-size:9px}.topHeader1Text[_ngcontent-%COMP%]:hover{cursor:pointer}.topHeader1Text[_ngcontent-%COMP%]{display:inline-block;border:none;margin-left:10px;margin-right:10px;height:5px;font-size:1.5em}.topHeader1Lines[_ngcontent-%COMP%]{display:inline-block;border:none;margin-left:10px;margin-right:10px;font-size:3.5em;opacity:.2}.searchBtn[_ngcontent-%COMP%]{background-color:#c46868;border:none;font-size:16px;cursor:pointer;border-radius:50%;height:90%}.searchBtnIcon[_ngcontent-%COMP%]{background-color:#c46868;color:#fff;height:50%}hr[_ngcontent-%COMP%]{width:100%;height:1px;margin-bottom:100px;opacity:.2}a[_ngcontent-%COMP%]:hover{text-decoration:underline}a[_ngcontent-%COMP%]{text-decoration:none}*[_ngcontent-%COMP%]{background-color:#fff;height:100%;color:#000}"]}),n})();function oye(n,t){1&n&&(w(0,"div")(1,"h1"),I(2,"YOU HAVE LOST ON THE EASIEST"),C(),w(3,"h1"),I(4,"MINESWEEPER POSSIBLE!"),C(),w(5,"h1"),I(6,"Click Restart to Restart"),C()())}function aye(n,t){1&n&&(w(0,"div")(1,"h1"),I(2,"YOU WON"),C(),w(3,"h1"),I(4,"Happy 3 months <3"),C(),w(5,"h1"),I(6,"Turn sound on and enjoy the pictures"),C()())}function lye(n,t){if(1&n&&(w(0,"div")(1,"h1"),I(2,"<3"),C(),w(3,"h1"),Ne(4,"img",6)(5,"img",6)(6,"img",6),C(),w(7,"h1"),I(8,"<3"),C()()),2&n){const e=Ge();W(4),Eh("src",e.allPictures[e.indexOfPhoto],dh),W(1),Eh("src",e.allPictures[e.indexOfPhoto+1],dh),W(1),Eh("src",e.allPictures[e.indexOfPhoto+2],dh)}}function cye(n,t){if(1&n){const e=to();w(0,"div")(1,"button",7),H("click",function(){const r=Un(e).$implicit;return Wn(Ge().btnPress(r))}),I(2),C()()}if(2&n){const e=t.$implicit,i=Ge();W(1),Eh("id",e),oe("disabled",i.endGameIfPlacedOnMine),W(1),ot(i.allButtonsStrings[e])}}let uye=(()=>{class n{constructor(){this.allButtons=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239],this.allButtonsStrings=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],this.allMineButtons=[7,13,25,26,28,32,34,35,44,45,49,50,51,55,56,64,76,84,104,124,125,145,146,166,167,187,188,208,209,211,212,192,193,173,174,154,155,135,136,116,96,230],this.allOuterNumberLeftButtons=[5,6,23,24,43,63,83,103,123,144,165,186,207,229,228,227,0,1,2,3,4,20,21,22,40,41,42,60,61,62,80,81,82,100,101,102,120,121,122,140,141,142,143,160,161,162,163,164,180,181,182,183,184,185,200,201,202,203,204,205,206,220,221,222,223,224,225,226,227],this.allOuterNumberRightButtons=[14,15,16,36,37,57,77,97,117,137,157,156,176,175,196,215,195,194,214,213,231,232,233,234,235,236,237,238,239,216,217,218,219,197,198,199,177,178,179,158,159,138,139,118,119,98,99,78,79,58,59,38,39,17,18,19],this.allInnerNumberButtons=[27,46,47,48,68,69,70,71,72,52,53,54,33,74,75,95,115,114,134,133,153,152,171,172,191,190,189,210,169,168,148,147,127,126,106,105,85,65,66,67,87,86,88,89,90,91,92,93,73,94,113,112,111,110,109,108,107,128,129,130,131,132,151,150,170,149],this.allUpperOuterNumberButtons=[29,30,31,8,9,10,11,12],this.flag=!1,this.numberOfMines=1,this.endGameIfPlacedOnMine=!1,this.gameWin=!1,this.gameWin2=!0,this.indexOfPhoto=0,this.audio=new Audio("assets/leahFiles/musicNCS.mp3"),this.allPictures=["assets/leahFiles/img1.JPG","assets/leahFiles/img2.jpg","assets/leahFiles/img3.JPG","assets/leahFiles/img4.JPG","assets/leahFiles/img5.JPG","assets/leahFiles/img6.jpg","assets/leahFiles/img7.JPG","assets/leahFiles/img8.jpg","assets/leahFiles/img9.jpg","assets/leahFiles/img10.JPG","assets/leahFiles/img11.JPG","assets/leahFiles/img12.jpg","assets/leahFiles/img13.jpg","assets/leahFiles/img14.jpg","assets/leahFiles/img15.JPG","assets/leahFiles/img16.JPG","assets/leahFiles/img17.JPG","assets/leahFiles/img18.jpg","assets/leahFiles/img19.jpg","assets/leahFiles/img20.JPG","assets/leahFiles/img21.JPG","assets/leahFiles/img22.jpg","assets/leahFiles/img23.JPG","assets/leahFiles/img24.jpg","assets/leahFiles/img25.jpg","assets/leahFiles/img26.jpg","assets/leahFiles/img27.jpg","assets/leahFiles/img28.jpg","assets/leahFiles/img29.JPG","assets/leahFiles/img30.JPG","assets/leahFiles/img31.JPG","assets/leahFiles/img32.JPG","assets/leahFiles/img33.jpg","assets/leahFiles/img34.jpg"]}h1Pressed(){this.flag=!this.flag}h2Pressed(){for(var e of this.allButtons)document.getElementById(""+e).style.backgroundColor="pink";for(let i=0;i<this.allButtonsStrings.length;i++)this.allButtonsStrings[i]="";this.endGameIfPlacedOnMine=!1}checkIfplaceOnMine(e){for(var i of this.allMineButtons)if(e==i)return!0;return!1}placeFromUserInput(e){let i=!1;if(!i)for(var s of this.allOuterNumberLeftButtons)s==e&&(this.uncheckAllLeft(),i=!0);if(!i)for(var s of this.allOuterNumberRightButtons)s==e&&(this.uncheckAllRight(),i=!0);if(!i)for(var s of this.allInnerNumberButtons)s==e&&(this.uncheckAllInner(),i=!0);if(!i)for(var s of this.allUpperOuterNumberButtons)s==e&&(this.uncheckAllUpper(),i=!0)}checkIfAllMinesDone(){for(var e of this.allMineButtons)if("red"!=document.getElementById(""+e).style.backgroundColor)return!1;return!0}runVideo(){this.waitForPicturesReading()}waitForPicturesReading(){var e=this;return Q(function*(){yield new Promise(i=>setTimeout(i,1e4)),e.audio.play(),e.gameWin2=!1;for(let i=0;i<300;i++)yield new Promise(s=>setTimeout(s,4e3)),e.indexOfPhoto+=1,e.indexOfPhoto>=32&&(e.indexOfPhoto=0)})()}btnPress(e){this.flag||(this.endGameIfPlacedOnMine=this.checkIfplaceOnMine(e)),"f"==this.allButtonsStrings[e]?(this.allButtonsStrings[e]="",document.getElementById(""+e).style.backgroundColor="pink"):this.flag&&"grey"!=document.getElementById(""+e).style.backgroundColor?(document.getElementById(""+e).style.backgroundColor="red",this.allButtonsStrings[e]="f",this.gameWin=this.checkIfAllMinesDone(),this.gameWin&&this.runVideo()):this.placeFromUserInput(e)}uncheckAllLeft(){for(var e of this.allOuterNumberLeftButtons)document.getElementById(""+e).style.backgroundColor="grey",this.allButtonsStrings[e]="",4==e?this.allButtonsStrings[4]="1":5==e?this.allButtonsStrings[5]="2":6==e?this.allButtonsStrings[6]="3":23==e?this.allButtonsStrings[23]="1":24==e?this.allButtonsStrings[24]="3":43==e?this.allButtonsStrings[43]="2":63==e?this.allButtonsStrings[63]="3":83==e?this.allButtonsStrings[83]="3":103==e?this.allButtonsStrings[103]="3":123==e?this.allButtonsStrings[123]="2":144==e?this.allButtonsStrings[144]="3":143==e?this.allButtonsStrings[143]="1":164==e?this.allButtonsStrings[164]="1":165==e?this.allButtonsStrings[165]="3":185==e?this.allButtonsStrings[185]="1":186==e?this.allButtonsStrings[186]="3":206==e?this.allButtonsStrings[206]="1":207==e?this.allButtonsStrings[207]="3":227==e?this.allButtonsStrings[227]="1":228==e?this.allButtonsStrings[228]="2":229==e&&(this.allButtonsStrings[229]="3")}uncheckAllRight(){for(var e of this.allOuterNumberRightButtons)document.getElementById(""+e).style.backgroundColor="grey",this.allButtonsStrings[e]="",14==e?this.allButtonsStrings[14]="3":15==e?this.allButtonsStrings[15]="2":16==e?this.allButtonsStrings[16]="1":36==e?this.allButtonsStrings[36]="3":37==e?this.allButtonsStrings[37]="1":57==e?this.allButtonsStrings[57]="2":77==e?this.allButtonsStrings[77]="3":97==e?this.allButtonsStrings[97]="3":117==e?this.allButtonsStrings[117]="3":137==e?this.allButtonsStrings[137]="2":157==e?this.allButtonsStrings[157]="1":156==e?this.allButtonsStrings[156]="3":176==e?this.allButtonsStrings[176]="1":175==e?this.allButtonsStrings[175]="3":195==e?this.allButtonsStrings[195]="1":194==e?this.allButtonsStrings[194]="3":214==e?this.allButtonsStrings[214]="1":213==e?this.allButtonsStrings[213]="3":233==e?this.allButtonsStrings[233]="1":232==e?this.allButtonsStrings[232]="2":231==e&&(this.allButtonsStrings[231]="3")}uncheckAllInner(){for(var e of this.allInnerNumberButtons)document.getElementById(""+e).style.backgroundColor="grey",this.allButtonsStrings[e]="",27==e?this.allButtonsStrings[27]="3":46==e?this.allButtonsStrings[46]="3":47==e?this.allButtonsStrings[47]="2":48==e?this.allButtonsStrings[48]="2":68==e?this.allButtonsStrings[68]="1":69==e?this.allButtonsStrings[69]="2":70==e?this.allButtonsStrings[70]="3":71==e?this.allButtonsStrings[71]="2":72==e?this.allButtonsStrings[72]="1":52==e?this.allButtonsStrings[52]="2":53==e?this.allButtonsStrings[53]="2":54==e?this.allButtonsStrings[54]="3":33==e?this.allButtonsStrings[33]="3":74==e?this.allButtonsStrings[74]="1":75==e?this.allButtonsStrings[75]="4":95==e?this.allButtonsStrings[95]="3":115==e?this.allButtonsStrings[115]="4":114==e?this.allButtonsStrings[114]="1":134==e?this.allButtonsStrings[134]="3":133==e?this.allButtonsStrings[133]="1":153==e?this.allButtonsStrings[153]="3":152==e?this.allButtonsStrings[152]="1":172==e?this.allButtonsStrings[172]="3":171==e?this.allButtonsStrings[171]="1":191==e?this.allButtonsStrings[191]="3":190==e?this.allButtonsStrings[190]="2":189==e?this.allButtonsStrings[189]="3":210==e?this.allButtonsStrings[210]="3":169==e?this.allButtonsStrings[169]="1":168==e?this.allButtonsStrings[168]="3":148==e?this.allButtonsStrings[148]="1":147==e?this.allButtonsStrings[147]="3":127==e?this.allButtonsStrings[127]="1":126==e?this.allButtonsStrings[126]="3":106==e?this.allButtonsStrings[106]="1":105==e?this.allButtonsStrings[105]="4":85==e?this.allButtonsStrings[85]="3":65==e?this.allButtonsStrings[65]="4":66==e&&(this.allButtonsStrings[66]="1")}uncheckAllUpper(){for(var e of this.allUpperOuterNumberButtons)document.getElementById(""+e).style.backgroundColor="grey",this.allButtonsStrings[e]="",8==e?this.allButtonsStrings[8]="2":9==e?this.allButtonsStrings[9]="1":11==e?this.allButtonsStrings[11]="1":12==e?this.allButtonsStrings[12]="2":29==e?this.allButtonsStrings[29]="3":30==e?this.allButtonsStrings[30]="3":31==e&&(this.allButtonsStrings[31]="3")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-leah"]],decls:10,vars:5,consts:[[1,"headerButtons"],["id","h1","mat-raised-button","","color","primary",1,"placeButton",3,"click"],["id","h5","mat-raised-button","","color","primary",1,"placeButton",3,"click"],[4,"ngIf"],[1,"grid-container"],[4,"ngFor","ngForOf"],["alt","fswaAPI2",1,"image1",3,"src"],[1,"grid-item",3,"id","disabled","click"]],template:function(e,i){1&e&&(w(0,"div",0)(1,"button",1),H("click",function(){return i.h1Pressed()}),I(2),C(),w(3,"button",2),H("click",function(){return i.h2Pressed()}),I(4,"Restart"),C()(),ze(5,oye,7,0,"div",3),ze(6,aye,7,0,"div",3),ze(7,lye,9,3,"div",3),w(8,"div",4),ze(9,cye,3,3,"div",5),C()),2&e&&(W(2),ln("Place Flag = ",i.flag,""),W(3),oe("ngIf",1==i.endGameIfPlacedOnMine),W(1),oe("ngIf",1==i.gameWin&&1==i.gameWin2),W(1),oe("ngIf",1==i.gameWin&&0==i.gameWin2),W(2),oe("ngForOf",i.allButtons))},dependencies:[ku,pl,co],styles:[".headerButtons[_ngcontent-%COMP%]{position:relative;text-align:center;max-width:100%}.placeButton[_ngcontent-%COMP%]:hover{background-color:#00008b}.placeButton[_ngcontent-%COMP%]{width:18%;height:25%;padding:10px;margin:5px;background-color:#00f}.placeButton[_ngcontent-%COMP%]:focus{background-color:#00008b}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto auto auto auto auto auto auto auto auto auto auto auto auto auto auto auto auto auto;background-color:#000;padding:1px;width:60px;margin-left:17.6%}.grid-item[_ngcontent-%COMP%]{background-color:#eb1035;border:1px solid rgba(0,0,0,.8);font-size:15px;padding:35px;margin-bottom:-20px;margin-right:-10px;text-align:center}h1[_ngcontent-%COMP%]{margin-top:5%;text-align:center;font-size:5vw;color:gold;padding-bottom:5%}.image1[_ngcontent-%COMP%]{display:inline-block;width:30%;height:25%;margin-left:2%}"]}),n})(),dye=(()=>{class n extends Qh{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275cmp=Zn({type:n,selectors:[["app-project-one"]],features:[$t],decls:19,vars:0,consts:[["mat-raised-button","",3,"click"],["mat-raised-button","","id","b1",3,"click"],["id","a1"],["id","a2"],["id","a3",1,"test"],["src","assets/fswa/fswaAPI2.jpg","alt","fswaAPI2",1,"image1"],["src","assets/fswa/fswaCircle.jpg","alt","fswaCircle",1,"image1"],["src","assets/fswa/fswaList.png","alt","fswaList",1,"image1"],["src","assets/fswa/fswaSQL.png","alt","fswaSQL",1,"image2"],["src","assets/fswa/fswaUIService.png","alt","fswaUIService",1,"image2"],["src","assets/fswa/fswaUISubscribe.png","alt","fswaUISubscribe",1,"image2"]],template:function(e,i){1&e&&(w(0,"button",0),H("click",function(){return i.loopThroughProjects(4)}),I(1,"Click for projects!"),C(),w(2,"button",1),H("click",function(){return i.loopThroughProjects(1)}),I(3,"Click for projects!"),C(),Ne(4,"br")(5,"br")(6,"br"),w(7,"h2",2)(8,"b"),I(9,"Full Stack Web Application: Expense Tracker"),C()(),w(10,"p",3),I(11,"Used SSMS, API, and Angular to make this full expense tracker app. Used stored procedures, Dapper, HttpGet Controllers, Angular components, Angular Services to make this web app. Learned a lot on a web applications worked(ie. how the front end gets data from the database)"),C(),w(12,"div",4),Ne(13,"img",5)(14,"img",6)(15,"img",7)(16,"img",8)(17,"img",9)(18,"img",10),C())},dependencies:[co],styles:["h2[_ngcontent-%COMP%]{font-size:40px}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}b[_ngcontent-%COMP%]{color:#0f1213}.test[_ngcontent-%COMP%]{position:relative;max-width:100%}.image1[_ngcontent-%COMP%]{display:inline-block;width:30%;height:25%;max-height:300px;margin-left:2%;position:relative;z-index:1;margin-bottom:-20px;animation:_ngcontent-%COMP%_picAppear1 15s infinite}.image2[_ngcontent-%COMP%]{display:inline-block;margin-left:2%;width:30%;height:25%;max-height:300px;position:relative;z-index:3;margin-top:-100%;animation:_ngcontent-%COMP%_picAppear2 15s infinite}#b1[_ngcontent-%COMP%]{float:right}#a1[_ngcontent-%COMP%]{text-align:center;animation:_ngcontent-%COMP%_picAppearStart .5s linear}#a2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1s linear;margin-left:5%;margin-right:5%}#a3[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1.5s linear}@keyframes _ngcontent-%COMP%_picAppear1{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_picAppear2{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes _ngcontent-%COMP%_picAppearStart{0%{opacity:0}50%{opacity:0}to{opacity:1}}"]}),n})(),hye=(()=>{class n extends Qh{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275cmp=Zn({type:n,selectors:[["app-project-two"]],features:[$t],decls:21,vars:0,consts:[["mat-raised-button","",3,"click"],["mat-raised-button","","id","b1",3,"click"],["id","a1"],["id","a2"],["href","https://github.com/SammySaysSo/spaceinvader.git","target","_blank"],["id","a3",1,"test"],["src","assets/spaceInvader/siStart.png","alt","siStartPic",1,"image1"],["src","assets/spaceInvader/siGameBegin.png","alt","siGameBeginPic",1,"image1"],["src","assets/spaceInvader/siInstruct.png","alt","siInstructPic",1,"image1"],["src","assets/spaceInvader/siGameMiddle.png","alt","siGameMiddlePic",1,"image2"],["src","assets/spaceInvader/siEnd.png","alt","siEndPic",1,"image2"],["src","assets/spaceInvader/siGameBoss.png","alt","siGameBossPic",1,"image2"]],template:function(e,i){1&e&&(w(0,"button",0),H("click",function(){return i.loopThroughProjects(0)}),I(1,"Click for projects!"),C(),w(2,"button",1),H("click",function(){return i.loopThroughProjects(2)}),I(3,"Click for projects!"),C(),Ne(4,"br")(5,"br")(6,"br"),w(7,"h2",2)(8,"b"),I(9,"Space Invader"),C()(),w(10,"p",3),I(11,"When making this game, got orignial idea from youtube, but added way more to it compared to previous games I created. Different menus, enemies, boss, pause, health, multiple shots, and a good ending screen depneding on how the player did. "),w(12,"a",4),I(13,"Click to see or download the code"),C()(),w(14,"div",5),Ne(15,"img",6)(16,"img",7)(17,"img",8)(18,"img",9)(19,"img",10)(20,"img",11),C())},dependencies:[co],styles:["h2[_ngcontent-%COMP%]{font-size:40px}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}b[_ngcontent-%COMP%]{color:#0f1213}#b1[_ngcontent-%COMP%]{float:right}.test[_ngcontent-%COMP%]{position:relative;max-width:100%}.image1[_ngcontent-%COMP%]{display:inline-block;width:30%;height:25%;max-height:300px;margin-left:2%;position:relative;z-index:1;margin-bottom:-20px;animation:_ngcontent-%COMP%_picAppear1 15s infinite}.image2[_ngcontent-%COMP%]{display:inline-block;margin-left:2%;width:30%;height:25%;max-height:300px;position:relative;z-index:3;margin-top:-100%;animation:_ngcontent-%COMP%_picAppear2 15s infinite}#a1[_ngcontent-%COMP%]{text-align:center;animation:_ngcontent-%COMP%_picAppearStart .5s linear}#a2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1s linear;margin-left:5%;margin-right:5%}#a3[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1.5s linear}@keyframes _ngcontent-%COMP%_picAppear1{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_picAppear2{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes _ngcontent-%COMP%_picAppearStart{0%{opacity:0}50%{opacity:0}to{opacity:1}}"]}),n})(),fye=(()=>{class n extends Qh{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275cmp=Zn({type:n,selectors:[["app-project-three"]],features:[$t],decls:21,vars:0,consts:[["mat-raised-button","",3,"click"],["mat-raised-button","","id","b1",3,"click"],["id","a1"],["id","a2"],["href","https://github.com/SammySaysSo/snake.git","target","_blank"],["id","a3",1,"test"],["src","assets/snake/snakeStart.png","alt","snakeStartPic",1,"image1"],["src","assets/snake/snakeCodeStart.png","alt","snakeCodeStartPic",1,"image1"],["src","assets/snake/snakeInGameSmall.png","alt","snakeInGameSmallPic",1,"image1"],["src","assets/snake/snakeCodeMiddle.png","alt","snakeCodeMiddlePic",1,"image2"],["src","assets/snake/snakeInGameBig.png","alt","snakeInGameBigPic",1,"image2"],["src","assets/snake/snakeCodeEnd.png","alt","snakeCodeEndPic",1,"image2"]],template:function(e,i){1&e&&(w(0,"button",0),H("click",function(){return i.loopThroughProjects(1)}),I(1,"Click for projects!"),C(),w(2,"button",1),H("click",function(){return i.loopThroughProjects(3)}),I(3,"Click for projects!"),C(),Ne(4,"br")(5,"br")(6,"br"),w(7,"h2",2)(8,"b"),I(9,"Snake"),C()(),w(10,"p",3),I(11,"When I was first learning about object oriented programming in high school, I used a youtube video to help make this game. I added some of my own code with it as well. Normal snake game with a song. "),w(12,"a",4),I(13,"Click to see or download the code"),C()(),w(14,"div",5),Ne(15,"img",6)(16,"img",7)(17,"img",8)(18,"img",9)(19,"img",10)(20,"img",11),C())},dependencies:[co],styles:["h2[_ngcontent-%COMP%]{font-size:40px}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}b[_ngcontent-%COMP%]{color:#0f1213}.test[_ngcontent-%COMP%]{position:relative;max-width:100%}.image1[_ngcontent-%COMP%]{display:inline-block;width:30%;height:25%;max-height:300px;margin-left:2%;position:relative;z-index:1;margin-bottom:-20px;animation:_ngcontent-%COMP%_picAppear1 15s infinite}.image2[_ngcontent-%COMP%]{display:inline-block;margin-left:2%;width:30%;height:25%;max-height:300px;position:relative;z-index:3;margin-top:-100%;animation:_ngcontent-%COMP%_picAppear2 15s infinite}#b1[_ngcontent-%COMP%]{float:right}#a1[_ngcontent-%COMP%]{text-align:center;animation:_ngcontent-%COMP%_picAppearStart .5s linear}#a2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1s linear;margin-left:5%;margin-right:5%}#a3[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1.5s linear}@keyframes _ngcontent-%COMP%_picAppear1{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_picAppear2{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes _ngcontent-%COMP%_picAppearStart{0%{opacity:0}50%{opacity:0}to{opacity:1}}"]}),n})(),pye=(()=>{class n extends Qh{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275cmp=Zn({type:n,selectors:[["app-project-four"]],features:[$t],decls:21,vars:0,consts:[["mat-raised-button","",3,"click"],["mat-raised-button","","id","b1",3,"click"],["id","a1"],["id","a2"],["href","https://github.com/SammySaysSo/fts.git","target","_blank"],["id","a3",1,"test"],["src","assets/fts/ftsStart.png","alt","ftsStartPic",1,"image1"],["src","assets/fts/ftsCredits.png","alt","ftsInGamePic",1,"image1"],["src","assets/fts/ftsInGame.png","alt","ftsCreditsPic",1,"image1"],["src","assets/fts/ftsComplete.png","alt","ftsInstructtPic",1,"image2"],["src","assets/fts/ftsInstruct.png","alt","ftsEndingePic",1,"image2"],["src","assets/fts/ftsEnding.png","alt","ftsCompletePic",1,"image2"]],template:function(e,i){1&e&&(w(0,"button",0),H("click",function(){return i.loopThroughProjects(2)}),I(1,"Click for projects!"),C(),w(2,"button",1),H("click",function(){return i.loopThroughProjects(4)}),I(3,"Click for projects!"),C(),Ne(4,"br")(5,"br")(6,"br"),w(7,"h2",2)(8,"b"),I(9,"Finish The song"),C()(),w(10,"p",3),I(11,"A game I made that has a song playing in the background. The goal is to dodge the blocks until the song ends(ie. Finish The Song). Has basic moving mechanics with scoring. "),w(12,"a",4),I(13,"Click to see or download the code"),C()(),w(14,"div",5),Ne(15,"img",6)(16,"img",7)(17,"img",8)(18,"img",9)(19,"img",10)(20,"img",11),C())},dependencies:[co],styles:["h2[_ngcontent-%COMP%]{font-size:40px}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}b[_ngcontent-%COMP%]{color:#0f1213}.test[_ngcontent-%COMP%]{position:relative;max-width:100%}.image1[_ngcontent-%COMP%]{display:inline-block;width:30%;height:25%;max-height:300px;margin-left:2%;position:relative;z-index:1;margin-bottom:-20px;animation:_ngcontent-%COMP%_picAppear1 15s infinite}.image2[_ngcontent-%COMP%]{display:inline-block;margin-left:2%;width:30%;height:25%;max-height:300px;position:relative;z-index:3;margin-top:-100%;animation:_ngcontent-%COMP%_picAppear2 15s infinite}#b1[_ngcontent-%COMP%]{float:right}#a1[_ngcontent-%COMP%]{text-align:center;animation:_ngcontent-%COMP%_picAppearStart .5s linear}#a2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1s linear;margin-left:5%;margin-right:5%}#a3[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1.5s linear}@keyframes _ngcontent-%COMP%_picAppear1{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_picAppear2{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes _ngcontent-%COMP%_picAppearStart{0%{opacity:0}50%{opacity:0}to{opacity:1}}"]}),n})(),mye=(()=>{class n extends Qh{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=mi(n)))(i||n)}}(),n.\u0275cmp=Zn({type:n,selectors:[["app-project-five"]],features:[$t],decls:23,vars:0,consts:[["mat-raised-button","",3,"click"],["mat-raised-button","","id","b1",3,"click"],["id","a1"],["id","a2"],["href","https://github.com/SammySaysSo/MicrocontrollerFinalProject","target","_blank"],["id","a3",1,"test"],["width","30%","height","30%","controls","","loop","","autoplay","",1,"vid"],["src","assets/mcu/MCUCombinedVideos.mp4","type","video/mp4"],["src","assets/mcu/MCUdiagram.png","alt","MCUDiagramPic",1,"image1"],["src","assets/mcu/ECEHardwareSchematicVideo.mp4","type","video/mp4"],["src","assets/mcu/MCUpart.png","alt","MCUPartPic",1,"image2"]],template:function(e,i){1&e&&(w(0,"button",0),H("click",function(){return i.loopThroughProjects(3)}),I(1,"Click for projects!"),C(),w(2,"button",1),H("click",function(){return i.loopThroughProjects(0)}),I(3,"Click for projects!"),C(),Ne(4,"br")(5,"br")(6,"br"),w(7,"h2",2)(8,"b"),I(9,"Microcontroller Embedded Systems"),C()(),w(10,"p",3),I(11," Hardware used as seen in the pictures below. Software uses IDE of microcontroller and languages of C & Assembler through the use of Microchip Studio! "),w(12,"a",4),I(13,"Click to see or download the code"),C()(),w(14,"div",5)(15,"video",6),Ne(16,"source",7),I(17," Your browser does not support the video tag. "),C(),Ne(18,"img",8),w(19,"video",6),Ne(20,"source",9),I(21," Your browser does not support the video tag. "),C(),Ne(22,"img",10),C())},dependencies:[co],styles:["h2[_ngcontent-%COMP%]{font-size:40px}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:visited{color:#00f}a[_ngcontent-%COMP%]:hover{color:#00008b}b[_ngcontent-%COMP%]{color:#0f1213}.test[_ngcontent-%COMP%]{position:relative;max-width:100%}.image1[_ngcontent-%COMP%]{display:inline-block;width:30%;height:25%;max-height:300px;margin-left:2%;z-index:1;margin-bottom:-20px;animation:_ngcontent-%COMP%_picAppear1 15s infinite}.image2[_ngcontent-%COMP%]{display:inline-block;margin-left:34%;width:30%;height:25%;max-height:300px;position:relative;z-index:3;margin-top:-100%;animation:_ngcontent-%COMP%_picAppear2 15s infinite}.vid[_ngcontent-%COMP%]{display:inline-block;width:30%;height:25%;max-height:300px;margin-left:2%;z-index:1;margin-bottom:-20px}#b1[_ngcontent-%COMP%]{float:right}#a1[_ngcontent-%COMP%]{text-align:center;animation:_ngcontent-%COMP%_picAppearStart .5s linear}#a2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1s linear;margin-left:5%;margin-right:5%}#a3[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_picAppearStart 1.5s linear}@keyframes _ngcontent-%COMP%_picAppear1{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_picAppear2{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes _ngcontent-%COMP%_picAppearStart{0%{opacity:0}50%{opacity:0}to{opacity:1}}"]}),n})();function gye(n,t){1&n&&(w(0,"h3"),I(1,"Game Over!"),C())}function bye(n,t){if(1&n&&(w(0,"h4"),I(1),C()),2&n){const e=Ge();W(1),ln("Score: ",e.counter,"")}}function _ye(n,t){1&n&&(w(0,"h2"),I(1,"Get a high score to enter your name into the leaderboard!"),C())}function yye(n,t){if(1&n){const e=to();w(0,"div")(1,"h4"),I(2,"INSERT YOUR NAME INTO THE LEADERBOARD!"),C(),w(3,"form",19)(4,"p"),Ne(5,"input",20),w(6,"button",21),H("click",function(){return Un(e),Wn(Ge().checkUserScoreAgainstLeaderboard())}),I(7,"Submit"),C()()()()}}let vye=(()=>{class n{constructor(){this.firebaseConfig={apiKey:"AIzaSyAqm7ooUgqpyKCWH3fPM1yzyANdWmFsGH4",authDomain:"fir-mywebsite.firebaseapp.com",databaseURL:"https://fir-mywebsite-default-rtdb.firebaseio.com",projectId:"fir-mywebsite",storageBucket:"fir-mywebsite.appspot.com",messagingSenderId:"271679200792",appId:"1:271679200792:web:807031f3f43102c9a2ad6d",measurementId:"G-8JCVNF7W86"},this.app=rf(this.firebaseConfig),this.lose=!1,this.turn=!1,this.greaterThanLeaderBoard=!1,this.order=[],this.playerOrder=[],this.counter=0,this.turnPlayerCounter=0,this.buttonText="Start",this.topPlayerNames=[],this.topPlayerScores=[],this.persons={},this.audio1=new Audio("https://s3.amazonaws.com/freecodecamp/simonSound1.mp3"),this.audio2=new Audio("https://s3.amazonaws.com/freecodecamp/simonSound2.mp3"),this.audio3=new Audio("https://s3.amazonaws.com/freecodecamp/simonSound3.mp3"),this.audio4=new Audio("https://s3.amazonaws.com/freecodecamp/simonSound4.mp3")}ngOnInit(){this.getLeaderboardFromDB()}getLeaderboardFromDB(){var e=this;return Q(function*(){e.topPlayerNames=[],e.topPlayerScores=[],e.persons={};for(var i=1;i<4;i++)document.getElementById("name"+i).innerHTML="",document.getElementById("value"+i).innerHTML="";const s=_i(Da());for(var r in yield vc(Fr(s,"names/name1")).then(o=>{o.exists()?e.persons.name1={Name:o.val().name,Score:o.val().score}:console.log("No data available")}).catch(o=>{console.error(o)}),yield vc(Fr(s,"names/name2")).then(o=>{o.exists()?e.persons.name2={Name:o.val().name,Score:o.val().score}:console.log("No data available")}).catch(o=>{console.error(o)}),yield vc(Fr(s,"names/name3")).then(o=>{o.exists()?e.persons.name3={Name:o.val().name,Score:o.val().score}:console.log("No data available")}).catch(o=>{console.error(o)}),e.persons)e.topPlayerNames.push(e.persons[r].Name),e.topPlayerScores.push(e.persons[r].Score);for(i=1;i<4;i++)document.getElementById("name"+i).innerHTML=i.toString()+": <b>"+e.topPlayerNames[i-1]+"</b>&nbsp&nbsp&nbspScore: ",document.getElementById("value"+i).innerHTML=e.topPlayerScores[i-1].toString();e.greaterThanLeaderBoard=!1})()}StartGame(){this.lose=!1,this.turn=!1,this.greaterThanLeaderBoard=!1,this.order=[],this.playerOrder=[],this.counter=0,this.turnPlayerCounter=0,this.buttonText="Start",this.getLeaderboardFromDB(),this.RunGame()}RunGame(){if(this.lose){this.buttonText="Restart";for(var e=0;e<3;e++)this.counter>this.topPlayerScores[e]&&(this.greaterThanLeaderBoard=!0)}else this.turn?this.turnPlayerCounter+=1:(this.playerOrder=[],this.counter+=1,this.turnPlayerCounter=0,this.order.push(Math.floor(4*Math.random())+1),this.RunComputerTurn(),this.turn=!0)}RunPlayerTurn(e){var i=this;return Q(function*(){1==e?i.RunTopLeft():2==e?i.RunTopRight():3==e?i.RunBotLeft():i.RunBotRight(),yield new Promise(s=>setTimeout(s,500)),document.getElementById("topleft").style.background="darkgreen",document.getElementById("topright").style.background="darkred",document.getElementById("bottomleft").style.background="goldenrod",document.getElementById("bottomright").style.background="darkblue",yield new Promise(s=>setTimeout(s,500)),i.lose=i.compareUserToSpecificComputerPlacement(e),i.turnPlayerCounter==i.order.length&&(i.turn=!1),i.RunGame()})()}compareUserToSpecificComputerPlacement(e){return e!=this.order[this.playerOrder.length]||(this.playerOrder.push(e),!1)}RunComputerTurn(){var e=this;return Q(function*(){for(var i=0;i<e.order.length;i++)1==e.order[i]?e.RunTopLeft():2==e.order[i]?e.RunTopRight():3==e.order[i]?e.RunBotLeft():4==e.order[i]&&e.RunBotRight(),yield new Promise(s=>setTimeout(s,500)),document.getElementById("topleft").style.background="darkgreen",document.getElementById("topright").style.background="darkred",document.getElementById("bottomleft").style.background="goldenrod",document.getElementById("bottomright").style.background="darkblue",yield new Promise(s=>setTimeout(s,500));e.RunGame()})()}RunTopLeft(){this.audio1.play(),document.getElementById("topleft").style.background="lightgreen"}RunTopRight(){this.audio2.play(),document.getElementById("topright").style.background="lightsalmon"}RunBotLeft(){this.audio3.play(),document.getElementById("bottomleft").style.background="lightgoldenrodyellow"}RunBotRight(){this.audio4.play(),document.getElementById("bottomright").style.background="lightblue"}checkUserScoreAgainstLeaderboard(){var e=document.getElementById("name").value;this.counter>this.topPlayerScores[0]?this.changeRowOne(e):this.counter>this.topPlayerScores[1]?this.changeRowTwo(e):this.counter>this.topPlayerScores[2]&&this.changeRowThree(e)}changeRowThree(e){var i=this;return Q(function*(){const s=Da();yield us(_i(s,"names/name3"),{name:e,score:i.counter}),i.getLeaderboardFromDB()})()}changeRowTwo(e){var i=this;return Q(function*(){const s=Da();yield us(_i(s,"names/name2"),{name:e,score:i.counter}),yield us(_i(s,"names/name3"),{name:i.topPlayerNames[1],score:i.topPlayerScores[1]}),i.getLeaderboardFromDB()})()}changeRowOne(e){var i=this;return Q(function*(){const s=Da();yield us(_i(s,"names/name1"),{name:e,score:i.counter}),yield us(_i(s,"names/name2"),{name:i.topPlayerNames[0],score:i.topPlayerScores[0]}),yield us(_i(s,"names/name3"),{name:i.topPlayerNames[1],score:i.topPlayerScores[1]}),i.getLeaderboardFromDB()})()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-games"]],decls:31,vars:6,consts:[[1,"desk"],["id","name1"],["id","value1"],["id","name2"],["id","value2"],["id","name3"],["id","value3"],[4,"ngIf"],["id","outer-circle"],["id","topleft",3,"click"],["id","topright",3,"click"],["id","bottomleft",3,"click"],["id","bottomright",3,"click"],["id","inner-circle"],["id","title",1,"font-effect-emboss"],["id","switches"],["id","start",1,"button",3,"click"],["id","turn"],[1,"text2"],["id","contactForm"],["type","text","name","name","id","name","value","John","required",""],["type","submit","id","submitButton",3,"click"]],template:function(e,i){1&e&&(w(0,"h1")(1,"u"),I(2,"LEADERBOARD"),C()(),w(3,"div",0),Ne(4,"span",1)(5,"span",2),C(),w(6,"div",0),Ne(7,"span",3)(8,"span",4),C(),w(9,"div",0),Ne(10,"span",5)(11,"span",6),C(),ze(12,gye,2,0,"h3",7),ze(13,bye,2,1,"h4",7),ze(14,_ye,2,0,"h2",7),ze(15,yye,8,0,"div",7),w(16,"div",8)(17,"button",9),H("click",function(){return i.RunPlayerTurn(1)}),C(),w(18,"button",10),H("click",function(){return i.RunPlayerTurn(2)}),C(),w(19,"button",11),H("click",function(){return i.RunPlayerTurn(3)}),C(),w(20,"button",12),H("click",function(){return i.RunPlayerTurn(4)}),C(),w(21,"div",13)(22,"div",14),I(23,"SIMON"),C(),w(24,"div",15)(25,"button",16),H("click",function(){return i.StartGame()}),I(26),C()(),w(27,"div",17),I(28),C(),w(29,"div",18),I(30,"SCORE"),C()()()),2&e&&(W(12),oe("ngIf",i.lose),W(1),oe("ngIf",i.lose),W(1),oe("ngIf",!i.lose),W(1),oe("ngIf",i.greaterThanLeaderBoard),W(11),ot(i.buttonText),W(2),ot(i.counter))},dependencies:[pl,ix,Kv,vf],styles:[".toggle[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}.button[_ngcontent-%COMP%]{border-radius:50%!important;font-size:1.5em;background-color:#d3d3d3;margin-left:58px}#switches[_ngcontent-%COMP%]{position:absolute;font-family:Original Surfer,cursive;margin-left:26px;margin-top:110px}.text2[_ngcontent-%COMP%]{position:absolute;font-family:Original Surfer,cursive;margin-left:90px;margin-top:197px}.text1[_ngcontent-%COMP%]{position:absolute;font-family:Original Surfer,cursive;margin-left:19px;margin-top:142px}.text1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{padding-left:70px}#title[_ngcontent-%COMP%]{font-family:Original Surfer,cursive;position:absolute;font-size:40px;margin-left:35px;margin-top:40px}#turn[_ngcontent-%COMP%]{position:absolute;background:#330000;color:red;font-family:courier;font-size:20px;height:30px;width:50px;margin-left:90px;margin-top:170px;text-align:center;vertical-align:middle;line-height:30px}#outer-circle[_ngcontent-%COMP%]{background:rgb(255,228,228);border-radius:1em;height:1em;width:.5em;position:relative;margin:auto;margin-top:calc(10em + 10%)}#topleft[_ngcontent-%COMP%]{position:absolute;height:18em;width:18em;border-radius:18em 0 0;-moz-border-radius:18em 0 0 0;-webkit-border-radius:18em 0 0 0;background:darkgreen;top:50%;left:50%;margin:-18em 0 0 -18em;border-style:solid;border-width:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}#topright[_ngcontent-%COMP%]{position:absolute;height:18em;width:18em;border-radius:0 18em 0 0;-moz-border-radius:0 18em 0 0;-webkit-border-radius:0 18em 0 0;background:darkred;top:50%;left:50%;margin:-18em 0 0;border-style:solid;border-width:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}#bottomleft[_ngcontent-%COMP%]{position:absolute;height:18em;width:18em;border-radius:0 0 0 18em;-moz-border-radius:0 0 0 18em;-webkit-border-radius:0 0 0 18em;background:goldenrod;top:50%;left:50%;margin:0 -18em;border-style:solid;border-width:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}#bottomright[_ngcontent-%COMP%]{position:absolute;height:18em;width:18em;border-radius:0 0 18em;-moz-border-radius:0 0 18em 0;-webkit-border-radius:0 0 18em 0;background:darkblue;top:50%;left:50%;margin:0 0 -18em;border-style:solid;border-width:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}#inner-circle[_ngcontent-%COMP%]{position:absolute;background:grey;border-radius:50%;height:18em;width:18em;border-style:solid;border-width:10px;top:50%;left:50%;margin:-125px 0 0 -125px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}#topleft[_ngcontent-%COMP%]:hover{background:lightgreen;cursor:pointer}#topright[_ngcontent-%COMP%]:hover{background:lightsalmon;cursor:pointer}#bottomleft[_ngcontent-%COMP%]:hover{background:lightgoldenrodyellow;cursor:pointer}#bottomright[_ngcontent-%COMP%]:hover{background:lightblue;cursor:pointer}h3[_ngcontent-%COMP%]{margin-top:1.5%;text-align:center;font-size:3vw;color:red}h4[_ngcontent-%COMP%]{margin-top:2%;text-align:center;font-size:3vw;color:#000}h1[_ngcontent-%COMP%]{text-align:center;margin-top:1%;font-size:2.5vw}.desk[_ngcontent-%COMP%]{text-align:center;margin-top:2%}#name1[_ngcontent-%COMP%], #name2[_ngcontent-%COMP%], #name3[_ngcontent-%COMP%]{font-size:2.5vw}#value1[_ngcontent-%COMP%], #value2[_ngcontent-%COMP%], #value3[_ngcontent-%COMP%]{font-size:2.5vw;color:#e40000}#contactForm[_ngcontent-%COMP%]{font-size:2.5vw;text-align:center;margin-top:2%}input[type=text][_ngcontent-%COMP%]{padding:12px 20px;margin:8px 0;box-sizing:border-box;border:3px solid #ccc;transition:.5s;outline:none}button[_ngcontent-%COMP%]{margin-left:1%}h4[_ngcontent-%COMP%]{font-size:2vw}#submitButton[_ngcontent-%COMP%]{background-color:#04aa6d;border:none;color:#fff;padding:15px 32px;text-align:center;text-decoration:none;display:inline-block;font-size:16px;margin:4px 2px;cursor:pointer;transition-duration:.4s;border-radius:12px}#submitButton[_ngcontent-%COMP%]:hover{box-shadow:0 12px 16px #0000003d,0 17px 50px #00000030}h2[_ngcontent-%COMP%]{text-align:center;margin-top:2%;padding-bottom:2em;font-size:2vw}"]}),n})();function xye(n,t){if(1&n&&(w(0,"div")(1,"p",4),I(2),C()()),2&n){const e=t.$implicit;W(2),ln("- ",e,"")}}let Cye=(()=>{class n{constructor(){this.allTextValues=[],this.counter=1,this.firebaseConfig={apiKey:"AIzaSyAqm7ooUgqpyKCWH3fPM1yzyANdWmFsGH4",authDomain:"fir-mywebsite.firebaseapp.com",databaseURL:"https://fir-mywebsite-default-rtdb.firebaseio.com",projectId:"fir-mywebsite",storageBucket:"fir-mywebsite.appspot.com",messagingSenderId:"271679200792",appId:"1:271679200792:web:807031f3f43102c9a2ad6d",measurementId:"G-8JCVNF7W86"},this.app=rf(this.firebaseConfig)}ngOnInit(){this.getAllInitialChat(),setInterval(()=>{this.getAllInitialChat()},5e3)}getAllInitialChat(){var e=this;return Q(function*(){e.allTextValues=[];const i=_i(Da());yield vc(Fr(i,"chat/alltext")).then(s=>{if(s.exists()){for(const[r,o]of Object.entries(JSON.parse(JSON.stringify(s.val()))))if(null!=o&&null!=o){e.counter=Number(r);for(const[a,l]of Object.entries(JSON.parse(JSON.stringify(o))))e.allTextValues.push(l)}}else console.log("No data available")}),e.allTextValues.reverse()})()}submitButtonForTextClicked(){if(""!=document.getElementById("name").value){this.allTextValues.reverse();let e=(new Date).toLocaleString();this.saveToDatabase(e+": "+document.getElementById("name").value),document.getElementById("name").value="",this.allTextValues.reverse()}}saveToDatabase(e){var i=this;return Q(function*(){i.allTextValues.push(e),i.counter+=1;const s=Da();yield us(_i(s,"chat/alltext/"+i.counter.toString()),{keyChatString:e})})()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-chatbox"]],decls:6,vars:1,consts:[["id","contactForm"],["type","text","name","name","id","name","placeholder","Insert text here...","required",""],["type","submit","id","submitButton",3,"click"],[4,"ngFor","ngForOf"],["id","actualText"]],template:function(e,i){1&e&&(w(0,"form",0)(1,"p"),Ne(2,"input",1),w(3,"button",2),H("click",function(){return i.submitButtonForTextClicked()}),I(4,"Submit"),C()()(),ze(5,xye,3,1,"div",3)),2&e&&(W(5),oe("ngForOf",i.allTextValues))},dependencies:[ku,ix,Kv,vf],styles:["#contactForm[_ngcontent-%COMP%]{font-size:2.5vw;text-align:center;margin-top:2%}#name1[_ngcontent-%COMP%], #name2[_ngcontent-%COMP%], #name3[_ngcontent-%COMP%]{font-size:2.5vw}#submitButton[_ngcontent-%COMP%]{background-color:#04aa6d;border:none;color:#fff;padding:10px 50px;text-align:center;text-decoration:none;display:inline-block;font-size:15px;margin:4px 2px;cursor:pointer;transition-duration:.4s;border-radius:12px}#name[_ngcontent-%COMP%]{width:50%;padding:12px 20px;margin:8px 0;display:inline-block;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}#actualText[_ngcontent-%COMP%]{margin-left:10px;color:#000;font-family:Helvetica,Arial,sans-serif}"]}),n})();function wye(n,t){if(1&n){const e=to();w(0,"div",11)(1,"input",12),H("ngModelChange",function(s){const o=Un(e).index,a=Ge().index;return Wn(Ge(2).tmpResult[a][o]=s)})("keydown",function(s){const o=Un(e).index,a=Ge().index;return Wn(Ge(2).handleKeyDown(s,a,o))}),C()()}if(2&n){const e=t.index,i=Ge().index,s=Ge(2);W(1),oe("ngModel",s.tmpResult[i][e])}}function Sye(n,t){if(1&n&&(w(0,"div",9),ze(1,wye,2,1,"div",10),C()),2&n){const e=t.$implicit;W(1),oe("ngForOf",e)}}function Iye(n,t){if(1&n&&(w(0,"div",7),ze(1,Sye,2,1,"div",8),C()),2&n){const e=Ge();W(1),oe("ngForOf",e.tmpResult)}}function Eye(n,t){if(1&n){const e=to();w(0,"div")(1,"button",15),H("click",function(){const r=Un(e).$implicit;return Wn(Ge(2).updateBoardWithSpecificGenNum(r.score))}),I(2),C()()}if(2&n){const e=t.$implicit;W(2),jy("",e.textIfReset," Generation Number: ",e.genNum,". Number of Problems: ",e.score," ")}}function kye(n,t){if(1&n&&(w(0,"div",13),ze(1,Eye,3,3,"div",14),C()),2&n){const e=Ge();W(1),oe("ngForOf",e.bestScoreList)}}let Tye=(()=>{class n{constructor(){this.actualList=[[0,1,0,6,0,0,3,0,0],[0,2,7,0,0,0,0,6,0],[0,8,3,0,0,4,1,0,7],[0,0,1,0,0,5,9,2,6],[0,4,0,7,2,0,8,0,1],[2,5,0,8,0,1,4,0,3],[0,3,2,4,0,9,0,0,0],[5,0,8,1,6,0,0,0,0],[0,6,0,0,0,8,0,0,9]],this.tempCost=0,this.counter=0,this.tmpResult=[],this.tmpScore=0,this.tmpCounter=0,this.PopSize=3e3,this.generation=1,this.countResets=0,this.populationList=[],this.bestScoreList=[]}ngOnInit(){this.resetBoard()}handleKeyDown(e,i,s){return"Backspace"===e.key||"Delete"===e.key?(e.preventDefault(),void(this.tmpResult[i][s]=0)):e.key>="0"&&e.key<="9"?(this.tmpResult[i][s]=Number(e.key),void e.preventDefault()):(this.tmpResult[i+1][s]=this.tmpResult[i+1][s],void e.preventDefault())}calculateDistanceInOrderOffspring(e){this.tempCost=0;for(let i=0;i<9;i+=3)for(let s=0;s<9;s+=3){let r=[];for(let o=0;o<3;o++)for(let a=0;a<3;a++)r.push(e[i+o][s+a]);this.tempCost+=Math.max(0,r.filter(o=>1===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>2===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>3===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>4===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>5===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>6===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>7===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>8===o).length-1),this.tempCost+=Math.max(0,r.filter(o=>9===o).length-1)}for(let i=0;i<9;i++)for(let s=1;s<=9;s++){let r=0;for(let o=0;o<e.length;o++)e[o][i]===s&&(this.tempCost+=r,r=1)}return this.tempCost}getRandomInt(e,i){return Math.floor(Math.random()*(i-e+1))+e}generateRandomCitiesInitial(e){let i=JSON.parse(JSON.stringify(e)),s=[],r=0;for(let o of i){for(s.push([...o]);s[r].includes(0);){let a=this.getRandomInt(1,9);for(;s[r].includes(a);)a=this.getRandomInt(1,9);let l=s[r].indexOf(0);s[r][l]=a}r+=1}return s}deepCopy(e){return JSON.parse(JSON.stringify(e))}getRandomIndex(e,i){let s=Math.floor(9*Math.random());for(;0!=e[s]&&s!=i;)s=Math.floor(9*Math.random());return s}helperSwap(e){for(let i=0;i<9;i++)for(let s=1;s<=9;s++){let r=0;for(let o=0;o<e.length;o++)if(e[o][i]===s){if(1===r){const a=e.map((l,c)=>l[i]===s?c:-1).filter(l=>-1!==l);return[s,...a]}r=1}}return[0]}swapTwoNumsButNotPermanent(e,i){let s=JSON.parse(JSON.stringify(i)),r=this.helperSwap(s);if(r.length>=3){const o=r[0],a=r[1],l=i[a].indexOf(o);if(!e[a].includes(i[a][l])){let d=this.getRandomIndex(e[a],l);[i[a][l],i[a][d]]=[i[a][d],i[a][l]]}const c=r[2],u=i[c].indexOf(o);if(!e[c].includes(i[c][u])){let d=this.getRandomIndex(e[c],u);[i[c][u],i[c][d]]=[i[c][d],i[c][u]]}}}generateOffSpring(e,i,s,r,o,a,l,c,u){const d=Math.floor(Math.random()*i);let h=JSON.parse(JSON.stringify(s[d].legitArray)),f=JSON.parse(JSON.stringify(e));h[r]=f[r];let p=0;const g=Math.random();g<.95&&(1==o?c.forEach(y=>{h[r].includes(y)||(h[r][a]=c[p]),p+=1,a+=1}):u.forEach(y=>{h[r].includes(y)||(h[r][l]=u[p]),p+=1,l+=1}));let m=0;for(let y of h[r]){let v=-1;if(0==y){for(;-1==v||h[r].includes(v);)v=Math.floor(9*Math.random())+1;h[r][m]=v}m+=1}return g<.5&&this.swapTwoNumsButNotPermanent(e,h),{genNum:0,score:this.calculateDistanceInOrderOffspring(h),legitArray:h,textIfReset:"New Best!"}}clearBoard(){for(let e=0;e<9;e++)for(let i=0;i<9;i++)this.tmpResult[e][i]=void 0;this.tempCost=0,this.counter=0,this.tmpScore=0,this.tmpCounter=0,this.PopSize=3e3,this.generation=1,this.countResets=0,this.populationList=[],this.bestScoreList=[]}findPossibilities(e,i,s){if(0!=e[i][s])return new Set;const r=new Set(e[i]),o=new Set;for(let d=0;d<9;d++)o.add(e[d][s]);const a=3*Math.floor(i/3),l=3*Math.floor(s/3),c=new Set;for(let d=a;d<a+3;d++)for(let h=l;h<l+3;h++)c.add(e[d][h]);const u=new Set;for(let d=1;d<=9;d++)u.add(d);for(let d of r)u.delete(d);for(let d of o)u.delete(d);for(let d of c)u.delete(d);return u}preprocessEasyCells(e){let i=!0;for(;i;){i=!1;for(let s=0;s<9;s++)for(let r=0;r<9;r++)if(0===e[s][r]){const o=this.findPossibilities(e,s,r);if(1===o.size){const a=[...o][0];e[s][r]=a,i=!0}}}}resetBoard(){this.tmpResult=JSON.parse(JSON.stringify(this.actualList))}easyNums(){this.tmpResult=this.solveForEasyNums(this.tmpResult)}solveForEasyNums(e){const i=JSON.parse(JSON.stringify(e)),s=[];for(let r=0;r<9;r+=3)for(let o=0;o<9;o+=3){const a=[];for(let l=0;l<3;l++)for(let c=0;c<3;c++)a.push(i[r+l][o+c]);s.push(a)}for(let r=0;r<9;r++)for(let o=1;o<=9;o++)if(!s[r].includes(o)){const a=[...s[r]];for(let l=0;l<9;l++)0!=a[l]&&(a[l]=10);if(0==r){if(s[1].includes(o)){const u=s[1].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[2].includes(o)){const u=s[2].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[3].includes(o)){const u=s[3].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[6].includes(o)){const u=s[6].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[0][c]=o:c<=5?e[1][c-3]=o:e[2][c-6]=o)}if(1==r){if(s[0].includes(o)){const u=s[0].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[2].includes(o)){const u=s[2].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[4].includes(o)){const u=s[4].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[7].includes(o)){const u=s[7].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[0][c+3]=o:c<=5?e[1][c-3+3]=o:e[2][c-6+3]=o)}if(2==r){if(s[0].includes(o)){const u=s[0].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[1].includes(o)){const u=s[1].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[5].includes(o)){const u=s[5].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[8].includes(o)){const u=s[8].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[0][c+6]=o:c<=5?e[1][c-3+6]=o:e[2][c-6+6]=o)}if(3==r){if(s[4].includes(o)){const u=s[4].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[5].includes(o)){const u=s[5].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[0].includes(o)){const u=s[0].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[6].includes(o)){const u=s[6].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[3][c]=o:c<=5?e[4][c-3]=o:e[5][c-6]=o)}if(4==r){if(s[3].includes(o)){const u=s[3].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[5].includes(o)){const u=s[5].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[1].includes(o)){const u=s[1].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[7].includes(o)){const u=s[7].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[3][c+3]=o:c<=5?e[4][c-3+3]=o:e[5][c-6+3]=o)}if(5==r){if(s[3].includes(o)){const u=s[3].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[4].includes(o)){const u=s[4].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[2].includes(o)){const u=s[2].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[8].includes(o)){const u=s[8].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[3][c+6]=o:c<=5?e[4][c-3+6]=o:e[5][c-6+6]=o)}if(6==r){if(s[7].includes(o)){const u=s[7].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[8].includes(o)){const u=s[8].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[0].includes(o)){const u=s[0].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[3].includes(o)){const u=s[3].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[6][c]=o:c<=5?e[7][c-3]=o:e[8][c-6]=o)}if(7==r){if(s[6].includes(o)){const u=s[6].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[8].includes(o)){const u=s[8].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[1].includes(o)){const u=s[1].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[4].includes(o)){const u=s[4].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[6][c+3]=o:c<=5?e[7][c-3+3]=o:e[8][c-6+3]=o)}if(8==r){if(s[6].includes(o)){const u=s[6].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[7].includes(o)){const u=s[7].indexOf(o);u<=2?(a[0]=10,a[1]=10,a[2]=10):u<=5?(a[3]=10,a[4]=10,a[5]=10):(a[6]=10,a[7]=10,a[8]=10)}if(s[2].includes(o)){const u=s[2].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}if(s[5].includes(o)){const u=s[5].indexOf(o);0==u||3==u||6==u?(a[0]=10,a[3]=10,a[6]=10):1==u||4==u||7==u?(a[1]=10,a[4]=10,a[7]=10):(a[2]=10,a[5]=10,a[8]=10)}let l=0,c=-1;for(let u=0;u<9;u++)10!=a[u]&&(l++,c=u);1==l&&(c<=2?e[6][c+6]=o:c<=5?e[7][c-3+6]=o:e[8][c-6+6]=o)}}return e}startGA(){var e=this;return Q(function*(){e.actualList=JSON.parse(JSON.stringify(e.tmpResult)),e.tempCost=0,e.counter=0,e.tmpScore=0,e.tmpCounter=0,e.countResets=0,e.generation=1,e.populationList=[],e.bestScoreList=[];let i=[],s=0;for(var r=0;r<e.PopSize;r++)i=e.generateRandomCitiesInitial(e.actualList),s=e.calculateDistanceInOrderOffspring(i),e.populationList.push({genNum:1,score:s,legitArray:i,textIfReset:"New Best!"});let o=-1,a=-1;for(;0!=o&&e.tmpCounter<500;){if(0!=o&&e.tmpCounter<500){e.populationList.sort((h,f)=>h.score-f.score),(-1==o||o>e.populationList[0].score)&&(o=e.populationList[0].score,e.tmpResult=e.populationList[0].legitArray,a=e.generation,e.tmpCounter+=1,e.bestScoreList.unshift(e.populationList[0]),yield new Promise(h=>setTimeout(h,500))),e.generation+=1;let d=[];for(var c=0;c<50;c++)d.push({genNum:e.generation,score:e.populationList[c].score,legitArray:e.populationList[c].legitArray,textIfReset:"New Best!"});for(var u=0;u<e.PopSize-50;u++){let h=e.getRandomInt(0,50),p=(e.getRandomInt(0,50),e.getRandomInt(0,1)),g=e.getRandomInt(0,8),m=[],b=[],_=e.getRandomInt(0,7),y=e.getRandomInt(_+1,8),v=e.getRandomInt(0,7),x=e.getRandomInt(v+1,8);m=e.deepCopy(e.populationList[h].legitArray[g].slice(_,y)),b=e.deepCopy(e.populationList[h].legitArray[g].slice(v,x));let S=e.generateOffSpring(e.actualList,e.PopSize,e.populationList,g,p,_,v,m,b);S.genNum=e.generation,d.push(S)}e.populationList=JSON.parse(JSON.stringify(d))}if(e.generation-a>100){e.countResets+=1,e.bestScoreList=[],1==e.countResets?(e.actualList=e.solveForEasyNums(e.actualList),e.bestScoreList.unshift({genNum:e.countResets,score:s,legitArray:[],textIfReset:"RESET"})):e.countResets<4?(e.preprocessEasyCells(e.actualList),e.actualList=e.solveForEasyNums(e.actualList),e.bestScoreList.unshift({genNum:e.countResets,score:s,legitArray:[],textIfReset:"RESET Again! Applying Solve Easy Cells & Preprocessing..."})):(e.bestScoreList.unshift({genNum:e.countResets,score:s,legitArray:[],textIfReset:"GA Algorithm failed! Applying Backtracking method"}),e.solveSudoku(e.actualList)),o=-1,a=-1,e.generation=1;let d=[];for(r=0;r<e.PopSize;r++)i=e.generateRandomCitiesInitial(e.actualList),s=e.calculateDistanceInOrderOffspring(i),d.push({genNum:1,score:s,legitArray:i,textIfReset:"New Best!"});e.populationList=JSON.parse(JSON.stringify(d))}yield new Promise(d=>setTimeout(d,100))}})()}stopGA(){this.tmpCounter+=500}updateBoardWithSpecificGenNum(e){this.tmpResult=this.bestScoreList.find(i=>i.score==e)?.legitArray}isValid(e,i,s,r){if(e[i].includes(r))return!1;for(let l=0;l<9;l++)if(e[l][s]==r)return!1;const o=3*Math.floor(i/3),a=3*Math.floor(s/3);for(let l=o;l<o+3;l++)for(let c=a;c<a+3;c++)if(e[l][c]==r)return!1;return!0}solveSudoku(e){for(let i=0;i<9;i++)for(let s=0;s<9;s++)if(0==e[i][s]){for(let r=1;r<=9;r++)if(this.isValid(e,i,s,r)){if(e[i][s]=r,this.solveSudoku(e))return!0;e[i][s]=0}return!1}return!0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-sudoku"]],decls:23,vars:3,consts:[[1,"test"],[1,"sudoku-container"],["class","sudoku-board",4,"ngIf"],[1,"content"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],["class","score-container",4,"ngIf"],[1,"sudoku-board"],["class","sudoku-row",4,"ngFor","ngForOf"],[1,"sudoku-row"],["class","sudoku-cell",4,"ngFor","ngForOf"],[1,"sudoku-cell"],["type","text","maxlength","1",1,"sudoku-input",3,"ngModel","ngModelChange","keydown"],[1,"score-container"],[4,"ngFor","ngForOf"],[1,"best-score-text",3,"click"]],template:function(e,i){1&e&&(w(0,"p",0),I(1,"Place numbers 0-9 in the cells. Note, insert a 0 for an empty cell"),C(),w(2,"div",1),ze(3,Iye,2,1,"div",2),C(),w(4,"div",3)(5,"button",4),H("click",function(){return i.startGA()}),I(6,"Start Genetic Algorithm"),C(),w(7,"button",4),H("click",function(){return i.stopGA()}),I(8,"Stop Genetic Algorithm"),C(),w(9,"button",4),H("click",function(){return i.resetBoard()}),I(10,"Reset Board"),C(),w(11,"button",4),H("click",function(){return i.clearBoard()}),I(12,"Clear Board"),C()(),w(13,"div",3)(14,"button",5),H("click",function(){return i.preprocessEasyCells(i.tmpResult)}),I(15,"Apply Preprocessing"),C(),w(16,"button",5),H("click",function(){return i.easyNums()}),I(17,"Solve Easy Cells"),C(),w(18,"button",5),H("click",function(){return i.solveSudoku(i.tmpResult)}),I(19,"Apply Backtracking"),C()(),w(20,"p",0),I(21),C(),ze(22,kye,2,1,"div",6)),2&e&&(W(3),oe("ngIf",i.tmpResult.length>0),W(18),ln("Current Generation Number: ",i.generation,""),W(1),oe("ngIf",i.bestScoreList.length>0))},dependencies:[ku,pl,co,gg,xD,VD,nx],styles:[".sudoku-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;margin:20px 0}.sudoku-board[_ngcontent-%COMP%]{display:grid;grid-template-rows:repeat(9,1fr);width:380px;border:2px solid black;background-color:#fff;box-shadow:0 4px 10px #0003}.sudoku-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(9,1fr)}.sudoku-cell[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:40px;height:40px;border:1px solid #ccc}.sudoku-cell[_ngcontent-%COMP%]:nth-child(3n){border-right:2px solid black}.sudoku-row[_ngcontent-%COMP%]:nth-child(3n)   .sudoku-cell[_ngcontent-%COMP%]{border-bottom:2px solid black}.sudoku-input[_ngcontent-%COMP%]{width:100%;height:100%;border:none;outline:none;text-align:center;font-size:18px;font-family:Arial,sans-serif;background-color:#f9f9f9;color:#333}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}button[_ngcontent-%COMP%]{display:block;margin-top:10px;margin-left:10px}.score-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:10px;width:100%;margin-top:10px}.best-score-text[_ngcontent-%COMP%]{background:linear-gradient(45deg,#6a11cb,#2575fc);color:#fff;padding:10px 20px;border-radius:10px;box-shadow:0 4px 8px #0003;font-size:1rem;margin:2px 0;text-align:center;width:100%;max-width:600px;animation:_ngcontent-%COMP%_fadeIn 1s ease-in-out}.best-score-text[_ngcontent-%COMP%]:hover{transform:scale(1.05);cursor:pointer}.test[_ngcontent-%COMP%]{margin-top:5px;text-align:center}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]}),n})();function Dye(n,t){if(1&n&&(w(0,"p",4),I(1),C()),2&n){const e=Ge();W(1),ln("Number of users currently playing: ",e.numOfUsersPlaying.length,"/4")}}function Nye(n,t){if(1&n){const e=to();w(0,"div",5)(1,"button",6),H("click",function(){return Un(e),Wn(Ge().joinGame())}),I(2,"Join Game"),C()()}}function Aye(n,t){if(1&n){const e=to();w(0,"div",5)(1,"button",6),H("click",function(){return Un(e),Wn(Ge().leaveGame())}),I(2,"Leave Game"),C()()}}function Mye(n,t){if(1&n){const e=to();w(0,"div")(1,"button",14),H("click",function(){Un(e);const s=Ge().index;return Wn(Ge(2).getUserButtonSelected(s))}),I(2),C()()}if(2&n){const e=Ge(),i=e.index,s=e.$implicit,r=Ge(2);W(1),oe("ngClass",r.getMainUserButtonPosition(i)),W(1),ln("YOU ",s.score,"")}}function Pye(n,t){if(1&n&&(w(0,"div")(1,"button",15),I(2),C()()),2&n){const e=Ge(),i=e.index,s=e.$implicit,r=Ge(2);W(1),oe("ngClass",r.getButtonPosition(i)),W(1),HI("User-",i+1," ",s.score,"")}}function Rye(n,t){if(1&n&&(w(0,"div"),ze(1,Mye,3,2,"div",13),ze(2,Pye,3,3,"div",13),C()),2&n){const e=t.$implicit,i=Ge(2);W(1),oe("ngIf",e.boxID==i.currentID),W(1),oe("ngIf",e.boxID!=i.currentID)}}function Oye(n,t){if(1&n&&(w(0,"div",7)(1,"div",8)(2,"div",9),I(3),C()(),w(4,"div",10)(5,"div",11),I(6),C()(),ze(7,Rye,3,2,"div",12),C()),2&n){const e=Ge();W(1),oe("ngStyle",e.movingBoxStyles),W(2),ln(" ",e.howManyScoresSent," "),W(1),oe("ngStyle",e.otherMovingBoxStyles),W(2),ln(" ",e.sentBoxesNumber," "),W(1),oe("ngForOf",e.numOfUsersPlaying)}}function Fye(n,t){if(1&n){const e=to();w(0,"div")(1,"button",19),H("click",function(s){const o=Un(e).$implicit;return Wn(Ge(2).getNormalButtonSelected(o.boxID,s))}),I(2),C()()}if(2&n){const e=t.$implicit,i=t.index,s=Ge(2);k$("content content-",i,""),W(1),oe("ngClass",s.getNormalButtonColors(i)),W(1),jy("",e.boxID," & ",e.score," & ",s.boxSelected[i],"")}}function Lye(n,t){if(1&n&&(w(0,"div",16)(1,"div",17),ze(2,Fye,3,7,"div",18),C()()),2&n){const e=Ge();W(2),oe("ngForOf",e.allBoxesData)}}let $ye=(()=>{class n{constructor(){this.inGame=!1,this.countNumberUsers=0,this.currentID=0,this.numOfUsersPlaying=[],this.allBoxesData=[],this.sentBoxesData=[],this.sentBoxesAlrDone=[],this.sentBoxesNumber=0,this.mainNodeScoreCount=0,this.userSelected=!1,this.color=["green","orange","blue","purple"],this.boxSelected=[],this.previousBoxSelected=0,this.movingBoxStyles={},this.otherMovingBoxStyles={},this.wasChanged=!1,this.wasChangedCount=0,this.howManyScoresSent=0,this.transitions=["transform 0s ease","transform 1s ease","transform 2s ease","transform 3s ease","transform 4s ease","transform 5s ease","transform 6s ease"],this.transitionFlag=0,this.timeoutTimer=0,this.firebaseConfig={apiKey:"AIzaSyAqm7ooUgqpyKCWH3fPM1yzyANdWmFsGH4",authDomain:"fir-mywebsite.firebaseapp.com",databaseURL:"https://fir-mywebsite-default-rtdb.firebaseio.com",projectId:"fir-mywebsite",storageBucket:"fir-mywebsite.appspot.com",messagingSenderId:"271679200792",appId:"1:271679200792:web:807031f3f43102c9a2ad6d",measurementId:"G-8JCVNF7W86"},this.app=rf(this.firebaseConfig),this.db=Da()}ngOnInit(){for(let e=5;e<=9;e++)this.allBoxesData.push({boxID:e,color:"grey",score:10})}getDataOnAtomAlready(){var e=this;return Q(function*(){if(e.inGame){let i=[];e.countNumberUsers=0;let s=0;const r=_i(Da());yield vc(Fr(r,"atom/user")).then(a=>{if(a.exists())for(const[l,c]of Object.entries(JSON.parse(JSON.stringify(a.val()))))if(0!=Number(l)){let u=!1;if(i.forEach(d=>{d.boxID==Number(l)&&(u=!0)}),0==u&&null!=c){let h=Object.entries(JSON.parse(JSON.stringify(c)));const f={boxID:Number(l),color:e.color[s],score:Number(h[0][1])};i.push(f),s+=1}e.countNumberUsers=Number(l)}}),i.sort(),e.numOfUsersPlaying!=i&&(e.numOfUsersPlaying=i),yield vc(Fr(r,"atom/boxes")).then(a=>{if(a.exists())for(const[l,c]of Object.entries(JSON.parse(JSON.stringify(a.val()))))if(null!=c){let u=c,d=e.allBoxesData.find(h=>h.boxID==Number(l));d.score=u.score,d.color=u.color}});let o=e.numOfUsersPlaying.find(a=>a.boxID==e.currentID);null!=o&&(yield vc(Fr(r,"atom/sendFromUser")).then(a=>{if(a.exists())for(const[l,c]of Object.entries(JSON.parse(JSON.stringify(a.val()))))if(null!=c){let u=c;if(u.color!=o.color&&null==e.sentBoxesData.find(d=>d.ID==Number(l))){const d={ID:Number(l),boxID:u.boxID,color:u.color,score:u.score};e.sentBoxesData.push(d),console.log(e.sentBoxesData)}}}))}})()}addUsertoGame(){var e=this;return Q(function*(){e.countNumberUsers+=1,e.currentID=e.countNumberUsers,yield us(_i(e.db,"atom/user/"+e.countNumberUsers.toString()),{score:e.mainNodeScoreCount})})()}joinGame(){var e=this;return Q(function*(){e.inGame=!0,yield e.getDataOnAtomAlready(),yield e.addUsertoGame();for(let i=0;i<5;i++)e.boxSelected.push(!1);e.runningGame()})()}removeUserFromGame(){var e=this;return Q(function*(){const i=_i(e.db,"atom/user/"+e.currentID.toString());yield function Sbe(n){return Ta("remove",n._path),us(n,null)}(i)})()}leaveGame(){var e=this;return Q(function*(){e.inGame=!1,clearInterval(e.intervalId),yield e.removeUserFromGame(),e.numOfUsersPlaying=[],e.boxSelected=[],e.mainNodeScoreCount=0})()}updateMainNodeScoreCount(){var e=this;return Q(function*(){e.mainNodeScoreCount+=1,yield us(_i(e.db,"atom/user/"+e.currentID.toString()),{score:e.mainNodeScoreCount}),e.allBoxesData.forEach(function(){var i=Q(function*(s){"grey"!=s.color&&s.boxID!=e.previousBoxSelected&&(yield us(_i(e.db,"atom/boxes/"+s.boxID),{score:s.score+1,color:s.color}))});return function(s){return i.apply(this,arguments)}}()),e.previousBoxSelected=0,(e.wasChanged||e.wasChangedCount>0)&&(2==e.wasChangedCount?(e.movingBoxStyles={transform:"translate(0px, 0px)",transition:e.transitions[0]},e.wasChangedCount=0):(e.wasChanged=!1,e.wasChangedCount+=1))})()}runSentScoresOnScreen(){this.sentBoxesData.forEach(e=>{null==this.sentBoxesAlrDone.find(i=>i==e.ID)&&(this.getOtherPositionsAndTime(e.color,e.boxID),this.sentBoxesNumber=e.score,this.sentBoxesAlrDone.push(e.ID))})}runningGame(){var e=this;return Q(function*(){e.intervalId=setInterval(Q(function*(){e.getDataOnAtomAlready(),yield e.updateMainNodeScoreCount(),e.runSentScoresOnScreen()}),1e3)})()}getButtonPosition(e){return["top-left","top-right","bottom-left","bottom-right"][e]||""}getMainUserButtonPosition(e){let i=["top-left","top-right","bottom-left","bottom-right"];return this.userSelected&&(i=["top-leftSelected","top-rightSelected","bottom-leftSelected","bottom-rightSelected"]),i[e]||""}getUserButtonSelected(e){this.userSelected=!this.userSelected}getNormalButtonColors(e){return this.allBoxesData[e].color}getPositionsAndTime(e,i,s){const r=i.target.getBoundingClientRect();"green"==e.color?(5==s.boxID||6==s.boxID?(this.transitionFlag=2,this.timeoutTimer=1500):7==s.boxID?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",marginLeft:"70px",backgroundColor:e.color,transform:`translate(${r.x-r.width+60}px, ${r.y-r.width-70}px)`}):"orange"==e.color?(5==s.boxID||8==s.boxID?(this.transitionFlag=2,this.timeoutTimer=1500):7==s.boxID?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",float:"right",position:"absolute",right:"0",backgroundColor:e.color,transform:`translate(${-1*(r.x-r.width+60)}px, ${r.y-r.width-70}px)`}):"blue"==e.color?(3==s.boxID||9==s.boxID?(this.transitionFlag=2,this.timeoutTimer=1500):7==s.boxID?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",marginLeft:"80px",backgroundColor:e.color,transform:`translate(${r.x-r.width+60}px, ${-1*(r.y-r.width-70)}px)`}):"purple"==e.color&&(3==s.boxID||4==s.boxID?(this.transitionFlag=2,this.timeoutTimer=1500):7==s.boxID?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",marginTop:"700px",float:"right",position:"absolute",right:"0",backgroundColor:e.color,transform:`translate(${-1*(r.x-r.width+60)}px, ${-1*(r.y-r.width-70)}px)`})}getRandomInt(){return Math.floor(1000001*Math.random())+0}getNormalButtonSelected(e,i){var s=this;return Q(function*(){if(s.userSelected){let r=s.allBoxesData.find(a=>a.boxID==e),o=s.numOfUsersPlaying.find(a=>a.boxID==s.currentID);if(s.mainNodeScoreCount>r.score&&s.inGame){s.howManyScoresSent=s.mainNodeScoreCount,s.getPositionsAndTime(o,i,r);let a=s.mainNodeScoreCount-r.score;r.color==o.color&&(a=s.mainNodeScoreCount+r.score),s.mainNodeScoreCount=0,yield us(_i(s.db,"atom/sendFromUser/"+s.getRandomInt().toString()),{boxID:r.boxID,color:o.color,score:s.howManyScoresSent}),yield us(_i(s.db,"atom/user/"+s.currentID.toString()),{score:s.mainNodeScoreCount}),setTimeout(Q(function*(){yield us(_i(s.db,"atom/boxes/"+e),{score:a,color:o.color}),s.wasChanged=!0}),s.timeoutTimer)}s.userSelected=!1}else{let r=!1,o=0,a=0;if(s.boxSelected.forEach(l=>{1==l&&(r=!0,o=a),a+=1}),0==r)s.boxSelected[e-5]=!0;else if(1==s.boxSelected[e-5])s.boxSelected[e-5]=!1;else{let l=s.allBoxesData.find(u=>u.boxID==e),c=s.numOfUsersPlaying.find(u=>u.boxID==s.currentID)?.color;s.allBoxesData[o].color==c&&s.allBoxesData[o].score>l.score&&(yield us(_i(s.db,"atom/boxes/"+e),{score:s.allBoxesData[o].score,color:c}),yield us(_i(s.db,"atom/boxes/"+(o+5)),{score:0,color:c}),s.boxSelected[o]=!1,s.previousBoxSelected=o+5)}}})()}getOtherPositionsAndTime(e,i){"green"==e?(5==i||6==i?(this.transitionFlag=2,this.timeoutTimer=1500):7==i?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",marginLeft:"70px",backgroundColor:e,transform:"translate(60px, 70px)"}):"orange"==e?(5==i||8==i?(this.transitionFlag=2,this.timeoutTimer=1500):7==i?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",float:"right",position:"absolute",right:"0",backgroundColor:e,transform:"translate(60px, 70px)"}):"blue"==e?(3==i||9==i?(this.transitionFlag=2,this.timeoutTimer=1500):7==i?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",marginLeft:"80px",backgroundColor:e,transform:"translate(60px, 70px)"}):"purple"==e&&(3==i||4==i?(this.transitionFlag=2,this.timeoutTimer=1500):7==i?(this.transitionFlag=4,this.timeoutTimer=3500):(this.transitionFlag=6,this.timeoutTimer=5500),this.movingBoxStyles={transition:this.transitions[this.transitionFlag],display:"block",marginTop:"700px",float:"right",position:"absolute",right:"0",backgroundColor:e,transform:"translate(60px, 70px)"})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-atom-war"]],decls:6,vars:5,consts:[["class","test",4,"ngIf"],["class","leaveButton",4,"ngIf"],["class","button-container",4,"ngIf"],["class","buttonWrapper",4,"ngIf"],[1,"test"],[1,"leaveButton"],["mat-raised-button","","color","primary",3,"click"],[1,"button-container"],["id","moving-box",3,"ngStyle"],["id","moving-box-text"],["id","other-moving-box",3,"ngStyle"],["id","other-moving-box-text"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"UserButton",3,"ngClass","click"],[1,"UserButton",3,"ngClass"],[1,"buttonWrapper"],[1,"buttonContainer"],[3,"class",4,"ngFor","ngForOf"],[1,"buttonContent",3,"ngClass","click"]],template:function(e,i){1&e&&(w(0,"body"),ze(1,Dye,2,1,"p",0),ze(2,Nye,3,0,"div",1),ze(3,Aye,3,0,"div",1),ze(4,Oye,8,5,"div",2),ze(5,Lye,3,1,"div",3),C()),2&e&&(W(1),oe("ngIf",i.numOfUsersPlaying.length>0),W(1),oe("ngIf",!i.inGame),W(1),oe("ngIf",i.inGame),W(1),oe("ngIf",i.numOfUsersPlaying.length>0),W(1),oe("ngIf",i.inGame))},dependencies:[VE,ku,pl,Q3,co],styles:[".leaveButton[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:15px}.test[_ngcontent-%COMP%]{margin-top:5px;text-align:center;color:#fff}.button-container[_ngcontent-%COMP%]{position:relative;height:100vh}.UserButton[_ngcontent-%COMP%]{position:absolute;padding:20px 30px;font-size:18px;width:150px;height:60px;background-color:#4caf50;color:#fff;border:none;border-radius:50%;cursor:pointer;transition:background-color .3s}.UserButton[_ngcontent-%COMP%]:hover{box-shadow:inset 0 4px 6px #0006}.top-left[_ngcontent-%COMP%]{top:0;left:0;margin-left:5%;background-color:#4caf50}.top-leftSelected[_ngcontent-%COMP%]{top:0;left:0;margin-left:5%;background-color:#2e7d32;box-shadow:inset 0 4px 6px #0006}.top-right[_ngcontent-%COMP%]{top:0;right:0;margin-right:5%;background-color:#ff5722}.top-rightSelected[_ngcontent-%COMP%]{top:0;right:0;margin-right:5%;background-color:#af320c;box-shadow:inset 0 4px 6px #0006}.bottom-left[_ngcontent-%COMP%]{bottom:0;left:0;margin-left:5%;background-color:#2196f3}.bottom-leftSelected[_ngcontent-%COMP%]{bottom:0;left:0;margin-left:5%;background-color:#0c60a5;box-shadow:inset 0 4px 6px #0006}.bottom-right[_ngcontent-%COMP%]{bottom:0;right:0;margin-right:5%;background-color:#9c27b0}.bottom-rightSelected[_ngcontent-%COMP%]{bottom:0;right:0;margin-right:5%;background-color:#701580;box-shadow:inset 0 4px 6px #0006}.buttonWrapper[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center}.buttonContainer[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr 1fr 1fr;gap:10px}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.content-0[_ngcontent-%COMP%]{grid-column:2;grid-row:1}.content-1[_ngcontent-%COMP%]{grid-column:1;grid-row:2}.content-2[_ngcontent-%COMP%]{grid-column:2;grid-row:2}.content-3[_ngcontent-%COMP%]{grid-column:3;grid-row:2}.content-4[_ngcontent-%COMP%]{grid-column:2;grid-row:3}.buttonContent[_ngcontent-%COMP%]{padding:10px 20px;background-color:gray;color:#fff;border:none;border-radius:5px;cursor:pointer}.buttonContent[_ngcontent-%COMP%]:hover{background-color:#0056b3}.green[_ngcontent-%COMP%]{background-color:green}.orange[_ngcontent-%COMP%]{background-color:orange}.blue[_ngcontent-%COMP%]{background-color:#00f}.purple[_ngcontent-%COMP%]{background-color:purple}body[_ngcontent-%COMP%]{margin:0;padding-bottom:100%;background-image:url(atomWarBackgroundPic.2ed4d95b4fa1fa59.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;background-attachment:fixed}.action-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;cursor:pointer;margin:20px}#moving-box[_ngcontent-%COMP%]{width:50px;height:50px;background-color:#3eaa28;position:fixed;margin-left:-10%;border-radius:50%;transition:transform 1s ease}#moving-box-text[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:16px;color:#fff;margin-top:30%}#other-moving-box[_ngcontent-%COMP%]{width:50px;height:50px;background-color:#3eaa28;position:fixed;margin-left:-10%;border-radius:50%;transition:transform 1s ease}#other-moving-box-text[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:16px;color:#fff;margin-top:30%}"]}),n})();class rH{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class zD{refCount(t){return gr("refCount")}incRef(t){return gr("incRef")}timerAvailable(){return!0}time(t){return gr("time")}read(t){return gr("read")}readSync(t){return gr("readSync")}readToGPU(t,e){return gr("readToGPU")}numDataIds(){return gr("numDataIds")}disposeData(t,e){return gr("disposeData")}write(t,e,i){return gr("write")}move(t,e,i,s,r){return gr("move")}createTensorFromGPUData(t,e,i){return gr("createTensorFromGPUData")}memory(){return gr("memory")}floatPrecision(){return gr("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return gr("dispose")}}function gr(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function oH(n){let t=n.length,e=0;for(;t>0;)e=Math.random()*t|0,t--,Sc(n,t,e)}function Xu(n,t,e){return Math.max(n,Math.min(t,e))}function UD(n){return n%2==0?n:n+1}function Sc(n,t,e){const i=n[t];n[t]=n[e],n[e]=i}function T(n,t){if(!n)throw new Error("string"==typeof t?t:t())}function po(n,t,e=""){T(tn(n,t),()=>e+` Shapes ${n} and ${t} must match`)}function aH(n){T(null!=n,()=>"The input to the tensor constructor must be a non-null value.")}function te(n){if(0===n.length)return 1;let t=n[0];for(let e=1;e<n.length;e++)t*=n[e];return t}function tn(n,t){if(n===t)return!0;if(null==n||null==t||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function xf(n){return n%1==0}function WD(n){const t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function Cf(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function lH(n,t=(s=>0),e,i){return new Promise((s,r)=>{let o=0;const a=()=>{if(n())return void s();o++;const l=t(o);null!=e&&o>=e?r():null!=i?i(a,l):setTimeout(a,l)};a()})}function cH(n,t){let e=1,i=-1;for(let r=0;r<n.length;++r)if(n[r]>=0)e*=n[r];else if(-1===n[r]){if(-1!==i)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${i} and dim ${r}`);i=r}else if(n[r]<0)throw Error(`Shapes can not be < 0. Found ${n[r]} at dim ${r}`);if(-1===i){if(t>0&&t!==e)throw Error(`Size(${t}) must match the product of shape ${n}`);return n}if(0===e)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(t%e!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${e}`);const s=n.slice();return s[i]=t/e,s}function Tt(n,t){const e=t.length;return T((n=null==n?t.map((i,s)=>s):[].concat(n)).every(i=>i>=-e&&i<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${n}`),T(n.every(i=>xf(i)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(i=>i<0?e+i:i)}function Ic(n,t){const e=[],i=[],s=null!=t&&Array.isArray(t)&&0===t.length,r=null==t||s?null:Tt(t,n).sort();let o=0;for(let a=0;a<n.length;++a){if(null!=r){if(r[o]===a&&1!==n[a])throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(null==r[o]||r[o]>a)&&1===n[a]&&(e.push(n[a]),i.push(a)),r[o]<=a&&o++}1!==n[a]&&(e.push(n[a]),i.push(a))}return{newShape:e,keptDims:i}}function vs(n,t){return yi(n,t)}function yi(n,t){let e=null;if(null==n||"float32"===n)e=new Float32Array(t);else if("int32"===n)e=new Int32Array(t);else if("bool"===n)e=new Uint8Array(t);else{if("string"!==n)throw new Error(`Unknown data type ${n}`);e=new Array(t)}return e}function uH(n,t){return!("complex64"===t||"float32"===t&&"complex64"!==n||"int32"===t&&"float32"!==n&&"complex64"!==n||"bool"===t&&"bool"===n)}function lx(n){if("float32"===n||"int32"===n)return 4;if("complex64"===n)return 8;if("bool"===n)return 1;throw new Error(`Unknown dtype ${n}`)}function wg(n){return"string"==typeof n||n instanceof String}function HD(n){return"number"==typeof n}function wf(n){return Array.isArray(n)?wf(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":HD(n)?"float32":wg(n)?"string":function jye(n){return"boolean"==typeof n}(n)?"bool":"float32"}function jD(n){return!!(n&&n.constructor&&n.call&&n.apply)}function GD(n,t){for(let e=t;e<n;++e)if(n%e==0)return e;return n}function Ye(n){const t=n.length;if(t<2)return[];const e=new Array(t-1);e[t-2]=n[t-1];for(let i=t-3;i>=0;--i)e[i]=e[i+1]*n[i+1];return e}function dH(n,t,e,i=!1){const s=new Array;if(1===t.length){const r=t[0]*(i?2:1);for(let o=0;o<r;o++)s[o]=e[n+o]}else{const r=t[0],o=t.slice(1),a=o.reduce((l,c)=>l*c)*(i?2:1);for(let l=0;l<r;l++)s[l]=dH(n+l*a,o,e,i)}return s}function qo(n,t,e=!1){if(0===n.length)return t[0];const i=n.reduce((s,r)=>s*r)*(e?2:1);if(0===i)return[];if(i!==t.length)throw new Error(`[${n}] does not match the input size ${t.length}${e?" for a complex tensor":""}.`);return dH(0,n,t,e)}function qD(n,t){const e=xs(n,t);for(let i=0;i<e.length;i++)e[i]=1;return e}function xs(n,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t)return new Uint8Array(n);throw new Error(`Unknown data type ${t}`)}function hH(n,t){const e=n.reduce((i,s)=>i*s,1);if(null==t||"float32"===t)return qo(n,new Float32Array(e));if("int32"===t)return qo(n,new Int32Array(e));if("bool"===t)return qo(n,new Uint8Array(e));throw new Error(`Unknown data type ${t}`)}function wl(n){n.forEach(t=>{T(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Aa(n,t,e){if(0===t)return 0;if(1===t)return n[0];let i=n[n.length-1];for(let s=0;s<n.length-1;++s)i+=e[s]*n[s];return i}function Sf(n,t,e){if(0===t)return[];if(1===t)return[n];const i=new Array(t);for(let s=0;s<i.length-1;++s)i[s]=Math.floor(n/e[s]),n-=i[s]*e[s];return i[i.length-1]=n,i}function KD(n){return n&&n.then&&"function"==typeof n.then}const fH="tfjsflags";class qye{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Kye,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(J().getBool("IS_TEST")||J().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,i){if(this.flagRegistry[t]={evaluationFn:e,setHook:i},null!=this.urlFlags[t]){const s=this.urlFlags[t];J().getBool("IS_TEST")||J().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${s}.`),this.set(t,s)}}getAsync(t){var e=this;return Q(function*(){return t in e.flags||(e.flags[t]=yield e.evaluateFlag(t)),e.flags[t]})()}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(KD(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);fH in t&&t[fH].split(",").forEach(i=>{const[s,r]=i.split(":");this.urlFlags[s]=function Yye(n,t){const e=t.toLowerCase();return"true"===e||"false"===e?"true"===e:""+ +e===e?+e:t}(0,r)})}}function Kye(n){const t={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...i)=>(function Xye(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}(t,i[0],i[1]),i.join("="))),t}function J(){return pH}let XD,pH=null;function mH(){if(null==XD){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(!(typeof self<"u"))throw new Error("Could not find a global object");n=self}XD=n}return XD}function YD(n,t){const e=function Qye(){const n=mH();return null==n._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals}();if(e.has(n))return e.get(n);{const i=t();return e.set(n,i),e.get(n)}}const cx="Abs",Sg="Acos",Ig="Acosh",If="Add",ZD="AddN",ux="ArgMax",dx="ArgMin",Eg="Asin",kg="Asinh",Tg="Atan",Dg="Atanh",Ng="Atan2",hx="AvgPool",eN="AvgPoolGrad",fx="AvgPool3D",tN="AvgPool3DGrad",px="BatchMatMul",mx="BatchToSpaceND",nN="Bincount",iN="BitwiseAnd",gH="BroadcastArgs",Ag="Cast",Mg="Ceil",Pg="ClipByValue",sN="Complex",gx="ComplexAbs",bx="Concat",_x="Conv2D",rN="Conv2DBackpropFilter",yx="Conv2DBackpropInput",vx="Conv3D",oN="Conv3DBackpropFilterV2",aN="Conv3DBackpropInputV2",Rg="Cos",Og="Cosh",lN="Cumprod",xx="Cumsum",cN="CropAndResize",uN="DenseBincount",dN="DepthToSpace",Cx="DepthwiseConv2dNative",hN="DepthwiseConv2dNativeBackpropFilter",fN="DepthwiseConv2dNativeBackpropInput",wx="Dilation2D",pN="Dilation2DBackpropInput",mN="Dilation2DBackpropFilter",Fg="RealDiv",gN="Einsum",Lg="Elu",bN="EluGrad",$g="Erf",Sx="Equal",Bg="Exp",Ix="ExpandDims",Vg="Expm1",yN="Fill",vN="FlipLeftRight",zg="Floor",Ug="FloorDiv",Ex="FusedBatchNorm",kx="GatherV2",_H="GatherNd",Tx="Greater",Wg="GreaterEqual",Hg="Identity",xN="IFFT",CN="Imag",jg="IsFinite",Gg="IsInf",qg="IsNan",Dx="LeakyRelu",Nx="Less",Ax="LessEqual",yH="LinSpace",Kg="Log",Xg="Log1p",Mx="LogicalAnd",Px="LogicalNot",Rx="LogicalOr",Ox="LRN",wN="LRNGrad",Fx="Max",Yg="Maximum",Lx="MaxPool",SN="MaxPoolGrad",$x="MaxPool3D",IN="MaxPool3DGrad",vH="MaxPoolWithArgmax",Bx="Mean",Vx="Min",Zg="Minimum",zx="MirrorPad",Qg="Mod",xH="Multinomial",Jg="Multiply",Ux="Neg",Wx="NotEqual",EN="NonMaxSuppressionV3",kN="NonMaxSuppressionV4",TN="NonMaxSuppressionV5",Hx="OnesLike",jx="OneHot",Gx="Pack",qx="PadV2",eb="Pow",Kx="Prelu",Xx="Prod",CH="RaggedGather",wH="RaggedRange",SH="RaggedTensorToTensor",DN="Range",NN="Real",tb="Reciprocal",nb="Relu",Yx="Reshape",Zx="ResizeNearestNeighbor",AN="ResizeNearestNeighborGrad",Qx="ResizeBilinear",MN="ResizeBilinearGrad",ib="Relu6",Jx="Reverse",sb="Round",rb="Rsqrt",IH="ScatterNd",EH="TensorScatterUpdate",kH="SearchSorted",eC="Select",ob="Selu",tC="Slice",ab="Sin",lb="Sinh",cb="Sign",ub="Sigmoid",db="Softplus",hb="Sqrt",nC="Sum",iC="SpaceToBatchND",sC="SplitV",rC="Softmax",PN="SparseFillEmptyRows",RN="SparseReshape",ON="SparseSegmentMean",FN="SparseSegmentSum",TH="SparseToDense",fb="SquaredDifference",LN="Square",oC="StaticRegexReplace",$N="StridedSlice",BN="StringNGrams",VN="StringSplit",zN="StringToHashBucketFast",pb="Sub",mb="Tan",gb="Tanh",bb="Tile",UN="TopK",WN="Transform",Ef="Transpose",HN="Unique",aC="Unpack",lC="UnsortedSegmentSum",cC="ZerosLike",_b="Step",jN="RotateWithOffset",uC="_FusedMatMul",dC="FusedConv2D",hC="FusedDepthwiseConv2D";function Lr(...n){J().getBool("IS_TEST")||J().getBool("PROD")||console.warn(...n)}function i0e(...n){J().getBool("IS_TEST")||J().getBool("PROD")||console.log(...n)}const kf=YD("kernelRegistry",()=>new Map),yb=YD("gradRegistry",()=>new Map);function DH(n,t){const e=KN(n,t);return kf.get(e)}function NH(n){return yb.get(n)}function GN(n){const t=kf.entries(),e=[];for(;;){const{done:i,value:s}=t.next();if(i)break;const[r,o]=s,[a]=r.split("_");a===n&&e.push(o)}return e}function qN(n){const{kernelName:t,backendName:e}=n,i=KN(t,e);kf.has(i)&&Lr(`The kernel '${t}' for backend '${e}' is already registered`),kf.set(i,n)}function s0e(n){const{kernelName:t}=n;yb.has(t)&&J().getBool("DEBUG")&&Lr(`Overriding the gradient for '${t}'`),yb.set(t,n)}function KN(n,t){return`${t}_${n}`}function AH(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var MH=xe(658);const Yu=xe.n(MH)()||MH;function fC(n){return Yu.fromString(n,!0,16)}const PH=fC("c3a5c85c97cb3127"),Zu=fC("b492b66fbe98f273"),Rs=fC("9ae16a3b2f90404f");function XN(n){return n.xor(n.shru(47))}function RH(n,t,e){const i=n.slice(t,t+e);return Yu.fromBytes(Array.from(i),!0,!0)}function En(n,t){return RH(n,t,8)}function OH(n,t){return RH(n,t,4)}function Qi(n,t){return 0===t?n:n.shru(t).or(n.shl(64-t))}function Ec(n,t,e=fC("9ddfea08eb382d69")){let i=n.xor(t).mul(e);i=i.xor(i.shru(47));let s=t.xor(i).mul(e);return s=s.xor(s.shru(47)),s=s.mul(e),s}function pC(n,t,e,i){return function o0e(n,t,e,i,s,r){s=s.add(n),r=Qi(r.add(s).add(i),21);const o=s;return s=(s=s.add(t)).add(e),r=r.add(Qi(s,44)),[s.add(i),r.add(o)]}(En(n,t),En(n,t+8),En(n,t+16),En(n,t+24),e,i)}function u0e(n,t=n.length){const e=Yu.fromNumber(81,!0);if(t<=32)return t<=16?function a0e(n,t=n.length){if(t>=8){const e=Rs.add(2*t),i=En(n,0).add(Rs),s=En(n,t-8);return Ec(Qi(s,37).mul(e).add(i),Qi(i,25).add(s).mul(e),e)}if(t>=4){const e=Rs.add(2*t);return Ec(OH(n,0).shl(3).add(t),OH(n,t-4),e)}if(t>0){const o=t+(n[t-1]<<2);return XN(Rs.mul(n[0]+(n[t>>1]<<8)).xor(PH.mul(o))).mul(Rs)}return Rs}(n,t):function l0e(n,t=n.length){const e=Rs.add(2*t),i=En(n,0).mul(Zu),s=En(n,8),r=En(n,t-8).mul(e),o=En(n,t-16).mul(Rs);return Ec(Qi(i.add(s),43).add(Qi(r,30)).add(o),i.add(Qi(s.add(Rs),18)).add(r),e)}(n,t);if(t<=64)return function c0e(n,t=n.length){const e=Rs.add(2*t),i=En(n,0).mul(Rs),s=En(n,8),r=En(n,t-8).mul(e),o=En(n,t-16).mul(Rs),a=Qi(i.add(s),43).add(Qi(r,30)).add(o),l=Ec(a,i.add(Qi(s.add(Rs),18)).add(r),e),c=En(n,16).mul(e),u=En(n,24),d=a.add(En(n,t-32)).mul(e),h=l.add(En(n,t-24)).mul(e);return Ec(Qi(c.add(u),43).add(Qi(d,30)).add(h),c.add(Qi(u.add(i),18)).add(d),e)}(n,t);let i=e,s=e.mul(Zu).add(113),r=XN(s.mul(Rs).add(113)).mul(Rs),o=[Yu.UZERO,Yu.UZERO],a=[Yu.UZERO,Yu.UZERO];i=i.mul(Rs).add(En(n,0));let l=0;const c=64*(t-1>>6),u=c+(t-1&63)-63;do{i=Qi(i.add(s).add(o[0]).add(En(n,l+8)),37).mul(Zu),s=Qi(s.add(o[1]).add(En(n,l+48)),42).mul(Zu),i=i.xor(a[1]),s=s.add(o[0]).add(En(n,l+40)),r=Qi(r.add(a[0]),33).mul(Zu),o=pC(n,l,o[1].mul(Zu),i.add(a[0])),a=pC(n,l+32,r.add(a[1]),s.add(En(n,l+16))),[r,i]=[i,r],l+=64}while(l!==c);const d=Zu.add(r.and(255).shl(1));return l=u,a[0]=a[0].add(t-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),i=Qi(i.add(s).add(o[0]).add(En(n,l+8)),37).mul(d),s=Qi(s.add(o[1]).add(En(n,l+48)),42).mul(d),i=i.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(En(n,l+40))),r=Qi(r.add(a[0]),33).mul(d),o=pC(n,l,o[1].mul(d),i.add(a[0])),a=pC(n,l+32,r.add(a[1]),s.add(En(n,l+16))),[r,i]=[i,r],Ec(Ec(o[0],a[0],d).add(XN(s).mul(PH)).add(r),Ec(o[1],a[1],d).add(i),d)}function kc(n,t){return"string"===t?Tc(n):Qu([n],t)}function Qu(n,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Ju(n)),J().getBool("DEBUG")&&function Uye(n,t){for(let e=0;e<n.length;e++){const i=n[e];if(isNaN(i)||!isFinite(i))throw Error(`A tensor of type ${t} being uploaded contains ${i}.`)}}(n,t),function d0e(n,t){return n instanceof Float32Array&&"float32"===t||n instanceof Int32Array&&"int32"===t||n instanceof Uint8Array&&"bool"===t}(n,t))return n;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t){const e=new Uint8Array(n.length);for(let i=0;i<e.length;++i)0!==Math.round(n[i])&&(e[i]=1);return e}throw new Error(`Unknown data type ${t}`)}function nr(){return J().platform.now()}function Tc(n,t="utf-8"){return t=t||"utf-8",J().platform.encode(n,t)}function Dc(n,t="utf-8"){return t=t||"utf-8",J().platform.decode(n,t)}function mo(n){return null!=J().platform.isTypedArray?J().platform.isTypedArray(n):AH(n)}function Ju(n,t=[],e=!1){if(null==t&&(t=[]),"boolean"==typeof n||"number"==typeof n||"string"==typeof n||KD(n)||null==n||mo(n)&&e)t.push(n);else if(Array.isArray(n)||mo(n))for(let i=0;i<n.length;++i)Ju(n[i],t,e);else{let i=-1;for(const s of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(s)&&(i=Math.max(i,Number(s)));for(let s=0;s<=i;s++)Ju(n[s],t,e)}return t}class h0e{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new p0e)}profileKernel(t,e,i){let s;const r=()=>{s=i()};let o;const a=nr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(r);else{r();for(const c of s)c.dataSync();o=Promise.resolve({kernelMs:nr()-a})}if(J().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<s.length;c++){const u=s[c];u.data().then(d=>{f0e(d,u.dtype,t)})}return{kernelName:t,outputs:s,inputs:e,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>null!=c.getExtraProfileInfo?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:i,timeMs:s,inputs:r,extraInfo:o}=t;i.forEach(a=>{Promise.all([a.data(),s,o]).then(l=>{this.logger.logKernelProfile(e,a,l[0],l[1],r,l[2])})})}}function f0e(n,t,e){if("float32"!==t)return!1;for(let i=0;i<n.length;i++){const s=n[i];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${e}'`),!0}return!1}class p0e{logKernelProfile(t,e,i,s,r,o){const a="number"==typeof s?Cf(`${s}ms`,9):s.error,l=Cf(t,25),c=e.rank,u=e.size,d=Cf(e.shape.toString(),14);let h="";for(const f in r){const p=r[f];if(null!=p){const g=p.shape||e.shape,m=g.length;h+=`${f}: ${m}D ${m>0?g:""} `}}console.log(`%c${l}\t%c${a}\t%c${c}D ${d}\t%c${u}\t%c${h}\t%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}const FH=20,vb=3,YN=7;function b0e(n,t,e,i){const s=Ye(t),r=function _0e(n,t,e,i){const s=te(t),r=i[i.length-1],o=new Array(r).fill(0),a=t.length,l="complex64"===e?Cb(n):n;if(a>1)for(let c=0;c<s/r;c++){const u=c*r;for(let d=0;d<r;d++)o[d]=Math.max(o[d],xb(l[u+d],0,e).length)}return o}(n,t,e,s),o=t.length,a=mC(n,t,e,s,r),l=["Tensor"];return i&&(l.push(`  dtype: ${e}`),l.push(`  rank: ${o}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join("\n")),l.join("\n")}function xb(n,t,e){let i;return i=Array.isArray(n)?`${parseFloat(n[0].toFixed(YN))} + ${parseFloat(n[1].toFixed(YN))}j`:wg(n)?`'${n}'`:"bool"===e?LH(n):parseFloat(n.toFixed(YN)).toString(),Cf(i,t)}function LH(n){return 0===n?"false":"true"}function mC(n,t,e,i,s,r=!0){const o="complex64"===e?2:1,a=t[0],l=t.length;if(0===l)return"complex64"===e?[xb(Cb(n)[0],0,e)]:"bool"===e?[LH(n[0])]:[n[0].toString()];if(1===l){if(a>FH){let b=Array.from(n.slice(0,vb*o)),_=Array.from(n.slice((a-vb)*o,a*o));return"complex64"===e&&(b=Cb(b),_=Cb(_)),["["+b.map((y,v)=>xb(y,s[v],e)).join(", ")+", ..., "+_.map((y,v)=>xb(y,s[a-vb+v],e)).join(", ")+"]"]}return["["+("complex64"===e?Cb(n):Array.from(n)).map((m,b)=>xb(m,s[b],e)).join(", ")+"]"]}const c=t.slice(1),u=i.slice(1),d=i[0]*o,h=[];if(a>FH){for(let g=0;g<vb;g++){const m=g*d;h.push(...mC(n.slice(m,m+d),c,e,u,s,!1))}h.push("...");for(let g=a-vb;g<a;g++){const m=g*d;h.push(...mC(n.slice(m,m+d),c,e,u,s,g===a-1))}}else for(let g=0;g<a;g++){const m=g*d;h.push(...mC(n.slice(m,m+d),c,e,u,s,g===a-1))}const f=2===l?",":"";h[0]="["+(a>0?h[0]+f:"");for(let g=1;g<h.length-1;g++)h[g]=" "+h[g]+f;let p=",\n";for(let g=2;g<l;g++)p+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(r?"":p),h}function Cb(n){const t=[];for(let e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}class ds{constructor(t,e,i){if(this.dtype=e,this.shape=t.slice(),this.size=te(t),null!=i){const s=i.length;T(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=i||yi(e,this.size),this.strides=Ye(t)}set(t,...e){0===e.length&&(e=[0]),T(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const i=this.locToIndex(e);this.values[i]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const s of t){if(s<0||s>=this.shape[e])throw new Error(`Requested out of range element at ${t}.   Buffer shape=${this.shape}`);e++}let i=t[t.length-1];for(let s=0;s<t.length-1;++s)i+=this.strides[s]*t[s];return this.values[i]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let i=0;i<t.length-1;++i)e+=this.strides[i]*t[i];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let i=0;i<e.length-1;++i)e[i]=Math.floor(t/this.strides[i]),t-=e[i]*this.strides[i];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Ko().makeTensor(this.values,this.shape,this.dtype)}}let Ko=null,Tf=null,$H=null;class Bi{constructor(t,e,i,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=te(t),this.strides=Ye(t),this.dataId=i,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){var t=this;return Q(function*(){const e=yield t.data();return Tf.buffer(t.shape,t.dtype,e)})()}bufferSync(){return Tf.buffer(this.shape,this.dtype,this.dataSync())}array(){var t=this;return Q(function*(){const e=yield t.data();return qo(t.shape,e,"complex64"===t.dtype)})()}arraySync(){return qo(this.shape,this.dataSync(),"complex64"===this.dtype)}data(){var t=this;return Q(function*(){t.throwIfDisposed();const e=Ko().read(t.dataId);if("string"===t.dtype){const i=yield e;try{return i.map(s=>Dc(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e})()}dataToGPU(t){return this.throwIfDisposed(),Ko().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Ko().readSync(this.dataId);if("string"===this.dtype)try{return t.map(e=>Dc(e))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){var t=this;return Q(function*(){t.throwIfDisposed();const e=yield Ko().read(t.dataId);return"string"===t.dtype?e:new Uint8Array(e.buffer)})()}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ko().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Tf.print(this,t)}clone(){return this.throwIfDisposed(),Tf.clone(this)}toString(t=!1){return b0e(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Tf.cast(this,t)}variable(t=!0,e,i){return this.throwIfDisposed(),Ko().makeVariable(this,t,e,i)}}function ne(){return YD("Tensor",()=>Bi)}Object.defineProperty(Bi,Symbol.hasInstance,{value:n=>!!n&&null!=n.data&&null!=n.dataSync&&null!=n.throwIfDisposed}),ne();class gC extends Bi{constructor(t,e,i,s){super(t.shape,t.dtype,t.dataId,s),this.trainable=e,this.name=i}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!tn(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Ko().disposeTensor(this),this.dataId=t.dataId,Ko().incRef(this,null)}dispose(){Ko().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(gC,Symbol.hasInstance,{value:n=>n instanceof Bi&&null!=n.assign&&n.assign instanceof Function});var bC=(()=>{return(n=bC||(bC={})).float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64",bC;var n})(),_C=(()=>{return(n=_C||(_C={})).float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64",_C;var n})(),yC=(()=>{return(n=yC||(yC={})).float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64",yC;var n})(),vC=(()=>{return(n=vC||(vC={})).float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64",vC;var n})();const C0e={float32:yC,int32:bC,bool:_C,complex64:vC};function br(n,t){if("string"===n||"string"===t){if("string"===n&&"string"===t)return"string";throw new Error(`Can not upcast ${n} with ${t}`)}return C0e[n][t]}function ZN(n){return br(n,"int32")}function BH(n){return null!=n&&"object"==typeof n&&"texture"in n&&n.texture instanceof WebGLTexture}function VH(n){return typeof GPUBuffer<"u"&&null!=n&&"object"==typeof n&&"buffer"in n&&n.buffer instanceof GPUBuffer}function ci(n,t){if(n.dtype===t.dtype)return[n,t];const e=br(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function zH(n){const t=[];return UH(n,t,new Set),t}function UH(n,t,e){if(null==n)return;if(n instanceof Bi)return void t.push(n);if(!function w0e(n){return Array.isArray(n)||"object"==typeof n}(n))return;const i=n;for(const s in i){const r=i[s];e.has(r)||(e.add(r),UH(r,t,e))}}function QN(n){return null!=n.kernelName}class WH{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}let S0e=(()=>{class n{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new WH}ready(){var e=this;return Q(function*(){if(null!=e.pendingBackendInit)return e.pendingBackendInit.then(()=>{});if(null!=e.backendInstance)return;const i=e.getSortedBackends();for(let s=0;s<i.length;s++){const r=i[s];if(yield e.initializeBackend(r).success)return void(yield e.setBackend(r))}throw new Error("Could not initialize any backends, all backend initializations failed.")})()}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:i}=this.initializeBackendsAndReturnBest();if(i)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:i}=this.initializeBackend(e);if(i)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,i,s=1){return e in this.registryFactory?(Lr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:i,priority:s},!0)}setBackend(e){var i=this;return Q(function*(){if(null==i.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(i.backendName=e,null==i.registry[e]){i.backendInstance=null;const{success:s,asyncInit:r}=i.initializeBackend(e);if(!(r?yield s:s))return!1}return i.backendInstance=i.registry[e],i.setupRegisteredKernels(),i.profiler=new h0e(i.backendInstance),!0})()}setupRegisteredKernels(){GN(this.backendName).forEach(i=>{null!=i.setupFunc&&i.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){GN(e).forEach(s=>{null!=s.disposeFunc&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const i=this.registryFactory[e];if(null==i)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=i.factory();if(!s||s instanceof zD||"function"!=typeof s.then)return this.registry[e]=s,{success:!0,asyncInit:!1};{const r=++this.pendingBackendInitId,o=s.then(a=>!(r<this.pendingBackendInitId||(this.registry[e]=a,this.pendingBackendInit=null,0))).catch(a=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Lr(`Initialization of backend ${e} failed`),Lr(a.stack||a.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}}catch(s){return Lr(`Initialization of backend ${e} failed`),Lr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,i)=>this.registryFactory[i].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let i=0;i<e.length;i++){const s=e[i],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,i){const s=this.state.tensorInfo.get(i),r=s.backend,o=this.readSync(i),a=r.refCount(i);r.disposeData(i,!0),s.backend=e,e.move(i,o,s.shape,s.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,i){let r,s=null;if(null==i){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");i=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof i)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=i(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,i,s){e();try{const r=s();return i(),r}catch(r){throw i(),r}}nextTensorId(){return n.nextTensorId++}nextVariableId(){return n.nextVariableId++}clone(e){const i=$.runKernel(Hg,{x:e});return this.addTapeNode(this.state.activeScope.name,{x:e},[i],a=>({x:()=>$.runKernel(Ag,{x:a},{dtype:"float32"})}),[],{}),i}runKernel(e,i,s){if(null==DH(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:i,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,i,s){const r=this.backend.numDataIds();let o=0;s.forEach(c=>{o+="complex64"===c.dtype?3:1});const l=r-i-o-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${e}'`)}runKernelFunc(e){let i,s=[];const r=this.isTapeOn(),o=this.state.numBytes,a=this.state.numTensors;let l,c;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const u=QN(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(QN(e)){const{kernelName:g,inputs:m,attrs:b}=e,_=DH(g,this.backendName);T(null!=_,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),l=()=>{const y=this.backend.numDataIds();c=_.kernelFunc({inputs:m,attrs:b,backend:this.backend});const v=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,y,v);const x=v.map(S=>null!=S.rank?S:this.makeTensorFromTensorInfo(S));if(r){const S=this.getTensorsForGradient(g,m,x);s=this.saveTensorsForBackwardMode(S)}return x}}else{const{forwardFunc:g}=e,m=b=>{r&&(s=b.map(_=>this.keep(this.clone(_))))};l=()=>{const b=this.backend.numDataIds();c=this.tidy(()=>g(this.backend,m));const _=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,b,_),_}}const{inputs:d,attrs:h}=e,f=QN(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(p=this.profiler.profileKernel(u,d,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),i=p.outputs):i=l()}),r&&this.addTapeNode(u,d,i,f,s,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(g=>null!=d[g]?d[g].shape:null),outputShapes:i.map(g=>g.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(c)?i:i[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,i,s){const r=NH(e);if(null!=r){const o=r.inputsToSave||[],a=r.outputsToSave||[];let l;r.saveAllInputs?(T(Array.isArray(i),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(i).map(u=>i[u])):l=o.map(u=>i[u]);const c=s.filter((u,d)=>a[d]);return l.concat(c)}return[]}makeTensor(e,i,s,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");r=r||this.backend;let o=e;"string"===(s=s||"float32")&&wg(e[0])&&(o=e.map(c=>Tc(c)));const a=r.write(o,i,s),l=new Bi(i,s,a,this.nextTensorId());if(this.trackTensor(l,r),"string"===s){const c=this.state.tensorInfo.get(a),u=function Hye(n){if(null==n)return 0;let t=0;return n.forEach(e=>t+=e.length),t}(o);this.state.numBytes+=u-c.bytes,c.bytes=u}return l}makeTensorFromDataId(e,i,s,r){return this.makeTensorFromTensorInfo({dataId:e,shape:i,dtype:s=s||"float32"},r)}makeTensorFromTensorInfo(e,i){const{dataId:s,shape:r,dtype:o}=e,a=new Bi(r,o,s,this.nextTensorId());return this.trackTensor(a,i),a}makeVariable(e,i=!0,s,r){s=s||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const o=new gC(e,i,s,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,i){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let s=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(s=e.size*lx(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:i||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof gC||this.track(e)}incRef(e,i){this.trackTensor(e,i),this.backend.incRef(e.dataId)}removeDataId(e,i){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===i&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const i=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=i.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const s=e.size*lx(e.dtype);this.state.numBytes-=s}i.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,i.backend)}disposeVariables(){for(const e in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[e])}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}profile(e){var i=this;return Q(function*(){i.state.profiling=!0;const s=i.state.numBytes,r=i.state.numTensors;i.state.activeProfile.kernels=[],i.state.activeProfile.result=yield e(),i.state.profiling=!1,i.state.activeProfile.peakBytes=Math.max(...i.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),i.state.activeProfile.newBytes=i.state.numBytes-s,i.state.activeProfile.newTensors=i.state.numTensors-r;for(const o of i.state.activeProfile.kernels)o.kernelTimeMs=yield o.kernelTimeMs,o.extraInfo=yield o.extraInfo;return i.state.activeProfile})()}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,i,s,r,o,a){const l={id:this.state.nextTapeNodeId++,kernelName:e,inputs:i,outputs:s,saved:o},c=NH(e);null!=c&&(r=c.gradFunc),null!=r&&(l.gradient=u=>(u=u.map((d,h)=>{if(null==d){const f=s[h],p=xs(f.size,f.dtype);return this.makeTensor(p,f.shape,f.dtype)}return d}),r(u.length>1?u:u[0],o,a))),this.state.activeTape.push(l)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const i={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(i.name=e),this.state.scopeStack.push(i),this.state.activeScope=i}endScope(e){const i=zH(e),s=new Set(i.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const a=this.state.activeScope.track[o];!a.kept&&!s.has(a.id)&&a.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],i.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(e,i,s,r=!1){if(T(i.length>0,()=>"gradients() received an empty list of xs."),null!=s&&"float32"!==s.dtype)throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));T(o instanceof Bi,()=>"The result y returned by f() must be a tensor.");const a=function m0e(n,t,e){const i={},s={};for(let l=0;l<t.length;l++)i[t[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<t.length;p++)if(i[h.id]){c.outputs.forEach(g=>i[g.id]=!0),f=!0,s[c.id]=!0;break}if(f)break}}const r={};r[e.id]=!0;const o={};for(let l=n.length-1;l>=0;l--){const c=n[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(r[c.outputs[d].id]){for(const h in u)r[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<n.length;l++){const c=n[l];if(s[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];i[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}(this.state.activeTape,i,o);if(!r&&0===a.length&&i.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const l={};l[o.id]=s??function I0e(n){const t=qD(te(n),"float32");return $.makeTensor(t,n,"float32")}(o.shape),function g0e(n,t,e,i){for(let s=t.length-1;s>=0;s--){const r=t[s],o=[];if(r.outputs.forEach(l=>{const c=n[l.id];o.push(null!=c?c:null)}),null==r.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${r.kernelName}.`);const a=r.gradient(o);for(const l in r.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=e(()=>a[l]());if("float32"!==c.dtype)throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=r.inputs[l];if(!tn(c.shape,u.shape))throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(null==n[u.id])n[u.id]=c;else{const d=n[u.id];n[u.id]=i(d,c),d.dispose()}}}}(l,a,u=>this.tidy(u),E0e);const c=i.map(u=>l[u.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(u=>{for(const d of u.saved)d.dispose()}),this.state.activeTape=null),{value:o,grads:c}})}customGrad(e){return T(jD(e),()=>"The f passed in customGrad(f) must be a function."),(...i)=>{let s;T(i.every(l=>l instanceof Bi),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const r={};return i.forEach((l,c)=>{r[c]=l}),this.runKernelFunc({forwardFunc:(l,c)=>(s=e(...i,c),T(s.value instanceof Bi,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(jD(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),backwardsFunc:(l,c)=>{const u=s.gradFunc(l,c),d=Array.isArray(u)?u:[u];T(d.length===i.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(d.every(f=>f instanceof Bi),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return d.forEach((f,p)=>{h[p]=()=>f}),h},inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,i){return this.state.tensorInfo.get(e).backend.readToGPU(e,i)}time(e){var i=this;return Q(function*(){const s=nr(),r=yield i.backend.time(e);return r.wallMs=nr()-s,r})()}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new WH;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}return n.nextTensorId=0,n.nextVariableId=0,n})();function HH(){const n=mH();if(null==n._tfengine){const t=new qye(n);n._tfengine=new S0e(t)}return function Zye(n){pH=n}(n._tfengine.ENV),function y0e(n){Ko=n}(()=>n._tfengine),n._tfengine}const $=HH();function E0e(n,t){return $.runKernel(If,{a:n,b:t})}let JN;function jH(n){if(void 0!==JN)return JN;if(n||function k0e(){return typeof navigator<"u"&&null!=navigator}()){if(n||(n=navigator),"ReactNative"===n.product)return!0;const t=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");return t?/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)):n.userAgentData&&n.userAgentData.mobile}return!1}function GH(){return typeof window<"u"&&null!=window.document||typeof WorkerGlobalScope<"u"}const ir=J();function xC(n,t){let e=n;if(mo(n))return"string"===t?[]:[n.length];if(BH(n))return[n.height,n.width*(n.channels||"RGBA").length];if(VH(n))return[n.buffer.size/(null==t?4:lx(t))];if(!Array.isArray(n))return[];const i=[];for(;Array.isArray(e)||mo(e)&&"string"!==t;)i.push(e.length),e=e[0];return Array.isArray(n)&&J().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&qH(n,i,[]),i}function qH(n,t,e){if(e=e||[],!Array.isArray(n)&&!mo(n))return void T(0===t.length,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);T(t.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${n.length} elements`),T(n.length===t[0],()=>`Element arr[${e.join("][")}] should have ${t[0]} elements, but has ${n.length} elements`);const i=t.slice(1);for(let s=0;s<n.length;++s)qH(n[s],i,e.concat(s))}function KH(n,t,e,i){if("string_or_numeric"!==n){if(null==n)throw new Error("Expected dtype cannot be null.");if("numeric"!==n&&n!==t||"numeric"===n&&"string"===t)throw new Error(`Argument '${e}' passed to '${i}' must be ${n} tensor, but got ${t} tensor`)}}function N(n,t,e,i="numeric"){if(n instanceof ne())return KH(i,n.dtype,t,e),n;let s=wf(n);if("string"!==s&&["bool","int32","float32"].indexOf(i)>=0&&(s=i),KH(i,s,t,e),null==n||!mo(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error(`Argument '${t}' passed to '${e}' must be a Tensor or TensorLike, but got '${null==n?"null":n.constructor.name}'`);const r=xC(n,s);!mo(n)&&!Array.isArray(n)&&(n=[n]);const a="string"!==s?Qu(n,s):Ju(n,[],!0);return $.makeTensor(a,r,s)}function XH(n,t,e,i="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${t} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((r,o)=>N(r,`${t}[${o}]`,e,i))}ir.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ir.registerFlag("IS_BROWSER",()=>GH()),ir.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"),ir.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),ir.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),ir.registerFlag("PROD",()=>!1),ir.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ir.getBool("DEBUG")),ir.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),ir.registerFlag("IS_TEST",()=>!1),ir.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ir.getBool("DEBUG")),ir.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),ir.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),ir.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);const T0e="__op";function V(n){const t=Object.keys(n);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let e=t[0];const i=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e+=T0e;const s=(...r)=>{$.startScope(e);try{const o=i(...r);return KD(o)&&console.error("Cannot return a Promise inside of tidy."),$.endScope(o),o}catch(o){throw $.endScope(null),o}};return Object.defineProperty(s,"name",{value:e,configurable:!0}),s}const ed=V({complex_:function D0e(n,t){const e=N(n,"real","complex"),i=N(t,"imag","complex");return po(e.shape,i.shape,`real and imag shapes, ${e.shape} and ${i.shape}, must match in call to tf.complex().`),$.runKernel(sN,{real:e,imag:i})}});function CC(n,t,e,i){if(null==i)i=wf(n);else if("complex64"===i)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(VH(n)||BH(n)){if("float32"!==i&&"int32"!==i)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${i}.`);return $.backend.createTensorFromGPUData(n,t||e,i)}if(!mo(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){wl(t);const s=te(t),r=te(e);T(s===r,()=>`Based on the provided shape, [${t}], the tensor should have ${s} values but has ${r}`);for(let o=0;o<e.length;++o){const l=o!==e.length-1||e[o]!==te(t.slice(o));T(e[o]===t[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${t}). `)}}return!mo(n)&&!Array.isArray(n)&&(n=[n]),t=t||e,n="string"!==i?Qu(n,i):Ju(n,[],!0),$.makeTensor(n,t,i)}function wb(n,t,e){return CC(n,t,xC(n,e),e)}const td={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Ma{static join(t){return new Ma(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,null==t||(t instanceof Array||(t=[t]),0===(t=t.map(i=>mo(i)?i.buffer:i)).length))return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let i=0;i<t.length;i++){const s=t[i];i!==t.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const r=e+s.byteLength;this.shards.push({buffer:s,start:e,end:r}),e=r}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,e=this.byteLength){if(0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),(e=Math.min(this.byteLength,e))<=t)return new ArrayBuffer(0);const i=this.findShardForByte(t);if(-1===i)throw new Error(`Could not find start shard for byte ${t}`);const r=new ArrayBuffer(e-t),o=new Uint8Array(r);let a=0;for(let l=i;l<this.shards.length;l++){const c=this.shards[l],d=t+a-c.start,h=a,p=Math.min(e,c.end)-c.start,g=new Uint8Array(c.buffer,d,p-d);if(o.set(g,h),a+=g.length,e<c.end)break}return r}findShardForByte(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(s){return t<s.start?-1:t>=s.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;const i=function N0e(n,t){let e=0,i=n.length;for(;e<=i;){const s=Math.floor((i-e)/2)+e,r=t(n[s]);if(0===r)return s;r<0?i=s:e=s+1}return-1}(this.shards,e);return-1===i?-1:(this.previousShardIndex=i,this.previousShardIndex)}}function Pa(){return $}function eA(){return $.memory()}function Y(n,t){return $.tidy(n,t)}function It(n){zH(n).forEach(e=>e.dispose())}function Ra(n){return $.keep(n)}function YH(n,t,e=1){return $.registerBackend(n,t,e)}!function x0e(n){$H=n}(function A0e(n){J().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")});const Nc=4;function QH(n,t){return tA.apply(this,arguments)}function tA(){return tA=Q(function*(n,t){const e=[],i=[],s=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<s.length;++o){const a=s[o],l=Array.isArray(n)?n[o].tensor:n[a];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype&&"complex64"!==l.dtype)throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){const u=new Promise(function(){var d=Q(function*(h){const f=yield l.bytes(),p=f.reduce((b,_)=>b+_.length,0)+Nc*f.length,g=new Uint8Array(p);let m=0;for(let b=0;b<f.length;b++){const _=f[b],y=new Uint8Array(new Uint32Array([_.length]).buffer);g.set(y,m),m+=Nc,g.set(_,m),m+=_.length}h(g)});return function(h){return d.apply(this,arguments)}}());i.push(u)}else i.push(l.data());null!=t&&(c.group=t),e.push(c)}return{data:O0e(yield Promise.all(i)),specs:e}}),tA.apply(this,arguments)}function P0e(n,t){const e=te(n.shape);let i;if("quantization"in n)i=td[n.quantization.dtype];else{if("string"===n.dtype){let s=0;for(let r=0;r<e;r++)s+=Nc+new Uint32Array(t(s,s+Nc))[0];return s}i=td[n.dtype]}return e*i}function ej(n,t){const e=n.name,i=n.dtype,s=n.shape,r=te(s);let o,a=0;if("quantization"in n){const l=n.quantization;if("uint8"===l.dtype||"uint16"===l.dtype){if(!("min"in l)||!("scale"in l))throw new Error(`Weight ${n.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==l.dtype)throw new Error(`Weight ${n.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==i)throw new Error(`Weight ${n.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${i}.`)}const c=td[l.dtype],u="uint8"===l.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===i)if("uint8"===l.dtype||"uint16"===l.dtype){o=new Float32Array(u.length);for(let d=0;d<u.length;d++)o[d]=u[d]*l.scale+l.min}else{if("float16"!==l.dtype)throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);o=function W0e(){const n=function V0e(){const n=e=>{let i=e<<13,s=0;for(;!(8388608&i);)s-=8388608,i<<=1;return i&=-8388609,s+=947912704,i|s},t=new Uint32Array(2048);t[0]=0;for(let e=1;e<1024;e++)t[e]=n(e);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function z0e(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let t=1;t<31;t++)n[t]=t<<23;for(let t=33;t<63;t++)n[t]=2147483648+(t-32<<23);return n}(),e=function U0e(){const n=new Uint32Array(64);for(let t=0;t<64;t++)n[t]=1024;return n[0]=n[32]=0,n}();return i=>{const s=new ArrayBuffer(4*i.length),r=new Uint32Array(s);for(let o=0;o<i.length;o++){const a=i[o];r[o]=n[e[a>>10]+(1023&a)]+t[a>>10]}return new Float32Array(s)}}()(u)}else{if("int32"!==i)throw new Error(`Unsupported dtype in weight '${e}': ${i}`);if("uint8"!==l.dtype&&"uint16"!==l.dtype)throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let d=0;d<u.length;d++)o[d]=Math.round(u[d]*l.scale+l.min)}a+=r*c}else if("string"===i){const l=te(n.shape);o=[];for(let c=0;c<l;c++){const u=new Uint32Array(t.slice(a,a+Nc))[0];a+=Nc;const d=new Uint8Array(t.slice(a,a+u));o.push(d),a+=u}}else{const l=td[i];if("float32"===i)o=new Float32Array(t);else if("int32"===i)o=new Int32Array(t);else{if("bool"!==i){if("complex64"===i){o=new Float32Array(t);const c=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let p=0;p<c.length;p++)c[p]=o[2*p],u[p]=o[2*p+1];const d=wb(c,s,"float32"),h=wb(u,s,"float32"),f=ed(d,h);return d.dispose(),h.dispose(),f}throw new Error(`Unsupported dtype in weight '${e}': ${i}`)}o=new Uint8Array(t)}a+=r*l}return wb(o,s,i)}function O0e(n){if(null===n)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let t=0;const e=[];n.forEach(r=>{if(t+=r.byteLength,e.push(r.byteLength===r.buffer.byteLength?r:new r.constructor(r)),!(r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${r.constructor.name}`)});const i=new Uint8Array(t);let s=0;return e.forEach(r=>{i.set(new Uint8Array(r.buffer),s),s+=r.byteLength}),i.buffer}const rA=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function nj(n){return rA?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function sj(n,t){const e={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:t};return null!=n.signature&&(e.signature=n.signature),null!=n.userDefinedMetadata&&(e.userDefinedMetadata=n.userDefinedMetadata),null!=n.modelInitializer&&(e.modelInitializer=n.modelInitializer),null!=n.initializerSignature&&(e.initializerSignature=n.initializerSignature),null!=n.trainingConfig&&(e.trainingConfig=n.trainingConfig),e}function rj(n,t){return oA.apply(this,arguments)}function oA(){return(oA=Q(function*(n,t){let e,i;return null!=n.weightsManifest&&([e,i]=yield t(n.weightsManifest)),function B0e(n,t,e){const i={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(null!=n.trainingConfig&&(i.trainingConfig=n.trainingConfig),null!=n.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!e)throw new Error("modelJSON has weightsManifest but weightData is null");i.weightSpecs=t,i.weightData=e}return null!=n.signature&&(i.signature=n.signature),null!=n.userDefinedMetadata&&(i.userDefinedMetadata=n.userDefinedMetadata),null!=n.modelInitializer&&(i.modelInitializer=n.modelInitializer),null!=n.initializerSignature&&(i.initializerSignature=n.initializerSignature),i}(n,e,i)})).apply(this,arguments)}function wC(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==n.modelTopology?0:nj(JSON.stringify(n.modelTopology)),weightSpecsBytes:null==n.weightSpecs?0:nj(JSON.stringify(n.weightSpecs)),weightDataBytes:null==n.weightData?0:new Ma(n.weightData).byteLength}}function oj(n){const t=[];for(const e of n)t.push(...e.weights);return t}class ei{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==ei.instance&&(ei.instance=new ei),ei.instance}static registerSaveRouter(t){ei.getInstance().saveRouters.push(t)}static registerLoadRouter(t){ei.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return ei.getHandlers(t,"save")}static getLoadHandlers(t,e){return ei.getHandlers(t,"load",e)}static getHandlers(t,e,i){const s=[];return("load"===e?ei.getInstance().loadRouters:ei.getInstance().saveRouters).forEach(o=>{const a=o(t,i);null!==a&&s.push(a)}),s}}const j0e=(n,t)=>ei.getLoadHandlers(n,t),SC="tensorflowjs",nd="models_store",Ac="model_info_store";function cA(){if(!J().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function uA(n){const t=n.result;t.createObjectStore(nd,{keyPath:"modelPath"}),t.createObjectStore(Ac,{keyPath:"modelPath"})}let Df=(()=>{class n{constructor(e){if(this.indexedDB=cA(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}save(e){var i=this;return Q(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return i.databaseAction(i.modelPath,e)})()}load(){var e=this;return Q(function*(){return e.databaseAction(e.modelPath)})()}databaseAction(e,i){return new Promise((s,r)=>{const o=this.indexedDB.open(SC,1);o.onupgradeneeded=()=>uA(o),o.onsuccess=()=>{const a=o.result;if(null==i){const l=a.transaction(nd,"readonly"),u=l.objectStore(nd).get(this.modelPath);u.onsuccess=()=>{if(null==u.result)return a.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=d=>(a.close(),r(u.error)),l.oncomplete=()=>a.close()}else{i.weightData=Ma.join(i.weightData);const l=wC(i),c=a.transaction(Ac,"readwrite");let d,h,u=c.objectStore(Ac);try{d=u.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(f){return r(f)}d.onsuccess=()=>{h=a.transaction(nd,"readwrite");const f=h.objectStore(nd);let p;try{p=f.put({modelPath:this.modelPath,modelArtifacts:i,modelArtifactsInfo:l})}catch(g){return r(g)}p.onsuccess=()=>s({modelArtifactsInfo:l}),p.onerror=g=>{u=c.objectStore(Ac);const m=u.delete(this.modelPath);m.onsuccess=()=>(a.close(),r(p.error)),m.onerror=b=>(a.close(),r(p.error))}},d.onerror=f=>(a.close(),r(d.error)),c.oncomplete=()=>{null==h?a.close():h.oncomplete=()=>a.close()}}},o.onerror=a=>r(o.error)})}}return n.URL_SCHEME="indexeddb://",n})();const aj=n=>J().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Df.URL_SCHEME)?function G0e(n){return new Df(n)}(n.slice(Df.URL_SCHEME.length)):null;ei.registerSaveRouter(aj),ei.registerLoadRouter(aj);class K0e{constructor(){this.indexedDB=cA()}listModels(){var t=this;return Q(function*(){return new Promise((e,i)=>{const s=t.indexedDB.open(SC,1);s.onupgradeneeded=()=>uA(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(Ac,"readonly"),l=o.objectStore(Ac).getAll();l.onsuccess=()=>{const c={};for(const u of l.result)c[u.modelPath]=u.modelArtifactsInfo;e(c)},l.onerror=c=>(r.close(),i(l.error)),o.oncomplete=()=>r.close()},s.onerror=r=>i(s.error)})})()}removeModel(t){var e=this;return Q(function*(){return t=function q0e(n){return n.startsWith(Df.URL_SCHEME)?n.slice(Df.URL_SCHEME.length):n}(t),new Promise((i,s)=>{const r=e.indexedDB.open(SC,1);r.onupgradeneeded=()=>uA(r),r.onsuccess=()=>{const o=r.result,a=o.transaction(Ac,"readwrite"),l=a.objectStore(Ac),c=l.get(t);let u;c.onsuccess=()=>{if(null==c.result)return o.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const d=l.delete(t),h=()=>{u=o.transaction(nd,"readwrite");const p=u.objectStore(nd).delete(t);p.onsuccess=()=>i(c.result.modelArtifactsInfo),p.onerror=g=>s(c.error)};d.onsuccess=h,d.onerror=f=>(h(),o.close(),s(c.error))}},c.onerror=d=>(o.close(),s(c.error)),a.oncomplete=()=>{null==u?o.close():u.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})})()}}const Oa="/",id="tensorflowjs_models",lj="info",X0e="model_topology",Y0e="weight_specs",Z0e="weight_data",Q0e="model_metadata";function cj(n){return{info:[id,n,lj].join(Oa),topology:[id,n,X0e].join(Oa),weightSpecs:[id,n,Y0e].join(Oa),weightData:[id,n,Z0e].join(Oa),modelMetadata:[id,n,Q0e].join(Oa)}}function uj(n){for(const t of Object.values(n))window.localStorage.removeItem(t)}function dj(n){const t=n.split(Oa);if(t.length<3)throw new Error(`Invalid key format: ${n}`);return t.slice(1,t.length-1).join(Oa)}let Nf=(()=>{class n{constructor(e){if(!J().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=cj(this.modelPath)}save(e){var i=this;return Q(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const s=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=wC(e),a=Ma.join(e.weightData);try{return i.LS.setItem(i.keys.info,JSON.stringify(o)),i.LS.setItem(i.keys.topology,s),i.LS.setItem(i.keys.weightSpecs,r),i.LS.setItem(i.keys.weightData,function F0e(n){if(rA)return Buffer.from(n).toString("base64");const t=new Uint8Array(n);let e="";for(let i=0,s=t.length;i<s;i++)e+=String.fromCharCode(t[i]);return btoa(e)}(a)),i.LS.setItem(i.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0})),{modelArtifactsInfo:o}}catch{throw uj(i.keys),new Error(`Failed to save model '${i.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}})()}load(){var e=this;return Q(function*(){const i=JSON.parse(e.LS.getItem(e.keys.info));if(null==i)throw new Error(`In local storage, there is no model with name '${e.modelPath}'`);if("JSON"!==i.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const s={},r=JSON.parse(e.LS.getItem(e.keys.topology));if(null==r)throw new Error(`In local storage, the topology of model '${e.modelPath}' is missing.`);s.modelTopology=r;const o=JSON.parse(e.LS.getItem(e.keys.weightSpecs));if(null==o)throw new Error(`In local storage, the weight specs of model '${e.modelPath}' are missing.`);s.weightSpecs=o;const a=e.LS.getItem(e.keys.modelMetadata);if(null!=a){const c=JSON.parse(a);s.format=c.format,s.generatedBy=c.generatedBy,s.convertedBy=c.convertedBy,null!=c.signature&&(s.signature=c.signature),null!=c.userDefinedMetadata&&(s.userDefinedMetadata=c.userDefinedMetadata),null!=c.modelInitializer&&(s.modelInitializer=c.modelInitializer),null!=c.initializerSignature&&(s.initializerSignature=c.initializerSignature),null!=c.trainingConfig&&(s.trainingConfig=c.trainingConfig)}const l=e.LS.getItem(e.keys.weightData);if(null==l)throw new Error(`In local storage, the binary weight values of model '${e.modelPath}' are missing.`);return s.weightData=function L0e(n){if(rA){const i=Buffer.from(n,"base64");return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)}const t=atob(n),e=new Uint8Array(t.length);for(let i=0;i<t.length;++i)e.set([t.charCodeAt(i)],i);return e.buffer}(l),s})()}}return n.URL_SCHEME="localstorage://",n})();const hj=n=>J().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Nf.URL_SCHEME)?function eve(n){return new Nf(n)}(n.slice(Nf.URL_SCHEME.length)):null;ei.registerSaveRouter(hj),ei.registerLoadRouter(hj);class tve{constructor(){T(J().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){var t=this;return Q(function*(){const e={},i=id+Oa,s=Oa+lj;for(let r=0;r<t.LS.length;++r){const o=t.LS.key(r);o.startsWith(i)&&o.endsWith(s)&&(e[dj(o)]=JSON.parse(t.LS.getItem(o)))}return e})()}removeModel(t){var e=this;return Q(function*(){const i=cj(t=function J0e(n){return n.startsWith(Nf.URL_SCHEME)?n.slice(Nf.URL_SCHEME.length):n}(t));if(null==e.LS.getItem(i.info))throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(e.LS.getItem(i.info));return uj(i),s})()}}class Os{constructor(){this.managers={}}static getInstance(){return null==Os.instance&&(Os.instance=new Os),Os.instance}static registerManager(t,e){T(null!=t,()=>"scheme must not be undefined or null."),t.endsWith("://")&&(t=t.slice(0,t.indexOf("://"))),T(t.length>0,()=>"scheme must not be an empty string.");const i=Os.getInstance();T(null==i.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),i.managers[t]=e}static getManager(t){const e=Os.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(Os.getInstance().managers)}}class nve{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){typeof window>"u"||!J().getBool("USE_SETTIMEOUTCUSTOM")?setTimeout(t,e):(this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",i=>{i.source===window&&i.data.name===this.messageName&&(i.stopPropagation(),(0,this.functionRefs[i.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0)))}isTypedArray(t){return AH(t)}}if(J().get("IS_BROWSER")){J().setPlatform("browser",new nve);try{Os.registerManager(Nf.URL_SCHEME,new tve)}catch{}try{Os.registerManager(Df.URL_SCHEME,new K0e)}catch{}}let Mf;function Dt(n,t="float32",e){return t=t||"float32",wl(n),new ds(n,t,e)}J().get("IS_NODE")&&!J().get("IS_BROWSER")&&J().setPlatform("node",new class sve{constructor(){this.util=xe(628),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=J().global.fetch?J().global.fetch(t,e):(null==Mf&&(Mf=xe(410)),Mf(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}});const Te=V({cast_:function rve(n,t){const e=N(n,"x","cast");if(!function Wye(n){return"bool"===n||"complex64"===n||"float32"===n||"int32"===n||"string"===n}(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==e.dtype||"string"!==t&&"string"===e.dtype)throw new Error("Only strings can be casted to strings");return $.runKernel(Ag,{x:e},{dtype:t})}}),sd=V({clone_:function ove(n){const e={x:N(n,"x","clone","string_or_numeric")};return $.runKernel(Hg,e)}});HH(),function v0e(n){Tf=n}({buffer:Dt,cast:Te,clone:sd,print:function ave(n,t=!1){console.log(n.toString(t))}});const ge=V({add_:function lve(n,t){let e=N(n,"a","add"),i=N(t,"b","add");return[e,i]=ci(e,i),$.runKernel(If,{a:e,b:i})}}),pj=V({floorDiv_:function cve(n,t){let e=N(n,"a","floorDiv"),i=N(t,"b","floorDiv");return[e,i]=ci(e,i),$.runKernel(Ug,{a:e,b:i})}}),qe=V({div_:function uve(n,t){let e=N(n,"a","div"),i=N(t,"b","div");return[e,i]=ci(e,i),"int32"===e.dtype&&"int32"===i.dtype?pj(e,i):$.runKernel(Fg,{a:e,b:i},{})}}),F=V({mul_:function dve(n,t){let e=N(n,"a","mul"),i=N(t,"b","mul");return[e,i]=ci(e,i),$.runKernel(Jg,{a:e,b:i})}}),Cs=V({sqrt_:function hve(n){const e={x:N(n,"x","sqrt","float32")};return $.runKernel(hb,e)}}),kn=V({square_:function fve(n){const t=N(n,"x","square");return $.runKernel("Square",{x:t},{})}}),Ht=V({zerosLike_:function pve(n){const e={x:N(n,"x","zerosLike")};return $.runKernel(cC,e)}});function Sl(n){return $.customGrad(n)}function ct(n,t){if((mo(n)&&"string"!==t||Array.isArray(n))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&mo(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return CC(n,[],[],t)}const gve=new Map,gA=new Map;class Pf{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class go{constructor(){this.classNameMap={}}static getMap(){return null==go.instance&&(go.instance=new go),go.instance}static register(t){go.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function pe(n,t,e){T(null!=n.className,()=>"Class being registered does not have the static className property defined."),T("string"==typeof n.className,()=>"className is required to be a string, but got type "+typeof n.className),T(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof e>"u"&&(e=n.className);const s=t+">"+e;return go.register(n),gve.set(s,n),gA.set(n,s),n}class Mc extends Pf{minimize(t,e=!1,i){const{value:s,grads:r}=this.computeGradients(t,i);if(null!=i){const o=i.map(a=>({name:a.name,tensor:r[a.name]}));this.applyGradients(o)}else this.applyGradients(r);return It(r),e?s:(s.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return function mve(n,t){T(jD(n),()=>"The f passed in variableGrads(f) must be a function"),T(null==t||Array.isArray(t)&&t.every(c=>c instanceof gC),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const e=null!=t;if(!e){t=[];for(const c in $.registeredVariables)t.push($.registeredVariables[c])}const i=e?t.filter(c=>!c.trainable):null,s=t.length;T((t=t.filter(c=>c.trainable)).length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const{value:o,grads:a}=$.gradients(n,t,null,!0);T(a.some(c=>null!=c),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(0===o.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return t.forEach((c,u)=>{null!=a[u]&&(l[c.name]=a[u])}),i?.forEach(c=>l[c.name]=null),{value:o,grads:l}}(t,e)}dispose(){null!=this.iterations_&&It(this.iterations_)}saveIterations(){var t=this;return Q(function*(){return null==t.iterations_&&(t.iterations_=0),{name:"iter",tensor:ct(t.iterations_,"int32")}})()}getWeights(){return Q(function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})()}setWeights(t){var e=this;return Q(function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${e.getClassName()}`)})()}extractIterations(t){var e=this;return Q(function*(){return e.iterations_=(yield t[0].tensor.data())[0],t.slice(1)})()}}Object.defineProperty(Mc,Symbol.hasInstance,{value:n=>null!=n.minimize&&null!=n.computeGradients&&null!=n.applyGradients});class mj extends Mc{static get className(){return"Adadelta"}constructor(t,e,i=null){super(),this.learningRate=t,this.rho=e,this.epsilon=i,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==i&&(this.epsilon=$.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(i=>i.name):Object.keys(t)).forEach((i,s)=>{const r=$.registeredVariables[i];null==this.accumulatedGrads[s]&&(this.accumulatedGrads[s]={originalName:`${i}/accum_grad`,variable:Y(()=>Ht(r).variable(!1))}),null==this.accumulatedUpdates[s]&&(this.accumulatedUpdates[s]={originalName:`${i}/accum_var`,variable:Y(()=>Ht(r).variable(!1))});const a=Array.isArray(t)?t[s].tensor:t[i];if(null==a)return;const l=this.accumulatedGrads[s].variable,c=this.accumulatedUpdates[s].variable;Y(()=>{const u=ge(F(l,this.rho),F(kn(a),1-this.rho)),d=F(qe(Cs(ge(c,this.epsilon)),Cs(ge(l,this.epsilon))),a),h=ge(F(c,this.rho),F(kn(d),1-this.rho));l.assign(u),c.assign(h);const f=ge(F(d,-this.learningRate),r);r.assign(f)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(It(this.accumulatedGrads.map(t=>t.variable)),It(this.accumulatedUpdates.map(t=>t.variable)))}getWeights(){var t=this;return Q(function*(){const e=[...t.accumulatedGrads,...t.accumulatedUpdates];return[yield t.saveIterations()].concat(e.map(i=>({name:i.originalName,tensor:i.variable})))})()}setWeights(t){var e=this;return Q(function*(){const i=(t=yield e.extractIterations(t)).length/2;e.accumulatedGrads=t.slice(0,i).map(r=>({originalName:r.name,variable:r.tensor.variable(!1)})),e.accumulatedUpdates=t.slice(i,2*i).map(r=>({originalName:r.name,variable:r.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}function Sb(n,t,e){return wl(n),e=e||wf(t),$.runKernel(yN,{},{shape:n,value:t,dtype:e})}class gj extends Mc{static get className(){return"Adagrad"}constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(i=>i.name):Object.keys(t)).forEach((i,s)=>{const r=$.registeredVariables[i];null==this.accumulatedGrads[s]&&(this.accumulatedGrads[s]={originalName:`${i}/accumulator`,variable:Y(()=>Sb(r.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[s].tensor:t[i];if(null==o)return;const a=this.accumulatedGrads[s].variable;Y(()=>{const l=ge(a,kn(o));a.assign(l);const c=ge(F(qe(o,Cs(ge(l,$.backend.epsilon()))),-this.learningRate),r);r.assign(c)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&It(this.accumulatedGrads.map(t=>t.variable))}getWeights(){var t=this;return Q(function*(){return[yield t.saveIterations()].concat(t.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))})()}setWeights(t){var e=this;return Q(function*(){t=yield e.extractIterations(t),e.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}const rd=V({pow_:function bve(n,t){let e=N(n,"base","pow"),i=N(t,"exp","pow");return[e,i]=ci(e,i),$.runKernel(eb,{a:e,b:i})}}),Be=V({sub_:function _ve(n,t){let e=N(n,"a","sub"),i=N(t,"b","sub");return[e,i]=ci(e,i),$.runKernel(pb,{a:e,b:i})}});class bj extends Mc{static get className(){return"Adam"}constructor(t,e,i,s=null){super(),this.learningRate=t,this.beta1=e,this.beta2=i,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Y(()=>{this.accBeta1=ct(e).variable(),this.accBeta2=ct(i).variable()}),null==s&&(this.epsilon=$.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);Y(()=>{const i=Be(1,this.accBeta1),s=Be(1,this.accBeta2);e.forEach((r,o)=>{const a=$.registeredVariables[r];null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:`${r}/m`,variable:Y(()=>Ht(a).variable(!1))}),null==this.accumulatedSecondMoment[o]&&(this.accumulatedSecondMoment[o]={originalName:`${r}/v`,variable:Y(()=>Ht(a).variable(!1))});const c=Array.isArray(t)?t[o].tensor:t[r];if(null==c)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=ge(F(u,this.beta1),F(c,1-this.beta1)),f=ge(F(d,this.beta2),F(kn(c),1-this.beta2)),p=qe(h,i),g=qe(f,s);u.assign(h),d.assign(f);const m=ge(F(qe(p,ge(Cs(g),this.epsilon)),-this.learningRate),a);a.assign(m)}),this.accBeta1.assign(F(this.accBeta1,this.beta1)),this.accBeta2.assign(F(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&It(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&It(this.accumulatedSecondMoment.map(t=>t.variable))}getWeights(){var t=this;return Q(function*(){const e=[...t.accumulatedFirstMoment,...t.accumulatedSecondMoment];return[yield t.saveIterations()].concat(e.map(i=>({name:i.originalName,tensor:i.variable})))})()}setWeights(t){var e=this;return Q(function*(){t=yield e.extractIterations(t),Y(()=>{e.accBeta1.assign(rd(e.beta1,e.iterations_+1)),e.accBeta2.assign(rd(e.beta2,e.iterations_+1))});const i=t.length/2;e.accumulatedFirstMoment=t.slice(0,i).map(r=>({originalName:r.name,variable:r.tensor.variable(!1)})),e.accumulatedSecondMoment=t.slice(i,2*i).map(r=>({originalName:r.name,variable:r.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}const Ji=V({abs_:function yve(n){const t=N(n,"x","abs");return $.runKernel("complex64"===t.dtype?gx:cx,{x:t})}});function Rf(n,t){const e=n.length,i=[];for(let s=0;s<e;s++){const r=e-1-s;(t[t.length-1-s]||1)>1&&1===(n[r]||1)&&i.unshift(r)}return i}function Vi(n,t){const e=[];for(let i=0;i<t.length;i++){const s=n[n.length-i-1],r=t.length-i-1;(null==s||1===s&&t[r]>1)&&e.unshift(r)}return e}function ft(n,t){const e=Math.max(n.length,t.length),i=new Array(e);for(let s=0;s<e;s++){let r=n[n.length-s-1];null==r&&(r=1);let o=t[t.length-s-1];if(null==o&&(o=1),1===r)i[e-s-1]=o;else if(1===o)i[e-s-1]=r;else{if(r!==o)throw Error(`Operands could not be broadcast together with shapes ${n} and ${t}.`);i[e-s-1]=r}}return i}const Pc=V({maximum_:function vve(n,t){let e=N(n,"a","maximum"),i=N(t,"b","maximum");return[e,i]=ci(e,i),"bool"===e.dtype&&(e=Te(e,"int32"),i=Te(i,"int32")),ft(e.shape,i.shape),$.runKernel(Yg,{a:e,b:i})}});class _j extends Mc{static get className(){return"Adamax"}constructor(t,e,i,s=null,r=0){super(),this.learningRate=t,this.beta1=e,this.beta2=i,this.epsilon=s,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Y(()=>{this.iteration=ct(0).variable(),this.accBeta1=ct(e).variable()}),null==s&&(this.epsilon=$.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);Y(()=>{const i=Be(1,this.accBeta1),s=qe(-this.learningRate,ge(F(this.iteration,this.decay),1));e.forEach((r,o)=>{const a=$.registeredVariables[r];null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:`${r}/m`,variable:Ht(a).variable(!1)}),null==this.accumulatedWeightedInfNorm[o]&&(this.accumulatedWeightedInfNorm[o]={originalName:`${r}/v`,variable:Ht(a).variable(!1)});const c=Array.isArray(t)?t[o].tensor:t[r];if(null==c)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=ge(F(u,this.beta1),F(c,1-this.beta1)),f=F(d,this.beta2),p=Ji(c),g=Pc(f,p);u.assign(h),d.assign(g);const m=ge(F(qe(s,i),qe(h,ge(g,this.epsilon))),a);a.assign(m)}),this.iteration.assign(ge(this.iteration,1)),this.accBeta1.assign(F(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&It(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&It(this.accumulatedWeightedInfNorm.map(t=>t.variable))}getWeights(){return Q(function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})()}setWeights(t){return Q(function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})()}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}class bA extends Mc{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(i=>i.name):Object.keys(t)).forEach((i,s)=>{const r=Array.isArray(t)?t[s].tensor:t[i];if(null==r)return;const o=$.registeredVariables[i];Y(()=>{const a=ge(F(this.c,r),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Ra(ct(-t))}dispose(){this.c.dispose()}getWeights(){var t=this;return Q(function*(){return[yield t.saveIterations()]})()}setWeights(t){var e=this;return Q(function*(){if(0!==(t=yield e.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")})()}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}class yj extends bA{static get className(){return"Momentum"}constructor(t,e,i=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=i,this.accumulations=[],this.m=ct(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(i=>i.name):Object.keys(t)).forEach((i,s)=>{const r=$.registeredVariables[i];null==this.accumulations[s]&&(this.accumulations[s]={originalName:`${i}/momentum`,variable:Y(()=>Ht(r).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(t)?t[s].tensor:t[i];null!=a&&Y(()=>{let l;const c=ge(F(this.m,o),a);l=ge(F(this.c,this.useNesterov?ge(a,F(c,this.m)):c),r),o.assign(c),r.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&It(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}getWeights(){var t=this;return Q(function*(){return[yield t.saveIterations()].concat(t.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))})()}setWeights(t){var e=this;return Q(function*(){t=yield e.extractIterations(t),e.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}class vj extends Mc{static get className(){return"RMSProp"}constructor(t,e=.9,i=0,s=null,r=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=i,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,null==s&&(this.epsilon=$.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(i=>i.name):Object.keys(t)).forEach((i,s)=>{const r=$.registeredVariables[i],o=!1;null==this.accumulatedMeanSquares[s]&&(this.accumulatedMeanSquares[s]={originalName:`${i}/rms`,variable:Y(()=>Ht(r).variable(o))}),null==this.accumulatedMoments[s]&&(this.accumulatedMoments[s]={originalName:`${i}/momentum`,variable:Y(()=>Ht(r).variable(o))}),null==this.accumulatedMeanGrads[s]&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${i}/mg`,variable:Y(()=>Ht(r).variable(o))});const a=Array.isArray(t)?t[s].tensor:t[i];if(null==a)return;const l=this.accumulatedMeanSquares[s].variable,c=this.accumulatedMoments[s].variable;Y(()=>{const u=ge(F(l,this.decay),F(kn(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,h=ge(F(d,this.decay),F(a,1-this.decay)),f=qe(F(a,this.learningRate),Cs(Be(u,ge(kn(h),this.epsilon)))),p=ge(F(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const g=Be(r,p);r.assign(g)}else{const d=ge(F(l,this.decay),F(kn(a),1-this.decay)),h=ge(F(c,this.momentum),qe(F(a,this.learningRate),Cs(ge(d,this.epsilon))));l.assign(d),c.assign(h);const f=Be(r,h);r.assign(f)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&It(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&It(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&It(this.accumulatedMoments.map(t=>t.variable))}getWeights(){var t=this;return Q(function*(){const e=[...t.accumulatedMeanSquares,...t.accumulatedMoments];return t.centered&&e.push(...t.accumulatedMeanGrads),[yield t.saveIterations()].concat(e.map(i=>({name:i.originalName,tensor:i.variable})))})()}setWeights(t){var e=this;return Q(function*(){t=yield e.extractIterations(t);const i=e.centered?t.length/3:t.length/2,s=!1;e.accumulatedMeanSquares=t.slice(0,i).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),e.accumulatedMoments=t.slice(i,2*i).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),e.centered&&(e.accumulatedMeanGrads=t.slice(2*i,3*i).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))})()}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}const xve=[mj,gj,bj,_j,yj,vj,bA];function xj(n){return new Promise(t=>setTimeout(t)).then(n)}let _A=(()=>{class n{constructor(e){if(!J().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),(null==e||0===e.length)&&(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}save(e){var i=this;return Q(function*(){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const s=Ma.join(e.weightData),r=window.URL.createObjectURL(new Blob([s],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const a=sj(e,[{paths:["./"+i.weightDataFileName],weights:e.weightSpecs}]),l=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),c=null==i.modelJsonAnchor?document.createElement("a"):i.modelJsonAnchor;if(c.download=i.modelJsonFileName,c.href=l,yield xj(()=>c.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){const u=null==i.weightDataAnchor?document.createElement("a"):i.weightDataAnchor;u.download=i.weightDataFileName,u.href=r,yield xj(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:wC(e)}}})()}}return n.URL_SCHEME="downloads://",n})();function Cj(n,t,e,i){(function o(l){T(null!=l&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")})(n),function a(l,c){T(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),T(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),T(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}(e=e??0,i=i??1);let s=0;return Promise.all(n.map(l=>(l.then(c=>{const u=e+ ++s/n.length*(i-e);return t(u),c}),l)))}function wj(n,t){return yA.apply(this,arguments)}function yA(){return(yA=Q(function*(n,t){null==t&&(t={});const e=null==t.fetchFunc?J().platform.fetch:t.fetchFunc,i=n.map(d=>e(d,t.requestInit,{isBinary:!0})),a=(null==t.onProgress?yield Promise.all(i):yield Cj(i,t.onProgress,0,.5)).map(d=>d.arrayBuffer());return null==t.onProgress?yield Promise.all(a):yield Cj(a,t.onProgress,.5,1)})).apply(this,arguments)}ei.registerSaveRouter(n=>J().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(_A.URL_SCHEME)?function Tve(n="model"){return new _A(n)}(n.slice(_A.URL_SCHEME.length)):null);let Sj=(()=>{class n{constructor(e,i){if(this.DEFAULT_METHOD="POST",null==i&&(i={}),this.weightPathPrefix=i.weightPathPrefix,this.weightUrlConverter=i.weightUrlConverter,null!=i.fetchFunc?(T("function"==typeof i.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=i.fetchFunc):this.fetch=J().platform.fetch,T(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&T(2===e.length,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,null!=i.requestInit&&null!=i.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=i.requestInit||{},this.loadOptions=i}save(e){var i=this;return Q(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const s=Object.assign({method:i.DEFAULT_METHOD},i.requestInit);s.body=new FormData;const o=sj(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(s.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),null!=e.weightData){const l=Ma.join(e.weightData);s.body.append("model.weights.bin",new Blob([l],{type:"application/octet-stream"}),"model.weights.bin")}const a=yield i.fetch(i.path,s);if(a.ok)return{modelArtifactsInfo:wC(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)})()}loadModelJSON(){var e=this;return Q(function*(){const i=yield e.fetch(e.path,e.requestInit);if(!i.ok)throw new Error(`Request to ${e.path} failed with status code ${i.status}. Please verify this URL points to the model JSON of the model to load.`);let s;try{s=yield i.json()}catch{let l=`Failed to parse model JSON of response from ${e.path}.`;throw e.path.endsWith(".pb")?l+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":l+=" Please make sure the server is serving valid JSON for this request.",new Error(l)}if(null==s.modelTopology&&null==s.weightsManifest)throw new Error(`The JSON from HTTP path ${e.path} contains neither model topology or manifest for weights.`);return s})()}load(){var e=this;return Q(function*(){return e.loadOptions.streamWeights?e.loadStream():rj(yield e.loadModelJSON(),s=>e.loadWeights(s))})()}loadStream(){var e=this;return Q(function*(){const i=yield e.loadModelJSON(),s=yield e.getWeightUrls(i.weightsManifest),r=oj(i.weightsManifest);return Object.assign(Object.assign({},i),{weightSpecs:r,getWeightStream:()=>function Dve(n,t){var e;const i=null==t.fetchFunc?J().platform.fetch:t.fetchFunc;let r,s=0;return null===(e=t.onProgress)||void 0===e||e.call(t,0),new ReadableStream({pull:(o=Q(function*(a){for(var l;s<n.length;){r||(r=(yield i(n[s],t.requestInit,{isBinary:!0})).body.getReader());const{done:c,value:u}=yield r.read();if(!c)return void a.enqueue(u);s++,r=void 0,null===(l=t.onProgress)||void 0===l||l.call(t,s/n.length)}a.close()}),function(l){return o.apply(this,arguments)})});var o}(s,e.loadOptions)})})()}getWeightUrls(e){var i=this;return Q(function*(){const s=Array.isArray(i.path)?i.path[1]:i.path,[r,o]=function Pve(n){const t=n.lastIndexOf("/"),e=n.lastIndexOf("?");return[n.substring(0,t)+"/",e>t?n.substring(e):""]}(s),a=i.weightPathPrefix||r,l=[],c=[];for(const u of e)for(const d of u.paths)null!=i.weightUrlConverter?c.push(i.weightUrlConverter(d)):l.push(a+d+o);return i.weightUrlConverter&&l.push(...yield Promise.all(c)),l})()}loadWeights(e){var i=this;return Q(function*(){const s=yield i.getWeightUrls(e);return[oj(e),yield wj(s,i.loadOptions)]})()}}return n.URL_SCHEME_REGEX=/^https?:\/\//,n})();function Ij(n){return null!=n.match(Sj.URL_SCHEME_REGEX)}const Ej=(n,t)=>{if(typeof fetch>"u"&&(null==t||null==t.fetchFunc))return null;{let e=!0;if(e=Array.isArray(n)?n.every(i=>Ij(i)):Ij(n),e)return kj(n,t)}return null};function kj(n,t){return new Sj(n,t)}ei.registerSaveRouter(Ej),ei.registerLoadRouter(Ej);const CA=-2,Lve=-1;function wA(n,t,e){const i=n.shape.length;T(i===t.length,()=>`Error in slice${i}D: Length of begin ${t} must match the rank of the array (${i}).`),T(i===e.length,()=>`Error in slice${i}D: Length of size ${e} must match the rank of the array (${i}).`);for(let s=0;s<i;++s)T(t[s]+e[s]<=n.shape[s],()=>`Error in slice${i}D: begin[${s}] + size[${s}] (${t[s]+e[s]}) would overflow input.shape[${s}] (${n.shape[s]})`)}function $ve(n){const t=[];let e=0;for(;n>0;)1&n&&t.push(e),n/=2,e++;return t}function SA(n,t,e){const i=[];for(let s=0;s<n.length;s++)i[s]=Math.ceil((t[s]-n[s])/e[s]);return i}function Dj(n,t,e,i){const s=[...n];for(let r=s.length;r<i.length;r++)s.push(1);for(let r=0;r<e;r++)0===r?s[t]=1:(s.splice(t,0,1),s.pop());return s}function Nj(n,t,e){return e<=n?e:e-(t-1)}function Aj(n,t){const e=[];for(let i=0;i<n;i++)e.push(t+i);return e}function Bve(n,t,e,i,s,r,o,a,l){const c=n.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(t.length&&e>0){const f=t[0],p=e+1;u=Mj(o,f,p,i,n),d=Pj(a,f,p,s,n),h=Dj(r,f,p,n)}else for(let f=0;f<c;f++)u[f]=Oj(o,i,r,n,f,l),d[f]=Fj(a,s,r,n,f,l),h[f]=Rj(r,f,l);return{begin:u,end:d,strides:h}}function Mj(n,t,e,i,s){const r=[...s],o=Aj(e,t);for(let a=0;a<r.length;a++)if(o.indexOf(a)>-1)r[a]=0;else{const l=Nj(t,e,a);let c=i[l];n&1<<l&&(c=0),r[a]=c}return r}function Pj(n,t,e,i,s){const r=[...s],o=Aj(e,t);for(let a=0;a<r.length;a++)if(o.indexOf(a)>-1)r[a]=Number.MAX_SAFE_INTEGER;else{const l=Nj(t,e,a);let c=i[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),r[a]=c}for(let a=0;a<r.length;a++)r[a]<0&&(r[a]+=s[a]),r[a]=Xu(0,r[a],s[a]);return r}function Rj(n,t,e){let i=n[t];return(e&1<<t||null==i)&&(i=1),i}function Oj(n,t,e,i,s,r){let o=t[s];(n&1<<s||r&1<<s||null==o)&&(o=(e[s]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=i[s];return o<0&&(o+=l),o=Xu(0,o,l-1),o}function Fj(n,t,e,i,s,r){let o=t[s];const a=e[s]||1;(n&1<<s||r&1<<s||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=i[s];return o<0&&(o+=l),o=a>0?Xu(0,o,l):Xu(-1,o,l-1),o}function IA(n,t,e){let i=e.length;for(let s=0;s<e.length;s++)if(e[s]>1){i=s;break}for(let s=i+1;s<e.length;s++)if(t[s]>0||e[s]!==n[s])return!1;return!0}function EA(n,t){let e=n.length>0?n[n.length-1]:1;for(let i=0;i<n.length-1;i++)e+=n[i]*t[i];return e}function kC(n,t,e){let i;const s=n.shape.length;let r;return i="number"==typeof t?[t,...new Array(s-1).fill(0)]:t.length<s?t.concat(new Array(s-t.length).fill(0)):t.slice(),i.forEach(o=>{T(-1!==o,()=>"slice() does not support negative begin indexing.")}),r=null==e?new Array(s).fill(-1):"number"==typeof e?[e,...new Array(s-1).fill(-1)]:e.length<s?e.concat(new Array(s-e.length).fill(-1)):e,r=r.map((o,a)=>o>=0?o:(T(-1===o,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),n.shape[a]-i[a])),[i,r]}function kA(n,t,e,i,s,r,o,a,l){let c;if(null==i?(c=new Array(t.length),c.fill(1)):c=i,null!=o&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:e.slice(),strides:c.slice(),beginMask:s,endMask:r,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let y=0;y<d.dims;y++)u&&1<<y&a&&d.numAddAxisAfterEllipsis++,1<<y&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function Vve(n,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let e=0;t.beginValid=null!=n.begin,t.endValid=null!=n.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let i=0;i<n.dims;i++)if(1<<i&n.ellipsisMask){const s=Math.min(t.dims-(n.dims-i)+1+n.numAddAxisAfterEllipsis,t.dims);for(;e<s;e++)t.begin[e]=0,t.end[e]=0,t.strides[e]=1,t.beginMask|=1<<e,t.endMask|=1<<e,t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[e]=i}else if(1<<i&n.newAxisMask)t.finalShapeGatherIndices.push(CA),t.finalShapeGatherIndicesSparse.push(-1);else{if(e===t.begin.length)throw Error(`Index out of range using input dim ${e}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=n.begin&&(t.begin[e]=n.begin[i]),null!=n.end&&(t.end[e]=n.end[i]),t.strides[e]=n.strides[i],n.beginMask&1<<i&&(t.beginMask|=1<<e),n.endMask&1<<i&&(t.endMask|=1<<e),n.shrinkAxisMask&1<<i?(t.finalShapeGatherIndices.push(Lve),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<e):(t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(i)),t.inputShapeGatherIndicesSparse[e]=i,e++}}(d,h);let f=!0,p=!0,g=!0;const m=[],b=[];for(let y=0;y<n.length;++y){if(0===h.strides[y])throw Error(`strides[${y}] must be non-zero`);const v=!!(h.shrinkAxisMask&1<<y),x=n[y];if(-1===x){m.push(v?1:-1);continue}const S=[h.beginMask&1<<y,h.endMask&1<<y],E=[h.strides[y]>0?0:-1,h.strides[y]>0?x:x-1];if(v&&h.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===h.strides[y];const k=!!(h.beginMask&1<<y&&h.endMask&1<<y);if(h.beginValid&&h.endValid){if(v){const U=h.begin[y]<0?x+h.begin[y]:h.begin[y];if(h.begin[y]=U,h.end[y]=h.begin[y]+1,U<0||U>=x)throw Error(`slice index ${h.begin[y]} of dimension ${y} out of bounds.`)}else h.begin[y]=Lj(h.begin[y],0,h.strides[y],x,S,E),h.end[y]=Lj(h.end[y],1,h.strides[y],x,S,E);const R=1===h.strides[y]&&0===h.begin[y]&&h.end[y]===x;f=f&&R,p=p&&(0===y&&1===h.strides[y]||R)}else f=f&&1===h.strides[y]&&k,p=p&&(0===y&&1===h.strides[y]||k);let D,M=!1;if(h.beginValid&&h.endValid?(D=h.end[y]-h.begin[y],M=!0):v?(D=1,M=!0):k&&x>=0&&(D=h.strides[y]<0?-x:x,M=!0),M){let R;R=0===D||D<0!=h.strides[y]<0?0:Math.trunc(D/h.strides[y])+(D%h.strides[y]!=0?1:0),m.push(R)}else m.push(-1)}for(let y=0;y<h.finalShapeGatherIndices.length;++y){const v=h.finalShapeGatherIndices[y];v>=0?b.push(m[v]):v===CA&&b.push(1)}return{finalShapeSparse:b.filter((y,v)=>h.finalShapeGatherIndices[v]!==CA),finalShape:b,isIdentity:f,sliceDim0:p,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function Lj(n,t,e,i,s,r){if(s[t])return e>0?r[t]:r[t+1&1];{const o=n<0?i+n:n;return o<r[0]?r[0]:o>r[1]?r[1]:o}}const $j=V({all_:function Uve(n,t=null,e=!1){const s={x:N(n,"x","all","bool")};return $.runKernel("All",s,{axis:t,keepDims:e})}}),TA=V({any_:function Wve(n,t=null,e=!1){const s={x:N(n,"x","any","bool")};return $.runKernel("Any",s,{axis:t,keepDims:e})}}),Ib=V({argMax_:function Hve(n,t=0){const i={x:N(n,"x","argMax")};return $.runKernel(ux,i,{axis:t})}});function Eb(n,t,e,i,s="NHWC",r){return es(n,[...t,n[3]],e,r,i,null,null,El(s))}function bo(n,t,e,i,s,r,o="channelsLast"){const[a,l]=kb(t);let c;if("channelsLast"===o)c=[a,l,n[3],n[3]];else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);c=[a,l,n[1],n[1]]}return es(n,c,e,i,s,r,!1,o)}function Il(n,t,e,i,s,r,o="NDHWC"){const[a,l,c]=NA(t);let u,d;if("NDHWC"===o)d="channelsLast",u=[a,l,c,n[4],n[4]];else{if("NCDHW"!==o)throw new Error(`Unknown dataFormat ${o}`);d="channelsFirst",u=[a,l,c,n[1],n[1]]}return Rc(n,u,e,i,s,!1,d,r)}function es(n,t,e,i,s,r,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if("channelsLast"===a)[l,c,u,d]=n;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[l,d,c,u]=n}const[h,f,,p]=t,[g,m]=kb(e),[b,_]=kb(i),y=Of(h,b),v=Of(f,_),{padInfo:x,outHeight:S,outWidth:E}=function qve(n,t,e,i,s,r,o,a,l){let c,u,d;if("number"==typeof n){c={top:n,bottom:n,left:n,right:n,type:0===n?"VALID":"NUMBER"};const f=function jve(n,t,e,i,s){null==i&&(i=DA(n,t,e));const o=n[1];return[Tb((n[0]-t+2*i)/e+1,s),Tb((o-t+2*i)/e+1,s)]}([t,e],r,i,n,a);u=f[0],d=f[1]}else if("same"===n){u=Math.ceil(t/i),d=Math.ceil(e/s);const h=Math.max(0,(u-1)*i+r-t),f=Math.max(0,(d-1)*s+o-e),p=Math.floor(h/2),g=h-p,m=Math.floor(f/2);c={top:p,bottom:g,left:m,right:f-m,type:"SAME"}}else if("valid"===n)c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-r+1)/i),d=Math.ceil((e-o+1)/s);else{if("object"!=typeof n)throw Error(`Unknown padding parameter: ${n}`);{const h="channelsLast"===l?n[1][0]:n[2][0],f="channelsLast"===l?n[1][1]:n[2][1],p="channelsLast"===l?n[2][0]:n[3][0],g="channelsLast"===l?n[2][1]:n[3][1];c={top:h,bottom:f,left:p,right:g,type:0===h&&0===f&&0===p&&0===g?"VALID":"EXPLICIT"},u=Tb((t-r+h+f)/i+1,a),d=Tb((e-o+p+g)/s+1,a)}}return{padInfo:c,outHeight:u,outWidth:d}}(s,c,u,g,m,y,v,r,a),k=o?p*d:p;let D;return"channelsFirst"===a?D=[l,k,S,E]:"channelsLast"===a&&(D=[l,S,E,k]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:S,outWidth:E,outChannels:k,padInfo:x,strideHeight:g,strideWidth:m,filterHeight:h,filterWidth:f,effectiveFilterHeight:y,effectiveFilterWidth:v,dilationHeight:b,dilationWidth:_,inShape:n,outShape:D,filterShape:t}}function Rc(n,t,e,i,s,r=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[l,c,u,d,h]=n;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[l,h,c,u,d]=n}const[f,p,g,,m]=t,[b,_,y]=NA(e),[v,x,S]=NA(i),E=Of(f,v),k=Of(p,x),D=Of(g,S),{padInfo:M,outDepth:R,outHeight:U,outWidth:X}=function Kve(n,t,e,i,s,r,o,a,l,c,u){let d,h,f,p;if("valid"===n&&(n=0),"number"==typeof n){d={top:n,bottom:n,left:n,right:n,front:n,back:n,type:0===n?"VALID":"NUMBER"};const m=function Gve(n,t,e,i,s,r){null==s&&(s=DA(n,t[0],i[0]));const o=[0,0,0,e];for(let a=0;a<3;a++)n[a]+2*s>=t[a]&&(o[a]=Tb((n[a]-t[a]+2*s)/i[a]+1,r));return o}([t,e,i,1],[a,l,c],1,[s,r,o],n,u);h=m[0],f=m[1],p=m[2]}else{if("same"!==n)throw Error(`Unknown padding parameter: ${n}`);{h=Math.ceil(t/s),f=Math.ceil(e/r),p=Math.ceil(i/o);const g=(h-1)*s+a-t,m=(f-1)*r+l-e,b=(p-1)*o+c-i,_=Math.floor(g/2),y=g-_,v=Math.floor(m/2),x=m-v,S=Math.floor(b/2);d={top:v,bottom:x,left:S,right:b-S,front:_,back:y,type:"SAME"}}}return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}(s,c,u,d,b,_,y,E,k,D,a),ee=r?m*h:m;let K;return"channelsFirst"===o?K=[l,ee,R,U,X]:"channelsLast"===o&&(K=[l,R,U,X,ee]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:R,outHeight:U,outWidth:X,outChannels:ee,padInfo:M,strideDepth:b,strideHeight:_,strideWidth:y,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:E,effectiveFilterHeight:k,effectiveFilterWidth:D,dilationDepth:v,dilationHeight:x,dilationWidth:S,inShape:n,outShape:K,filterShape:t}}function DA(n,t,e,i=1){const s=Of(t,i);return Math.floor((n[0]*(e-1)-e+s)/2)}function kb(n){return"number"==typeof n?[n,n,n]:2===n.length?[n[0],n[1],1]:n}function NA(n){return"number"==typeof n?[n,n,n]:n}function Of(n,t){return t<=1?n:n+(n-1)*(t-1)}function Tb(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function Oc(n){const[t,e,i]=kb(n);return 1===t&&1===e&&1===i}function hs(n,t){return Oc(n)||Oc(t)}function od(n){return kb(n).every(t=>t>0)}function El(n){if("NHWC"===n)return"channelsLast";if("NCHW"===n)return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Fs(n,t,e){if(null!=e){if("string"==typeof t)throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);if("number"==typeof t)T(xf(t),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);else{if("object"!=typeof t)throw Error(`Error in ${n}: Unknown padding parameter: ${t}`);t.forEach(i=>{i.forEach(s=>{T(xf(s),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${s}.`)})})}}}const j=V({reshape_:function Xve(n,t){const i={x:N(n,"x","reshape","string_or_numeric")};return $.runKernel(Yx,i,{shape:t})}}),AA=V({avgPool_:function Yve(n,t,e,i,s){const r=N(n,"x","avgPool","float32");T(hs(e,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`);let a=r,l=!1;3===r.rank&&(l=!0,a=j(r,[1,r.shape[0],r.shape[1],r.shape[2]])),T(4===a.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Fs("avgPool",i,s);let d=$.runKernel(hx,{x:a},{filterSize:t,strides:e,pad:i,dimRoundingMode:s});return d=Te(d,r.dtype),l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Qve=V({avgPool3d_:function Zve(n,t,e,i,s,r="NDHWC"){const o=N(n,"x","avgPool3d","float32");let a=o,l=!1;4===o.rank&&(l=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(5===a.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T("NDHWC"===r,()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),T("number"==typeof e&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`),Fs("avgPool3d",i,s);let d=$.runKernel(fx,{x:a},{filterSize:t,strides:e,pad:i,dimRoundingMode:s,dataFormat:r});return d=Te(d,a.dtype),l?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});function Jve(n){let t;return t=0===n.rank||1===n.rank?j(n,[1,1,1,n.size]):2===n.rank?j(n,[1,1,n.shape[0],n.shape[1]]):3===n.rank?j(n,[1,n.shape[0],n.shape[1],n.shape[2]]):n,t}const TC=V({batchNorm_:function exe(n,t,e,i,s,r){null==r&&(r=.001);const o=N(n,"x","batchNorm"),a=N(t,"mean","batchNorm"),l=N(e,"variance","batchNorm");let c,u;null!=s&&(c=N(s,"scale","batchNorm")),null!=i&&(u=N(i,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(null==u||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(null==c||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Jve(o),scale:c,offset:u,mean:a,variance:l},p=$.runKernel(Ex,h,{varianceEpsilon:r});return j(p,o.shape)}}),nxe=V({batchNorm2d_:function txe(n,t,e,i,s,r){const o=N(n,"x","batchNorm"),a=N(t,"mean","batchNorm"),l=N(e,"variance","batchNorm");let c,u;return null!=s&&(c=N(s,"scale","batchNorm")),null!=i&&(u=N(i,"offset","batchNorm")),T(2===o.rank,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),T(2===a.rank||1===a.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(2===l.rank||1===l.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),null!=c&&T(2===c.rank||1===c.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),null!=u&&T(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),TC(o,a,l,u,c,r)}}),sxe=V({batchNorm3d_:function ixe(n,t,e,i,s,r){const o=N(n,"x","batchNorm"),a=N(t,"mean","batchNorm"),l=N(e,"variance","batchNorm");let c,u;return null!=s&&(c=N(s,"scale","batchNorm")),null!=i&&(u=N(i,"offset","batchNorm")),T(3===o.rank,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),T(3===a.rank||1===a.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(3===l.rank||1===l.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),null!=c&&T(3===c.rank||1===c.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),null!=u&&T(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),TC(o,a,l,u,c,r)}}),oxe=V({batchNorm4d_:function rxe(n,t,e,i,s,r){const o=N(n,"x","batchNorm"),a=N(t,"mean","batchNorm"),l=N(e,"variance","batchNorm");let c,u;return null!=s&&(c=N(s,"scale","batchNorm")),null!=i&&(u=N(i,"offset","batchNorm")),T(4===o.rank,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),T(4===a.rank||1===a.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(4===l.rank||1===l.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),null!=c&&T(4===c.rank||1===c.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),null!=u&&T(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),TC(o,a,l,u,c,r)}}),Db=V({broadcastTo_:function axe(n,t){let e=N(n,"broadcastTo","x");const i=e.shape;if(wl(t),t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){const c=e.shape.slice();for(;c.length<t.length;)c.unshift(1);e=j(e,c)}const s=e.shape,r=Array.from(t);for(let c=t.length-1;c>=0;c--)if(s[c]===t[c])r[c]=1;else if(1!==e.shape[c])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${t}].`);return 0===r.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length?sd(e):$.runKernel(bb,{x:e},{reps:r})}}),$r=V({clipByValue_:function lxe(n,t,e){const i=N(n,"x","clipByValue");return T(t<=e,()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`),t===e?Sb(i.shape,t,i.dtype):$.runKernel(Pg,{x:i},{clipValueMin:t,clipValueMax:e})}}),ws=V({concat_:function cxe(n,t=0){T(n.length>=1,()=>"Pass at least one tensor to concat");const e=XH(n,"tensors","concat","string_or_numeric");return"complex64"===e[0].dtype&&e.forEach(r=>{if("complex64"!==r.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${r.dtype}. `)}),1===e.length?sd(e[0]):$.runKernel(bx,e,{axis:t})}}),dxe=V({concat1d_:function uxe(n){return ws(n,0)}}),fxe=V({concat2d_:function hxe(n,t){return ws(n,t)}}),mxe=V({concat3d_:function pxe(n,t){return ws(n,t)}}),bxe=V({concat4d_:function gxe(n,t){return ws(n,t)}}),ad=V({conv2d_:function _xe(n,t,e,i,s="NHWC",r=[1,1],o){const a=N(n,"x","conv2d","float32"),l=N(t,"filter","conv2d","float32");let c=a,u=!1;3===a.rank&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(4===c.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(4===l.rank,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Fs("conv2d",i,o);const d="NHWC"===s?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),T(hs(e,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${r}'`),T(od(r),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(od(e),()=>"Error in conv2D: Strides should be larger than 0.");const p=$.runKernel(_x,{x:c,filter:l},{strides:e,pad:i,dataFormat:s,dilations:r,dimRoundingMode:o});return u?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Bj=V({conv1d_:function yxe(n,t,e,i,s="NWC",r=1,o){const a=N(n,"x","conv1d"),l=N(t,"filter","conv1d");let c=a,u=!1;2===a.rank&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1]])),T(3===c.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(3===l.rank,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Fs("conv1d",i,o),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(hs(e,r),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${r}'`),T(od(r),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(od(e),()=>"Error in conv1D: Stride should be larger than 0."),T("NWC"===s,()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=j(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=j(c,[c.shape[0],1,c.shape[1],c.shape[2]]),m=ad(h,d,[1,e],i,"NHWC",[1,r],o);return j(m,u?[m.shape[2],m.shape[3]]:[m.shape[0],m.shape[2],m.shape[3]])}}),MA=V({conv2DBackpropInput_:function vxe(n,t,e,i,s,r="NHWC",o){T(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let a=n,l=t,c=!1;3===t.rank&&(c=!0,l=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,n[0],n[1],n[2]]),T(4===a.length,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(4===l.rank,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(4===e.rank,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);const u="NHWC"===r?a[3]:a[1],d="NHWC"===r?l.shape[3]:l.shape[1];T(u===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${e.shape[2]}.`),T(d===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${e.shape[3]}.`),Fs("conv2dDerInput",s,o);const p=$.runKernel(yx,{dy:l,filter:e},{strides:i,pad:s,dataFormat:r,dimRoundingMode:o,inputShape:a});return c?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Vj=V({conv2dTranspose_:function xxe(n,t,e,i,s,r){const o=N(n,"x","conv2dTranspose"),a=N(t,"filter","conv2dTranspose");return MA(e,o,a,i,s,"NHWC",r)}}),wxe=V({conv3d_:function Cxe(n,t,e,i,s="NDHWC",r=[1,1,1]){const o=N(n,"x","conv3d"),a=N(t,"filter","conv3d");let l=o,c=!1;4===o.rank&&(c=!0,l=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(5===l.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(5===a.rank,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(hs(e,r),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${r}'`),T("NDHWC"===s,()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),T(od(r),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(od(e),()=>"Error in conv3D: Strides should be larger than 0.");const h=$.runKernel(vx,{x:l,filter:a},{strides:e,pad:i,dataFormat:s,dilations:r});return c?j(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),zj=V({conv3DBackpropInput_:function Sxe(n,t,e,i,s){T(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let r=n,o=t,a=!1;4===t.rank&&(a=!0,o=j(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),r=[1,n[0],n[1],n[2],n[3]]);const l=r[4],c=o.shape[4];T(5===r.length,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${r.length}.`),T(5===o.rank,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),T(5===e.rank,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),T(l===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${e.shape[3]}.`),T(c===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${e.shape[4]}.`);const h=$.runKernel(aN,{dy:o,filter:e},{pad:s,strides:i,inputShape:r});return a?j(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),Exe=V({conv3dTranspose_:function Ixe(n,t,e,i,s){const r=N(n,"x","conv3dTranspose"),o=N(t,"filter","conv3dTranspose");return zj(e,r,o,i,s)}}),Uj=V({denseBincount_:function kxe(n,t,e,i=!1){const s=N(n,"x","denseBincount"),r=N(t,"weights","denseBincount");return T("int32"===s.dtype,()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),T(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),T(e>=0,()=>`size must be non-negative, but got ${e}.`),T(r.size===s.size||0===r.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${r.shape}.`),$.runKernel(uN,{x:s,weights:r},{size:e,binaryOutput:i})}}),DC=V({depthwiseConv2d_:function Txe(n,t,e,i,s="NHWC",r=[1,1],o){const a=N(n,"x","depthwiseConv2d","float32"),l=N(t,"filter","depthwiseConv2d","float32");let c=a,u=!1;3===a.rank&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(4===c.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(4===l.rank,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d="NHWC"===s?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Fs("depthwiseConv2d",i,o);const p=$.runKernel(Cx,{x:c,filter:l},{strides:e,pad:i,dataFormat:s,dilations:r,dimRoundingMode:o});return u?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),NC=V({elu_:function Dxe(n){const e={x:N(n,"x","elu","float32")};return $.runKernel(Lg,e)}}),Fa=V({equal_:function Nxe(n,t){let e=N(n,"a","equal","string_or_numeric"),i=N(t,"b","equal","string_or_numeric");return[e,i]=ci(e,i),ft(e.shape,i.shape),$.runKernel(Sx,{a:e,b:i})}}),Wj=V({erf_:function Axe(n){let t=N(n,"x","erf");return T("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=Te(t,"float32")),$.runKernel($g,{x:t})}}),Br=V({exp_:function Mxe(n){const e={x:N(n,"x","exp")};return $.runKernel(Bg,e)}}),sr=V({expandDims_:function Pxe(n,t=0){const e=N(n,"x","expandDims","string_or_numeric");return T(t<=e.rank,()=>"Axis must be <= rank of the tensor"),$.runKernel(Ix,{input:e},{dim:t})}}),Xo=V({tile_:function Rxe(n,t){const e=N(n,"x","tile","string_or_numeric");return T(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${t}.`),$.runKernel(bb,{x:e},{reps:t})}}),Hj=V({eye_:function Oxe(n,t,e,i="float32"){null==t&&(t=n);const s=Dt([n,t],i),r=n<=t?n:t;for(let a=0;a<r;++a)s.set(1,a,a);const o=j(s.toTensor(),[n,t]);if(null==e)return o;if(1===e.length)return Xo(sr(o,0),[e[0],1,1]);if(2===e.length)return Xo(sr(sr(o,0),0),[e[0],e[1],1,1]);if(3===e.length)return Xo(sr(sr(sr(o,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}}),AC=V({floor_:function Fxe(n){const e={x:N(n,"x","floor","float32")};return $.runKernel(zg,e)}}),PA=V({gather_:function Lxe(n,t,e=0,i=0){const s=N(n,"x","gather"),r=N(t,"indices","gather","int32");return $.runKernel(kx,{x:s,indices:r},{axis:e,batchDims:i})}}),Vr=V({greater_:function $xe(n,t){let e=N(n,"a","greater","string_or_numeric"),i=N(t,"b","greater","string_or_numeric");return[e,i]=ci(e,i),ft(e.shape,i.shape),$.runKernel(Tx,{a:e,b:i})}}),ld=V({greaterEqual_:function Bxe(n,t){let e=N(n,"a","greaterEqual","string_or_numeric"),i=N(t,"b","greaterEqual","string_or_numeric");return[e,i]=ci(e,i),ft(e.shape,i.shape),$.runKernel(Wg,{a:e,b:i})}}),RA=V({leakyRelu_:function Vxe(n,t=.2){const i={x:N(n,"x","leakyRelu")};return $.runKernel(Dx,i,{alpha:t})}}),_o=V({log_:function zxe(n){const e={x:N(n,"x","log","float32")};return $.runKernel(Kg,e)}}),OA=V({log1p_:function Uxe(n){const e={x:N(n,"x","log1p")};return $.runKernel(Xg,e)}}),Yo=V({max_:function Wxe(n,t=null,e=!1){const s={x:N(n,"x","max")};return $.runKernel(Fx,s,{reductionIndices:t,keepDims:e})}}),We=V({sum_:function Hxe(n,t=null,e=!1){let i=N(n,"x","sum");return"bool"===i.dtype&&(i=Te(i,"int32")),$.runKernel(nC,{x:i},{axis:t,keepDims:e})}}),jj=V({logSoftmax_:function jxe(n,t=-1){const e=N(n,"logits","logSoftmax");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return Sl((s,r)=>{const a=Yo(s,t,!0),l=Be(s,a),c=Be(Te(l,"float32"),_o(We(Br(l),t,!0)));return r([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,g=Br(f);return Be(d,F(We(d,t,!0),g))}}})(e)}});function FA(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function Gj(n,t,e){const i=n.length+t.length,s=[];let r=0,o=0;for(let a=0;a<i;a++)-1===e.indexOf(a)?s.push(n[r++]):s.push(t[o++]);return s}function ts(n,t){const e=[],i=n.length;for(let r=0;r<i;r++)-1===t.indexOf(r)&&e.push(n[r]);return[e,t.map(r=>n[r])]}function vi(n,t){return Gj(n,t.map(i=>1),t)}function fs(n,t,e){T(FA(t,e),()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`)}function ti(n,t){if(FA(n,t))return null;const e=[];for(let i=0;i<t;++i)-1===n.indexOf(i)&&e.push(i);return n.forEach(i=>e.push(i)),e}function Fc(n){return n.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function xi(n,t){const e=[];for(let i=t-n;i<t;++i)e.push(i);return e}const LA=V({logSumExp_:function Gxe(n,t=null,e=!1){const i=N(n,"x","logSumExp"),s=Tt(t,i.shape),r=Yo(i,s,!0),o=Be(i,r),a=Br(o),l=We(a,s),c=_o(l),u=ge(j(r,c.shape),c);if(e){const d=vi(u.shape,s);return j(u,d)}return u}}),kl=V({logicalAnd_:function qxe(n,t){const e=N(n,"a","logicalAnd","bool"),i=N(t,"b","logicalAnd","bool");return ft(e.shape,i.shape),$.runKernel(Mx,{a:e,b:i})}}),nn=V({matMul_:function Kxe(n,t,e=!1,i=!1){let s=N(n,"a","matMul"),r=N(t,"b","matMul");return[s,r]=ci(s,r),$.runKernel(px,{a:s,b:r},{transposeA:e,transposeB:i})}}),$A=V({maxPool_:function Xxe(n,t,e,i,s){const r=N(n,"x","maxPool");let a=r,l=!1;3===r.rank&&(l=!0,a=j(r,[1,r.shape[0],r.shape[1],r.shape[2]])),T(4===a.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(hs(e,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`),Fs("maxPool",i,s);const d=$.runKernel(Lx,{x:a},{filterSize:t,strides:e,pad:i,dimRoundingMode:s});return l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Zxe=V({maxPool3d_:function Yxe(n,t=[1,1,1],e,i,s,r="NDHWC"){const o=N(n,"x","maxPool3d");let a=o,l=!1;4===o.rank&&(l=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(5===a.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T("NDHWC"===r,()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),Fs("maxPool3d",i,s);const d=$.runKernel($x,{x:a},{filterSize:t,strides:e,pad:i,dimRoundingMode:s,dataFormat:r});return l?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),Ci=V({mean_:function Qxe(n,t=null,e=!1){const s={x:N(n,"x","mean")};return $.runKernel(Bx,s,{axis:t,keepDims:e})}}),MC=V({min_:function Jxe(n,t=null,e=!1){const s={x:N(n,"x","min")};return $.runKernel(Vx,s,{axis:t,keepDims:e})}}),Ff=V({minimum_:function eCe(n,t){let e=N(n,"a","minimum"),i=N(t,"b","minimum");return[e,i]=ci(e,i),"bool"===e.dtype&&(e=Te(e,"int32"),i=Te(i,"int32")),ft(e.shape,i.shape),$.runKernel(Zg,{a:e,b:i})}}),BA=V({moments_:function tCe(n,t=null,e=!1){const i=Tt(t,(n=N(n,"x","moments")).shape),s=Ci(n,i,e);let r=s.shape;e||(r=vi(s.shape,i));const o=kn(Be(Te(n,"float32"),j(s,r)));return{mean:s,variance:Ci(o,i,e)}}}),Hn=V({neg_:function nCe(n){const e={x:N(n,"x","neg")};return $.runKernel(Ux,e)}}),Nb=V({notEqual_:function iCe(n,t){let e=N(n,"a","notEqual","string_or_numeric"),i=N(t,"b","notEqual","string_or_numeric");return[e,i]=ci(e,i),ft(e.shape,i.shape),$.runKernel(Wx,{a:e,b:i})}}),qj=V({oneHot_:function sCe(n,t,e=1,i=0,s="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:N(n,"indices","oneHot","int32")};return $.runKernel(jx,o,{dtype:s,depth:t,onValue:e,offValue:i})}});function ns(n,t="float32"){if(wl(n),"complex64"===t){const i=ns(n,"float32"),s=ns(n,"float32");return ed(i,s)}const e=xs(te(n),t);return $.makeTensor(e,n,t)}function Tl(n,t="float32"){if(wl(n),"complex64"===t){const i=Tl(n,"float32"),s=ns(n,"float32");return ed(i,s)}const e=qD(te(n),t);return $.makeTensor(e,n,t)}const yo=V({onesLike_:function rCe(n){const e={x:N(n,"x","onesLike")};return $.runKernel(Hx,e)}}),VA=V({pad_:function oCe(n,t,e=0){const i=N(n,"x","pad");if(0===i.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return $.runKernel(qx,{x:i},{paddings:t,constantValue:e})}}),zA=V({prelu_:function aCe(n,t){const e=N(n,"x","prelu"),i=N(t,"alpha","prelu");return $.runKernel(Kx,{x:e,alpha:i})}});var UA=xe(340);class WA{constructor(t,e,i,s,r){this.mean=t,this.stdDev=e,this.dtype=i,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=r||Math.random();this.random=UA.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let t,e,i=!1;for(;!i;){let s,r,o;do{s=2*this.random()-1,r=2*this.random()-1,o=s*s+r*r}while(o>=1||0===o);const a=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*s*a,e=this.mean+this.stdDev*r*a,(!this.truncated||this.isValidTruncated(t))&&(i=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class lCe{constructor(t=0,e=1,i,s){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=i,null==s&&(s=Math.random()),"number"==typeof s&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=UA.alea(s)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const fCe=V({randomNormal_:function hCe(n,t=0,e=1,i,s){if(wl(n),null!=i&&"bool"===i)throw new Error(`Unsupported data type ${i}`);const r=new WA(t,e,i,!1,s),o=Dt(n,i);for(let a=0;a<o.values.length;a++)o.values[a]=r.nextValue();return o.toTensor()}}),Ab=V({randomUniform_:function pCe(n,t=0,e=1,i="float32",s){wl(n);const r=Dt(n,i),o=new lCe(t,e,null,s);for(let a=0;a<r.values.length;a++)r.values[a]=o.nextValue();return r.toTensor()}});function Mb(n,t,e=1,i="float32"){if(0===e)throw new Error("Cannot have a step of zero");return $.runKernel(DN,{},{start:n,stop:t,step:e,dtype:i})}const Dl=V({relu_:function mCe(n){const e={x:N(n,"x","relu")};return $.runKernel(nb,e)}}),cd=V({reverse_:function gCe(n,t){const i={x:N(n,"x","reverse")};return $.runKernel(Jx,i,{dims:t})}}),Kj=V({selu_:function bCe(n){const e={x:N(n,"x","selu")};return $.runKernel(ob,e)}}),Xj=V({separableConv2d_:function _Ce(n,t,e,i,s,r=[1,1],o="NHWC"){const a=N(n,"x","separableConv2d"),l=N(t,"depthwiseFilter","separableConv2d"),c=N(e,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(3===a.rank&&(d=!0,u=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(4===u.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(4===l.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(4===c.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(1===c.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(1===c.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];T(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=DC(u,l,i,s,o,r),m=ad(p,c,1,"valid",o);return d?j(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),Lf=V({sigmoid_:function yCe(n){const e={x:N(n,"x","sigmoid","float32")};return $.runKernel(ub,e)}}),_n=V({slice_:function vCe(n,t,e){const i=N(n,"x","slice","string_or_numeric");if(0===i.rank)throw new Error("Slicing scalar is not possible");return $.runKernel(tC,{x:i},{begin:t,size:e})}}),jA=V({slice1d_:function xCe(n,t,e){const i=N(n,"x","slice1d");return T(1===i.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${i.rank} tensor`),_n(i,[t],[e])}}),Yj=V({slice2d_:function CCe(n,t,e){const i=N(n,"x","slice2d");return T(2===i.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${i.rank} tensor`),_n(i,t,e)}}),GA=V({slice3d_:function wCe(n,t,e){const i=N(n,"x","slice3d");return T(3===i.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${i.rank} tensor`),_n(i,t,e)}}),PC=V({slice4d_:function SCe(n,t,e){const i=N(n,"x","slice4d");return T(4===i.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${i.rank} tensor`),_n(i,t,e)}}),qA=V({softmax_:function ICe(n,t=-1){const e=N(n,"logits","softmax","float32");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${t}`);return $.runKernel(rC,{logits:e},{dim:t})}}),Pb=V({softplus_:function ECe(n){const e={x:N(n,"x","softplus")};return $.runKernel(db,e)}}),zr=V({split_:function kCe(n,t,e=0){const s={x:N(n,"x","split")};return $.runKernel(sC,s,{numOrSizeSplits:t,axis:e})}}),Rb=V({squeeze_:function TCe(n,t){const e=N(n,"x","squeeze","string_or_numeric");return j(e,Ic(e.shape,t).newShape)}}),Nl=V({stack_:function DCe(n,t=0){const e=XH(n,"tensors","stack","string_or_numeric");return T(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&T(t<=e[0].rank,()=>"Axis must be <= rank of the tensor"),$.runKernel(Gx,e,{axis:t})}}),RC=V({tanh_:function NCe(n){const e={x:N(n,"x","tanh","float32")};return $.runKernel(gb,e)}});function rr(n,t){aH(n);const e=xC(n,t);if(1!==e.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return CC(n,null,e,t)}function Ob(n,t,e){if(aH(n),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const i=xC(n,e);if(2!==i.length&&1!==i.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===i.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return CC(n,t,i,e)}const Zj=V({truncatedNormal_:function ACe(n,t=0,e=1,i,s){if(wl(n),null!=i&&"bool"===i)throw new Error("Unsupported data type $ { dtype }");const r=new WA(t,e,i,!0,s),o=Dt(n,i);for(let a=0;a<o.values.length;a++)o.values[a]=r.nextValue();return o.toTensor()}}),ud=V({unstack_:function MCe(n,t=0){const e=N(n,"x","unstack","string_or_numeric");return T(t>=-e.shape.length&&t<e.shape.length,()=>`Axis = ${t} is not in [-${e.shape.length}, ${e.shape.length})`),$.runKernel(aC,{value:e},{axis:t})}}),Ls=V({where_:function RCe(n,t,e){const i=N(t,"a","where"),s=N(e,"b","where"),r=N(n,"condition","where","bool"),o=ft(ft(r.shape,i.shape),s.shape),a=Db(r,o),l=Db(i,o),c=Db(s,o);return $.runKernel(eC,{condition:a,t:l,e:c})}}),KA=V({imag_:function OCe(n){const e={input:N(n,"input","imag")};return $.runKernel(CN,e)}}),OC=V({real_:function FCe(n){const e={input:N(n,"input","real")};return $.runKernel(NN,e)}}),jt=V({transpose_:function LCe(n,t,e){const i=N(n,"x","transpose");if(null==t&&(t=i.shape.map((o,a)=>a).reverse()),T(i.rank===t.length,()=>`Error in transpose: rank of input ${i.rank} must match length of perm ${t}.`),t.forEach(o=>{T(o>=0&&o<i.rank,()=>`All entries in 'perm' must be between 0 and ${i.rank-1} but got ${t}`)}),i.rank<=1)return i.clone();const s={x:i},r={perm:t};return"complex64"===i.dtype?Y(()=>{let o=OC(i),a=KA(i);return o=$.runKernel(Ef,{x:o},r),a=$.runKernel(Ef,{x:a},r),e&&(a=Hn(a)),ed(o,a)}):$.runKernel(Ef,s,r)}}),VCe=V({dropout_:function BCe(n,t,e,i){const s=N(n,"x","dropout");if(T("float32"===s.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),T(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),0===t)return n instanceof Bi?s.clone():s;const r=function $Ce(n,t){if(null==t)return n.shape.slice();if(tn(n.shape,t))return t;if(n.shape.length===t.length){const e=[];for(let i=0;i<n.shape.length;i++)e.push(null==t[i]&&null!=n.shape[i]?n.shape[i]:t[i]);return e}return t}(s,e),o=1-t,a=qe(AC(ge(Ab(r,0,1,"float32",i),o)),o);return F(s,a)}}),XA=V({fft_:function zCe(n){return T("complex64"===n.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`),$.runKernel("FFT",{input:n})}}),YA=V({rfft_:function UCe(n,t){T("float32"===n.dtype,()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let e=n.shape[n.shape.length-1];const i=n.size/e;let s;if(null!=t&&t<e){const p=n.shape.map(m=>0),g=n.shape.map(m=>m);g[n.shape.length-1]=t,s=_n(n,p,g),e=t}else if(null!=t&&t>e){const p=n.shape.map(g=>g);p[n.shape.length-1]=t-e,s=ws([n,ns(p)],n.shape.length-1),e=t}else s=n;const r=Ht(s),o=j(ed(s,r),[i,e]),a=XA(o),l=Math.floor(e/2)+1,c=OC(a),u=KA(a),d=zr(c,[l,e-l],c.shape.length-1),h=zr(u,[l,e-l],u.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,j(ed(d[0],h[0]),f)}}),FC=V({ifft_:function WCe(n){return T("complex64"===n.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`),$.runKernel(xN,{input:n})}}),Qj=V({irfft_:function HCe(n){const t=n.shape[n.shape.length-1],e=n.size/t;let i;if(t<=2){const s=j(n,[e,t]);i=FC(s)}else{const s=[e,2*(t-1)],r=j(OC(n),[e,t]),o=j(KA(n),[e,t]),a=cd(_n(r,[0,1],[e,t-2]),1),l=F(cd(_n(o,[0,1],[e,t-2]),1),ct(-1)),c=ws([r,a],1),u=ws([o,l],1),d=j(ed(c,u),[s[0],s[1]]);i=FC(d)}if(i=OC(i),3===n.rank&&0!==n.shape[0]){const s=i,r=n.shape[0];i=j(i,[r,i.shape[0]/r,i.shape[1]]),s.dispose()}return i}}),ZA=V({conv2DBackpropFilter_:function jCe(n,t,e,i,s,r="NHWC",o){let a=n;3===n.rank&&(a=j(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=t;3===l.rank&&(l=j(t,[1,t.shape[0],t.shape[1],t.shape[2]])),T(4===a.rank,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(4===l.rank,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(4===e.length,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);const c="NHWC"===r?a.shape[3]:a.shape[1],u="NHWC"===r?l.shape[3]:l.shape[1];return T(c===e[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${e[2]}.`),T(u===e[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${e[3]}).`),Fs("conv2dDerFilter",s,o),$.runKernel(rN,{x:a,dy:l},{strides:i,pad:s,dataFormat:r,dimRoundingMode:o,filterShape:e})}}),Jj=V({relu6_:function GCe(n){const e={x:N(n,"x","relu6")};return $.runKernel(ib,e)}}),Fb=V({step_:function qCe(n,t=0){const i={x:N(n,"x","step")};return $.runKernel(_b,i,{alpha:t})}});function LC(n,t,e){if(null==e||"linear"===e)return n;if("relu"===e)return F(n,Fb(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function $C(n,t){let e=t;const i=Vi(n.shape,t.shape);return i.length>0&&(e=We(e,i)),j(e,n.shape)}function BC(n,t,e,i){if("linear"===t)return n;if("relu"===t)return Dl(n);if("elu"===t)return NC(n);if("relu6"===t)return Jj(n);if("prelu"===t)return zA(n,e);if("leakyrelu"===t)return RA(n,i);if("sigmoid"===t)return Lf(n);throw new Error(`Unknown fused activation ${t}.`)}const VC=(n,t)=>!(n>0)||"linear"===t,XCe=V({fusedConv2d_:function KCe({x:n,filter:t,strides:e,pad:i,dataFormat:s="NHWC",dilations:r=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(!1===VC($.state.gradientDepth,l=l||"linear")){T("NHWC"===s,()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=ad(n,t,e,i,s,r,o);return null!=a&&(S=ge(S,a)),BC(S,l,c,u)}const d=N(n,"x","conv2d","float32"),h=N(t,"filter","conv2d","float32");let f=d,p=!1;3===d.rank&&(p=!0,f=j(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(4===f.rank,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(4===h.rank,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Fs("fused conv2d",i,o);const g="NHWC"===s?f.shape[3]:f.shape[1];T(h.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${h.shape[2]}.`),T(hs(e,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${r}'`);const m=es(f.shape,h.shape,e,r,i,o);let b,_;if(null!=a&&(b=N(a,"bias","fused conv2d"),[b]=ci(b,d),"NHWC"===s?ft(m.outShape,b.shape):(T(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),T(0===b.shape.length||b.shape[0]===m.outChannels||1===b.shape[0],()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${m.outChannels})`))),null!=c){const S=c.shape;if(T(S.length<=1||3===S.length,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),1===S.length)T(1===S[0]||S[0]===m.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${m.outChannels}).`);else if(3===S.length)try{ft(S,m.outShape)}catch{throw Error(`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${m.outShape}).`)}_=N(c,"prelu weights","fused conv2d")}const y=(S,E)=>{T("NHWC"===s,()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[k,D,M,R]=E,U=LC(S,M,l);T(Oc(r),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const K=[MA(D.shape,U,k,e,i),ZA(D,U,k.shape,e,i)];if(null!=R){const O=$C(R,U);K.push(O)}return K},v={x:f,filter:h,bias:b,preluActivationWeights:_},x={strides:e,pad:i,dataFormat:s,dilations:r,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return null==a?Sl((E,k,D)=>{let M=$.runKernel(dC,v,x);return D([k,E,M]),p&&(M=j(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:y}})(f,h):Sl((E,k,D,M)=>{let R=$.runKernel(dC,v,x);return M([k,E,R,D]),p&&(R=j(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:y}})(f,h,b)}}),eG=V({depthwiseConv2dNativeBackpropFilter_:function YCe(n,t,e,i,s,r=[1,1],o){let a=n;3===n.rank&&(a=j(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=t;return 3===l.rank&&(l=j(t,[1,t.shape[0],t.shape[1],t.shape[2]])),$.runKernel(hN,{x:a,dy:l},{strides:i,pad:s,dimRoundingMode:o,dilations:r,filterShape:e})}}),tG=V({depthwiseConv2dNativeBackpropInput_:function ZCe(n,t,e,i,s,r=[1,1],o){let a=t,l=!1;3===t.rank&&(l=!0,a=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const d=$.runKernel(fN,{dy:a,filter:e},{strides:i,pad:s,dimRoundingMode:o,dilations:r,inputShape:n});return l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),nG=V({fusedMatMul_:function JCe({a:n,b:t,transposeA:e=!1,transposeB:i=!1,bias:s,activation:r="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(!1===VC($.state.gradientDepth,r)){let R=nn(n,t,e,i);return null!=s&&(R=ge(R,s)),BC(R,r,o,a)}let l=N(n,"a","fused matMul"),c=N(t,"b","fused matMul");[l,c]=ci(l,c);const u=e?l.shape[l.rank-2]:l.shape[l.rank-1],d=i?c.shape[c.rank-1]:c.shape[c.rank-2],h=e?l.shape[l.rank-1]:l.shape[l.rank-2],f=i?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),g=c.shape.slice(0,-2),m=te(p),b=te(g);T(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${e} and transposeB=${i} must match.`);const y=ft(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),v=j(l,e?[m,u,h]:[m,h,u]),x=j(c,i?[b,f,d]:[b,d,f]);let S,E;null!=s&&(S=N(s,"bias","fused matMul"),[S]=ci(S,l),ft(y,S.shape)),null!=o&&(E=N(o,"prelu weights","fused matMul"));const k=(R,U)=>{const[X,ee,K,O]=U,z=LC(j(R,K.shape),K,r);let B,q;return e||i?!e&&i?(B=nn(z,ee,!1,!1),q=nn(z,X,!0,!1)):e&&!i?(B=nn(ee,z,!1,!0),q=nn(X,z,!1,!1)):(B=nn(ee,z,!0,!0),q=nn(z,X,!0,!0)):(B=nn(z,ee,!1,!0),q=nn(X,z,!0,!1)),null!=s?[B,q,$C(O,z)]:[B,q]},D={a:v,b:x,bias:S,preluActivationWeights:E},M={transposeA:e,transposeB:i,activation:r,leakyreluAlpha:a};return null==s?Sl((U,X,ee)=>{const K=$.runKernel(uC,D,M);return ee([U,X,K]),{value:j(K,y),gradFunc:k}})(v,x):Sl((U,X,ee,K)=>{const O=$.runKernel(uC,D,M);return K([U,X,O,ee]),{value:j(O,y),gradFunc:k}})(v,x,S)}}),lwe=V({cropAndResize_:function awe(n,t,e,i,s="bilinear",r=0){const o=N(n,"image","cropAndResize"),a=N(t,"boxes","cropAndResize","float32"),l=N(e,"boxInd","cropAndResize","int32"),c=a.shape[0];return T(4===o.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),T(2===a.rank&&4===a.shape[1],()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(1===l.rank&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(2===i.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${i.length}.`),T(i[0]>=1&&i[1]>=1,()=>`cropSize must be atleast [1,1], but was ${i}`),T("bilinear"===s||"nearest"===s,()=>`method must be bilinear or nearest, but was ${s}`),$.runKernel(cN,{image:o,boxes:a,boxInd:l},{method:s,extrapolationValue:r,cropSize:i})}}),uwe=V({flipLeftRight_:function cwe(n){const t=N(n,"image","flipLeftRight","float32");return T(4===t.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`),$.runKernel(vN,{image:t},{})}}),hwe=V({grayscaleToRGB_:function dwe(n){const t=N(n,"image","grayscaleToRGB"),e=t.rank-1,i=t.shape[e];T(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),T(1===i,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${i}.`);const s=new Array(t.rank);return s.fill(1,0,e),s[e]=3,Xo(t,s)}}),Lb=V({einsum_:function fwe(n,...t){const e=t.map((s,r)=>N(s,`tensors${r}`,"einsum"));return $.runKernel(gN,e,{equation:n})}}),mwe=V({rgbToGrayscale_:function pwe(n){const t=N(n,"image","RGBToGrayscale"),i=t.shape[t.rank-1];T(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),T(3===i,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${i}.`);const s=t.dtype,r=Te(t,"float32"),o=rr([.2989,.587,.114]);let a;switch(t.rank){case 2:a=Lb("ij,j->i",r,o);break;case 3:a=Lb("ijk,k->ij",r,o);break;case 4:a=Lb("ijkl,l->ijk",r,o);break;case 5:a=Lb("ijklm,m->ijkl",r,o);break;case 6:a=Lb("ijklmn,n->ijklm",r,o);break;default:throw new Error("Not a valid tensor rank.")}return a=sr(a,-1),Te(a,s)}}),bwe=V({rotateWithOffset_:function gwe(n,t,e=0,i=.5){const s=N(n,"image","rotateWithOffset","float32");return T(4===s.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`),$.runKernel(jN,{image:s},{radians:t,fillValue:e,center:i})}});function $f(n,t,e,i,s,r){null==i&&(i=.5),null==s&&(s=Number.NEGATIVE_INFINITY),null==r&&(r=0);const o=n.shape[0];return e=Math.min(e,o),T(0<=i&&i<=1,()=>`iouThreshold must be in [0, 1], but was '${i}'`),T(2===n.rank,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),T(4===n.shape[1],()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),T(1===t.rank,()=>"scores must be a 1D tensor"),T(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),T(0<=r&&r<=1,()=>`softNmsSigma must be in [0, 1], but was '${r}'`),{maxOutputSize:e,iouThreshold:i,scoreThreshold:s,softNmsSigma:r}}const ywe=V({nonMaxSuppression_:function _we(n,t,e,i=.5,s=Number.NEGATIVE_INFINITY){const r=N(n,"boxes","nonMaxSuppression","float32"),o=N(t,"scores","nonMaxSuppression","float32"),a=$f(r,o,e,i,s);return $.runKernel(EN,{boxes:r,scores:o},{maxOutputSize:e=a.maxOutputSize,iouThreshold:i=a.iouThreshold,scoreThreshold:s=a.scoreThreshold})}});function vwe(n,t,e){const i=function xwe(n,t,e){return function wwe(n,t,e){let i=0,s=n.length,r=0,o=!1;for(;i<s;){r=i+(s-i>>>1);const a=e(t,n[r]);a>0?i=r+1:(s=r,o=!a)}return o?i:-i-1}(n,t,e||Cwe)}(n,t,e);n.splice(i<0?-(i+1):i,0,t)}function Cwe(n,t){return n>t?1:n<t?-1:0}function QA(n,t,e,i,s){return tM(n,t,e,i,s,0)}function JA(n,t,e,i,s,r){return tM(n,t,e,i,s,0,!1,r,!0)}function eM(n,t,e,i,s,r){return tM(n,t,e,i,s,r,!0)}function tM(n,t,e,i,s,r,o=!1,a=!1,l=!1){const c=[];for(let m=0;m<t.length;m++)t[m]>s&&c.push({score:t[m],boxIndex:m,suppressBeginIndex:0});c.sort(oG);const u=r>0?-.5/r:0,d=[],h=[];for(;d.length<e&&c.length>0;){const m=c.pop(),{score:b,boxIndex:_,suppressBeginIndex:y}=m;if(b<s)break;let v=!1;for(let x=d.length-1;x>=y;--x){const S=Swe(n,_,d[x]);if(S>=i){v=!0;break}if(m.score=m.score*Iwe(i,u,S),m.score<=s)break}m.suppressBeginIndex=d.length,v||(m.score===b?(d.push(_),h.push(m.score)):m.score>s&&vwe(c,m,oG))}const f=d.length,p=e-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const g={selectedIndices:d};return o&&(g.selectedScores=h),l&&(g.validOutputs=f),g}function Swe(n,t,e){const i=n.subarray(4*t,4*t+4),s=n.subarray(4*e,4*e+4),r=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]),c=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),f=(a-r)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const g=Math.max(r,c),m=Math.max(o,u),b=Math.min(a,d),_=Math.min(l,h),y=Math.max(b-g,0)*Math.max(_-m,0);return y/(f+p-y)}function Iwe(n,t,e){const i=Math.exp(t*e*e);return e<=n?i:0}function oG(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}function nM(){return(nM=Q(function*(n,t,e,i=.5,s=Number.NEGATIVE_INFINITY){const r=N(n,"boxes","nonMaxSuppressionAsync"),o=N(t,"scores","nonMaxSuppressionAsync"),a=$f(r,o,e,i,s);e=a.maxOutputSize,i=a.iouThreshold,s=a.scoreThreshold;const l=yield Promise.all([r.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=QA(c,u,e,i,s);return r!==n&&r.dispose(),o!==t&&o.dispose(),rr(d,"int32")})).apply(this,arguments)}const Dwe=V({nonMaxSuppressionWithScore_:function Twe(n,t,e,i=.5,s=Number.NEGATIVE_INFINITY,r=0){const o=N(n,"boxes","nonMaxSuppression"),a=N(t,"scores","nonMaxSuppression"),l=$f(o,a,e,i,s,r),d=$.runKernel(TN,{boxes:o,scores:a},{maxOutputSize:e=l.maxOutputSize,iouThreshold:i=l.iouThreshold,scoreThreshold:s=l.scoreThreshold,softNmsSigma:r=l.softNmsSigma});return{selectedIndices:d[0],selectedScores:d[1]}}});function iM(){return(iM=Q(function*(n,t,e,i=.5,s=Number.NEGATIVE_INFINITY,r=0){const o=N(n,"boxes","nonMaxSuppressionAsync"),a=N(t,"scores","nonMaxSuppressionAsync"),l=$f(o,a,e,i,s,r);e=l.maxOutputSize,i=l.iouThreshold,s=l.scoreThreshold,r=l.softNmsSigma;const c=yield Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=eM(u,d,e,i,s,r);return o!==n&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:rr(h,"int32"),selectedScores:rr(f)}})).apply(this,arguments)}const Pwe=V({nonMaxSuppressionPadded_:function Mwe(n,t,e,i=.5,s=Number.NEGATIVE_INFINITY,r=!1){const o=N(n,"boxes","nonMaxSuppression"),a=N(t,"scores","nonMaxSuppression"),l=$f(o,a,e,i,s,null),p=$.runKernel(kN,{boxes:o,scores:a},{maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:r});return{selectedIndices:p[0],validOutputs:p[1]}}});function sM(){return(sM=Q(function*(n,t,e,i=.5,s=Number.NEGATIVE_INFINITY,r=!1){const o=N(n,"boxes","nonMaxSuppressionAsync"),a=N(t,"scores","nonMaxSuppressionAsync"),l=$f(o,a,e,i,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=yield Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:g}=JA(h,f,c,u,d,r);return o!==n&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:rr(p,"int32"),validOutputs:ct(g,"int32")}})).apply(this,arguments)}const aG=V({resizeBilinear_:function Fwe(n,t,e=!1,i=!1){const s=N(n,"images","resizeBilinear");T(3===s.rank||4===s.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),T(2===t.length,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),T(!1===i||!1===e,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let r=s,o=!1;3===s.rank&&(o=!0,r=j(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=t,c=$.runKernel(Qx,{images:r},{alignCorners:e,halfPixelCenters:i,size:t});return o?j(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),lG=V({resizeNearestNeighbor_:function Lwe(n,t,e=!1,i=!1){const s=N(n,"images","resizeNearestNeighbor");T(3===s.rank||4===s.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),T(2===t.length,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),T("float32"===s.dtype||"int32"===s.dtype,()=>"`images` must have `int32` or `float32` as dtype"),T(!1===i||!1===e,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let r=s,o=!1;3===s.rank&&(o=!0,r=j(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=t,c=$.runKernel(Zx,{images:r},{alignCorners:e,halfPixelCenters:i,size:t});return o?j(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),Bwe=V({bincount_:function $we(n,t,e){const i=N(n,"x","bincount"),s=N(t,"weights","bincount");return T("int32"===i.dtype,()=>`Error in bincount: input dtype must be int32, but got ${i.dtype}`),T(e>=0,()=>`size must be non-negative, but got ${e}.`),T(s.size===i.size||0===s.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${i.shape}, weights shape: ${s.shape}.`),$.runKernel(nN,{x:i,weights:s},{size:e})}}),Bf=V({lessEqual_:function Vwe(n,t){let e=N(n,"a","lessEqual","string_or_numeric"),i=N(t,"b","lessEqual","string_or_numeric");return[e,i]=ci(e,i),ft(e.shape,i.shape),$.runKernel(Ax,{a:e,b:i})}}),cG=V({round_:function zwe(n){const e={x:N(n,"x","round")};return $.runKernel(sb,e)}}),Hwe=V({threshold_:function Uwe(n,t="binary",e=!1,i=.5){const s=N(n,"image","threshold"),l=s.shape[0]*s.shape[1];let u,d,h,f,c=F(rr([i]),255);if(T(3===s.rank,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),T(3===s.shape[2]||1===s.shape[2],()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),T("int32"===s.dtype||"float32"===s.dtype,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),T("otsu"===t||"binary"===t,()=>`Method must be binary or otsu, but was ${t}`),3===s.shape[2]){[u,d,h]=zr(s,[1,1,1],-1);const m=F(u,.2989),b=F(d,.587),_=F(h,.114);f=ge(ge(m,b),_)}else f=n;"otsu"===t&&(c=function Wwe(n,t){let r,o,a,l,c,u,e=rr([-1]),i=rr([0]),s=rr([0]);for(let d=0;d<n.size-1;d++){r=_n(n,0,d+1),o=_n(n,d+1),c=qe(We(r),t),u=qe(We(o),t);const h=We(F(r,Mb(0,r.size)));a=qe(h,We(r));const f=Sb(o.shape,r.size),p=ge(Mb(0,o.size),f),g=F(o,p);l=qe(We(g),We(o));const m=Be(a,l),b=Be(a,l),_=F(c,u);s=F(F(_,m),b);const y=Vr(s,i);i=Ls(y,s,i),e=Ls(y,rr([d]),e)}return e}(Bwe(Te(cG(f),"int32"),wb([]),256),l));const p=e?Bf(f,c):Vr(f,c);return Te(F(p,255),"int32")}}),Gwe=V({transform_:function jwe(n,t,e="nearest",i="constant",s=0,r){const o=N(n,"image","transform","float32"),a=N(t,"transforms","transform","float32");return T(4===o.rank,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),T(2===a.rank&&(a.shape[0]===o.shape[0]||1===a.shape[0])&&8===a.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(null==r||2===r.length,()=>`Error in transform: outputShape must be [height, width] or null, but got ${r}.`),$.runKernel(WN,{image:o,transforms:a},{interpolation:e,fillMode:i,fillValue:s,outputShape:r})}}),zC=V({less_:function qwe(n,t){let e=N(n,"a","less","string_or_numeric"),i=N(t,"b","less","string_or_numeric");return[e,i]=ci(e,i),ft(e.shape,i.shape),$.runKernel(Nx,{a:e,b:i})}}),Xwe=V({bandPart_:function Kwe(n,t,e){const i=N(n,"a","bandPart");T(i.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${i.rank}.`);const s=i.shape,[r,o]=i.shape.slice(-2);let a,l;"number"==typeof t?(T(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),T(t<=r,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${r}).`),a=N(t<0?r:t,"numLower","bandPart")):(T("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),a=Ls(zC(t,0),r,Ff(t,r))),"number"==typeof e?(T(e%1==0,()=>`bandPart(): numUpper must be an integer, got ${e}.`),T(e<=o,()=>`bandPart(): numUpper (${e}) must not be greater than the number of columns (${o}).`),l=N(e<0?o:e,"numUpper","bandPart")):(T("int32"===e.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),l=Ls(zC(e,0),o,Ff(e,o)));const c=j(Mb(0,r,1,"int32"),[-1,1]),u=Mb(0,o,1,"int32"),d=Be(c,u),h=kl(Bf(d,a),ld(d,Hn(l))),f=ns([r,o],i.dtype);return j(Nl(ud(j(i,[-1,r,o])).map(p=>Ls(h,p,f))),s)}});function uG(n,t,e=null){if(0===n.rank)return Ji(n);if(1!==n.rank&&null===e)return uG(j(n,[-1]),t,e);if(1===n.rank||"number"==typeof e||Array.isArray(e)&&1===e.length){if(1===t)return We(Ji(n),e);if(t===1/0)return Yo(Ji(n),e);if(t===-1/0)return MC(Ji(n),e);if("euclidean"===t||2===t)return Cs(We(rd(Ji(n),ct(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(e)&&2===e.length){if(1===t)return Yo(We(Ji(n),e[0]),e[1]-1);if(t===1/0)return Yo(We(Ji(n),e[1]),e[0]);if(t===-1/0)return MC(We(Ji(n),e[1]),e[0]);if("fro"===t||"euclidean"===t)return Cs(We(kn(n),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}const UC=V({norm_:function Ywe(n,t="euclidean",e=null,i=!1){const s=uG(n=N(n,"x","norm"),t,e);let r=s.shape;if(i){const o=Tt(e,n.shape);r=vi(s.shape,o)}return j(s,r)}}),Qwe=V({gramSchmidt_:function Zwe(n){let t;if(Array.isArray(n)){t=!1,T(null!=n&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=n[0].shape[0];for(let r=1;r<n.length;++r)T(n[r].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[r].shape[0]} vs. ${s})`)}else t=!0,n=zr(n,n.shape[0],0).map(s=>Rb(s,[0]));T(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const e=[],i=n;for(let s=0;s<n.length;++s)e.push($.tidy(()=>{let r=i[s];if(s>0)for(let o=0;o<s;++o){const a=F(We(F(e[o],r)),e[o]);r=Be(r,a)}return qe(r,UC(r,"euclidean"))}));return t?Nl(e,0):e}});function dG(n,t=!1){return $.tidy(()=>{T(2===n.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const e=n.shape[0],i=n.shape[1];let s=Hj(e),r=sd(n);const o=Ob([[1]],[1,1]);let a=sd(o);const l=e>=i?i:e;for(let c=0;c<l;++c){const u=r,d=a,h=s;[a,r,s]=$.tidy(()=>{const f=_n(r,[c,c],[e-c,1]),p=UC(f),g=_n(r,[c,c],[1,1]),m=Ls(Vr(g,0),Ob([[-1]]),Ob([[1]])),b=Be(g,F(m,p)),_=qe(f,b);a=1===_.shape[0]?sd(o):ws([o,_n(_,[1,0],[_.shape[0]-1,_.shape[1]])],0);const y=Hn(qe(nn(m,b),p)),v=_n(r,[c,0],[e-c,i]),x=F(y,a),S=jt(a);if(0===c)r=Be(v,nn(x,nn(S,v)));else{const D=Be(v,nn(x,nn(S,v)));r=ws([_n(r,[0,0],[c,i]),D],0)}const E=jt(x),k=_n(s,[0,c],[e,s.shape[1]-c]);if(0===c)s=Be(k,nn(nn(k,a),E));else{const D=Be(k,nn(nn(k,a),E));s=ws([_n(s,[0,0],[e,c]),D],1)}return[a,r,s]}),It([u,d,h])}return!t&&e>i&&(s=_n(s,[0,0],[e,i]),r=_n(r,[0,0],[i,i])),[s,r]})}const e1e=V({qr_:function Jwe(n,t=!1){if(T(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),2===n.rank)return dG(n,t);{const e=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),i=ud(j(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),s=[],r=[];return i.forEach(l=>{const[c,u]=dG(l,t);s.push(c),r.push(u)}),[j(Nl(s,0),n.shape),j(Nl(r,0),n.shape)]}}}),hG=V({squaredDifference_:function h1e(n,t){let e=N(n,"a","squaredDifference"),i=N(t,"b","squaredDifference");return[e,i]=ci(e,i),ft(e.shape,i.shape),$.runKernel(fb,{a:e,b:i},{})}}),Ml={flipLeftRight:uwe,grayscaleToRGB:hwe,resizeNearestNeighbor:lG,resizeBilinear:aG,rgbToGrayscale:mwe,rotateWithOffset:bwe,cropAndResize:lwe,nonMaxSuppression:ywe,nonMaxSuppressionAsync:function Ewe(n,t,e){return nM.apply(this,arguments)},nonMaxSuppressionWithScore:Dwe,nonMaxSuppressionWithScoreAsync:function Nwe(n,t,e){return iM.apply(this,arguments)},nonMaxSuppressionPadded:Pwe,nonMaxSuppressionPaddedAsync:function Rwe(n,t,e){return sM.apply(this,arguments)},threshold:Hwe,transform:Gwe},L1e={bandPart:Xwe,gramSchmidt:Qwe,qr:e1e},Vf=class $1e{static sgd(t){return new bA(t)}static momentum(t,e,i=!1){return new yj(t,e,i)}static rmsprop(t,e=.9,i=0,s=null,r=!1){return new vj(t,e,i,s,r)}static adam(t=.001,e=.9,i=.999,s=null){return new bj(t,e,i,s)}static adadelta(t=.001,e=.95,i=null){return new mj(t,e,i)}static adamax(t=.002,e=.9,i=.999,s=null,r=0){return new _j(t,e,i,s,r)}static adagrad(t,e=.1){return new gj(t,e)}},B1e=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function fG(){return new Promise(n=>B1e(()=>n()))}function rM(n,t){const e=n[0].length;n.forEach((s,r)=>{T(s.length===e,()=>`Error in concat${e}D: rank of tensors[${r}] must be the same as the rank of the rest (${e})`)}),T(t>=0&&t<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);const i=n[0];n.forEach((s,r)=>{for(let o=0;o<e;o++)T(o===t||s[o]===i[o],()=>`Error in concat${e}D: Shape of tensors[${r}] (${s}) does not match the shape of the rest (${i}) along the non-concatenated axis ${r}.`)})}function La(n,t){const e=n[0].slice();for(let i=1;i<n.length;i++)e[t]+=n[i][t];return e}var vo=(()=>{return(n=vo||(vo={}))[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS",vo;var n})();function pG(n,t,e){let i=new Array;if(null==e&&null==t)return i;if(null==t)for(;i.length<n+e.length;)i.push(-1);else i=t.slice();if(null==e)return i;if(n+e.length!==i.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${n+e.length}, but shape.rank = ${i.length}`);for(let s=1;s<e.length;++s){const r=e[s],o=i[i.length-e.length+s],a=i[o];if(r>=0)if(a>=0){if(a!==r)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${s+n}] = ${r} but shape[${s+n}] = ${a}`)}else i[o]=r}return i}function mG(n){const t={FIRST_DIM_SIZE:vo.FIRST_DIM_SIZE,VALUE_ROWIDS:vo.VALUE_ROWIDS,ROW_LENGTHS:vo.ROW_LENGTHS,ROW_SPLITS:vo.ROW_SPLITS,ROW_LIMITS:vo.ROW_LIMITS,ROW_STARTS:vo.ROW_STARTS},e=[];for(const i of n){if(!(i in t))break;e.push(t[i])}return e}function gG(n){return 0===n.length?0:n[0]===vo.FIRST_DIM_SIZE?n.length-1:n.length}function bG(n,t){if(null==n||null==t)return;const e=n.length,i=t.length;if(e>=i)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${e} must be less than ragged tensor input flatValues.rank = ${i})`);for(let s=0;s<Math.min(e,i-1);++s){const r=n[s],o=t[s+1];if(r>=0&&o>=0&&1!==r&&r!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${s-n.length}] = ${r} but ragged tensor input.flatValues.shape[${s-n.length}] = ${o}`)}}const oM=30;function WC(n){return n<=oM?n:GD(n,Math.floor(Math.sqrt(n)))}function aM(n,t,e){return[e*("number"==typeof n?n:n[0]),t*("number"==typeof n?n:n[1])]}function $b(n,t,e,i=!0){let s=[];if(i)s=s.concat(t.slice(0)),s.push(n[0]/e),s=s.concat(n.slice(1));else{s=s.concat(n[0]);const r=t.length;for(let o=0;o<r;++o)s=s.concat([n[o+1]/t[o],t[o]]);s=s.concat(n.slice(r+1))}return s}function Bb(n,t,e=!0){const i=[];if(e){i.push(t);for(let s=t+1;s<n;++s)s<=2*t?(i.push(s),i.push(s-(t+1))):i.push(s)}else{const s=[],r=[];for(let o=1;o<n;++o)o>=2*t+1||o%2==1?r.push(o):s.push(o);i.push(...s),i.push(0),i.push(...r)}return i}function Vb(n,t,e,i=!0){const s=[];s.push(i?n[0]/e:n[0]*e);for(let r=1;r<n.length;++r)s.push(r<=t.length?i?t[r-1]*n[r]:n[r]/t[r-1]:n[r]);return s}function lM(n,t){const e=[0];for(let i=0;i<t;++i)e.push(n[i][0]);return e}function cM(n,t,e){const i=n.slice(0,1);for(let s=0;s<e;++s)i.push(n[s+1]-t[s][0]-t[s][1]);return i}function uM(n,t){const e=n.shape.length,i=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(i<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${i}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[i-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[i-1]} vs. ${e}`);if(0===te(n.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const s=t.shape,r=s[s.length-1];let o=1;for(let d=0;d<s.length-1;++d)o*=s[d];const a=n.shape,l=s.slice();l.pop();let c=1;for(let d=r;d<e;++d)c*=a[d],l.push(a[d]);const u=[...Ye(n.shape).map(d=>d/c),1].slice(0,r);return[l,o,c,u]}function _G(n,t,e){const i=t.rank>1?t.shape[t.rank-1]:1,s=t.rank>1?t.rank-1:1,r=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${t.shape}, shape: ${n}, sliceDim: ${i}, and batchDim: ${s}.`;if(e.rank<s)throw new Error(r+` update.rank < ${s}. `);if(n.length<i+(e.rank-s))throw new Error(r+` Output shape length < ${i+(e.rank-s)}`);if(e.rank!==s+n.length-i)throw new Error(r+" update.rank != "+(s+n.length-i));for(let o=0;o<s;++o)if(e.shape[o]!==t.shape[o])throw new Error(r+` updates.shape[${o}] (${e.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<e.rank-s;++o)if(e.shape[o+s]!==n[o+i])throw new Error(r+` updates.shape[${o+s}] (${e.shape[o+s]}) != shape[${o+s}] (${n[o+s]})`)}function V1e(n,t,e){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(0===e.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===n.size)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}_G(e,t,n)}function dd(n,t,e){const i=t.shape.length,s=i>1?t.shape[i-1]:1,r=e.length;let o=1;for(let d=s;d<r;++d)o*=e[d];const a=s<1?1:s;return{sliceRank:s,numUpdates:te(t.shape)/a,sliceSize:o,strides:[...Ye(e.slice(0,s)),1],outputSize:te(e)}}const HC=1.7580993408473768,jC=1.0507009873554805,dM=.3275911,hM=.254829592,fM=-.284496736,pM=1.421413741,mM=-1.453152027,gM=1.061405429;function Pl(n,t){if(n.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${t.length}.`);const e=new Float32Array(2*n.length);for(let i=0;i<e.length;i+=2)e[i]=n[i/2],e[i+1]=t[i/2];return e}function yG(n){const t=new Float32Array(n.length/2),e=new Float32Array(n.length/2);for(let i=0;i<n.length;i+=2)t[i/2]=n[i],e[i/2]=n[i+1];return{real:t,imag:e}}function vG(n){const t=Math.ceil(n.length/4),e=new Float32Array(t),i=new Float32Array(t);for(let s=0;s<n.length;s+=4)e[Math.floor(s/4)]=n[s],i[Math.floor(s/4)]=n[s+1];return{real:e,imag:i}}function xG(n){const t=Math.floor(n.length/4),e=new Float32Array(t),i=new Float32Array(t);for(let s=2;s<n.length;s+=4)e[Math.floor(s/4)]=n[s],i[Math.floor(s/4)]=n[s+1];return{real:e,imag:i}}function bM(n,t){return{real:n[2*t],imag:n[2*t+1]}}function CG(n,t,e,i){n[2*i]=t,n[2*i+1]=e}function wG(n,t){const e=new Float32Array(n/2),i=new Float32Array(n/2);for(let s=0;s<Math.ceil(n/2);s++){const r=(t?2:-2)*Math.PI*(s/n);e[s]=Math.cos(r),i[s]=Math.sin(r)}return{real:e,imag:i}}function SG(n,t,e){const i=(e?2:-2)*Math.PI*(n/t);return{real:Math.cos(i),imag:Math.sin(i)}}const _M="->",z1e=/->/g,IG=",",EG="...";function yM(n,t){const e=((n=n.replace(/\s/g,"")).length-n.replace(z1e,"").length)/_M.length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error(`Equation must contain exactly one arrow ("${_M}").`);const[i,s]=n.split(_M);T(-1===i.indexOf(EG),()=>`The ellipsis notation ("${EG}") is not supported yet.`);const r=i.split(IG),o=r.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<s.length;++h){const f=s[h];if(!r.some(p=>-1!==p.indexOf(f)))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);-1===a.indexOf(f)&&a.push(f)}for(let h=0;h<i.length;++h){const f=i[h];-1===a.indexOf(f)&&f!==IG&&a.push(f)}const l=new Array(r.length);for(let h=0;h<o;++h){if(new Set(r[h].split("")).size!==r[h].length)throw new Error(`Found duplicate axes in input component ${r[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<r[h].length;++f)l[h].push(a.indexOf(r[h][f]))}const c=a.length,d=[];for(let h=s.length;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function vM(n,t){let e=new Array(n);e.fill(-1);for(let s=0;s<t.length;++s)e[t[s]]=s;const i=[];for(let s=0;s<n;++s)-1===e[s]&&i.push(s);return e=e.filter(s=>-1!==s),{permutationIndices:e,expandDims:i}}function xM(n,t,e){const i=new Array(n);for(let s=0;s<e.length;++s){const r=e[s].shape;for(let o=0;o<t[s].length;++o)void 0===i[t[s][o]]?i[t[s][o]]=r[o]:T(i[t[s][o]]===r[o],()=>`Expected dimension ${i[t[s][o]]} at axis ${o} of input shaped ${JSON.stringify(r)}, but got dimension ${r[o]}`)}}function CM(n,t){const e=n,i=[];let s=0;0===n.length&&e.push(-1),s=n.length+1;for(let o=0;o<s;++o)i.push([]);const r=[];for(let o=0;o<e.length;++o){const l=U1e(t,e[o]);for(const c of l)-1===r.indexOf(c)&&(i[o].push(c),r.push(c))}return{path:e,steps:i}}function wM(n){return n.every((t,e)=>t===e)}function U1e(n,t){const e=[];for(let i=0;i<n.length;++i)(0===n[i].length||-1!==n[i].indexOf(t)||-1===t)&&e.push(i);return e}function SM(n,t,e=0){let i=[];if("number"==typeof t)T(n.shape[e]%t==0,()=>"Number of splits must evenly divide the axis."),i=new Array(t).fill(n.shape[e]/t);else{T(t.reduce((o,a)=>(-1===a&&(o+=1),o),0)<=1,()=>"There should be only one negative value in split array.");const r=t.indexOf(-1);if(-1!==r){const o=t.reduce((a,l)=>l>0?a+l:a);t[r]=n.shape[e]-o}T(n.shape[e]===t.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),i=t}return i}function kG(n){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${n}`}function TG(n,t){return`indices(${n}, 0) is invalid: ${t} < 0`}function DG(n,t,e){return`indices(${n}, 0) is invalid: ${t} >= ${e}`}function NG(n,t){return`only one output dimension may be -1, not both ${n} and ${t}`}function AG(n,t){return`size ${n} must be non-negative, not ${t}`}function MG(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function PG(n,t){return`Input to reshape is a SparseTensor with ${te(n)}\n  dense values, but the requested shape requires a multiple of ${te(t)}. inputShape=${n} outputShape= ${t}`}function RG(n,t){return`Input to reshape is a tensor with ${te(n)} dense values, but the requested shape has ${te(t)}. inputShape=${n} outputShape=${t}`}function IM(){return"segment ids must be >= 0"}function OG(){return"segment ids are not increasing"}function FG(n,t){return`Segment id ${n} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function LG(n,t,e){return`Bad: indices[${n}] == ${t} out of range [0, ${e})`}function $G(n,t){let i,e=!1;for(n<=oM?(i=n,e=!0):i=GD(n,Math.floor(Math.sqrt(n)));!e;)i>t||i===n?e=!0:i=GD(n,i+1);return i}function BG(n,t,e){const i=[],s=n.length;for(let r=0;r<s;r++)i.push(r!==t?n[r]:e);return i}function EM(n,t,e,i){const s=t.shape.length,r=n.shape.length;if(0!==i&&(i<-s||i>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${i}`);if(i<0&&(i+=s),i>r)throw new Error(`batchDims (${i}) must be less than rank(x) (\n    ${r}).`);if(e<i)throw new Error(`batchDims (${i}) must be less than or equal to axis (${e}).`);for(let d=0;d<i;++d)if(n.shape[d]!==t.shape[d])throw new Error(`x.shape[${d}]: ${n.shape[d]} should be equal to indices.shape[${d}]: ${t.shape[d]}.`);const o=n.shape[e],a=[];let l=1,c=1,u=1;for(let d=0;d<i;++d)a.push(n.shape[d]),l*=n.shape[d];for(let d=i;d<e;d++)a.push(n.shape[d]),c*=n.shape[d];for(let d=i;d<s;d++)a.push(t.shape[d]);for(let d=e+1;d<r;d++)a.push(n.shape[d]),u*=n.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}function Rl(n){try{return n.map(t=>Dc(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function VG(n){return n.map(t=>Tc(t))}function zG(n,t){const e=[];for(let r=0;r<t.length;r++)t[r]&&e.push(r);const i=Dt(n,"int32"),s=Dt([e.length,n.length],"int32");for(let r=0;r<e.length;r++){const o=i.indexToLoc(e[r]);s.values.set(o,r*n.length)}return s.toTensor()}!function Cve(){for(const n of xve)pe(n)}();const UG={kernelName:cx,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(n,Fb(Te(e,"float32"),-1))}}},W1e={kernelName:Sg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const i=kn(Te(e,"float32")),s=Cs(Be(ct(1),i));return Hn(qe(n,s))}}}},H1e={kernelName:Ig,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const i=Cs(Be(kn(Te(e,"float32")),1));return qe(n,i)}}}},j1e={kernelName:If,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ft(e.shape,i.shape);return{a:()=>{let a=n;const l=Vi(e.shape,s);return l.length>0&&(a=We(a,l)),j(a,e.shape)},b:()=>{let a=n;const l=Vi(i.shape,s);return l.length>0&&(a=We(a,l)),j(a,i.shape)}}}},G1e={kernelName:ZD,saveAllInputs:!0,gradFunc:(n,t)=>{const e={};return t.forEach((i,s)=>{e[s]=()=>n.clone()}),e}},q1e={kernelName:ux,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ht(e)}}},K1e={kernelName:dx,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ht(e)}}},X1e={kernelName:Eg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,Cs(Be(ct(1),kn(Te(e,"float32")))))}}},Y1e={kernelName:kg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const i=Cs(ge(ct(1),kn(Te(e,"float32"))));return qe(n,i)}}}},Z1e={kernelName:Ng,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ft(e.shape,i.shape);return{a:()=>{const a=ge(kn(e),kn(i));let l=F(n,qe(i,a));const c=Vi(e.shape,s);return c.length>0&&(l=We(l,c)),j(l,e.shape)},b:()=>{const a=ge(kn(e),kn(i));let l=Hn(F(n,qe(e,a)));const c=Vi(i.shape,s);return c.length>0&&(l=We(l,c)),j(l,i.shape)}}}},Q1e={kernelName:Tg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,ge(kn(Te(e,"float32")),1))}}},J1e={kernelName:Dg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,Be(ct(1),kn(Te(e,"float32"))))}}},tSe=V({avgPool3dGrad_:function eSe(n,t,e,i,s,r){const o=N(n,"dy","avgPool3dGrad"),a=N(t,"input","avgPool3dGrad");let l=o,c=a,u=!1;4===a.rank&&(u=!0,l=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(5===l.rank,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(5===c.rank,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Fs("avgPool3dGrad",s,r);const f=$.runKernel(tN,{dy:l,input:c},{filterSize:e,strides:i,pad:s,dimRoundingMode:r});return u?j(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),nSe={kernelName:fx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{filterSize:s,strides:r,pad:o,dimRoundingMode:a}=e;return{x:()=>tSe(n,i,s,r,o,a)}}},sSe=V({avgPoolGrad_:function iSe(n,t,e,i,s){const r=N(n,"dy","avgPoolGrad"),o=N(t,"input","avgPoolGrad");T(o.rank===r.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${r.rank})`);let a=o,l=r,c=!1;3===o.rank&&(c=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=j(r,[1,r.shape[0],r.shape[1],r.shape[2]])),T(4===l.rank,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(4===a.rank,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const h=$.runKernel(eN,{dy:l,input:a},{filterSize:e,strides:i,pad:s});return c?j(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),rSe={kernelName:hx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{filterSize:s,strides:r,pad:o}=e;return{x:()=>sSe(n,i,s,r,o)}}},oSe={kernelName:px,inputsToSave:["a","b"],gradFunc:(n,t,e)=>{const[i,s]=t,{transposeA:r,transposeB:o}=e;return r||o?!r&&o?{a:()=>nn(n,s,!1,!1),b:()=>nn(n,i,!0,!1)}:r&&!o?{a:()=>nn(s,n,!1,!0),b:()=>nn(i,n,!1,!1)}:{a:()=>nn(s,n,!0,!0),b:()=>nn(n,i,!0,!0)}:{a:()=>nn(n,s,!1,!0),b:()=>nn(i,n,!0,!1)}}},kM=V({spaceToBatchND_:function aSe(n,t,e){const i=N(n,"x","spaceToBatchND");return T(i.rank>=1+t.length,()=>`input rank ${i.rank} should be > than [blockShape] ${t.length}`),T(e.length===t.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${t.length}`),T(i.shape.reduce((o,a,l)=>l>0&&l<=t.length?o&&(a+e[l-1][0]+e[l-1][1])%t[l-1]==0:o,!0),()=>`input spatial dimensions ${i.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${t.toString()}`),$.runKernel(iC,{x:i},{blockShape:t,paddings:e})}}),lSe={kernelName:mx,gradFunc:(n,t,e)=>{const{blockShape:i,crops:s}=e;return{x:()=>kM(n,i,s)}}},cSe={kernelName:"BroadcastTo",gradFunc:(n,t,e)=>{const s=e.inputShape,r=e.shape,o=Array.from(r);for(let l=s.length-1;l>=0;l--)if(s[l]===r[l])o[l]=1;else if(1!==s[l])throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${r}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>We(n,a,!0)}}},uSe={kernelName:Ag,gradFunc:n=>({x:()=>n.clone()})},dSe={kernelName:Mg,gradFunc:n=>({x:()=>Ht(n)})},hSe={kernelName:Pg,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{clipValueMin:s,clipValueMax:r}=e;return{x:()=>Ls(kl(ld(i,s),Bf(i,r)),n,Ht(n))}}},fSe={kernelName:gx,inputsToSave:["x"],gradFunc:UG.gradFunc},pSe={kernelName:bx,saveAllInputs:!0,gradFunc:(n,t,e)=>{const i=t.map(l=>l.shape),{axis:s}=e,r=Tt(s,t[0].shape)[0],o=i.map(l=>l[r]);return zr(n,o,r).map(l=>()=>l)}},mSe={kernelName:_x,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[i,s]=t,{dilations:r,strides:o,pad:a,dataFormat:l}=e;return T(Oc(r),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`),{x:()=>MA(i.shape,n,s,o,a,l),filter:()=>ZA(i,n,s.shape,o,a,l)}}},gSe={kernelName:yx,inputsToSave:["dy","filter"],gradFunc:(n,t,e)=>{const[i,s]=t,{strides:r,pad:o,dataFormat:a,dimRoundingMode:l}=e;return{dy:()=>ad(n,s,r,o,a,1,l),filter:()=>ZA(n,i,s.shape,r,o,a,l)}}},_Se=V({conv3DBackpropFilter_:function bSe(n,t,e,i,s){let r=n;4===n.rank&&(r=j(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let o=t;return 4===o.rank&&(o=j(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),T(5===r.rank,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${r.shape}.`),T(5===o.rank,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),T(5===e.length,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),T(r.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${r.shape[4]}) must match input depth in filter (${e[3]}.`),T(o.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${e[4]}).`),$.runKernel(oN,{x:r,dy:o},{strides:i,pad:s,filterShape:e})}}),ySe={kernelName:vx,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:i,strides:s,pad:r}=e;T(Oc(i),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const[o,a]=t;return{x:()=>zj(o.shape,n,a,s,r),filter:()=>_Se(o,n,a.shape,s,r)}}},WG=V({sin_:function vSe(n){const e={x:N(n,"x","sin","float32")};return $.runKernel(ab,e)}}),xSe={kernelName:Rg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(Hn(WG(Te(e,"float32"))),n)}}},HG=V({sinh_:function CSe(n){const e={x:N(n,"x","sinh")};return $.runKernel(lb,e)}}),wSe={kernelName:Og,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(HG(Te(e,"float32")),n)}}},jG=V({cumsum_:function SSe(n,t=0,e=!1,i=!1){const r={x:N(n,"x","cumsum")};return $.runKernel(xx,r,{axis:t,exclusive:e,reverse:i})}}),ISe={kernelName:xx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{axis:s,exclusive:r,reverse:o}=e;return{x:()=>{const a=ti([s],i.rank);let l=jG(n,s,r,!o);return null!=a&&(l=jt(l,a)),l}}}},ESe={kernelName:Cx,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:i,strides:s,pad:r,dimRoundingMode:o}=e,a=i??[1,1];T(Oc(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=t;return T(4===l.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(4===c.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(hs(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),Fs("depthwiseConv2d",r,o),{x:()=>tG(l.shape,n,c,s,r,a,o),filter:()=>eG(l,n,c.shape,s,r,a,o)}}},kSe={kernelName:wx,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[i,s]=t,r={x:i,filter:s,dy:n},o={x:i,filter:s,dy:n};return{x:()=>$.runKernel(pN,r,e),filter:()=>$.runKernel(mN,o,e)}}},TSe={kernelName:Lg,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t,i={dy:n,y:e};return{x:()=>$.runKernel(bN,i)}}},DSe={kernelName:$g,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,i=F(Br(Hn(kn(e))),2/Math.sqrt(Math.PI));return{x:()=>F(n,i)}}},NSe={kernelName:Bg,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(n,e)}}},ASe={kernelName:Ix,inputsToSave:["input"],gradFunc:(n,t)=>{const[e]=t;return{input:()=>j(n,e.shape)}}},MSe={kernelName:Vg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(n,Br(e))}}},PSe={kernelName:zg,gradFunc:n=>({x:()=>Ht(n)})},RSe={kernelName:Ug,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ft(e.shape,i.shape);return{a:()=>{const a=qe(n,Te(i,"float32")),l=Vi(e.shape,s);return l.length>0?j(We(a,l),e.shape):a},b:()=>{let a=F(n,Te(e,"float32"));const l=Vi(i.shape,s);l.length>0&&(a=j(We(a,l),i.shape));const c=kn(i);return Hn(qe(a,Te(c,"float32")))}}}},GG=V({rsqrt_:function OSe(n){const e={x:N(n,"x","rsqrt","float32")};return $.runKernel(rb,e)}}),FSe={kernelName:Ex,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,t,e)=>{const{varianceEpsilon:i}=e,[s,r,o,a]=t,l=a??ct(1),c=Vi(r.shape,s.shape),u=[];if(1===r.rank){for(let v=0;v<s.shape.length-1;++v)u.push(s.shape[v]);u.push(1)}const d=Be(s,r),h=F(n,l),f=GG(ge(o,ct(i))),p=F(F(F(f,f),f),ct(-.5));return{x:()=>j(F(F(n,1===r.rank?Xo(j(f,[1,1,1,r.shape[0]]),u):f),l),s.shape),mean:()=>{let v=F(F(f,ct(-1)),h);return 1===r.rank&&(v=We(v,c)),j(v,r.shape)},variance:()=>{let v=F(F(p,d),h);return 1===r.rank&&(v=We(v,c)),j(v,r.shape)},scale:()=>{const v=F(d,f);let x=F(n,v);return 1===r.rank&&(x=We(x,c)),j(x,r.shape)},offset:()=>{let v=n;return 1===r.rank&&(v=We(v,c)),j(v,r.shape)}}}},qG=V({unsortedSegmentSum_:function LSe(n,t,e){const i=N(n,"x","unsortedSegmentSum"),s=N(t,"segmentIds","unsortedSegmentSum","int32");return T(xf(e),()=>"numSegments must be of dtype int"),$.runKernel(lC,{x:i,segmentIds:s},{numSegments:e})}}),$Se={kernelName:kx,inputsToSave:["x","indices"],gradFunc:(n,t,e)=>{const[i,s]=t,{axis:r,batchDims:o}=e,a=Tt(r,i.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,a),g=p.length,m=h.slice(r,h.length).slice(1),b=m.length,_=KG(0,g),y=KG(g+1,g+1+b),v=XG([p,[f],m]),x=j(d,v),S=j(u,[f]),E=XG([[g],_,y]),k=jt(x,E);let D=qG(k,S,c.shape[a]);const M=Fc(E);return D=jt(D,M),D};if(1===o){const u=i.split(i.shape[0],0);return{x:()=>Nl(u.map((f,p)=>l(f,s.slice(p,1),n.slice(p,1))())).reshape(i.shape),indices:()=>s}}return{x:l(i,s,n),indices:()=>s}}};function KG(n,t){const e=[];for(let i=n;i<t;++i)e.push(i);return e}function XG(n){const t=[];for(let e=0;e<n.length;++e)for(let i=0;i<n[e].length;++i)t.push(n[e][i]);return t}const BSe={kernelName:Wg,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t;return{a:()=>Ht(e),b:()=>Ht(i)}}},VSe={kernelName:Hg,gradFunc:n=>({x:()=>Te(n,"float32")})},zSe={kernelName:jg,gradFunc:n=>({x:()=>Ht(n)})},USe={kernelName:Gg,gradFunc:n=>({x:()=>Ht(n)})},WSe={kernelName:qg,gradFunc:n=>({x:()=>Ht(n)})},HSe={kernelName:Dx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{alpha:s}=e,r=Vr(i,0);return{x:()=>Ls(r,n,F(n,s))}}},jSe={kernelName:Xg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,ge(e,1))}}},GSe={kernelName:Kg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,Te(e,"float32"))}}},qSe={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[i]=t,{axis:s}=e;return{logits:()=>{const o=Br(i);return Be(n,F(We(n,s,!0),o))}}}},XSe=V({localResponseNormalizationBackprop_:function KSe(n,t,e,i=5,s=1,r=1,o=.5){return $.runKernel(wN,{x:n,y:t,dy:e},{depthRadius:i,bias:s,alpha:r,beta:o})}}),YSe={kernelName:Ox,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[i,s]=t,{depthRadius:r,bias:o,alpha:a,beta:l}=e;return{x:()=>XSe(i,s,n,r,o,a,l)}}};function YG(n,t,e,i){return t.rank<e.rank&&(t=j(t,vi(t.shape,i))),n.rank<e.rank&&(n=j(n,vi(n.shape,i))),{x:()=>F(n,Te(Fa(e,t),n.dtype))}}const ZG={kernelName:Fx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const i=e,{reductionIndices:s}=i,r=t[0],l=YG(n,t[1],r,Tt(s,r.shape));return{x:()=>l.x()}}},ZSe={kernelName:Yg,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t;return{a:()=>F(n,Te(ld(e,i),"float32")),b:()=>F(n,Te(zC(e,i),"float32"))}}},JSe=V({maxPool3dGrad_:function QSe(n,t,e,i,s,r,o){const a=N(n,"dy","maxPool3dGrad"),l=N(t,"input","maxPool3dGrad"),c=N(e,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;4===l.rank&&(f=!0,u=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=j(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=j(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(5===u.rank,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(5===d.rank,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),T(5===h.rank,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Fs("maxPool3dGrad",r,o);const m=$.runKernel(IN,{dy:u,input:d,output:h},{filterSize:i,strides:s,pad:r,dimRoundingMode:o});return f?j(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),eIe={kernelName:$x,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[i,s]=t,{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=e;return{x:()=>JSe(n,i,s,r,o,a,l)}}},nIe=V({maxPoolGrad_:function tIe(n,t,e,i,s,r,o){const a=N(n,"dy","maxPoolGrad"),l=N(t,"input","maxPoolGrad"),c=N(e,"output","maxPoolGrad");return T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(4===a.rank,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(4===l.rank,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Fs("maxPoolGrad",r,o),$.runKernel(SN,{dy:a,input:l,output:c},{filterSize:i,strides:s,pad:r,dimRoundingMode:o})}}),iIe={kernelName:Lx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[i,s]=t,{filterSize:r,strides:o,pad:a}=e;return{x:()=>nIe(n,i,s,r,o,a)}}},sIe={kernelName:Bx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{axis:s}=e,r=Tt(s,i.shape),l=te(ts(i.shape,r)[1]);return{x:()=>{const u=i.shape.slice();r.forEach(f=>{u[f]=1});const d=j(n,u);return qe(F(d,Tl(i.shape,"float32")),l)}}}},rIe={kernelName:Vx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const i=e,{axis:s}=i,[r,o]=t,l=YG(n,o,r,Tt(s,r.shape));return{x:()=>l.x()}}},oIe={kernelName:Zg,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t;return{a:()=>F(n,Te(Bf(e,i),"float32")),b:()=>F(n,Te(Vr(e,i),"float32"))}}},aIe={kernelName:zx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const i=t[0],{paddings:s}=e,r=s.map(o=>o[0]);return{x:()=>_n(n,r,i.shape)}}},lIe={kernelName:Qg,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ft(e.shape,i.shape);return{a:()=>{const a=Vi(e.shape,s);return a.length>0?j(We(n,a),e.shape):n},b:()=>{const a=F(n,Hn(AC(qe(e,i)))),l=Vi(i.shape,s);return l.length>0?j(We(a,l),i.shape):a}}}},cIe={kernelName:Jg,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ft(e.shape,i.shape);return{a:()=>{const a=F(n,Te(i,"float32")),l=Vi(e.shape,s);return l.length>0?j(We(a,l),e.shape):a},b:()=>{const a=F(n,Te(e,"float32")),l=Vi(i.shape,s);return l.length>0?j(We(a,l),i.shape):a}}}},uIe={kernelName:Ux,gradFunc:n=>({x:()=>Hn(n)})},dIe={kernelName:jx,inputsToSave:["indices"],gradFunc:(n,t)=>{const e=t[0];return{indices:()=>ns(e.shape,"float32")}}},hIe={kernelName:Hx,gradFunc:n=>({x:()=>Ht(n)})},fIe={kernelName:Gx,saveAllInputs:!0,gradFunc:(n,t,e)=>{const{axis:i}=e;return ud(n,i).map(r=>()=>r)}},QG={kernelName:qx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const i=t[0],{paddings:s}=e,r=s.map(o=>o[0]);return{x:()=>_n(n,r,i.shape)}}},pIe={kernelName:eb,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,t)=>{const[e,i,s]=t,r=e,o=i,a=ft(r.shape,o.shape);return{a:()=>{const u=Te(o,"float32");let d=F(n,F(u,rd(r,Be(u,ct(1)))));const h=Vi(r.shape,a);return h.length>0&&(d=We(d,h)),j(d,r.shape)},b:()=>{const u=Vr(r,0),d=Ls(u,_o(r),Ht(r));let h=F(n,F(s,d));const f=Vi(o.shape,a);return f.length>0&&(h=We(h,f)),j(h,o.shape)}}}},mIe={kernelName:Kx,inputsToSave:["x","alpha"],gradFunc:(n,t)=>{const[e,i]=t,s=Vr(e,0);return{x:()=>Ls(s,n,F(n,i)),alpha:()=>{let r=Ls(s,Ht(n),F(n,e));const o=Vi(i.shape,n.shape);return o.length>0&&(r=We(r,o)),j(r,i.shape)}}}},TM=V({cumprod_:function gIe(n,t=0,e=!1,i=!1){const r={x:N(n,"x","cumprod")};return $.runKernel(lN,r,{axis:t,exclusive:e,reverse:i})}});const yIe={kernelName:Xx,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{axis:s}=e;let r=[];return r=null==s?i.shape.map((o,a)=>a):"number"==typeof s?[s]:s,{x:()=>function _Ie(n,t,e){const i=n.shape.length,s=i-e.length,r=ti(e,i);let o=n;null!=r&&(o=jt(n,r));const a=o.shape.slice(),c=a.splice(i-e.length,e.length).reduce((h,f)=>h*f,1);a.push(c);let d=function bIe(n,t,e){const i=n.shape.slice();i[e]=1;const s=j(t,i),r=TM(n,e,!0,!1),o=TM(n,e,!0,!0),a=F(r,o);return F(s,a)}(o.reshape(a),t,s);if(d=d.reshape(o.shape),null!=r){const h=Fc(r);d=jt(d,h)}return d}(i,n,r)}}},vIe={kernelName:Fg,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ft(e.shape,i.shape);return{a:()=>{const a=qe(n,Te(i,"float32")),l=Vi(e.shape,s);return l.length>0?j(We(a,l),e.shape):a},b:()=>{let a=F(n,Te(e,"float32"));const l=Vi(i.shape,s);l.length>0&&(a=j(We(a,l),i.shape));const c=kn(i);return Hn(qe(a,Te(c,"float32")))}}}},xIe={kernelName:tb,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,Hn(kn(e)))}}},CIe={kernelName:ib,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,i=F(Bf(e,6),Fb(e));return{x:()=>F(n,Te(i,"float32"))}}},wIe={kernelName:nb,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(n,Te(Fb(e),"float32"))}}},SIe={kernelName:Yx,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>j(n,e.shape)}}},IIe={kernelName:Qx,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[i]=t,s={dy:n,images:i};return{images:()=>$.runKernel(MN,s,e)}}},EIe={kernelName:Zx,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[i]=t,s={dy:n,images:i};return{images:()=>$.runKernel(AN,s,e)}}},kIe={kernelName:Jx,gradFunc:(n,t,e)=>{const{dims:i}=e,s=Tt(i,n.shape);return{x:()=>cd(n,s)}}},TIe={kernelName:sb,gradFunc:n=>({x:()=>Ht(n)})},DIe={kernelName:rb,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Hn(qe(n,F(rd(e,1.5),2)))}}},DM=V({logicalNot_:function NIe(n){const e={x:N(n,"x","logicalNot","bool")};return $.runKernel(Px,e)}}),AIe={kernelName:eC,inputsToSave:["condition"],gradFunc:(n,t)=>{const[e]=t;return{condition:()=>Te(Ht(e),"float32"),t:()=>F(n,Te(e,n.dtype)),e:()=>F(n,Te(DM(e),n.dtype))}}},MIe={kernelName:ob,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const i=Vr(e,ct(0)),s=ct(HC),r=ct(jC),o=F(n,r),a=F(F(n,s),Br(Te(e,"float32")));return Ls(i,o,a)}}}},PIe={kernelName:ub,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(n,F(e,Be(ct(1),e)))}}},RIe={kernelName:cb,gradFunc:n=>({x:()=>Ht(n)})},NM=V({cos_:function OIe(n){const e={x:N(n,"x","cos","float32")};return $.runKernel(Rg,e)}}),FIe={kernelName:ab,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(NM(Te(e,"float32")),n)}}},JG=V({cosh_:function LIe(n){const e={x:N(n,"x","cosh","float32")};return $.runKernel(Og,e)}}),$Ie={kernelName:lb,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(JG(Te(e,"float32")),n)}}},BIe={kernelName:tC,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{begin:s,size:r}=e,o=i.shape,[a,l]=kC(i,s,r),c=[];for(let u=0;u<n.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>VA(n,c)}}},VIe={kernelName:rC,outputsToSave:[!0],gradFunc:(n,t,e)=>{const[i]=t,{dim:s}=e,o=F(n,i);return{logits:()=>Be(o,F(We(o,[s],!0),i))}}},zIe={kernelName:db,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(n,Lf(e))}}},AM=V({batchToSpaceND_:function UIe(n,t,e){const i=N(n,"x","batchToSpaceND"),s=t.reduce((a,l)=>a*l);return T(i.rank>=1+t.length,()=>`input rank is ${i.rank} but should be > than blockShape.length ${t.length}`),T(e.length===t.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`),T(i.shape[0]%s==0,()=>`input tensor batch is ${i.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${s}`),$.runKernel(mx,{x:i},{blockShape:t,crops:e})}}),e6={kernelName:iC,gradFunc:(n,t,e)=>{const{blockShape:i,paddings:s}=e;return{x:()=>AM(n,i,s)}}},t6={kernelName:sC,gradFunc:(n,t,e)=>{const{axis:i}=e;return{x:()=>ws(n,i)}}},iEe=[UG,W1e,H1e,j1e,G1e,q1e,K1e,X1e,Y1e,Z1e,Q1e,J1e,nSe,rSe,oSe,lSe,cSe,uSe,dSe,hSe,fSe,pSe,gSe,mSe,ySe,xSe,wSe,ISe,ESe,kSe,vIe,TSe,DSe,NSe,ASe,MSe,RSe,PSe,FSe,$Se,BSe,VSe,zSe,USe,WSe,HSe,jSe,GSe,qSe,YSe,ZG,ZG,ZSe,eIe,iIe,sIe,rIe,oIe,aIe,lIe,cIe,uIe,dIe,hIe,fIe,QG,QG,pIe,mIe,yIe,xIe,CIe,wIe,SIe,IIe,EIe,kIe,TIe,DIe,AIe,MIe,PIe,RIe,FIe,$Ie,BIe,VIe,zIe,e6,e6,t6,t6,{kernelName:hb,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,F(Cs(Te(e,"float32")),2))}}},{kernelName:fb,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ct(2);return{a:()=>F(n,F(s,Be(e,i))),b:()=>F(n,F(s,Be(i,e)))}}},{kernelName:LN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(n,F(Te(e,"float32"),2))}}},{kernelName:_b,gradFunc:n=>({x:()=>Ht(n)})},{kernelName:pb,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,i]=t,s=ft(e.shape,i.shape);return{a:()=>{let a=n;const l=Vi(e.shape,s);return l.length>0&&(a=We(a,l)),j(a,e.shape)},b:()=>{let a=n;const l=Vi(i.shape,s);return l.length>0&&(a=We(a,l)),j(Hn(a),i.shape)}}}},{kernelName:nC,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,s=i.shape.slice(),{axis:r}=e;Tt(r,i.shape).forEach(c=>{s[c]=1});const a=j(n,s),l=F(a,Tl(i.shape,"float32"));return{x:()=>l}}},{kernelName:mb,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>qe(n,kn(NM(e)))}}},{kernelName:gb,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>F(Be(ct(1),kn(e)),n)}}},{kernelName:bb,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[i]=t,{reps:s}=e;return{x:()=>{let o=Ht(i);if(1===i.rank)for(let a=0;a<s[0];++a)o=ge(o,_n(n,[a*i.shape[0]],[i.shape[0]]));else if(2===i.rank)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)o=ge(o,_n(n,[a*i.shape[0],l*i.shape[1]],[i.shape[0],i.shape[1]]));else if(3===i.rank)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)o=ge(o,_n(n,[a*i.shape[0],l*i.shape[1],c*i.shape[2]],[i.shape[0],i.shape[1],i.shape[2]]));else{if(4!==i.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${i.rank} tensors yet.`);for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)for(let u=0;u<s[3];++u)o=ge(o,_n(n,[a*i.shape[0],l*i.shape[1],c*i.shape[2],u*i.shape[3]],[i.shape[0],i.shape[1],i.shape[2],i.shape[3]]))}return o}}}},{kernelName:Ef,gradFunc:(n,t,e)=>{const i=e,{perm:s}=i,r=Fc(s);return{x:()=>jt(n,r)}}},{kernelName:aC,gradFunc:(n,t,e)=>{const i=e,{axis:s}=i;return{value:()=>Nl(n,s)}}},{kernelName:lC,inputsToSave:["segmentIds"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>function tEe(n,t){const e=Pc(t,Ht(t)),i=PA(n,e);let s=ld(t,ct(0,"int32"));const r=i.rank-s.rank;for(let a=0;a<r;++a)s=sr(s,a+1);s=kl(s,Tl(i.shape,"bool"));const o=Ht(i);return Ls(s,i,o)}(n,e)}}},{kernelName:cC,gradFunc:n=>({x:()=>Ht(n)})}];for(const n of iEe)s0e(n);ne().prototype.abs=function(){return this.throwIfDisposed(),Ji(this)};const rEe=V({acos_:function sEe(n){const e={x:N(n,"x","acos")};return $.runKernel(Sg,e)}});ne().prototype.acos=function(){return this.throwIfDisposed(),rEe(this)};const aEe=V({acosh_:function oEe(n){const e={x:N(n,"x","acosh")};return $.runKernel(Ig,e)}});ne().prototype.acosh=function(){return this.throwIfDisposed(),aEe(this)},ne().prototype.add=function(n){return this.throwIfDisposed(),ge(this,n)},ne().prototype.all=function(n,t){return this.throwIfDisposed(),$j(this,n,t)},ne().prototype.any=function(n,t){return this.throwIfDisposed(),TA(this,n,t)},ne().prototype.argMax=function(n){return this.throwIfDisposed(),Ib(this,n)};const cEe=V({argMin_:function lEe(n,t=0){const i={x:N(n,"x","argMin")};return $.runKernel(dx,i,{axis:t})}});ne().prototype.argMin=function(n){return this.throwIfDisposed(),cEe(this,n)},ne().prototype.asScalar=function(){return this.throwIfDisposed(),T(1===this.size,()=>"The array must have only 1 element."),j(this,[])},ne().prototype.asType=function(n){return this.throwIfDisposed(),Te(this,n)},ne().prototype.as1D=function(){return this.throwIfDisposed(),j(this,[this.size])},ne().prototype.as2D=function(n,t){return this.throwIfDisposed(),j(this,[n,t])},ne().prototype.as3D=function(n,t,e){return this.throwIfDisposed(),j(this,[n,t,e])},ne().prototype.as4D=function(n,t,e,i){return this.throwIfDisposed(),j(this,[n,t,e,i])},ne().prototype.as5D=function(n,t,e,i,s){return this.throwIfDisposed(),j(this,[n,t,e,i,s])};const dEe=V({asin_:function uEe(n){const e={x:N(n,"x","asin")};return $.runKernel(Eg,e)}});ne().prototype.asin=function(){return this.throwIfDisposed(),dEe(this)};const fEe=V({asinh_:function hEe(n){const e={x:N(n,"x","asinh")};return $.runKernel(kg,e)}});ne().prototype.asinh=function(){return this.throwIfDisposed(),fEe(this)};const mEe=V({atan_:function pEe(n){const e={x:N(n,"x","atan")};return $.runKernel(Tg,e)}});ne().prototype.atan=function(){return this.throwIfDisposed(),mEe(this)};const bEe=V({atan2_:function gEe(n,t){let e=N(n,"a","atan2"),i=N(t,"b","atan2");return[e,i]=ci(e,i),$.runKernel(Ng,{a:e,b:i})}});ne().prototype.atan2=function(n){return this.throwIfDisposed(),bEe(this,n)};const yEe=V({atanh_:function _Ee(n){const e={x:N(n,"x","atanh")};return $.runKernel(Dg,e)}});ne().prototype.atanh=function(){return this.throwIfDisposed(),yEe(this)},ne().prototype.avgPool=function(n,t,e,i){return this.throwIfDisposed(),AA(this,n,t,e,i)},ne().prototype.batchToSpaceND=function(n,t){return this.throwIfDisposed(),AM(this,n,t)},ne().prototype.batchNorm=function(n,t,e,i,s){return this.throwIfDisposed(),TC(this,n,t,e,i,s)},ne().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Db(this,n)},ne().prototype.cast=function(n){return this.throwIfDisposed(),Te(this,n)};const xEe=V({ceil_:function vEe(n){const e={x:N(n,"x","ceil","float32")};return $.runKernel(Mg,e)}});ne().prototype.ceil=function(){return this.throwIfDisposed(),xEe(this)},ne().prototype.clipByValue=function(n,t){return this.throwIfDisposed(),$r(this,n,t)},ne().prototype.concat=function(n,t){return this.throwIfDisposed(),n instanceof Bi&&(n=[n]),ws([this,...n],t)},ne().prototype.conv1d=function(n,t,e,i,s,r){return this.throwIfDisposed(),Bj(this,n,t,e,i,s,r)},ne().prototype.conv2dTranspose=function(n,t,e,i,s){return this.throwIfDisposed(),Vj(this,n,t,e,i,s)},ne().prototype.conv2d=function(n,t,e,i,s,r){return this.throwIfDisposed(),ad(this,n,t,e,i,s,r)},ne().prototype.cos=function(){return this.throwIfDisposed(),NM(this)},ne().prototype.cosh=function(){return this.throwIfDisposed(),JG(this)},ne().prototype.cumprod=function(n,t,e){return this.throwIfDisposed(),TM(this,n,t,e)},ne().prototype.cumsum=function(n,t,e){return this.throwIfDisposed(),jG(this,n,t,e)};const wEe=V({depthToSpace_:function CEe(n,t,e="NHWC"){const i=N(n,"x","depthToSpace","float32"),s="NHWC"===e?i.shape[1]:i.shape[2],r="NHWC"===e?i.shape[2]:i.shape[3],o="NHWC"===e?i.shape[3]:i.shape[1];return T(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),T(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${t}  for depthToSpace with input shape\n    ${i.shape}`),T(r*t>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${r} and ${t} for depthToSpace with input shape\n        ${i.shape}`),T(o%(t*t)==0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${i.shape}`),$.runKernel(dN,{x:i},{blockSize:t,dataFormat:e})}});ne().prototype.depthToSpace=function(n,t){return this.throwIfDisposed(),wEe(this,n,t)},ne().prototype.depthwiseConv2d=function(n,t,e,i,s,r){return this.throwIfDisposed(),DC(this,n,t,e,i,s,r)};const IEe=V({dilation2d_:function SEe(n,t,e,i,s=[1,1],r="NHWC"){const o=N(n,"x","dilation2d"),a=N(t,"filter","dilation2d");T(3===o.rank||4===o.rank,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),T(3===a.rank,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T("NHWC"===r,()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${r}`);let l=o,c=!1;3===o.rank&&(l=j(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const h=$.runKernel(wx,{x:l,filter:a},{strides:e,pad:i,dilations:s});return c?j(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});ne().prototype.dilation2d=function(n,t,e,i,s){return this.throwIfDisposed(),IEe(this,n,t,e,i,s)};const kEe=V({divNoNan_:function EEe(n,t){let e=N(n,"a","div"),i=N(t,"b","div");[e,i]=ci(e,i);const s=qe(e,i),r=Ht(s),o=Fa(i,r);return Ls(o,r,s)}});ne().prototype.divNoNan=function(n){return this.throwIfDisposed(),kEe(this,n)},ne().prototype.div=function(n){return this.throwIfDisposed(),qe(this,n)};const DEe=V({dot_:function TEe(n,t){const e=N(n,"t1","dot"),i=N(t,"t2","dot");T(!(1!==e.rank&&2!==e.rank||1!==i.rank&&2!==i.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${i.rank}.`);const s=1===e.rank?e.size:e.shape[1],r=1===i.rank?i.size:i.shape[0];if(T(s===r,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${r}.`),1===e.rank&&1===i.rank){const o=j(e,[1,-1]),a=j(i,[-1,1]),l=nn(o,a);return j(l,[])}if(1===e.rank&&2===i.rank){const o=j(e,[1,-1]),a=j(i,[i.shape[0],i.shape[1]]),l=nn(o,a);return j(l,[l.size])}if(2===e.rank&&1===i.rank){const o=j(i,[-1,1]),a=nn(e,o);return j(a,[a.size])}{const o=j(i,[i.shape[0],i.shape[1]]);return nn(e,o)}}});ne().prototype.dot=function(n){return this.throwIfDisposed(),DEe(this,n)},ne().prototype.elu=function(){return this.throwIfDisposed(),NC(this)},ne().prototype.equal=function(n){return this.throwIfDisposed(),Fa(this,n)},ne().prototype.erf=function(){return this.throwIfDisposed(),Wj(this)};const AEe=V({euclideanNorm_:function NEe(n,t=null,e=!1){return UC(n,"euclidean",t,e)}});ne().prototype.euclideanNorm=function(n,t){return this.throwIfDisposed(),AEe(this,n,t)},ne().prototype.exp=function(){return this.throwIfDisposed(),Br(this)},ne().prototype.expandDims=function(n){return this.throwIfDisposed(),sr(this,n)};const PEe=V({expm1_:function MEe(n){const e={x:N(n,"x","expm1")};return $.runKernel(Vg,e)}});ne().prototype.expm1=function(){return this.throwIfDisposed(),PEe(this)},ne().prototype.fft=function(){return this.throwIfDisposed(),XA(this)},ne().prototype.flatten=function(){return this.throwIfDisposed(),j(this,[this.size])},ne().prototype.floor=function(){return this.throwIfDisposed(),AC(this)},ne().prototype.floorDiv=function(n){return this.throwIfDisposed(),pj(this,n)},ne().prototype.gather=function(n,t,e){return this.throwIfDisposed(),PA(this,n,t,e)},ne().prototype.greaterEqual=function(n){return this.throwIfDisposed(),ld(this,n)},ne().prototype.greater=function(n){return this.throwIfDisposed(),Vr(this,n)},ne().prototype.ifft=function(){return this.throwIfDisposed(),FC(this)},ne().prototype.irfft=function(){return this.throwIfDisposed(),Qj(this)};const OEe=V({isFinite_:function REe(n){const e={x:N(n,"x","isFinite")};return $.runKernel(jg,e)}});ne().prototype.isFinite=function(){return this.throwIfDisposed(),OEe(this)};const LEe=V({isInf_:function FEe(n){const e={x:N(n,"x","isInf")};return $.runKernel(Gg,e)}});ne().prototype.isInf=function(){return this.throwIfDisposed(),LEe(this)};const BEe=V({isNaN_:function $Ee(n){const e={x:N(n,"x","isNaN")};return $.runKernel(qg,e)}});ne().prototype.isNaN=function(){return this.throwIfDisposed(),BEe(this)},ne().prototype.leakyRelu=function(n){return this.throwIfDisposed(),RA(this,n)},ne().prototype.lessEqual=function(n){return this.throwIfDisposed(),Bf(this,n)},ne().prototype.less=function(n){return this.throwIfDisposed(),zC(this,n)};const zEe=V({localResponseNormalization_:function VEe(n,t=5,e=1,i=1,s=.5){const r=N(n,"x","localResponseNormalization");T(4===r.rank||3===r.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${r.rank}.`),T(xf(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=r,a=!1;3===r.rank&&(a=!0,o=j(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const u=$.runKernel(Ox,{x:o},{depthRadius:t,bias:e,alpha:i,beta:s});return a?j(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});ne().prototype.localResponseNormalization=function(n,t,e,i){return this.throwIfDisposed(),zEe(this,n,t,e,i)};const WEe=V({logSigmoid_:function UEe(n){const t=N(n,"x","logSigmoid");return Sl(i=>({value:Hn(Pb(Hn(i))),gradFunc:o=>F(o,Lf(Hn(i)))}))(t)}});ne().prototype.logSigmoid=function(){return this.throwIfDisposed(),WEe(this)},ne().prototype.logSoftmax=function(n){return this.throwIfDisposed(),jj(this,n)},ne().prototype.logSumExp=function(n,t){return this.throwIfDisposed(),LA(this,n,t)},ne().prototype.log=function(){return this.throwIfDisposed(),_o(this)},ne().prototype.log1p=function(){return this.throwIfDisposed(),OA(this)},ne().prototype.logicalAnd=function(n){return this.throwIfDisposed(),kl(this,n)},ne().prototype.logicalNot=function(){return this.throwIfDisposed(),DM(this)};const n6=V({logicalOr_:function HEe(n,t){const e=N(n,"a","logicalOr","bool"),i=N(t,"b","logicalOr","bool");return ft(e.shape,i.shape),$.runKernel(Rx,{a:e,b:i})}});ne().prototype.logicalOr=function(n){return this.throwIfDisposed(),n6(this,n)};const GEe=V({logicalXor_:function jEe(n,t){const e=N(n,"a","logicalXor","bool"),i=N(t,"b","logicalXor","bool");return ft(e.shape,i.shape),kl(n6(n,t),DM(kl(n,t)))}});ne().prototype.logicalXor=function(n){return this.throwIfDisposed(),GEe(this,n)},ne().prototype.matMul=function(n,t,e){return this.throwIfDisposed(),nn(this,n,t,e)},ne().prototype.maxPool=function(n,t,e,i){return this.throwIfDisposed(),$A(this,n,t,e,i)},ne().prototype.max=function(n,t){return this.throwIfDisposed(),Yo(this,n,t)},ne().prototype.maximum=function(n){return this.throwIfDisposed(),Pc(this,n)},ne().prototype.mean=function(n,t){return this.throwIfDisposed(),Ci(this,n,t)},ne().prototype.min=function(n,t){return this.throwIfDisposed(),MC(this,n,t)},ne().prototype.minimum=function(n){return this.throwIfDisposed(),Ff(this,n)};const KEe=V({mirrorPad_:function qEe(n,t,e){T("reflect"===e||"symmetric"===e,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);const i=N(n,"x","mirrorPad");if(0===i.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(t.length===i.rank,()=>`Padding doesn't match input. Must be ${i.rank}. Got ${t.length}.`);const s="reflect"===e?1:0;for(let a=0;a<i.rank;a++)T(2===t[a].length,()=>"Invalid number of paddings. Must be length of 2 each."),T(t[a][0]>=0&&t[a][0]<=i.shape[a]-s&&t[a][1]>=0&&t[a][1]<=i.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${i.shape[a]-s} or less than 0 for input of shape ${i.shape}`);return $.runKernel(zx,{x:i},{paddings:t,mode:e})}});ne().prototype.mirrorPad=function(n,t){return this.throwIfDisposed(),KEe(this,n,t)};const YEe=V({mod_:function XEe(n,t){let e=N(n,"a","mod"),i=N(t,"b","mod");return[e,i]=ci(e,i),$.runKernel(Qg,{a:e,b:i})}});ne().prototype.mod=function(n){return this.throwIfDisposed(),YEe(this,n)},ne().prototype.mul=function(n){return this.throwIfDisposed(),F(this,n)},ne().prototype.neg=function(){return this.throwIfDisposed(),Hn(this)},ne().prototype.norm=function(n,t,e){return this.throwIfDisposed(),UC(this,n,t,e)},ne().prototype.notEqual=function(n){return this.throwIfDisposed(),Nb(this,n)},ne().prototype.oneHot=function(n,t=1,e=0){return this.throwIfDisposed(),qj(this,n,t,e)},ne().prototype.onesLike=function(){return this.throwIfDisposed(),yo(this)},ne().prototype.pad=function(n,t){return this.throwIfDisposed(),VA(this,n,t)};const eke=V({pool_:function ZEe(n,t,e,i,s,r,o){null==s&&(s=[1,1]),null==r&&(r=1),0===i&&(i="valid");const a=N(n,"x","maxPool");let l=a,c=!1;3===a.rank&&(c=!0,l=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(hs(r,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`);const u=bo(l.shape,t,r,s,i),d=[u.dilationHeight,u.dilationWidth];let h;h="same"===i?function JEe(n,t){const i=n.map((o,a)=>o+(o-1)*(t[a]-1)).map(o=>o-1),s=i.map(o=>Math.floor(o/2)),r=i.map((o,a)=>o-s[a]);return i.map((o,a)=>[s[a],r[a]])}([u.filterHeight,u.filterWidth],d):[[0,0],[0,0]];const f=1===d[0]&&1===d[1],[p,g]=function QEe(n,t,e){const i=e.map(u=>u[0]),s=e.map(u=>u[1]),r=n.concat(i,s),o=t.map((u,d)=>(u-r[d]%u)%u),a=s.map((u,d)=>u+o[d]),l=t.map((u,d)=>[i[d],a[d]]),c=t.map((u,d)=>[0,o[d]]);return[l,c]}([u.inHeight,u.inWidth],d,h),m=f?i:"valid",b=f?l:kM(l,d,p),y=("avg"===e?()=>AA(b,t,r,m,o):()=>$A(b,t,r,m,o))(),v=f?y:AM(y,d,g);return c?j(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});ne().prototype.pool=function(n,t,e,i,s,r){return this.throwIfDisposed(),eke(this,n,t,e,i,s,r)},ne().prototype.pow=function(n){return this.throwIfDisposed(),rd(this,n)},ne().prototype.prelu=function(n){return this.throwIfDisposed(),zA(this,n)};const nke=V({prod_:function tke(n,t=null,e=!1){let i=N(n,"x","prod");return"bool"===i.dtype&&(i=Te(i,"int32")),$.runKernel(Xx,{x:i},{axis:t,keepDims:e})}});ne().prototype.prod=function(n,t){return this.throwIfDisposed(),nke(this,n,t)};const ske=V({reciprocal_:function ike(n){const e={x:N(n,"x","reciprocal")};return $.runKernel(tb,e)}});ne().prototype.reciprocal=function(){return this.throwIfDisposed(),ske(this)},ne().prototype.relu=function(){return this.throwIfDisposed(),Dl(this)},ne().prototype.relu6=function(){return this.throwIfDisposed(),Jj(this)},ne().prototype.reshapeAs=function(n){return this.throwIfDisposed(),j(this,n.shape)},ne().prototype.reshape=function(n){return this.throwIfDisposed(),j(this,n)},ne().prototype.resizeBilinear=function(n,t,e){return this.throwIfDisposed(),aG(this,n,t,e)},ne().prototype.resizeNearestNeighbor=function(n,t,e){return this.throwIfDisposed(),lG(this,n,t,e)},ne().prototype.reverse=function(n){return this.throwIfDisposed(),cd(this,n)},ne().prototype.rfft=function(){return this.throwIfDisposed(),YA(this)},ne().prototype.round=function(){return this.throwIfDisposed(),cG(this)},ne().prototype.rsqrt=function(){return this.throwIfDisposed(),GG(this)},ne().prototype.selu=function(){return this.throwIfDisposed(),Kj(this)},ne().prototype.separableConv2d=function(n,t,e,i,s,r){return this.throwIfDisposed(),Xj(this,n,t,e,i,s,r)},ne().prototype.sigmoid=function(){return this.throwIfDisposed(),Lf(this)};const oke=V({sign_:function rke(n){const e={x:N(n,"x","sign")};return $.runKernel(cb,e)}});ne().prototype.sign=function(){return this.throwIfDisposed(),oke(this)},ne().prototype.sin=function(){return this.throwIfDisposed(),WG(this)},ne().prototype.sinh=function(){return this.throwIfDisposed(),HG(this)},ne().prototype.slice=function(n,t){return this.throwIfDisposed(),_n(this,n,t)},ne().prototype.softmax=function(n){return this.throwIfDisposed(),qA(this,n)},ne().prototype.softplus=function(){return this.throwIfDisposed(),Pb(this)},ne().prototype.spaceToBatchND=function(n,t){return this.throwIfDisposed(),kM(this,n,t)},ne().prototype.split=function(n,t){return this.throwIfDisposed(),zr(this,n,t)},ne().prototype.sqrt=function(){return this.throwIfDisposed(),Cs(this)},ne().prototype.square=function(){return this.throwIfDisposed(),kn(this)},ne().prototype.squaredDifference=function(n){return this.throwIfDisposed(),hG(this,n)},ne().prototype.squeeze=function(n){return this.throwIfDisposed(),Rb(this,n)},ne().prototype.stack=function(n,t){this.throwIfDisposed();const e=n instanceof Bi?[this,n]:[this,...n];return Nl(e,t)},ne().prototype.step=function(n){return this.throwIfDisposed(),Fb(this,n)};const lke=V({stridedSlice_:function ake(n,t,e,i,s=0,r=0,o=0,a=0,l=0){const u={x:N(n,"x","stridedSlice","string_or_numeric")};return $.runKernel($N,u,{begin:t,end:e,strides:i,beginMask:s,endMask:r,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l})}});ne().prototype.stridedSlice=function(n,t,e,i,s,r,o,a){return this.throwIfDisposed(),lke(this,n,t,e,i,s,r,o,a)},ne().prototype.sub=function(n){return this.throwIfDisposed(),Be(this,n)},ne().prototype.sum=function(n,t){return this.throwIfDisposed(),We(this,n,t)};const uke=V({tan_:function cke(n){const e={x:N(n,"x","tan","float32")};return $.runKernel(mb,e)}});ne().prototype.tan=function(){return this.throwIfDisposed(),uke(this)},ne().prototype.tanh=function(){return this.throwIfDisposed(),RC(this)},ne().prototype.tile=function(n){return this.throwIfDisposed(),Xo(this,n)},ne().prototype.toBool=function(){return this.throwIfDisposed(),Te(this,"bool")},ne().prototype.toFloat=function(){return this.throwIfDisposed(),Te(this,"float32")},ne().prototype.toInt=function(){return this.throwIfDisposed(),Te(this,"int32")};const hke=V({topk_:function dke(n,t=1,e=!0){const i=N(n,"x","topk");if(0===i.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=i.shape[i.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${t}`);const r={x:i},o={k:t,sorted:e},[a,l]=$.runKernel(UN,r,o);return{values:a,indices:l}}});ne().prototype.topk=function(n,t){return this.throwIfDisposed(),hke(this,n,t)},ne().prototype.transpose=function(n){return this.throwIfDisposed(),jt(this,n)};const pke=V({unique_:function fke(n,t=0){const e=N(n,"x","unique","string_or_numeric");T(e.rank>0,()=>"The input tensor must be at least 1D");const i={x:e},s={axis:t},[r,o]=$.runKernel(HN,i,s);return{values:r,indices:o}}});ne().prototype.unique=function(n){return this.throwIfDisposed(),pke(this,n)},ne().prototype.unsortedSegmentSum=function(n,t){return this.throwIfDisposed(),qG(this,n,t)},ne().prototype.unstack=function(n){return this.throwIfDisposed(),ud(this,n)},ne().prototype.where=function(n,t){return this.throwIfDisposed(),Ls(n,this,t)},ne().prototype.zerosLike=function(){return this.throwIfDisposed(),Ht(this)};class $a extends Error{constructor(t){super(t),Object.setPrototypeOf(this,$a.prototype)}}class xo extends Error{constructor(t){super(t),Object.setPrototypeOf(this,xo.prototype)}}class L extends Error{constructor(t){super(t),Object.setPrototypeOf(this,L.prototype)}}class _t extends Error{constructor(t){super(t),Object.setPrototypeOf(this,_t.prototype)}}class MM extends Error{constructor(t){super(t),Object.setPrototypeOf(this,MM.prototype)}}class i6 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,i6.prototype)}}class s6{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const i=this.cache.keys().next().value;this.cache.delete(i)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const i=this.cache.keys().next().value;this.cache.delete(i)}this.maxEntries=t}}function hd(n,t){if(Array.isArray(n)){let e=[];for(let i=0;i<t;i++)e=e.concat(n);return e}{const e=new Array(t);return e.fill(n),e}}function Ur(n,t){if(!n)throw new MM(t)}function r6(n,t){let e=0;for(const i of n)i===t&&e++;return e}function or(n){return 1===n.length?n[0]:n}function cn(n){return Array.isArray(n)?n:[n]}function Ol(n){const e=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function fd(n){return n.length<=1||-1===n.indexOf("_")?n:n.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let Co={};function PM(n){if(null==n)return null;const t={};return t.className=n.getClassName(),t.config=n.getConfig(),t}function RM(n){if(null!=n&&"object"==typeof n)if(Array.isArray(n))n.forEach(t=>RM(t));else{const t=Object.keys(n);for(const e of t){const i=n[e];null!=i&&"object"==typeof i&&(Array.isArray(i)||"ndarray"!==i.type||"number"!=typeof i.value?RM(i):n[e]=i.value)}}}function zb(n,t={},e={},i="object",s=!1){if("string"==typeof n){let o;if(n in e)o=e[n];else if(n in Co)o=Co[n];else if(o=t[n],null==o)throw new L(`Unknown ${i}: ${n}. This may be due to one of the following reasons:\n1. The ${i} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${i} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}{const r=n;if(null==r.className||null==r.config)throw new L(`${i}: Improper config format: ${JSON.stringify(r)}.\n'className' and 'config' must set.`);const o=r.className;let a,l;if(o in e?[a,l]=e[o]:o in Co?[a,l]=Co.className:o in t&&([a,l]=t[o]),null==a)throw new L(`Unknown ${i}: ${o}. This may be due to one of the following reasons:\n1. The ${i} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${i} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=l){const c={};for(const f of Object.keys(Co))c[f]=Co[f];for(const f of Object.keys(e))c[f]=e[f];r.config.customObjects=c;const d=Object.assign({},Co);for(const f of Object.keys(e))Co[f]=e[f];RM(r.config);const h=l(a,r.config,e,s);return Co=Object.assign({},d),h}{const c=Object.assign({},Co);for(const d of Object.keys(e))Co[d]=e[d];const u=new a(r.config);return Co=Object.assign({},c),u}}}function GC(n,t){return-1*function mke(n,t){return n<t?-1:n>t?1:0}(n,t)}function Lc(n){if(null==n)return n;const t=[];for(const e of n)-1===t.indexOf(e)&&t.push(e);return t}function gke(n){if(null==n)throw new L(`Invalid value in obj: ${JSON.stringify(n)}`);for(const t in n)if(n.hasOwnProperty(t))return!1;return!0}function pd(n,t,e){if(null!=e&&n.indexOf(e)<0)throw new L(`${e} is not a valid ${t}.  Valid values are ${n} or null/undefined.`)}function OM(n,t,e=0,i=1/0){return Ur(e>=0),Ur(i>=e),Array.isArray(n)&&n.length>=e&&n.length<=i&&n.every(s=>typeof s===t)}function is(n,t){Array.isArray(n)?(T(n.length>0,()=>`${t} is unexpectedly an empty array.`),n.forEach((e,i)=>is(e,`element ${i+1} of ${t}`))):T(Number.isInteger(n)&&n>0,()=>`Expected ${t} to be a positive integer, but got ${o6(n)}.`)}function o6(n){return null===n?"null":Array.isArray(n)?"["+n.map(t=>o6(t)).join(",")+"]":"string"==typeof n?`"${n}"`:`${n}`}function a6(n){return"relu"===n?"relu":"linear"===n?"linear":"elu"===n?"elu":null}let _ke=0;function l6(){return _ke++}const qC={};function KC(n=""){return n in qC||(qC[n]=0),qC[n]+=1,n+qC[n].toString()}const yke=["channelsFirst","channelsLast"],vke=["nearest","bilinear"],xke=["valid","same","causal"],Cke=["max","avg"],wke=["sum","mul","concat","ave"],zf=new Map;function wi(n){pd(yke,"DataFormat",n)}function Wr(n){pd(xke,"PaddingMode",n)}function c6(n){pd(Cke,"PoolMode",n)}const Ub=[],u6="/";function md(n,t){Ub.push(n);try{const e=t();return Ub.pop(),e}catch(e){throw Ub.pop(),e}}function d6(n){if(!f6(n))throw new Error("Not a valid tensor name: '"+n+"'");return function Ike(){return 0===Ub.length?"":Ub.join(u6)+u6}()+n}function h6(n){if(!f6(n))throw new Error("Not a valid tensor name: '"+n+"'");zf.has(n)||zf.set(n,0);const t=zf.get(n);if(zf.set(n,zf.get(n)+1),t>0){const e=`${n}_${t}`;return zf.set(e,1),e}return n}const Eke=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function f6(n){return!!n.match(Eke)}function kke(n){return n===parseInt(n.toString(),10)}function $c(n,t,e){null==t&&(t=0),null==e&&(e=n.length);let i=1;for(let s=t;s<e;++s)i*=n[s];return i}function Uf(n){if(0===n.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let e=0;e<n.length;e++){const i=n[e];i<t&&(t=i)}return t}function Bc(n){if(0===n.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let e=0;e<n.length;e++){const i=n[e];i>t&&(t=i)}return t}function Zo(n,t){if(t<n)throw new L(`end (${t}) < begin (${n}) is forbidden.`);const e=[];for(let i=n;i<t;++i)e.push(i);return e}let XC;function zi(){return null==XC&&(XC=function ZH(){return $.backend}().epsilon()),XC}function Ba(n,t){return Te(n,t)}function Wb(n,t=-1){const e=n.shape.slice();return t<0&&(t=e.length+t+1),e.splice(t,0,1),j(n,e)}function gd(n,t,e){return Y(()=>{switch(n.rank){case 1:return jA(n,t,e);case 2:return Yj(n,[t,0],[e,n.shape[1]]);case 3:return GA(n,[t,0,0],[e,n.shape[1],n.shape[2]]);case 4:return PC(n,[t,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3]]);case 5:return _n(n,[t,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return _n(n,[t,0,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new L(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function FM(n,t,e){return Y(()=>{switch(n.rank){case 1:return jA(n,t,e);case 2:return Yj(n,[0,t],[n.shape[0],e]);case 3:return GA(n,[0,0,t],[n.shape[0],n.shape[1],e]);case 4:return PC(n,[0,0,0,t],[n.shape[0],n.shape[1],n.shape[2],e]);default:throw new L(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function YC(n,t,e,i){return Y(()=>{switch(n.rank){case 1:return jA(n,t,e);case 2:switch(i){case 1:return gd(n,t,e);case 2:return FM(n,t,e);default:throw new L(`The axis is not within the rank of the tensor ${i}`)}case 3:switch(i){case 1:return gd(n,t,e);case 2:return GA(n,[0,t,0],[n.shape[0],e,n.shape[2]]);case 3:return FM(n,t,e);default:throw new L(`The axis is not within the rank of the tensor ${i}`)}case 4:switch(i){case 1:return gd(n,t,e);case 2:return PC(n,[0,t,0,0],[n.shape[0],e,n.shape[2],n.shape[3]]);case 3:return PC(n,[0,0,t,0],[n.shape[0],n.shape[1],e,n.shape[3]]);case 4:return FM(n,t,e);default:throw new L(`The axis is not within the rank of the tensor ${i}`)}default:throw new L(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function LM(n,t=-1){let e;return t<0&&(e=n[0].rank,t=0!==e?e:0),t===n[0].rank&&(t=-1),ws(n,t)}function m6(n,t){switch(n.rank){case 1:return dxe([n,t]);case 2:return fxe([n,t],0);case 3:return mxe([n,t],0);case 4:return bxe([n,t],0);default:throw new L(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function $M(n,t){if(Array.isArray(t)||(t=[t]),n.rank!==t.length)throw new L(`The length of input n (${t.length}) does not match the number of dimensions in input x (${n.rank})`);return Xo(n,t)}function ZC(n,t=0,e=1,i,s){return fCe(n,t,e,i,s)}function Va(n,t,e,i){if(n.rank<2||t.rank<2)throw new _t(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${t.shape}`);if(t.rank>=3&&n.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new _t(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${t.shape}`);if(2===n.rank&&2===t.rank)return nG({a:n,b:t,transposeA:!1,transposeB:!1,bias:i?BM(n.rank,i,"channelsLast"):null,activation:e});{const s=n.shape.slice(),r=s.pop();n=j(n,[-1,r]);const o=t.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:t.rank},(p,g)=>0===g?t.rank-2:g<=t.rank-2?g-1:g);t=j(jt(t,u),[l,-1]);const d=[...s,...c];return j(nG({a:n,b:t,transposeA:!1,transposeB:!1,bias:i?BM(n.rank,i,"channelsLast"):null,activation:e}),d)}}function g6(n,t,e){return Y(()=>(t=Array.isArray(t)?rr(t,"int32"):Te(t,"int32"),PA(n,t,e)))}function Hb(n){return F(n,n)}function BM(n,t,e){const i=t.shape;if(1!==t.rank&&t.rank!==n)throw new L(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${n}`);if(5===n){if("channelsFirst"===e)return j(t,1===i.length?[1,i[0],1,1,1]:[1,i[3],i[0],i[1],i[2]]);if("channelsLast"===e)return j(t,1===i.length?[1,1,1,1,i[0]]:[1].concat(i))}else if(4===n){if("channelsFirst"===e)return j(t,1===i.length?[1,i[0],1,1]:[1,i[2],i[0],i[1]]);if("channelsLast"===e)return j(t,1===i.length?[1,1,1,i[0]]:[1].concat(i))}else if(3===n){if("channelsFirst"===e)return j(t,1===i.length?[1,i[0],1]:[1,i[1],i[0]]);if("channelsLast"===e)return j(t,1===i.length?[1,1,i[0]]:[1].concat(i))}else if(n<3)return t;throw new L(`Unsupported input rank by biasAdd: ${t.rank}`)}function Jo(n,t,e){return Y(()=>(null==e&&(e="channelsLast"),wi(e),ge(n,BM(n.rank,t,e))))}function b6(n,t,e,i){return Y(()=>VCe(n,t,e,i))}function jb(n,t,e=!1){return e?n():t()}const Fke=["fanIn","fanOut","fanAvg"],Lke=["normal","uniform","truncatedNormal"];class wo extends Pf{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}pe((()=>{class n extends wo{apply(e,i){return ns(e,i)}}return n.className="Zeros",n})());let _6=(()=>{class n extends wo{apply(e,i){return Tl(e,i)}}return n.className="Ones",n})();pe(_6),pe((()=>{class n extends wo{constructor(e){if(super(),"object"!=typeof e)throw new L(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new L(`config must have value set but got ${e}`);this.value=e.value}apply(e,i){return Y(()=>F(ct(this.value),Tl(e,i)))}getConfig(){return{value:this.value}}}return n.className="Constant",n})()),pe((()=>{class n extends wo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,i){return Ab(e,this.minval,this.maxval,i,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}return n.className="RandomUniform",n})()),pe((()=>{class n extends wo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,i){if("float32"!==(i=i||"float32")&&"int32"!==i)throw new _t(`randomNormal does not support dType ${i}.`);return ZC(e,this.mean,this.stddev,i,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="RandomNormal",n})()),pe((()=>{class n extends wo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,i){if("float32"!==(i=i||"float32")&&"int32"!==i)throw new _t(`truncatedNormal does not support dType ${i}.`);return Zj(e,this.mean,this.stddev,i,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="TruncatedNormal",n})()),pe((()=>{class n extends wo{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,i){return Y(()=>{if(2!==e.length||e[0]!==e[1])throw new L("Identity matrix initializer can only be used for 2D square matrices.");return F(this.gain,Hj(e[0]))})}getConfig(){return{gain:this.gain}}}return n.className="Identity",n})());let Hr=(()=>{class n extends wo{constructor(e){if(super(),e.scale<0)throw new L(`scale must be a positive float. Got: ${e.scale}`);this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,function $ke(n){pd(Fke,"FanMode",n)}(this.mode),this.distribution=null==e.distribution?"normal":e.distribution,function Bke(n){pd(Lke,"Distribution",n)}(this.distribution),this.seed=e.seed}apply(e,i){const s=function Vke(n,t="channelsLast"){let e,i;if(wi(t),2===n.length)e=n[0],i=n[1];else if(-1!==[3,4,5].indexOf(n.length)){if("channelsFirst"===t){const s=$c(n,2);e=n[1]*s,i=n[0]*s}else if("channelsLast"===t){const s=$c(n,0,n.length-2);e=n[n.length-2]*s,i=n[n.length-1]*s}}else{const s=$c(n);e=Math.sqrt(s),i=Math.sqrt(s)}return[e,i]}(e),r=s[0],o=s[1];let a=this.scale;if(a/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,o):Math.max(1,(r+o)/2),"normal"===this.distribution){const l=Math.sqrt(a);if("float32"!==(i=i||"float32")&&"int32"!==i)throw new _t(`${this.getClassName()} does not support dType ${i}.`);return Zj(e,0,l,i,this.seed)}{const l=Math.sqrt(3*a);return Ab(e,-l,l,i,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}return n.className="VarianceScaling",n})();pe(Hr);let y6=(()=>{class n extends Hr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return Hr.className}}return n.className="GlorotUniform",n})();pe(y6);let v6=(()=>{class n extends Hr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return Hr.className}}return n.className="GlorotNormal",n})();pe(v6);let x6=(()=>{class n extends Hr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return Hr.className}}return n.className="HeNormal",n})();pe(x6);let C6=(()=>{class n extends Hr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return Hr.className}}return n.className="HeUniform",n})();pe(C6);let w6=(()=>{class n extends Hr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return Hr.className}}return n.className="LeCunNormal",n})();pe(w6);let S6=(()=>{class n extends Hr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return Hr.className}}return n.className="LeCunUniform",n})();pe(S6),pe((()=>{class n extends wo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,i){return Y(()=>{if(e.length<2)throw new _t("Shape must be at least 2D.");if("int32"!==i&&"float32"!==i&&void 0!==i)throw new TypeError(`Unsupported data type ${i}.`);const s=te(e.slice(0,-1)),r=e[e.length-1],o=s*r;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const l=ZC([Math.max(r,s),Math.min(r,s)],0,1,i,this.seed),c=L1e.qr(l,!1);let u=c[0];const h=c[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=F(u,h.sign()),s<r&&(u=u.transpose()),F(ct(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}return n.className="Orthogonal",n})());const I6={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function E6(n,t={}){return zb(n,go.getMap().classNameMap,t,"initializer")}function ni(n){return PM(n)}function jn(n){if("string"==typeof n){const t=n in I6?I6[n]:n;if("GlorotNormal"===t)return new v6;if("GlorotUniform"===t)return new y6;if("HeNormal"===t)return new x6;if("HeUniform"===t)return new C6;if("LeCunNormal"===t)return new w6;if("LeCunUniform"===t)return new S6;{const e={};return e.className=t,e.config={},E6(e)}}return n instanceof wo?n:E6(n)}function VM(n){return Array.isArray(n)&&Array.isArray(n[0])}function QC(n){return 0===n.length?[]:Array.isArray(n[0])?n:[n]}function st(n){let t;if(Array.isArray(n)){if(1!==n.length)throw new L(`Expected Tensor length to be 1; got ${n.length}`);t=n[0]}else t=n;return t}function Xt(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(1===n.length)return n[0];throw new L(`Expected exactly 1 Shape; got ${n.length}`)}return n}function JC(n){let t=0;for(const e of n)t+=0===e.shape.length?1:e.shape.reduce((i,s)=>i*s);return t}const k6="Variable";class za{constructor(t,e="float32",i=k6,s=!0,r=null){this.dtype=e??"float32",this.shape=t.shape,this.id=l6(),this.originalName=d6(i=i??k6),this.name=h6(this.originalName),this.trainable_=s,this.constraint=r,this.val=function PCe(n,t=!0,e,i){return $.makeVariable(n,t,e,i)}(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function zke(n,t){if(n.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function zM(n){return n.map(t=>t.read())}function UM(n){n.forEach(t=>{t[0].write(t[1])})}class Ui{constructor(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Ua{constructor(t,e,i,s,r,o,a){this.dtype=t,this.shape=e,this.sourceLayer=i,this.inputs=s,this.callArgs=r,this.outputTensorIndex=a,this.id=l6(),null!=o&&(this.originalName=d6(o),this.name=h6(this.originalName)),this.rank=e.length}}let Uke=0;class ew{constructor(t,e){this.callArgs=e,this.id=Uke++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const i of t.inboundLayers)i?.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)t.push(null!=e?e.name:null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Wke=0;class Nt extends Pf{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Wke++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const i=this.getClassName();e=Ol(i)+"_"+KC(i)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let i;if(null!=t.batchInputShape)i=t.batchInputShape;else if(null!=t.inputShape){let r=null;null!=t.batchSize&&(r=t.batchSize),i=[r].concat(t.inputShape)}this.batchInputShape=i;let s=t.dtype;null==s&&(s=t.inputDType),null==s&&(s="float32"),this.dtype=s}this.initialWeights=null!=t.weights?t.weights:null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new xo(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new L(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return or(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return or(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new $a(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new $a(`Layer ${this.name} is not connected, no input to return.`);return or(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new $a(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new $a(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return or(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const e=cn(t);if(null==this.inputSpec||0===this.inputSpec.length)return;const i=cn(this.inputSpec);if(e.length!==i.length)throw new L(`Layer ${this.name} expects ${i.length} inputs, but it received ${e.length} input tensors. Input received: ${t}`);for(let s=0;s<e.length;s++){const r=e[s],o=i[s];if(null==o)continue;const a=r.rank;if(null!=o.ndim&&a!==o.ndim)throw new L(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(null!=o.maxNDim&&a>o.maxNDim)throw new L(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(null!=o.minNDim&&a<o.minNDim)throw new L(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(null!=o.dtype&&r.dtype!==o.dtype)throw new L(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${r.dtype}.`);if(o.axes){const l=r.shape;for(const c in o.axes){const u=Number(c),d=o.axes[c];if(null!=d&&-1===[d,null].indexOf(u>=0?l[u]:l[l.length+u]))throw new L(`Input ${s} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(null!=o.shape)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=r.shape[l];if(null!=c&&null!=u&&c!==u)throw new L(`Input ${s} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${r.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const i=cn(t),s=function Gke(n){let t=!0;for(const e of cn(n))if(!(e instanceof Ua)){t=!1;break}return t}(t),r=function qke(n){let t=!0;for(const e of cn(n))if(e instanceof Ua){t=!1;break}return t}(t);if(s===r)throw new L("Arguments to apply() must be all SymbolicTensors or all Tensors");return md(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const o=[];for(const a of cn(t))o.push(a.shape);this.build(or(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&r&&(this._refCount=1)}if(this.assertInputCompatibility(t),r){let o=this.call(t,e);this.supportsMasking&&this.setMaskMetadata(t,o);const a=cn(o),l=[];for(let c of a)-1!==i.indexOf(c)&&(c=c.clone()),l.push(c);if(o=or(l),null!=this.activityRegularizer)throw new _t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}{const o=function Hke(n){n=cn(n);const t=[];for(const e of n)t.push(e.shape);return or(t)}(t),a=this.computeOutputShape(o);let l;const c="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?o[0]:o),l=null!=a&&a.length>0&&Array.isArray(a[0])?a.map((u,d)=>new Ua(c,u,this,cn(t),e,this.name,d)):new Ua(c,a,this,cn(t),e,this.name),this.addInboundNode(t,l,null,null,o,a,e),this._refCount++,null!=this.activityRegularizer)throw new _t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((i,s)=>{null!=i&&null!=t[s]&&t[s]!==i&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new $a(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const i=JSON.stringify(e.outputShapes);-1===t.indexOf(i)&&t.push(i)}if(1===t.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new $a(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new xo(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return JC(this.weights)}build(t){this.built=!0}getWeights(t=!1){return zM(t?this.trainableWeights:this.weights)}setWeights(t){Y(()=>{const e=this.weights;if(e.length!==t.length)throw new L(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const i=[],s=zM(e);for(let r=0;r<s.length;++r){const o=s[r],a=e[r],l=t[r];if(!tn(o.shape,l.shape))throw new L(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);i.push([a,l])}UM(i)})}addWeight(t,e,i,s,r,o,a,l){if(-1!==this._addedWeightNames.indexOf(t))throw new L(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==i&&(i="float32"),this.fastWeightInitDuringBuild&&(s=null!=l?l():jn("zeros"));const c=s.apply(e,i),u=new za(c,i,t,o,a);return c.dispose(),null!=r&&this.addLoss(()=>r.apply(u.read())),null==o&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=cn(t),null!=this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach(i=>{if(null!=i)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return e}setMaskMetadata(t,e,i){if(!this.supportsMasking)return;const s=this.computeMask(t,i),r=cn(e),o=cn(s);if(r.length!==o.length)throw new Error(`${this.name} outputs ${r.length} tensors but ${r.length} masks for those tensors`);for(let a=0;a<r.length;a++)r[a].kerasMask=o[a]}addInboundNode(t,e,i,s,r,o,a=null){const l=cn(t);e=cn(e),i=cn(i),s=cn(s),r=QC(r),o=QC(o);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new ew({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:e,inputMasks:i,outputMasks:s,inputShapes:r,outputShapes:o},a);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function T6(n,t,e){if((null==t||null!=e&&e>0)&&(t=n.sourceLayer,e=n.nodeIndex),0===t.inboundNodes.length)return[n];{const i=t.inboundNodes[e];if(0===i.inboundLayers.length)return i.inputTensors;{const s=[];for(let r=0;r<i.inboundLayers.length;r++){const c=T6(i.inputTensors[r],i.inboundLayers[r],i.nodeIndices[r]);for(const u of c)-1===s.indexOf(u)&&s.push(u)}return s}}}let tw=(()=>{class n extends Nt{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:KC("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new L("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let i=e.batchInputShape;if(null==i){if(null==e.inputShape)throw new L("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new L("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=i,this.dtype=s,this.inputSpec=[{shape:i}];const r=new Ua(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new ew({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]})}apply(e,i){throw new L(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}return n.className="InputLayer",n})();pe(tw);class Vc{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Vc)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,i){if(null!=this.id2Value[t.id])throw new L(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=function Xke(n,t){if(null==n.dtype||n.dtype===t.dtype)return t;try{return Te(t,n.dtype)}catch{throw new L(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=i&&(this.id2Mask[t.id]=i),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Ua){if(null==this.id2Value[t.id])throw new L(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new L(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof Ua){if(null==this.id2Value[t.id])throw new L(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new L(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&It(this.id2Mask)}}const nw=new s6,iw=new s6;function Gb(n,t,e,i){const s=null!=e&&e.training,r=Array.isArray(n),o=r?n:[n],a=o.map(p=>p.name),l=[],c=t.names();for(const p of a)-1!==c.indexOf(p)?l.push(t.getValue(p)):l.push(null);null!=i&&(i.maxNumTensors=-1/0,i.minNumTensors=1/0);const u=a.join(",")+"|"+t.names().sort().join(",");let h,d=nw.get(u);if(null==d){const p=function Zke(n,t){T(null!=n&&n.length>0,()=>"Expected at least one fetch, got none");let e=[],i={};if(1===n.length){const s=D6(n[0],t);e=s.sorted,i=s.recipientMap}else{const s=new Set;for(const r of n){const{sorted:o,recipientMap:a}=D6(r,t);for(const l of o)s.has(l.name)||(e.push(l),s.add(l.name));for(const l in a)null==i[l]&&(i[l]=new Set),a[l].forEach(c=>i[l].add(c))}}return{sorted:e,recipientCounts:Qke(i)}}(o,t);d=p.sorted,h=p.recipientCounts,nw.put(u,d),iw.put(u,h)}h={},s||Object.assign(h,iw.get(u));const f=new Vc(t);for(let p=0;p<d.length;++p){if(null!=i){const D=eA().numTensors;D>i.maxNumTensors&&(i.maxNumTensors=D),D<i.minNumTensors&&(i.minNumTensors=D)}const g=d[p],m=g.sourceLayer;if(m instanceof tw)continue;const b=[],_=[],y=[];let v=!1;for(const D of g.inputs){const M=f.getValue(D),R=f.getMask(D);b.push(M),_.push(R),null!=R&&(v=!0),s||(h[D.name]--,0===h[D.name]&&!t.hasKey(D)&&-1===a.indexOf(D.name)&&!M.isDisposed&&!0!==D.sourceLayer.stateful&&y.push(M))}v&&((e=e||{}).mask=_[0]);const x=cn(m.apply(b,e));let S=null;m.supportsMasking&&(S=m.computeMask(b,_));const E=Jke(g),k=Array.isArray(E)?E:[E];for(let D=0;D<k.length;++D){f.hasKey(k[D])||f.add(k[D],x[D],Array.isArray(S)?S[0]:S);const M=a.indexOf(k[D].name);-1!==M&&(l[M]=x[D])}s||It(y)}return f.disposeMasks(),r?l:l[0]}function Qke(n){const t={};for(const e in n)t[e]=n[e].size;return t}function D6(n,t){const e=new Set,i=[],s={};for(const a of t.names())e.add(a);const r=[],o=[];for(r.push(n);r.length>0;){const a=r[r.length-1];if(e.has(a.name)){r.pop();continue}const l=o[o.length-1]===r.length-1;if(0===a.inputs.length||l)r.pop(),i.push(a),e.add(a.name),l&&o.pop();else{o.push(r.length-1);for(const c of a.inputs)null==s[c.name]&&(s[c.name]=new Set),s[c.name].add(a.name),!e.has(c.name)&&r.push(c)}}return{sorted:i,recipientMap:s}}function Jke(n){let t;if(1===n.sourceLayer.inboundNodes.length)t=n.sourceLayer.output;else{let e=null;for(let i=0;i<n.sourceLayer.inboundNodes.length;++i)for(const s of n.sourceLayer.inboundNodes[i].outputTensors)if(s.id===n.id){e=i;break}t=n.sourceLayer.getOutputAt(e)}return t}function WM(n,t){return Y(()=>Cs(We(F(n,n),t,!0)))}J().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function Yke(n){nw?.setMaxEntries(n),iw?.setMaxEntries(n)});class qb extends Pf{getConfig(){return{}}}pe((()=>{class n extends qb{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Y(()=>{const i=WM(e,this.axis),s=$r(i,0,this.maxValue);return F(e,qe(s,ge(zi(),i)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}return n.className="MaxNorm",n})()),pe((()=>{class n extends qb{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Y(()=>qe(e,ge(zi(),WM(e,this.axis))))}getConfig(){return{axis:this.axis}}}return n.className="UnitNorm",n})()),pe((()=>{class n extends qb{apply(e){return Dl(e)}}return n.className="NonNeg",n})()),pe((()=>{class n extends qb{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Y(()=>{const i=WM(e,this.axis),s=ge(F(this.rate,$r(i,this.minValue,this.maxValue)),F(1-this.rate,i));return F(e,qe(s,ge(zi(),i)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}return n.className="MinMaxNorm",n})());const N6={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Wi(n){return PM(n)}function A6(n,t={}){return zb(n,go.getMap().classNameMap,t,"constraint")}function Hi(n){return null==n?null:"string"==typeof n?A6({className:n in N6?N6[n]:n,config:{}}):n instanceof qb?n:A6(n)}function zc(n){return HM.apply(this,arguments)}function HM(){return(HM=Q(function*(n){if(null==n)return;const t=[],e=[],i=[];for(const s in n){const r=n[s];if("number"!=typeof r){const o=r;t.push(o.data()),e.push(s),i.push(o)}}if(t.length>0){const s=yield Promise.all(t);for(let r=0;r<s.length;++r)n[e[r]]=s[r][0];It(i)}})).apply(this,arguments)}function M6(n){if(null!=n)for(const t in n){const e=n[t];"number"!=typeof e&&e.dispose()}}class Wf{constructor(){this.validationData=null}setParams(t){this.params=t}onEpochBegin(t,e){return Q(function*(){})()}onEpochEnd(t,e){return Q(function*(){})()}onBatchBegin(t,e){return Q(function*(){})()}onBatchEnd(t,e){return Q(function*(){})()}onTrainBegin(t){return Q(function*(){})()}onTrainEnd(t){return Q(function*(){})()}setModel(t){}}class tTe{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}onEpochBegin(t,e){var i=this;return Q(function*(){null==e&&(e={});for(const s of i.callbacks)yield s.onEpochBegin(t,e)})()}onEpochEnd(t,e){var i=this;return Q(function*(){null==e&&(e={});for(const s of i.callbacks)yield s.onEpochEnd(t,e)})()}onBatchBegin(t,e){var i=this;return Q(function*(){null==e&&(e={});for(const s of i.callbacks)yield s.onBatchBegin(t,e)})()}onBatchEnd(t,e){var i=this;return Q(function*(){null==e&&(e={});for(const s of i.callbacks)yield s.onBatchEnd(t,e)})()}onTrainBegin(t){var e=this;return Q(function*(){null==t&&(t={});for(const i of e.callbacks)yield i.onTrainBegin(t)})()}onTrainEnd(t){var e=this;return Q(function*(){null==t&&(t={});for(const i of e.callbacks)yield i.onTrainEnd(t)})()}}class nTe extends Wf{constructor(){super()}onEpochBegin(t){var e=this;return Q(function*(){e.seen=0,e.totals={}})()}onBatchEnd(t,e){var i=this;return Q(function*(){null==e&&(e={});const s=null==e.size?0:e.size;i.seen+=s;for(const r in e){const o=e[r];if("number"==typeof o)i.totals.hasOwnProperty(r)||(i.totals[r]=0),i.totals[r]=i.totals[r]+o*s;else{let a;r in i.totals?a=i.totals[r]:i.totals[r]=0;const l=Y(()=>ge(i.totals[r],F(o,s)));i.totals[r]=l,a?.dispose()}}})()}onEpochEnd(t,e){var i=this;return Q(function*(){if(null!=e)for(const s of i.params.metrics)null!=i.totals[s]&&("number"==typeof i.totals[s]?e[s]=i.totals[s]/i.seen:Y(()=>{const r=F(qe(1,i.seen),i.totals[s]);e[s]=r,i.totals[s].dispose(),Ra(e[s])}))})()}}class iTe extends Wf{onTrainBegin(t){var e=this;return Q(function*(){e.epoch=[],e.history={}})()}onEpochEnd(t,e){var i=this;return Q(function*(){null==e&&(e={}),i.epoch.push(t);for(const s in e)null==i.history[s]&&(i.history[s]=[]),i.history[s].push(e[s])})()}syncData(){var t=this;return Q(function*(){const e=[],i=[],s=[];for(const o in t.history){const a=t.history[o];for(let l=0;l<a.length;++l)"number"!=typeof a[l]&&(e.push(a[l].data()),i.push(o),s.push(l))}const r=yield Promise.all(e);for(let o=0;o<r.length;++o)t.history[i[o]][s[o]].dispose(),t.history[i[o]][s[o]]=r[o][0]})()}}class sTe extends Wf{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||fG,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");HD(this.yieldEvery)&&(this.maybeWait=function bke(n,t,e){let s,i=null!=e?e():nr();return(...o)=>{const a=null!=e?e():nr();return a-i<t||(i=a,s=n(...o)),s}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}maybeWait(t,e,i){var s=this;return Q(function*(){const r=[];null!=s.yield&&(yield zc(i),r.push(s.yield(t,e,i))),r.push(s.nextFrameFunc()),yield Promise.all(r)})()}onEpochBegin(t,e){var i=this;return Q(function*(){i.currentEpoch=t,null!=i.epochBegin&&(yield zc(e),yield i.epochBegin(t,e))})()}onEpochEnd(t,e){var i=this;return Q(function*(){const s=[];null!=i.epochEnd&&(yield zc(e),s.push(i.epochEnd(t,e))),"epoch"===i.yieldEvery&&s.push(i.nextFrameFunc()),yield Promise.all(s)})()}onBatchBegin(t,e){var i=this;return Q(function*(){null!=i.batchBegin&&(yield zc(e),yield i.batchBegin(t,e))})()}onBatchEnd(t,e){var i=this;return Q(function*(){const s=[];null!=i.batchEnd&&(yield zc(e),s.push(i.batchEnd(t,e))),"batch"===i.yieldEvery?s.push(i.nextFrameFunc()):HD(i.yieldEvery)&&s.push(i.maybeWait(i.currentEpoch,t,e)),yield Promise.all(s)})()}onTrainBegin(t){var e=this;return Q(function*(){null!=e.trainBegin&&(yield zc(t),yield e.trainBegin(t))})()}onTrainEnd(t){var e=this;return Q(function*(){null!=e.trainEnd&&(yield zc(t),yield e.trainEnd(t))})()}}function P6(n,t){return null==n&&(n={}),n instanceof Wf?[n]:Array.isArray(n)&&n[0]instanceof Wf?n:cn(n).map(i=>new sTe(i,t))}let rTe=(()=>{class n{constructor(){}static registerCallbackConstructor(e,i){T(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),n.checkForDuplicate(i),null==n.constructors[e]&&(n.constructors[e]=[]),n.constructors[e].push(i)}static checkForDuplicate(e){for(const i in n.constructors)n.constructors[+i].forEach(r=>{if(r===e)throw new L("Duplicate callback constructor.")})}static clear(){n.constructors={}}static createCallbacks(e){const i=[];for(const s in n.constructors){const r=+s;e>=r&&i.push(...n.constructors[r])}return i.map(s=>new s)}}return n.constructors={},n})();function R6(n,t,e,i,s,r,o,a,l){const c=new iTe,u=[new nTe,...rTe.createCallbacks(t)];null!=n&&u.push(...n),u.push(c);const d=new tTe(u);return d.setParams({epochs:e,initialEpoch:i,samples:s,steps:r,batchSize:o,verbose:t,doValidation:a,metrics:l}),{callbackList:d,history:c}}function Wa(n,t={},e=!1){return zb(n,go.getMap().classNameMap,t,"layer",e)}function sw(n,t){return Y(()=>{"float32"!==n.dtype&&(n=Te(n,"float32"));const e=We(Hb(n),t,!0),i=Sb(e.shape,zi()),s=Cs(Pc(e,i));return qe(n,s)})}function rw(n,t){return Y(()=>Ci(Hb(Be(t,n)),-1))}function jM(n,t){return Y(()=>Ci(Ji(Be(t,n)),-1))}function GM(n,t){return Y(()=>{const e=Be(n,t),i=$r(Ji(n),zi(),Number.MAX_VALUE),s=Ji(qe(e,i));return F(100,Ci(s,-1))})}function Kb(n,t,e=!1){return Y(()=>{if(e)t=qA(t);else{const i=We(t,t.shape.length-1,!0);t=qe(t,i)}return t=$r(t,zi(),1-zi()),Hn(We(F(Te(n,"float32"),_o(t)),t.shape.length-1))})}function ow(n,t,e=!1){return Y(()=>{const i=Te(AC(function Ake(n){const t=[$c(n.shape)];return j(n,t)}(n)),"int32"),s=(t=$r(t,zi(),1-zi())).shape;return Kb(j(qj(i,s[s.length-1]),s),t,e)})}function aw(n,t){return Y(()=>{let e;return e=$r(t,zi(),1-zi()),e=_o(qe(e,Be(1,e))),Ci(function dTe(n,t){if(!tn(n.shape,t.shape))throw new L(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(t.shape)}`);return Y(()=>{const e=Dl(t),i=Hn(Ji(t));return ge(Be(e,F(t,n)),OA(Br(i)))})}(n,e),-1)})}function O6(n,t){return Y(()=>{const e=sw(n,-1),i=sw(t,-1),s=F(e,i);return Hn(We(s,-1))})}const lw={meanSquaredError:rw,meanAbsoluteError:jM,meanAbsolutePercentageError:GM,meanSquaredLogarithmicError:function oTe(n,t){return Y(()=>{const e=$r(t,zi(),Number.MAX_VALUE),i=_o(ge(1,e)),s=$r(n,zi(),Number.MAX_VALUE),r=_o(ge(1,s));return Ci(Hb(Be(i,r)),-1)})},squaredHinge:function aTe(n,t){return Y(()=>{const e=Pc(0,Be(1,F(n,t)));return Ci(Hb(e),-1)})},hinge:function lTe(n,t){return Y(()=>{const e=Pc(0,Be(1,F(n,t)));return Ci(e,-1)})},categoricalHinge:function cTe(n,t){return Y(()=>{const e=We(F(n,t),-1),i=Yo(F(Be(1,n),t),-1);return Pc(0,ge(1,Be(i,e)))})},logcosh:function uTe(n,t){return Y(()=>{const e=Math.log(2),i=Be(t,n),s=Be(ge(i,Pb(F(-2,i))),e);return Ci(s,-1)})},categoricalCrossentropy:Kb,sparseCategoricalCrossentropy:ow,binaryCrossentropy:aw,kullbackLeiblerDivergence:function hTe(n,t){return Y(()=>{const e=$r(n,zi(),1),i=$r(t,zi(),1);return We(F(n,_o(qe(e,i))),-1)})},poisson:function fTe(n,t){return Y(()=>{const e=_o(ge(zi(),t));return Ci(Be(t,F(n,e)),-1)})},cosineProximity:O6};function qM(n){if("string"==typeof n){if(n in lw)return lw[n];let t=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new L(t)}return n}function F6(n,t){return Y(()=>{const e=F(.5,yo(t)),i=Ba(Vr(t,e),n.dtype);return Ci(Fa(n,i),-1)})}function L6(n,t){return Y(()=>Ba(Fa(Ib(n,-1),Ib(t,-1)),"float32"))}function bTe(n,t){return aw(n,t)}function _Te(n,t){return n.rank===t.rank&&(n=Rb(n,[n.rank-1])),(t=Ib(t,-1)).dtype!==n.dtype&&(t=Te(t,n.dtype)),Te(Fa(n,t),"float32")}const B6=Kb,V6=ow,cw={binaryAccuracy:F6,categoricalAccuracy:L6,precision:function gTe(n,t){return Y(()=>{const e=function $6(n,t){return Y(()=>Te(We(kl(Fa(n,1),Fa(t,1))),"float32"))}(n,t),i=function mTe(n,t){return Y(()=>Te(We(kl(Fa(n,0),Fa(t,1))),"float32"))}(n,t),s=ge(e,i);return Te(Ls(Vr(s,0),qe(e,s),0),"float32")})},categoricalCrossentropy:B6,sparseCategoricalCrossentropy:V6,mse:rw,MSE:rw,mae:jM,MAE:jM,mape:GM,MAPE:GM,cosine:O6};function ETe(n){if("string"==typeof n&&n in cw)return cw[n];if("string"!=typeof n&&null!=n)return n;throw new L(`Unknown metric ${n}`)}function uw(n){if(Ur(null!==n,`Unknown LossOrMetricFn ${n}`),"string"==typeof n)return n;{let t;for(const e of Object.keys(lw))if(lw[e]===n){t=e;break}if(void 0!==t)return t;for(const e of Object.keys(cw))if(cw[e]===n){t=e;break}return void 0!==t?t:n.name}}const z6=1048576;function U6(n,t,e=!1){if(null==n||"object"!=typeof n||Object.getPrototypeOf(n)!==Object.prototype||!KM(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){const i=JSON.stringify(n);i.length>z6&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${i.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${z6}.`)}}function KM(n){if(null===n)return!0;if("object"==typeof n){if(Object.getPrototypeOf(n)===Object.prototype){const t=Object.keys(n);for(const e of t)if("string"!=typeof e||!KM(n[e]))return!1;return!0}if(Array.isArray(n)){for(const t of n)if(!KM(t))return!1;return!0}return!1}{const t=typeof n;return"string"===t||"number"===t||"boolean"===t}}function dw(n,t,e=console.log){let i="";for(let s=0;s<n.length;++s)s>0&&(i=i.slice(0,i.length-1)+" "),i+=n[s],i=i.slice(0,t[s]),i+=" ".repeat(t[s]-i.length);e(i)}function ATe(n,t,e){let i,s;try{s=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{i=JSON.stringify(n.outputShape)}catch{i="multiple"}dw([`${n.name} (${n.getClassName()})`,s,i,n.countParams().toString()],t,e)}function MTe(n,t,e,i){let s,r;try{r=n.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const o=[];for(const d of n.inboundNodes)if(!(null!=e&&e.length>0&&-1===e.indexOf(d)))for(let h=0;h<d.inboundLayers.length;++h)o.push(`${d.inboundLayers[h].name}[${d.nodeIndices[h]}][${d.tensorIndices[h]}]`);const a=n.name,l=n.getClassName(),c=0===o.length?"":o[0];dw([`${a} (${l})`,r,s,n.countParams().toString(),c],t,i);for(let d=1;d<o.length;++d)dw(["","","","",o[d]],t,i)}function W6(n,t,e){return("inboundNodes"===n||"outputLayers"===n||"inputLayers"===n)&&0===t&&"string"==typeof e}function hw(n,t){if(null===n)return null;if("string"==typeof n)return fd(n);if("number"==typeof n||"boolean"==typeof n)return n;if(n instanceof Array){const e=[],i=n.length;for(let s=0;s<i;++s){const r=n[s];W6(t,s,r)?e.push(r):e.push(hw(r,t))}return e}{const e={};for(const i of Object.keys(n)){const s=n[i];if("name"===i&&"string"==typeof s)e[i]=s;else{const r=fd(i);e[r]=hw(s,r)}}return e}}function XM(n,t){if(null==n)return null;if("string"==typeof n)return Ol(n);if("number"==typeof n||"boolean"==typeof n)return n;if(n instanceof Array){const e=[],i=n.length;for(let s=0;s<i;++s){const r=n[s];W6(t,s,r)?e.push(r):e.push(XM(r,t))}return e}{const e={};for(const i of Object.keys(n)){const s=n[i];e[Ol(i)]="name"!==i&&"className"!==i||"string"!=typeof s?XM(s,i):s}return e}}class ea extends Nt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const _=this.getClassName().toLowerCase();this.name=KC(_)}if(this.supportsMasking=!1,this.trainable_=!0,this.inputs=Array.isArray(t.inputs)?t.inputs.slice():[t.inputs],this.outputs=Array.isArray(t.outputs)?t.outputs.slice():[t.outputs],Lc(this.inputs).length!==this.inputs.length)throw new L(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(_=>_.name)}`);Lc(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(_=>_.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const _ of this.outputs){const v=_.nodeIndex,x=_.tensorIndex;this.outputLayers.push(_.sourceLayer),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(x)}for(const _ of this.inputs){const y=_.sourceLayer,v=_.nodeIndex,x=_.tensorIndex;Ur(0===v,"input layer has >1 nodes"),Ur(0===x,"input layer has >1 tensors"),this.inputLayers.push(y),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(x)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let _=0;_<this.inputLayers.length;_++){const y=this.inputLayers[_];if(!(y instanceof tw))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${_} (0-based) originates from layer type ${y.getClassName()}.`);this.inputNames.push(y.name),this.feedInputShapes.push(y.batchInputShape),this.feedInputNames.push(y.name)}for(const _ of this.outputLayers)this.outputNames.push(_.name);this.internalInputShapes=this.inputs.map(_=>_.shape),this.internalOutputShapes=this.outputs.map(_=>_.shape);const e={},i={},s={},r={},o={},a=[],l=(_,y,v,x,S,E)=>{(null==x||null==S||null==E)&&(x=_.sourceLayer,S=_.nodeIndex,E=_.tensorIndex);const k=x.inboundNodes[S];if(-1!==v.indexOf(k))throw new xo(`The tensor ${_.name} at layer "${x.name}" is part of a cycle.`);if(-1!==y.indexOf(k))return;this.containerNodes.add(ea.nodeKey(x,S)),x.id in o||(o[x.id]=Object.keys(o).length),-1===v.indexOf(k)&&v.push(k);const D=k.inboundLayers.length;for(let M=0;M<D;M++)l(k.inputTensors[M],y,v,k.inboundLayers[M],k.nodeIndices[M],k.tensorIndices[M]);for(y.push(k);v.indexOf(k)>=0;)v.splice(v.indexOf(k),1);a.push(k)},c=[],u=[];for(const _ of this.outputs)l(_,c,u);const d=a.slice().reverse();for(const _ of d){i[_.id]=_,_.id in e||(e[_.id]=0);let y=e[_.id];y=Math.max(y,null==s[_.outboundLayer.id]?0:s[_.outboundLayer.id]),s[_.outboundLayer.id]=y,r[_.outboundLayer.id]=_.outboundLayer,e[_.id]=y;for(let x=0;x<_.inboundLayers.length;x++){const k=_.inboundLayers[x].inboundNodes[_.nodeIndices[x]];e[k.id]=Math.max(y+1,null==e[k.id]?0:e[k.id]),i[k.id]=k}}const h={};for(const _ in e){const y=e[_];y in h||(h[y]=[]),h[y].push(i[_])}const f={};for(const _ in s){const y=s[_];y in f||(f[y]=[]),f[y].push(r[_])}let p=Object.keys(f).map(_=>parseInt(_,10)).sort(GC);this.layers=[];for(const _ of p){const y=f[_];y.sort((v,x)=>{const S=o[v.id],E=o[x.id];return S<E?-1:S>E?1:0});for(const v of y)v instanceof ea&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=f,p=Object.keys(h).map(_=>parseInt(_,10)).sort(GC);const g=this.inputs.slice(),m=[];for(const _ of p)for(const y of h[_]){const v=y.outboundLayer;if(null!=v){for(const x of y.inputTensors)if(-1===g.indexOf(x))throw new xo(`Graph disconnected: cannot obtain value for tensor ${x} at layer "${v.name}". The following previous layers were accessed without issue: ${m}`);for(const x of y.outputTensors)g.push(x);m.push(v.name)}}this.nodesByDepth=h;const b=this.layers.map(_=>_.name);for(const _ of b){const y=b.filter(v=>v===_).length;if(1!==y)throw new xo(`The name "${_}" is used ${y} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(b))}this.outboundNodes=[],this.inboundNodes=[],new ew({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(_=>null),outputMasks:this.outputs.map(_=>null),inputShapes:this.inputs.map(_=>_.shape),outputShapes:this.outputs.map(_=>_.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(i=>i.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new L("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const i of this.layers)e.push(...i.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const i={};let s=0;const r=(n=>{const t=Object.keys(n);if(0===t.length)return!1;const e=t[0].split("/");return!isNaN(parseInt(e[e.length-1],10))})(t);r&&this.parseWeights(t);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=r?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(null!=i[u])throw new L(`Duplicate weight name: ${u}`);i[u]=c,s++}const o=[];for(const a in t){let l=a;if(null==i[a]){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(null!=i[l])o.push([i[l],t[a]]);else if(e)throw new L(`Provided weight data has no target variable: ${a}`);delete i[l]}if(e){const a=[];for(const l in i)a.push(l);if(a.length>0)throw new L(`${a.length} of ${s} weights are not set: ${a}`)}UM(o)}parseWeights(t){for(const e in Object.keys(t)){const i=e.split("/"),s=["vars","layer_checkpoint_dependencies"],r=i.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!s.includes(o)).join("/");r!==e&&(t[r]=t[e],delete t[e])}}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 4.22.0",e.backend="TensorFlow.js",e}toJSON(t,e=!0){const i=XM(this.updatedConfig());return e?JSON.stringify(i):i}call(t,e){return Y(()=>{t=cn(t);const i=new Vc;for(let s=0;s<this.inputs.length;++s)i.add(this.inputs[s],t[s]);return Gb(this.outputs,i,e)})}computeMask(t,e){return Y(()=>{let i;return t=cn(t),i=null==e?hd(null,t.length):cn(e),this.runInternalGraph(t,i)[1]})}computeOutputShape(t){const e=QC(t);if(e.length!==this.inputLayers.length)throw new L(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const i={};for(let a=0;a<e.length;a++)i[this.inputLayers[a].name+"_0_0"]=e[a];const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(GC);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(-1!==this.inputLayers.map(g=>g.id).indexOf(u.id))continue;const d=[];for(let g=0;g<c.inboundLayers.length;g++)d.push(i[`${c.inboundLayers[g].name}_${c.nodeIndices[g]}_${c.tensorIndices[g]}`]);const f=QC(u.computeOutputShape(or(d))),p=u.inboundNodes.indexOf(c);for(let g=0;g<f.length;g++)i[`${u.name}_${p}_${g}`]=f[g]}}const r=[],o=[];for(let a=0;a<this.outputLayers.length;a++)o.push(`${this.outputLayers[a].name}_${this.outputLayersNodeIndices[a]}_${this.outputLayersTensorIndices[a]}`);for(let a=0;a<o.length;a++){const l=o[a];Ur(l in i),r.push(i[l])}return or(r)}runInternalGraph(t,e){null==e&&(e=hd(null,t.length));const i={};for(let l=0;l<this.inputs.length;++l)i[this.inputs[l].id]=[t[l],e[l]];const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(GC);for(const l of s){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const g of h)g.id in i&&p.push(i[g.id]);if(p.length===h.length){let m,b,_,y,g={};if(null!=u.callArgs&&(g=u.callArgs),1===p.length){const[v,x]=p[0];null==g.mask&&(g.mask=x),_=cn(d.call(v,g)),y=cn(d.computeMask(v,x)),m=[v],b=[x]}else m=p.map(v=>v[0]),b=p.map(v=>v[1]),null==g.mask&&(g.mask=b),_=cn(d.call(m,g)),y=cn(d.computeMask(m,b));if(d.activityRegularizer)throw new _t("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<f.length;++v)i[f[v].id]=[_[v],y[v]]}}}const r=[],o=[],a=[];for(const l of this.outputs){Ur(l.id in i,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=i[l.id];a.push(c.shape),r.push(c),o.push(u)}return[r,o,a]}buildNodeConversionMap(t){const e={};let i;for(const s of this.layers){i=s instanceof ea?1:0;for(let r=0;r<s.inboundNodes.length;r++){const o=ea.nodeKey(s,r);this.containerNodes.has(o)&&(e[o]=i,i+=1)}}return e}getLayer(t,e){if(null!=e)return this.findLayer(e);if(null==t)throw new L("Provide either a layer name or layer index");if("number"==typeof t)return this.findLayer(t);for(const i of this.layers)if(i.name===t)return i;throw new L(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new L(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return Y(()=>{const t=[];for(const e of this.layers)for(let i=0;i<e.inboundNodes.length;++i){const s=ea.nodeKey(e,i);this.containerNodes.has(s)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),i=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],f=ea.nodeKey(o,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const g=[];for(let m=0;m<h.inboundLayers.length;m++){const b=h.inboundLayers[m],y=h.tensorIndices[m];let x=e[ea.nodeKey(b,h.nodeIndices[m])];null==x&&(x=0),g.push([b.name,x,y,p])}c.push(g)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,i.push(u)}t.layers=i;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],c=ea.nodeKey(a,this.inputLayersNodeIndices[o]);if(!this.containerNodes.has(c))continue;let u=e[c];null==u&&(u=0),s.push([a.name,u,this.inputLayersTensorIndices[o]])}t.inputLayers=s;const r=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],c=ea.nodeKey(a,this.outputLayersNodeIndices[o]);if(!this.containerNodes.has(c))continue;let u=e[c];null==u&&(u=0),r.push([a.name,u,this.outputLayersTensorIndices[o]])}return t.outputLayers=r,t}static fromConfig(t,e,i={},s=!1){const r={},o={};function a(m,b){m.name in o?o[m.name].push(b):o[m.name]=[b]}function l(m,b){const _=[];let y;for(const v of b){const x=v[0],S=v[1],E=v[2];if(y=null==v[3]?{}:v[3],!(x in r))return void a(m,b);const k=r[x];if(k.inboundNodes.length<=S)return void a(m,b);_.push(k.inboundNodes[S].outputTensors[E])}_.length>0&&m.apply(or(_),y)}function c(m){const b=m.name,_=Wa(m,null!=e.customObjects?e.customObjects:{});_.setFastWeightInitDuringBuild(s),r[b]=_,m.inboundNodes.forEach(v=>{if(!(v instanceof Array))throw new L(`Corrupted configuration, expected array for nodeData: ${v}`);a(_,v)})}const u=e.name,d=e.layers;for(const m of d)c(m);for(;!gke(o);)for(const m of d){const b=r[m.name];if(b.name in o){const _=o[b.name];delete o[b.name];for(const y of _)l(b,y)}}const h=[],f=[],p=e.inputLayers;for(const m of p){const b=m[0],_=m[1],y=m[2];Ur(b in r),h.push(r[b].inboundNodes[_].outputTensors[y])}const g=e.outputLayers;for(const m of g){const b=m[0],_=m[1],y=m[2];Ur(b in r),f.push(r[b].inboundNodes[_].outputTensors[y])}return new t({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new L("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Y(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}function j6(n,t){return function H6(n,t,e){const i=t.length;if(null==n||Array.isArray(n)&&0===n.length)return t.map(s=>null);if(1===i)return Array.isArray(n)&&1===n.length?n:"object"==typeof n&&t[0]in n?[n[t[0]]]:[n];if(Array.isArray(n)){if(n.length!==i)throw new Error(`Provided ${e} is an array of ${n.length} element(s), but the model has ${i} outputs. Make sure a set of weights is provided for each model output.`);return n}if("object"==typeof n&&Object.keys(n).length>0&&"object"==typeof n[Object.keys(n)[0]]){const s=[];return t.forEach(r=>{s.push(r in n?n[r]:null)}),s}throw new Error(`The model has multiple (${i}) outputs, so ${e} must be either an array with ${i} elements or an object with ${t} keys. Provided ${e} not understood: ${JSON.stringify(n)}`)}(n,t,"classWeight")}function G6(n,t,e,i){return ZM.apply(this,arguments)}function ZM(){return(ZM=Q(function*(n,t,e,i){if(null!=t||null!=i)throw new Error("Support sampleWeight is not implemented yet");if(null!=e){const s=Y(()=>{if(1===n.shape.length)return sd(n);if(2===n.shape.length){if(n.shape[1]>1)return Ib(n,1);if(1===n.shape[1])return j(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(yield s.data());It(s);const o=[];return r.forEach(a=>{if(null==e[a])throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(e[a])}),rr(o,"float32")}return null})).apply(this,arguments)}function RTe(n,t){return F(n,t)}const OTe=32;function q6(n,t){let e,i;e=t.xs,i=t.ys,T(null!=e&&null!=i,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const r=K6("input",n.inputNames,e),o=K6("output",n.outputNames,i),a=r[0].shape[0];T(r.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${r.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),T(o.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<r.length;l++)T(r[l].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${r[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:r,ys:o}}function K6(n,t,e){if(e instanceof Bi)return[e];if(Array.isArray(e))return T(e.length===t.length,()=>`Received an array of ${e.length} Tensors, but expected ${t.length} to match the ${n} keys ${t}.`),e;{const i=[];for(const s of t){if(null==e[s])throw new L(`The feature data generated by the dataset lacks the required ${n} key '${s}'.`);i.push(e[s])}return i}}function QM(){return(QM=Q(function*(n,t,e){const i=null!=e.batchesPerEpoch;if(T(null!=n.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(null!=e,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(null!=e.epochs&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),T(!i||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),T(null==e.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const s=null!=e.validationData;let r,o;if(s)if(X6(e.validationData))T(null==e.validationBatches||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{const m=function FTe(n){if(3===n.length)throw new _t("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}(e.validationData);r=m.xs,o=m.ys}const a=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let c;c=s?l.slice().concat(l.map(m=>"val_"+m)):l.slice();const u=P6(e.callbacks,e.yieldEvery),d=null==e.verbose?1:e.verbose,{callbackList:h,history:f}=R6(u,d,e.epochs,null,null,function $Te(n,t){let e=null;return null!=t.batchesPerEpoch?e=t.batchesPerEpoch:Number.isFinite(n.size)&&(e=n.size),e}(t,e),null,s,c);h.setModel(n),n.history=f,yield h.onTrainBegin(),n.stopTraining_=!1;let p=null==e.initialEpoch?0:e.initialEpoch,g=yield t.iterator();for(;p<e.epochs;){const m={};yield h.onEpochBegin(p);let b=0,_=0;for(i||(g=yield t.iterator());!i||b<e.batchesPerEpoch;){const y=yield g.next();if(i&&y.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${b} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(null!=y.value){const{xs:v,ys:x}=q6(n,y.value),S={};S.batch=_,S.size=v[0].shape[0],yield h.onBatchBegin(_,S);const E=[];if(null!=e.classWeight){const M=j6(e.classWeight,n.outputNames);for(let R=0;R<M.length;++R)E.push(yield G6(x[R],null,M[R]))}const k=v.concat(x).concat(E),D=a(k);It(k);for(let M=0;M<l.length;++M){const U=D[M];S[l[M]]=U,Ra(U)}yield h.onBatchEnd(_,S),M6(S),_++,b++}if(i?b>=e.batchesPerEpoch:y.done){if(s){let v;v=X6(e.validationData)?cn(yield n.evaluateDataset(e.validationData,{batches:e.validationBatches})):cn(n.evaluate(r,o,{batchSize:null==e.validationBatchSize?OTe:e.validationBatchSize,verbose:0}));for(let x=0;x<n.metricsNames.length;++x)m[`val_${n.metricsNames[x]}`]=v[x]}break}if(n.stopTraining_)break}if(yield h.onEpochEnd(p,m),p++,n.stopTraining_)break}return yield h.onTrainEnd(),yield n.history.syncData(),n.history}finally{n.isTraining=!1}})).apply(this,arguments)}function X6(n){return"function"==typeof n.iterator}function JM(){return(JM=Q(function*(n,t,e){const i=null!=(e=e||{}).batches,s=n.testFunction;let r=[];if(e.verbose>0)throw new _t("Verbose mode is not implemented yet.");T(!i||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);const o=function BTe(n){return"function"==typeof n.next}(t)?t:yield t.iterator();let a=0,l=0;for(;!i||l<e.batches;){const c=yield o.next();if(r=Y(()=>{if(c.value){const{xs:u,ys:d}=q6(n,c.value),h=u.concat(d),f=Y(()=>s(h));if(It(h),0===l)for(let g=0;g<f.length;++g)r.push(ct(0));const p=h[0].shape[0];for(let g=0;g<f.length;++g){const m=f[g],b=r[g];r[g]=Y(()=>ge(r[g],F(p,m))),l>0&&It(b)}It(f),a+=p,++l}return r}),c.done){i&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<r.length;++c){const u=r[c];r[c]=qe(r[c],a),It(u)}return or(r)})).apply(this,arguments)}function eP(n){T(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function Xb(n,t,e){return null==n?[null]:Array.isArray(n)?n.map(i=>gd(i,t,e-t)):gd(n,t,e-t)}function tP(n,t){return Y(()=>null==n?null:Array.isArray(n)?n.map(e=>tP(e,t)):g6(n,"int32"===t.dtype?t:Te(t,"int32")))}function nP(n,t){const e=[];let i=0,s=null;for(;i<n;)s=i+t,s>=n&&(s=n),e.push([i,s]),i=s;return e}function Y6(n){const t=[];n instanceof Bi&&(n=[n]);for(let e=0;e<n.length;++e){const i=n[e];if(1===i.rank)t.push(Wb(i,1));else{if(0===i.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(i)}}return t}function ta(n,t){if(null==n)return;const e=[];if(t instanceof Bi)e.push(t.id);else if(Array.isArray(t))t.forEach(s=>e.push(s.id));else if(null!=t)for(const s in t)e.push(t[s].id);const i=[];if(n instanceof Bi)-1===e.indexOf(n.id)&&i.push(n);else if(Array.isArray(n))n.forEach(s=>{-1===e.indexOf(s.id)&&i.push(s)});else if(null!=n)for(const s in n){const r=n[s];-1===e.indexOf(r.id)&&i.push(r)}i.forEach(s=>{s.isDisposed||s.dispose()})}function iP(n){return Array.isArray(n)}function Z6(n){return!function zTe(n){return n instanceof Bi}(n)&&!iP(n)}function Q6(n,t,e,i=!0,s=""){if(null==t||0===t.length){if(null!=n){let o=!1;if(iP(n)&&n.length>0)o=!0;else if(Z6(n)){for(const a in n)if(n.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new L(`Error when checking model ${s} expected no data, but got ${n}`)}return[]}if(null==n)return t.map(o=>null);let r;if(Z6(n)){r=[];for(const o of t){if(null==n[o])throw new L(`No data provided for "${o}". Need data for each key in: ${t}`);r.push(n[o])}}else if(iP(n)){if(n.length!==t.length)throw new L(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);r=n}else{if(t.length>1)throw new L(`The model ${s} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);r=[n]}if(r=Y6(r),null!=e)for(let o=0;o<t.length;++o){if(null==e[o])continue;const a=r[o];if(a.shape.length!==e[o].length)throw new L(`Error when checking ${s}: expected ${t[o]} to have ${e[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<e[o].length;++l){if(0===l&&!i)continue;const u=e[o][l];if(null!=u&&u>=0&&a.shape[l]!==u)throw new L(`${s} expected a batch of elements where each example has shape [${e[o].slice(1,e[o].length)}] (i.e.,tensor shape [*,${e[o].slice(1,e[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return r}function J6(n,t,e,i=!0,s=""){let r;if(Array.isArray(n)){if(n.length!==t.length)throw new L(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${n.length} Tensors(s).`);r=n}else{if(t.length>1)throw new L(`The model expects ${t.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);r=[n]}if(null!=e)for(let o=0;o<t.length;++o){if(null==e[o])continue;const a=r[o];if(a.shape.length!==e[o].length)throw new L(`Error when checking ${s}: expected ${t[o]} to have ${e[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<e[o].length;++l){if(0===l&&!i)continue;const u=e[o][l];if(null!=u&&u!==a.shape[l])throw new L(`Error when checking ${s}: expected ${t[o]} to have shape ${JSON.stringify(e[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}let Hf=(()=>{class n extends ea{constructor(e){super(e),this.isTraining=!1}summary(e,i,s=console.log){if(!this.built)throw new L("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function TTe(n,t,e,i=console.log){const s=function NTe(n){let t=!0;const e=[],i=[];for(const s in n.nodesByDepth)e.push(n.nodesByDepth[s]);for(const s of e){if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}i.push(...s)}if(t)for(const s of n.layers){let r=!1;for(const o of s.inboundNodes)if(-1!==i.indexOf(o)){if(r){t=!1;break}r=!0}if(!t)break}return t}(n),r=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(s?(t=t||90,e=e||[.32,.61,.89,1]):(t=t||115,e=e||[.24,.48,.7,.8,1]),e[e.length-1]<=1&&(e=e.map(u=>Math.floor(t*u))),!s){r.push("Receives inputs"),o=[];for(const u in n.nodesByDepth)o.push(...n.nodesByDepth[u])}i("_".repeat(t)),dw(r,e,i),i("=".repeat(t));const a=n.layers;for(let u=0;u<a.length;++u)s?ATe(a[u],e,i):MTe(a[u],e,o,i),i((u===a.length-1?"=":"_").repeat(t));n.checkTrainableWeightsConsistency();const l=function DTe(n){let t;return t=JC(null!=n.collectedTrainableWeights?n.collectedTrainableWeights:n.trainableWeights),t}(n),c=JC(n.nonTrainableWeights);i(`Total params: ${l+c}`),i(`Trainable params: ${l}`),i(`Non-trainable params: ${c}`),i("_".repeat(t))}(this,e,i,s)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function kTe(n){const t={Adagrad:()=>Vf.adagrad(.01),Adadelta:()=>Vf.adadelta(1,.95,zi()),Adam:()=>Vf.adam(.001,.9,.999,zi()),Adamax:()=>Vf.adamax(.002,.9,.999,zi(),0),RMSProp:()=>Vf.rmsprop(.001,.9,0,zi()),SGD:()=>Vf.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,n in t)return t[n]();throw new L(`Unknown Optimizer ${n}`)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Mc))throw new L("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let i=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new L(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);i=e.loss.map(l=>qM(l))}else{const a=qM(e.loss);this.outputs.forEach(l=>{i.push(a)})}else{e.loss=e.loss;for(const a in e.loss)if(-1===this.outputNames.indexOf(a))throw new L(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)null==e.loss[a]&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),i.push(qM(e.loss[a]))}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const l=this.internalOutputShapes[a];this.feedOutputNames.push(this.outputNames[a]),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[a])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],md("loss",()=>{for(let a=0;a<this.outputs.length;++a)-1===s.indexOf(a)&&this.outputs.length>1&&(this.metricsTensors.push([this.lossFunctions[a],a]),this.metricsNames.push(this.outputNames[a]+"_loss"))});const r=function HTe(n,t){if(null==n||Array.isArray(n)&&0===n.length)return t.map(i=>[]);let e;if("string"==typeof n||"function"==typeof n)e=[n];else{if(!Array.isArray(n)&&"object"!=typeof n)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);e=n}if(Array.isArray(e))return t.map(i=>e);{const i=[];for(const s of t){let r=e.hasOwnProperty(s)?e[s]:[];Array.isArray(r)||(r=[r]),i.push(r)}return i}}(e.metrics,this.outputNames),o=(a,l,c)=>{this.outputNames.length>1&&(l=this.outputNames[a]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([c,a])};md("metric",()=>{for(let a=0;a<this.outputs.length;++a)-1===s.indexOf(a)&&(u=>{let h,f,p;for(const g of u){if("string"==typeof g&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(g)){const b=this.internalOutputShapes[a];let _;1===b[b.length-1]||this.lossFunctions[a]===aw?-1!==["accuracy","acc"].indexOf(g)?f=F6:-1!==["crossentropy","ce"].indexOf(g)&&(f=bTe):this.lossFunctions[a]===ow?-1!==["accuracy","acc"].indexOf(g)?f=_Te:-1!==["crossentropy","ce"].indexOf(g)&&(f=V6):-1!==["accuracy","acc"].indexOf(g)?f=L6:-1!==["crossentropy","ce"].indexOf(g)&&(f=B6),-1!==["accuracy","acc"].indexOf(g)?_="acc":-1!==["crossentropy","ce"].indexOf(g)&&(_="ce"),p=f,h=""+_}else p=ETe(g),h=""+uw(g);let m;md(h,()=>{m=p}),o(a,h,m)}})(r[a])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,i,s={}){const r=null==s.batchSize?32:s.batchSize;eP(r);const a=this.standardizeUserDataXY(e,i,!0,r);try{const l=a[0].concat(a[1]);return this.makeTestFunction(),or(this.testLoop(this.testFunction,l,r,s.verbose,s.steps))}finally{ta(a[0],e),ta(a[1],i)}}evaluateDataset(e,i){var s=this;return Q(function*(){return s.makeTestFunction(),function VTe(n,t,e){return JM.apply(this,arguments)}(s,e,i)})()}checkNumSamples(e,i,s,r="steps"){let o;if(null!=s){if(o=null,null!=i)throw new L(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${i}`)}else{if(null==e)throw new L(`Either the input data should have a defined shape, or ${r} shoud be specified.`);o=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return o}execute(e,i){if(Array.isArray(i)&&0===i.length)throw new L("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(i),o=this.retrieveSymbolicTensors(s?i:[i]),a=new Vc;if(e instanceof Bi&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new L(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)a.add(this.inputs[c],e[c])}else for(const c of this.inputs){const u=e[c.name];if(null==u)throw new L(`No value is provided for the model's input ${c.name}`);a.add(c,u)}const l=Gb(o,a);return s?l:l[0]}retrieveSymbolicTensors(e){const i=hd(null,e.length);let s=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],a=o.map(l=>l.name);for(let l=0;l<e.length;++l){const c=a.indexOf(e[l]);if(-1!==c&&(i[l]=o[c],s--),0===s)break}if(0===s)break}if(s>0){const r=[];throw i.forEach((o,a)=>{null==o&&r.push(e[a])}),new L(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return i}predictLoop(e,i=32,s=!1){return Y(()=>{const r=this.checkNumSamples(e);if(s)throw new _t("Verbose predictLoop() is not implemented yet.");const o=nP(r,i),a=this.outputs.map(l=>[]);for(let l=0;l<o.length;++l)Y(()=>{const h=Xb(e,o[l][0],o[l][1]),f=[];if(Array.isArray(h))for(let g=0;g<h.length;++g)f.push({key:this.inputs[g],value:h[g]});else f.push({key:this.inputs[0],value:h});const p=new Vc(f);return Gb(this.outputs,p)}).forEach((u,d)=>a[d].push(u));return or(a.map(l=>ws(l,0)))})}predict(e,i={}){const s=Y6(e);J6(s,this.inputNames,this.feedInputShapes,!1);try{const r=null==i.batchSize?32:i.batchSize;return eP(r),this.predictLoop(s,r)}finally{ta(s,e)}}predictOnBatch(e){J6(e,this.inputNames,this.feedInputShapes,!0);const i=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,i)}standardizeUserDataXY(e,i,s=!0,r){if(null==this.optimizer_)throw new xo("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let a=0;a<this.feedOutputShapes.length;++a){const l=this.feedOutputShapes[a];o.push(this.feedLossFns[a]===ow?l.slice(0,l.length-1).concat([1]):l)}if(function UTe(n,t,e){const i=Lc(n.map(r=>r.shape[0]));i.sort();const s=Lc(t.map(r=>r.shape[0]));if(s.sort(),i.length>1)throw new L(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(r=>r.shape))}`);if(s.length>1)throw new L(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(r=>r.shape))}`);if(i.length>0&&s.length>0&&!tn(i,s))throw new L(`Input Tensors should have the same number of samples as target Tensors. Found ${i[0]} input sample(s) and ${s[0]} target sample(s).`)}(e=Q6(e,this.feedInputNames,this.feedInputShapes,!1,"input"),i=Q6(i,this.feedOutputNames,o,!1,"target")),function WTe(n,t,e){const i=[rw,aw,Kb];for(let s=0;s<n.length;++s){const r=n[s],o=t[s],a=e[s];if(null!=o){if(o===Kb&&1===r.shape[r.shape.length-1])throw new L(`You are passing a target array of shape ${r.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==i.indexOf(o)){const l=r.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const h=c[u];if(null!=h&&l[u]!==h)throw new L(`A target Tensor with shape ${r.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(i,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&e[0].shape[0]%r!=0)throw new L(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,i]}standardizeUserData(e,i,s,r,o=!0,a){var l=this;return Q(function*(){const[c,u]=l.standardizeUserDataXY(e,i,o,a);if(null!=s)throw new Error("sample weight is not supported yet.");let d=null;if(null!=r){const h=j6(r,l.outputNames);d=[];for(let f=0;f<h.length;++f)d.push(yield G6(u[f],null,h[f]))}return[c,u,d]})()}testLoop(e,i,s,r=0,o){return Y(()=>{const a=this.checkNumSamples(i,s,o,"steps"),l=[];if(r>0)throw new _t("Verbose mode is not implemented yet.");if(null!=o)throw new _t("steps mode in testLoop() is not implemented yet");{const c=nP(a,s),u=rr(Zo(0,a));for(let d=0;d<c.length;++d){const h=c[d][0],f=c[d][1],p=gd(u,h,f-h),g=tP(i,p),m=e(g);if(0===d)for(let b=0;b<m.length;++b)l.push(ct(0));for(let b=0;b<m.length;++b)l[b]=ge(l[b],F(f-h,m[b]))}for(let d=0;d<l.length;++d)l[d]=qe(l[d],a)}return l})}getDedupedMetricsNames(){const e=this.metricsNames,i=[];for(let s=0;s<e.length;++s){const r=e[s];let o=r;r6(e,r)>1&&(o+=`_${r6(e.slice(0,s),r)}`),i.push(o)}return i}makeTrainFunction(){return e=>{const i=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],c=this.collectedTrainableWeights.map(h=>h.read());return[this.optimizer_.minimize(()=>{const h=[];for(let m=0;m<this.inputs.length;++m)h.push({key:this.inputs[m],value:s[m]});const f=new Vc(h),p=Gb(this.outputs,f,{training:!0});let g;for(let m=0;m<this.lossFunctions.length;++m){let _=(0,this.lossFunctions[m])(r[m],p[m]);null!=o[m]&&(_=RTe(_,o[m]));const y=Ci(_);i.push(y),g=0===m?_:ge(g,_)}for(let m=0;m<this.metricsTensors.length;++m){let b;if(this.outputs.length>1&&m<this.outputs.length)b=i[m];else{const y=this.metricsTensors[m][1];b=Ci((0,this.metricsTensors[m][0])(r[y],p[y]))}Ra(b),a.push(b)}return g=Ci(g),this.calculateLosses().forEach(m=>{g=ge(g,m)}),g},!0,c)].concat(a)}}makeTestFunction(){this.testFunction=e=>Y(()=>{const i=[];let s;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let u=0;u<this.inputs.length;++u)a.push({key:this.inputs[u],value:r[u]});const l=new Vc(a),c=Gb(this.outputs,l);for(let u=0;u<this.lossFunctions.length;++u){const h=Ci((0,this.lossFunctions[u])(o[u],c[u]));s=0===u?h:ge(s,h),i.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const h=this.metricsTensors[u][1],f=Ci((0,this.metricsTensors[u][0])(o[h],c[h]));i.push(f)}return i})}fit(e,i,s={}){var r=this;return Q(function*(){if(r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let o,a,l,c,u,d,h,f,p;r.isTraining=!0;try{const g=null==s.batchSize?32:s.batchSize;eP(g);const m=!1,b=yield r.standardizeUserData(e,i,s.sampleWeight,s.classWeight,m,g);o=b[0],a=b[1],p=b[2];let y,_=!1;if(null!=s.validationData&&s.validationData.length>0){if(_=!0,2!==s.validationData.length)throw 3===s.validationData.length?new _t("validationData including sample weights is not supported yet."):new L(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);u=s.validationData[0],d=s.validationData[1];const R=!0,U=yield r.standardizeUserData(u,d,null,null,R,g);h=U[0],f=U[1],y=h.concat(f)}else if(null!=s.validationSplit&&s.validationSplit>0&&s.validationSplit<1){_=!0;const R=Math.floor(o[0].shape[0]*(1-s.validationSplit)),U=o[0].shape[0];h=Xb(o,R,U),l=o,o=Xb(o,0,R),f=Xb(a,R,U),c=a,a=Xb(a,0,R),y=h.concat(f)}else null!=s.validationSteps&&(_=!0);const v=o.concat(a).concat(p);r.checkTrainableWeightsConsistency();const x=r.makeTrainFunction(),S=r.getDedupedMetricsNames();let E,k;_?(r.makeTestFunction(),E=r.testFunction,k=S.slice().concat(S.map(R=>"val_"+R))):(E=null,y=[],k=S.slice());const D=P6(s.callbacks,s.yieldEvery);return yield r.fitLoop(x,v,S,g,s.epochs,s.verbose,D,E,y,s.shuffle,k,s.initialEpoch,null,null)}finally{r.isTraining=!1,ta(o,e),ta(a,i),ta(l,e),ta(c,i),ta(h,u),ta(f,d),null!=p&&It(p)}})()}fitLoop(e,i,s,r,o,a,l,c,u,d,h,f,p,g){var m=this;return Q(function*(){null==r&&(r=32),null==o&&(o=1),null==d&&(d=!0),null==f&&(f=0);let b=!1;if(null!=c&&null!=u&&(b=!0),null!=g&&(b=!0,null==p))throw new L("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const _=m.checkNumSamples(i,r,p,"steps_per_epoch");let y;null!=_&&(y=Zo(0,_)),null==a&&(a=1);const{callbackList:v,history:x}=R6(l,a,o,f,_,p,r,b,h);v.setModel(m),m.history=x,yield v.onTrainBegin(),m.stopTraining_=!1;for(let S=f;S<o;++S){yield v.onEpochBegin(S);const E={};if(null!=p)throw new _t("stepsPerEpoch mode is not implemented yet.");{if("batch"===d)throw new _t("batch shuffling is not implemneted yet");d&&oH(y);const k=rr(y),D=nP(_,r);for(let M=0;M<D.length;++M){const R={};if(yield v.onBatchBegin(M,R),Y(()=>{const U=D[M][0],X=D[M][1],ee=gd(k,U,X-U);R.batch=M,R.size=X-U;const K=tP(i,ee),O=e(K);for(let z=0;z<s.length;++z){const q=O[z];R[s[z]]=q,Ra(q)}if(M===D.length-1&&b){const z=m.testLoop(c,u,r);for(let B=0;B<s.length;++B){const q=s[B],se=z[B];Ra(se),E["val_"+q]=se}}}),yield v.onBatchEnd(M,R),M6(R),m.stopTraining_)break}k.dispose()}if(yield v.onEpochEnd(S,E),m.stopTraining_)break}return yield v.onTrainEnd(),yield m.history.syncData(),m.history})()}fitDataset(e,i){var s=this;return Q(function*(){return function LTe(n,t,e){return QM.apply(this,arguments)}(s,e,i)})()}trainOnBatch(e,i){var s=this;return Q(function*(){const r=yield s.standardizeUserData(e,i),o=r[0],a=r[1],c=s.makeTrainFunction()(o.concat(a)),u=[];for(const d of c){const h=yield d.data();u.push(h[0])}return It(c),ta(r[0],e),ta(r[1],i),or(u)})()}getNamedWeights(e){const i=[],s=null!=e&&e.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let a=0;a<r.length;++a)s&&!r[a].trainable||i.push({name:r[a].originalName,tensor:o[a]});return i}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const i=eA().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=i-eA().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=Ol(this.loss);else if(Array.isArray(this.loss)){for(const i of this.loss)if("string"!=typeof i)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(i=>Ol(i))}else{const i=Object.keys(this.loss);e={};const s=this.loss;for(const r of i){if("string"!=typeof s[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=Ol(s[r])}}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[Ol(uw(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Ol(uw(e)));{const e={};for(const i in this.metrics)e[i]=Ol(uw(this.metrics[i]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const s=Wa(hw(e.optimizer_config));let r,o;if("string"==typeof e.loss)r=fd(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(a=>fd(a));else if(null!=e.loss){r={};for(const a in e.loss)r[a]=fd(e.loss[a])}if(Array.isArray(e.metrics))o=e.metrics.map(a=>fd(a));else if(null!=e.metrics){o={};for(const a in e.metrics)o[a]=fd(e.metrics[a])}this.compile({loss:r,metrics:o,optimizer:s})}save(e,i){var s=this;return Q(function*(){if("string"==typeof e){const d=(n=>ei.getSaveHandlers(n))(e);if(0===d.length)throw new L(`Cannot find any save handlers for URL '${e}'`);if(d.length>1)throw new L(`Found more than one (${d.length}) save handlers for URL '${e}'`);e=d[0]}if(null==e.save)throw new L("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=yield QH(s.getNamedWeights(i)),c={modelTopology:s.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v4.22.0",convertedBy:null};if(null!=i&&i.includeOptimizer&&null!=s.optimizer){c.trainingConfig=s.getTrainingConfig();const d="optimizer",{data:h,specs:f}=yield QH(yield s.optimizer.getWeights(),d);r.specs.push(...f),r.data=function $0e(n){return Ma.join(n)}([r.data,h])}return null!=s.userDefinedMetadata&&(U6(s.userDefinedMetadata,s.name,!0),c.userDefinedMetadata=s.userDefinedMetadata),c.weightData=r.data,c.weightSpecs=r.specs,e.save(c)})()}setUserDefinedMetadata(e){U6(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}return n.className="Model",n})();function rP(){return rP=Q(function*(n,t){if(null==t&&(t={}),"string"==typeof n){const e=j0e(n,t);if(0===e.length)e.push(function Rve(n,t){return kj(n,t)}(n,t));else if(e.length>1)throw new L(`Found more than one (${e.length}) load handlers for URL '${n}'`);n=e[0]}return function qTe(n,t,e){return oP.apply(this,arguments)}(n,void 0,t)}),rP.apply(this,arguments)}function oP(){return(oP=Q(function*(n,t,e){if(null==e&&(e={}),null==n.load)throw new L("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const i=yield n.load();let s=i.modelTopology;null!=s.model_config&&(s=s.model_config);const r=null==e.strict||e.strict,o=null!=i.weightData&&null!=i.weightSpecs&&r,a=Wa(hw(s),t,o),l=i.trainingConfig;if(null!=l&&a.loadTrainingConfig(l),null!=i.userDefinedMetadata&&a.setUserDefinedMetadata(i.userDefinedMetadata),null!=i.weightData){if(null==i.weightSpecs)throw new L("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=function KTe(n,t){const e=function JH(n,t){const e=new Ma(n),i={};let s=0;for(const r of t){const o=P0e(r,(a,l)=>e.slice(s+a,s+l));i[r.name]=ej(r,e.slice(s,s+o)),s+=o}return i}(n,t),i={},s=[];return t.forEach(r=>{"optimizer"===r.group?s.push({name:r.name,tensor:e[r.name]}):i[r.name]=e[r.name]}),{modelWeights:i,optimizerWeights:s}}(i.weightData,i.weightSpecs);a.loadWeights(c,r),null!=a.optimizer&&u.length>0&&(yield a.optimizer.setWeights(u)),It(c),It(u.map(d=>d.tensor))}return a})).apply(this,arguments)}pe(Hf),pe((()=>{class n extends Hf{}return n.className="Functional",n})()),pe((()=>{class n extends Hf{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:KC("sequential_"),null!=e.layers)for(const i of e.layers)this.add(i)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new L(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const i=e instanceof n||e instanceof Hf;let s;if(i){if(s=e,1!==s.outputs.length)throw new L("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==s.inputs.length)throw new L("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new L("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=function Kke(n){if(null==n.batchShape&&null==n.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=n.batchShape&&null!=n.shape)throw new L("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=n.batchShape;null!=n.shape&&null==t&&(t=[null].concat(n.shape));let e=n.dtype;return null==e&&(e="float32"),new tw({batchInputShape:t,name:n.name,dtype:e,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(i)this.outputs=s.outputs,this.inputs=s.inputs;else{if(1!==e.inboundNodes.length)throw new L(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new L("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=T6(this.outputs[0])}this.inboundNodes=[],new ew({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:hd(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,i){return null==this.model&&this.build(),this.model.call(e,i)}build(e){if(Xt(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Hf({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,i,s=console.log){this.built||this.build(),super.summary(e,i,s)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,i,s={}){if(!this.built)throw new xo("The model needs to be compiled before being used.");return this.model.evaluate(e,i,s)}evaluateDataset(e,i){var s=this;return Q(function*(){if(!s.built)throw new xo("The model needs to be compiled before being used.");return s.model.evaluateDataset(e,i)})()}predict(e,i={}){return null==this.model&&this.build(),this.model.predict(e,i)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}fit(e,i,s={}){var r=this;return Q(function*(){if(!r.built)throw new xo("The model needs to be compiled before being used.");return r.model.fit(e,i,s)})()}fitDataset(e,i){var s=this;return Q(function*(){if(!s.built)throw new xo("The model needs to be compiled before being used.");return s.model.fitDataset(e,i)})()}trainOnBatch(e,i){var s=this;return Q(function*(){return s.model.trainOnBatch(e,i)})()}static fromConfig(e,i,s={},r=!1){let o,a={};if(i instanceof Array){if(null==i[0].className||"Merge"===i[0].className)throw new L("Legacy serialization format not supported yet.");o=i}else T(null!=i.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=i.layers,delete i.layers,a=i;const l=new e(a);if(!(l instanceof n))throw new _t(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(const c of o){const d=Wa(c,void 0,r);r&&d.setFastWeightInitDuringBuild(!0),l.add(d)}return l}set stopTraining(e){if(null==this.model)throw new L("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new L("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const i of this.layers){const s={};s.className=i.getClassName(),s.config=i.getConfig(),e.push(s)}return{name:this.name,layers:e}}}return n.className="Sequential",n})());class Ss extends Pf{getConfig(){return{}}}pe((()=>{class n extends Ss{apply(e,i=1){return function Pke(n,t=1){if(1!==t)throw new _t(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return NC(n)}(e,i)}}return n.className="elu",n})()),pe((()=>{class n extends Ss{apply(e){return Kj(e)}}return n.className="selu",n})()),pe((()=>{class n extends Ss{apply(e){return Dl(e)}}return n.className="relu",n})()),pe((()=>{class n extends Ss{apply(e){return Y(()=>Ff(6,Dl(e)))}}return n.className="relu6",n})()),pe((()=>{class n extends Ss{apply(e){return e}}return n.className="linear",n})()),pe((()=>{class n extends Ss{apply(e){return Lf(e)}}return n.className="sigmoid",n})()),pe((()=>{class n extends Ss{apply(e){return function Oke(n){return Y(()=>{const t=ge(.5,F(.2,n));return $r(t,0,1)})}(e)}}return n.className="hardSigmoid",n})()),pe((()=>{class n extends Ss{apply(e){return Pb(e)}}return n.className="softplus",n})()),pe((()=>{class n extends Ss{apply(e){return function Rke(n){return Y(()=>qe(n,ge(Ji(n),1)))}(e)}}return n.className="softsign",n})()),pe((()=>{class n extends Ss{apply(e){return RC(e)}}return n.className="tanh",n})());let e8=(()=>{class n extends Ss{apply(e,i=-1){return qA(e,i)}}return n.className="softmax",n})();function Uc(n){return n.getClassName()}function aP(n,t={}){return zb(n,go.getMap().classNameMap,t,"activation")}function Wc(n){if(null==n){return aP({className:"linear",config:{}})}if("string"==typeof n){const t={};return t.className=n,t.config={},aP(t)}return n instanceof Ss?n:aP(n)}pe(e8),pe((()=>{class n extends Ss{apply(e,i=-1){return jj(e,i)}}return n.className="logSoftmax",n})()),pe((()=>{class n extends Ss{apply(e){return Y(()=>Y(()=>{const i=Math.sqrt(2),s=F(.5,ge(1,Wj(qe(e,i))));return F(e,s)}))}}return n.className="gelu",n})()),pe((()=>{class n extends Ss{apply(e){return Y(()=>F(.5,F(e,ge(1,RC(F(Cs(qe(2,Math.PI)),ge(e,F(.044715,rd(e,3)))))))))}}return n.className="gelu_new",n})()),pe((()=>{class n extends Ss{apply(e){return Y(()=>F(e,RC(Pb(e))))}}return n.className="mish",n})()),pe((()=>{class n extends Ss{apply(e,i=1){return Y(()=>F(Lf(F(e,i)),e))}}return n.className="swish",n})());class t8 extends Pf{}pe((()=>{class n extends t8{constructor(e){super(),function lP(n){if(null!=n&&"object"!=typeof n)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return Y(()=>{let i=ns([1]);return this.hasL1&&(i=ge(i,We(F(this.l1,Ji(e))))),this.hasL2&&(i=ge(i,We(F(this.l2,Hb(e))))),j(i,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,i){return new e({l1:i.l1,l2:i.l2})}}return n.className="L1L2",n})());const n8={l1l2:"L1L2"};function wn(n){return PM(n)}function i8(n,t={}){return zb(n,go.getMap().classNameMap,t,"regularizer")}function Gn(n){return null==n?null:"string"==typeof n?i8({className:n in n8?n8[n]:n,config:{}}):n instanceof t8?n:i8(n)}function jf(n,t,e){if("number"==typeof n)return hd(n,t);if(n.length!==t)throw new L(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${n.length} elements.`);for(let i=0;i<t;++i){const s=n[i];if(!kke(s))throw new L(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(n)} including a non-integer number ${s}`)}return n}function na(n,t,e,i,s=1){if(null==n)return n;let o;return o="same"===e?n:n-(t+(t-1)*(s-1))+1,Math.floor((o+i-1)/i)}function Ha(n,t,e,i){if(null==n)return null;if("valid"===i)n=n*t+Bc([e-t,0]);else{if("same"!==i)throw new L(`Unsupport padding mode: ${i}.`);n*=t}return n}function uP(n,t){return Y(()=>(wi(t),"channelsFirst"===t?jt(n,[0,2,3,1]):n))}function s8(n,t){return Y(()=>(wi(t),"channelsFirst"===t?jt(n,[0,2,3,4,1]):n))}function dP(n,t,e,i=[1,1],s="valid",r,o,a=null){return Y(()=>{if(null==r&&(r="channelsLast"),wi(r),3!==n.rank&&4!==n.rank)throw new L(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(3!==t.rank&&4!==t.rank)throw new L(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=uP(n,r);if("causal"===s)throw new _t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=XCe({x:l,filter:t,strides:i,pad:"same"===s?"same":"valid",dilations:o,dataFormat:"NHWC",bias:e,activation:a}),"channelsFirst"===r&&(l=jt(l,[0,3,1,2])),l})}pe((()=>{class n extends Nt{constructor(e){super(e??{}),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,i){e=st(e);let s=Dl(e);return null!=this.maxValue&&(s=$r(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},i=super.getConfig();return Object.assign(e,i),e}}return n.className="ReLU",n})()),pe((()=>{class n extends Nt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,i){const s=st(e);return RA(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},i=super.getConfig();return Object.assign(e,i),e}}return n.className="LeakyReLU",n})()),pe((()=>{class n extends Nt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=jn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Gn(e.alphaRegularizer),this.alphaConstraint=Hi(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new L(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`);this.sharedAxes=[e.sharedAxes]}}build(e){const i=(e=Xt(e)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)i[r-1]=1;this.alpha=this.addWeight("alpha",i,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(null!=this.sharedAxes)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Ui({ndim:e.length,axes:s})],this.built=!0}call(e,i){return e=st(e),zA(e,this.alpha.read())}getConfig(){const e={alphaInitializer:ni(this.alphaInitializer),alphaRegularizer:wn(this.alphaRegularizer),alphaConstraint:Wi(this.alphaConstraint),sharedAxes:this.sharedAxes},i=super.getConfig();return Object.assign(e,i),e}}return n.className="PReLU",n})()),pe((()=>{class n extends Nt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new _t(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,i){const s=st(e);return NC(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},i=super.getConfig();return Object.assign(e,i),e}}return n.className="ELU",n})()),pe((()=>{class n extends Nt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,i){const s=st(e);return F(s,Te(Vr(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},i=super.getConfig();return Object.assign(e,i),e}}return n.className="ThresholdedReLU",n})()),pe((()=>{class n extends Nt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new e8).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,i){return Y(()=>{let s=st(e);const r=i.mask;if(null!=r){const o=F(Be(Tl(s.shape),Te(r,s.dtype)),ct(-1e9));s=ge(s,o)}return this.axis instanceof Array?this.axis.length>1?Br(Be(s,LA(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Softmax",n})());class fw extends Nt{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",fw.verifyArgs(e),this.rank=t,is(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new _t(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=jf(e.kernelSize,t,"kernelSize"),this.strides=jf(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,Wr(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wi(this.dataFormat),this.activation=Wc(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Hi(e.biasConstraint),this.biasRegularizer=Gn(e.biasRegularizer),this.activityRegularizer=Gn(e.activityRegularizer),this.dilationRate=jf(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new L(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new L(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new L(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(t){if(Ur("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!OM(t.kernelSize,"number",1,3))throw new L(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Uc(this.activation),useBias:this.useBias,biasInitializer:ni(this.biasInitializer),biasRegularizer:wn(this.biasRegularizer),activityRegularizer:wn(this.activityRegularizer),biasConstraint:Wi(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class Gf extends fw{constructor(t,e){super(t,e),this.kernel=null,Gf.verifyArgs(e),this.filters=e.filters,is(this.filters,"filters"),this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Hi(e.kernelConstraint),this.kernelRegularizer=Gn(e.kernelRegularizer)}build(t){t=Xt(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new L(`The channel dimension of the input should be defined. Found ${t[e]}`);const i=t[e],s=this.kernelSize.concat([i,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:i}}],this.built=!0}call(t,e){return Y(()=>{let i;t=st(t);const s=null==this.bias?null:this.bias.read(),r=a6(this.activation.getClassName());if(null!=r&&2===this.rank)i=dP(t,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)i=function r8(n,t,e,i=1,s="valid",r,o=1){return Y(()=>{if(null==r&&(r="channelsLast"),wi(r),3!==n.shape.length)throw new L(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(3!==t.shape.length)throw new L(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(null!=e&&1!==e.shape.length)throw new L(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if("channelsFirst"===r&&(n=jt(n,[0,2,1])),"causal"===s)throw new _t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Bj(n,t,i,"same"===s?"same":"valid","NWC",o);return null!=e&&(a=Jo(a,e)),a})}(t,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)i=dP(t,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new _t("convolutions greater than 3D are not implemented yet.");i=function o8(n,t,e,i=[1,1,1],s="valid",r,o){return Y(()=>{if(null==r&&(r="channelsLast"),wi(r),4!==n.rank&&5!==n.rank)throw new L(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(4!==t.rank&&5!==t.rank)throw new L(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=s8(n,r);if("causal"===s)throw new _t("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=wxe(a,t,i,"same"===s?"same":"valid","NDHWC",o),null!=e&&(a=Jo(a,e)),"channelsFirst"===r&&(a=jt(a,[0,4,1,2,3])),a})}(t,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(i=this.activation.apply(i))}return i})}computeOutputShape(t){t=Xt(t);const e=[],i="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let r=0;r<i.length;++r){const o=na(i[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(o)}let s=[t[0]];return"channelsLast"===this.dataFormat?(s=s.concat(e),s.push(this.filters)):(s.push(this.filters),s=s.concat(e)),s}getConfig(){const t={filters:this.filters,kernelInitializer:ni(this.kernelInitializer),kernelRegularizer:wn(this.kernelRegularizer),kernelConstraint:Wi(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new L(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}let a8=(()=>{class n extends Gf{constructor(e){super(2,e),n.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!OM(e.kernelSize,"number",1,2))throw new L(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv2D",n})();pe(a8);let l8=(()=>{class n extends Gf{constructor(e){super(3,e),n.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new L(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv3D",n})();pe(l8),pe((()=>{class n extends a8{constructor(e){if(super(e),this.inputSpec=[new Ui({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new L(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(4!==(e=Xt(e)).length)throw new L("Input should have rank 4; Received input shape: "+JSON.stringify(e));const i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i])throw new L("The channel dimension of the inputs should be defined. Found `None`.");const s=e[i],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ui({ndim:4,axes:{[i]:s}})],this.built=!0}call(e,i){return Y(()=>{let s=st(e);if(4!==s.shape.length)throw new L(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape;let a,l;"channelsFirst"===this.dataFormat?(a=2,l=3):(a=1,l=2);const u=r[l],h=this.kernelSize[1],p=this.strides[1],b=[r[0],Ha(r[a],this.strides[0],this.kernelSize[0],this.padding),Ha(u,p,h,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(s=jt(s,[0,2,3,1]));let _=Vj(s,this.kernel.read(),b,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(_=jt(_,[0,3,1,2])),null!=this.bias&&(_=Jo(_,this.bias.read(),this.dataFormat)),null!=this.activation&&(_=this.activation.apply(_)),_})}computeOutputShape(e){const i=(e=Xt(e)).slice();let s,r,o;"channelsFirst"===this.dataFormat?(s=1,r=2,o=3):(s=3,r=1,o=2);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.strides[0],u=this.strides[1];return i[s]=this.filters,i[r]=Ha(i[r],c,a,this.padding),i[o]=Ha(i[o],u,l,this.padding),i}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}return n.className="Conv2DTranspose",n})()),pe((()=>{class n extends l8{constructor(e){if(super(e),this.inputSpec=[new Ui({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new L(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(5!==(e=Xt(e)).length)throw new L("Input should have rank 5; Received input shape: "+JSON.stringify(e));const i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i])throw new L("The channel dimension of the inputs should be defined. Found `None`.");const s=e[i],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ui({ndim:5,axes:{[i]:s}})],this.built=!0}call(e,i){return Y(()=>{let s=st(e);if(5!==s.shape.length)throw new L(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape;let a,l,c;"channelsFirst"===this.dataFormat?(c=2,a=3,l=4):(c=1,a=2,l=3);const d=r[a],h=r[l],p=this.kernelSize[1],g=this.kernelSize[2],b=this.strides[1],_=this.strides[2],S=[r[0],Ha(r[c],this.strides[0],this.kernelSize[0],this.padding),Ha(d,b,p,this.padding),Ha(h,_,g,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(s=jt(s,[0,2,3,4,1]));let E=Exe(s,this.kernel.read(),S,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(E=jt(E,[0,4,1,2,3])),null!==this.bias&&(E=Jo(E,this.bias.read(),this.dataFormat)),null!==this.activation&&(E=this.activation.apply(E)),E})}computeOutputShape(e){const i=(e=Xt(e)).slice();let s,r,o,a;"channelsFirst"===this.dataFormat?(s=1,r=2,o=3,a=4):(s=4,r=1,o=2,a=3);const l=this.kernelSize[0],c=this.kernelSize[1],u=this.kernelSize[2],d=this.strides[0],h=this.strides[1],f=this.strides[2];return i[s]=this.filters,i[r]=Ha(i[r],d,l,this.padding),i[o]=Ha(i[o],h,c,this.padding),i[a]=Ha(i[a],f,u,this.padding),i}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}return n.className="Conv3DTranspose",n})());let XTe=(()=>{class n extends Gf{constructor(e,i){if(super(e,i),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==i.filters)throw new L("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=i.kernelInitializer||null!=i.kernelRegularizer||null!=i.kernelConstraint)throw new L("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=i.padding&&"same"!==i.padding&&"valid"!==i.padding)throw new L(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(i.padding)}`);this.depthMultiplier=null==i.depthMultiplier?1:i.depthMultiplier,this.depthwiseInitializer=jn(i.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Gn(i.depthwiseRegularizer),this.depthwiseConstraint=Hi(i.depthwiseConstraint),this.pointwiseInitializer=jn(i.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Gn(i.pointwiseRegularizer),this.pointwiseConstraint=Hi(i.pointwiseConstraint)}build(e){if((e=Xt(e)).length<this.rank+2)throw new L(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i]||e[i]<0)throw new L(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[i])}`);const s=e[i],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let l=0;l<this.rank;++l)o.push(1);o.push(s*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):null,this.inputSpec=[new Ui({ndim:this.rank+2,axes:{[i]:s}})],this.built=!0}call(e,i){return Y(()=>{let s;if(e=st(e),1===this.rank)throw new _t("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=jt(e,[0,2,3,1])),s=Xj(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Jo(s,this.bias.read(),this.dataFormat)),null!=this.activation&&(s=this.activation.apply(s)),"channelsFirst"===this.dataFormat&&(s=jt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=ni(this.depthwiseInitializer),e.pointwiseInitializer=ni(this.pointwiseInitializer),e.depthwiseRegularizer=wn(this.depthwiseRegularizer),e.pointwiseRegularizer=wn(this.pointwiseRegularizer),e.depthwiseConstraint=Wi(this.depthwiseConstraint),e.pointwiseConstraint=Wi(this.pointwiseConstraint),e}}return n.className="SeparableConv",n})();function c8(n,t,e,i){if(Array.isArray(n)){if(null!=t||null!=e)throw new L("When inputs is an array, neither initialState or constants should be provided");null!=i&&(e=n.slice(n.length-i,n.length),n=n.slice(0,n.length-i)),n.length>1&&(t=n.slice(1,n.length)),n=n[0]}function s(r){return null==r||Array.isArray(r)?r:[r]}return{inputs:n,initialState:t=s(t),constants:e=s(e)}}function u8(n,t,e,i=!1,s,r,o=!1,a=!1){return Y(()=>{const l=t.shape.length;if(l<3)throw new L(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Zo(2,l));if(t=jt(t,c),null!=r)throw new _t("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=s&&((s=Te(Te(s,"bool"),"float32")).rank===l-1&&(s=sr(s,-1)),s=jt(s,c)),i&&(t=cd(t,0),null!=s&&(s=cd(s,0)));const u=[];let d,h=e;const f=t.shape[0],p=ud(t);let g,m;null!=s&&(g=ud(s));for(let b=0;b<f;++b){const _=p[b],y=Y(()=>n(_,h));if(null==s)d=y[0],h=y[1];else{const v=Y(()=>{const x=g[b],S=Be(yo(x),x);return{output:ge(F(y[0],x),F(h[0],S)),newStates:h.map((D,M)=>ge(F(y[1][M],x),F(D,S)))}});d=v.output,h=v.newStates}a&&u.push(d)}return a&&(m=Nl(u,1)),[d,m,h]})}pe((()=>{class n extends XTe{constructor(e){super(2,e)}}return n.className="SeparableConv2D",n})()),pe((()=>{class n extends Gf{constructor(e){super(1,e),n.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!OM(e.kernelSize,"number",1,1))throw new L(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv1D",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,i){return Y(()=>{if(e=st(e),"channelsLast"===this.dataFormat){const s=YC(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return YC(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const s=YC(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return YC(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Cropping2D",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wi(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,function Ske(n){pd(vke,"InterpolationFormat",n)}(this.interpolation)}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],null==e[2]?null:this.size[0]*e[2],null==e[3]?null:this.size[1]*e[3]]:[e[0],null==e[1]?null:this.size[0]*e[1],null==e[2]?null:this.size[1]*e[2],e[3]]}call(e,i){return Y(()=>{let s=st(e);const r=s.shape;if("channelsFirst"===this.dataFormat){s=jt(s,[0,2,3,1]);const o=this.size[0]*r[2],a=this.size[1]*r[3],l="nearest"===this.interpolation?Ml.resizeNearestNeighbor(s,[o,a]):Ml.resizeBilinear(s,[o,a]);return jt(l,[0,3,1,2])}{const o=this.size[0]*r[1],a=this.size[1]*r[2];return"nearest"===this.interpolation?Ml.resizeNearestNeighbor(s,[o,a]):Ml.resizeBilinear(s,[o,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},i=super.getConfig();return Object.assign(e,i),e}}return n.className="UpSampling2D",n})()),pe((()=>{class n extends fw{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=jn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Hi(e.depthwiseConstraint),this.depthwiseRegularizer=Gn(e.depthwiseRegularizer)}build(e){if((e=Xt(e)).length<4)throw new L(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const i="channelsFirst"===this.dataFormat?1:3;if(null==e[i]||e[i]<0)throw new L(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[i]}).`);const s=e[i];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,i){return Y(()=>{let s=function YTe(n,t,e=[1,1],i="valid",s,r){return Y(()=>{null==s&&(s="channelsLast"),wi(s);let o=uP(n,s);if(4!==n.rank)throw new L(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(4!==t.rank)throw new L(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=DC(o,t,e,"same"===i?"same":"valid","NHWC",r),"channelsFirst"===s&&(o=jt(o,[0,3,1,2])),o})}(e=st(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Jo(s,this.bias.read(),this.dataFormat)),null!=this.activation&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Xt(e);const s="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=na("channelsFirst"===this.dataFormat?e[2]:e[1],this.kernelSize[0],this.padding,this.strides[0]),a=na(s,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,o,a]:[e[0],o,a,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=ni(this.depthwiseInitializer),e.depthwiseRegularizer=wn(this.depthwiseRegularizer),e.depthwiseConstraint=Wi(this.depthwiseRegularizer),e}}return n.className="DepthwiseConv2D",n})());let Yb=(()=>{class n extends Nt{constructor(e){let i;if(super(e),null==e.cell)throw new L("cell property is missing for the constructor of RNN.");if(i=Array.isArray(e.cell)?new f8({cells:e.cell}):e.cell,null==i.stateSize)throw new L("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=i,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new Ui({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?Zo(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(i=>null):this.states_}setStates(e){this.states_=e}computeOutputShape(e){VM(e)&&(e=e[0]);let i=this.cell.stateSize;Array.isArray(i)||(i=[i]);const s=i[0];let r;if(r=this.returnSequences?[e[0],e[1],s]:[e[0],s],this.returnState){const o=[];for(const a of i)o.push([e[0],a]);return[r].concat(o)}return r}computeMask(e,i){return Y(()=>{Array.isArray(i)&&(i=i[0]);const s=this.returnSequences?i:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}return s})}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,i=[];for(let s=0;s<e;++s)i.push(null);return i}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new _t("Constants support is not implemented in RNN yet.");VM(e)&&(e=e[0]);const s=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Ui({shape:[s,null,...r]});const o=[e[0]].concat(e.slice(2));let a;if(this.cell.build(o),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!tn(this.stateSpec.map(l=>l.shape[l.shape.length-1]),a))throw new L(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(l=>new Ui({shape:[null,l]}));this.stateful&&this.resetStates()}resetStates(e,i=!1){Y(()=>{if(!this.stateful)throw new $a("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(null==s)throw new L("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>ns([s,r])):[ns([s,this.cell.stateSize])];else if(null==e)It(this.states_),null!=this.keptStates&&(It(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>ns([s,r])):this.states_[0]=ns([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new L(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);!0===i?this.keptStates.push(this.states_.slice()):It(this.states_);for(let r=0;r<this.states_.length;++r){const o=e[r],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,l=[s,a];if(!tn(o.shape,l))throw new L(`State ${r} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>Ra(r.clone()))})}apply(e,i){let s=null==i?null:i.initialState,r=null==i?null:i.constants;null==i&&(i={});const o=c8(e,s,r,this.numConstants);e=o.inputs,s=o.initialState,r=o.constants;let a=[],l=[];if(null!=s){i.initialState=s,a=a.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Ui({shape:u.shape}));l=l.concat(this.stateSpec)}if(null!=r&&(i.constants=r,a=a.concat(r),this.numConstants=r.length),a[0]instanceof Ua){const u=[e].concat(a),d=this.inputSpec.concat(l),h=this.inputSpec;this.inputSpec=d;const f=super.apply(u,i);return this.inputSpec=h,f}return super.apply(e,i)}call(e,i){return Y(()=>{const s=null==i?null:i.mask,r=null==i?null:i.training;let o=null==i?null:i.initialState;e=st(e),null==o&&(o=this.stateful?this.states_:this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==a)throw new L(`RNN Layer has ${a} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const l={training:r},u=u8((g,m)=>{const b=this.cell.call([g].concat(m),l);return[b[0],b.slice(1)]},e,o,this.goBackwards,s,null,this.unroll,this.returnSequences),d=u[0],h=u[1],f=u[2];this.stateful&&this.resetStates(f,r);const p=this.returnSequences?h:d;return this.returnState?[p].concat(f):p})}getInitialState(e){return Y(()=>{let i=ns(e.shape);return i=We(i,[1,2]),i=Wb(i),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?$M(i,[1,s]):i):this.cell.stateSize>1?[$M(i,[1,this.cell.stateSize])]:[i]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),i={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(i.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===n.className&&(i.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),i)}static fromConfig(e,i,s={}){const o=Wa(i.cell,s);return new e(Object.assign(i,{cell:o}))}}return n.className="RNN",n})();pe(Yb);class pw extends Nt{}let d8=(()=>{class n extends pw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,is(this.units,"units"),this.activation=Wc(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Gn(e.kernelRegularizer),this.recurrentRegularizer=Gn(e.recurrentRegularizer),this.biasRegularizer=Gn(e.biasRegularizer),this.kernelConstraint=Hi(e.kernelConstraint),this.recurrentConstraint=Hi(e.recurrentConstraint),this.biasConstraint=Hi(e.biasConstraint),this.dropout=Uf([1,Bc([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=Uf([1,Bc([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Xt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,i){return Y(()=>{if(2!==e.length)throw new L(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=null!=i.training&&i.training;let o;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Hc({ones:()=>yo(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Hc({ones:()=>yo(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,l=this.recurrentDropoutMask;o=Va(null!=a?F(e,a):e,this.kernel.read()),null!=this.bias&&(o=Jo(o,this.bias.read())),null!=l&&(s=F(s,l));let c=ge(o,Va(s,this.recurrentKernel.read()));return null!=this.activation&&(c=this.activation.apply(c)),[c,c]})}getConfig(){const e=super.getConfig(),i={units:this.units,activation:Uc(this.activation),useBias:this.useBias,kernelInitializer:ni(this.kernelInitializer),recurrentInitializer:ni(this.recurrentInitializer),biasInitializer:ni(this.biasInitializer),kernelRegularizer:wn(this.kernelRegularizer),recurrentRegularizer:wn(this.recurrentRegularizer),biasRegularizer:wn(this.biasRegularizer),activityRegularizer:wn(this.activityRegularizer),kernelConstraint:Wi(this.kernelConstraint),recurrentConstraint:Wi(this.recurrentConstraint),biasConstraint:Wi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),i)}}return n.className="SimpleRNNCell",n})();pe(d8),pe((()=>{class n extends Yb{constructor(e){e.cell=new d8(e),super(e)}call(e,i){return Y(()=>(null!=this.cell.dropoutMask&&(It(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(It(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==i?null:i.mask,training:null==i?null:i.training,initialState:null==i?null:i.initialState})))}static fromConfig(e,i){return new e(i)}}return n.className="SimpleRNN",n})());let h8=(()=>{class n extends pw{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new L("GRUCell does not support reset_after parameter set to true.");this.units=e.units,is(this.units,"units"),this.activation=Wc(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Wc(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Gn(e.kernelRegularizer),this.recurrentRegularizer=Gn(e.recurrentRegularizer),this.biasRegularizer=Gn(e.biasRegularizer),this.kernelConstraint=Hi(e.kernelConstraint),this.recurrentConstraint=Hi(e.recurrentConstraint),this.biasConstraint=Hi(e.biasConstraint),this.dropout=Uf([1,Bc([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=Uf([1,Bc([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Xt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,i){return Y(()=>{if(2!==e.length)throw new L(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=null!=i.training&&i.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Hc({ones:()=>yo(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Hc({ones:()=>yo(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.recurrentDropoutMask;let l,c,u;0<this.dropout&&this.dropout<1&&(e=F(e,this.dropoutMask[0]));let d=Va(e,this.kernel.read());this.useBias&&(d=Jo(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=F(r,a[0]));const h=this.recurrentKernel.read(),[f,p]=zr(h,[2*this.units,this.units],h.rank-1),g=Va(r,f),[m,b,_]=zr(d,3,d.rank-1),[y,v]=zr(g,2,g.rank-1);l=this.recurrentActivation.apply(ge(m,y)),c=this.recurrentActivation.apply(ge(b,v));const x=Va(F(c,r),p);u=this.activation.apply(ge(_,x));const S=ge(F(l,r),F(ge(1,Hn(l)),u));return[S,S]})}getConfig(){const e=super.getConfig(),i={units:this.units,activation:Uc(this.activation),recurrentActivation:Uc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ni(this.kernelInitializer),recurrentInitializer:ni(this.recurrentInitializer),biasInitializer:ni(this.biasInitializer),kernelRegularizer:wn(this.kernelRegularizer),recurrentRegularizer:wn(this.recurrentRegularizer),biasRegularizer:wn(this.biasRegularizer),activityRegularizer:wn(this.activityRegularizer),kernelConstraint:Wi(this.kernelConstraint),recurrentConstraint:Wi(this.recurrentConstraint),biasConstraint:Wi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),i)}}return n.className="GRUCell",n})();pe(h8),pe((()=>{class n extends Yb{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new h8(e),super(e)}call(e,i){return Y(()=>(null!=this.cell.dropoutMask&&(It(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(It(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==i?null:i.mask,training:null==i?null:i.training,initialState:null==i?null:i.initialState})))}static fromConfig(e,i){return 0===i.implmentation&&(i.implementation=1),new e(i)}}return n.className="GRU",n})());let hP=(()=>{class n extends pw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,is(this.units,"units"),this.activation=Wc(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Wc(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Gn(e.kernelRegularizer),this.recurrentRegularizer=Gn(e.recurrentRegularizer),this.biasRegularizer=Gn(e.biasRegularizer),this.kernelConstraint=Hi(e.kernelConstraint),this.recurrentConstraint=Hi(e.recurrentConstraint),this.biasConstraint=Hi(e.biasConstraint),this.dropout=Uf([1,Bc([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=Uf([1,Bc([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var i;let r;if(e=Xt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,a=this.units;r=new((i=class extends wo{apply(c,u){const d=o.apply([a]),h=(new _6).apply([a]),f=o.apply([2*a]);return m6(m6(d,h),f)}}).className="CustomInit",i)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,i){return Y(()=>{const s=null!=i.training&&i.training;if(3!==e.length)throw new L(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Hc({ones:()=>yo(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Hc({ones:()=>yo(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const l=this.recurrentDropoutMask;let c,u,d,h;0<this.dropout&&this.dropout<1&&(e=F(e,this.dropoutMask[0]));let f=Va(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=F(r,l[0])),f=ge(f,Va(r,this.recurrentKernel.read())),this.useBias&&(f=Jo(f,this.bias.read()));const[p,g,m,b]=zr(f,4,f.rank-1);c=this.recurrentActivation.apply(p),u=this.recurrentActivation.apply(g),d=ge(F(u,o),F(c,this.activation.apply(m))),h=this.recurrentActivation.apply(b);const _=F(h,this.activation.apply(d));return[_,_,d]})}getConfig(){const e=super.getConfig(),i={units:this.units,activation:Uc(this.activation),recurrentActivation:Uc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ni(this.kernelInitializer),recurrentInitializer:ni(this.recurrentInitializer),biasInitializer:ni(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:wn(this.kernelRegularizer),recurrentRegularizer:wn(this.recurrentRegularizer),biasRegularizer:wn(this.biasRegularizer),activityRegularizer:wn(this.activityRegularizer),kernelConstraint:Wi(this.kernelConstraint),recurrentConstraint:Wi(this.recurrentConstraint),biasConstraint:Wi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),i)}}return n.className="LSTMCell",n})();pe(hP),pe((()=>{class n extends Yb{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new hP(e),super(e)}call(e,i){return Y(()=>(null!=this.cell.dropoutMask&&(It(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(It(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==i?null:i.mask,training:null==i?null:i.training,initialState:null==i?null:i.initialState})))}static fromConfig(e,i){return 0===i.implmentation&&(i.implementation=1),new e(i)}}return n.className="LSTM",n})());let f8=(()=>{class n extends pw{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const i of this.cells.slice().reverse())Array.isArray(i.stateSize)?e.push(...i.stateSize):e.push(i.stateSize);return e}call(e,i){return Y(()=>{let s=e.slice(1);const r=[];for(const l of this.cells.slice().reverse())Array.isArray(l.stateSize)?r.push(s.splice(0,l.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let a;for(let l=0;l<this.cells.length;++l){const c=this.cells[l];s=r[l],a=0===l?[e[0]].concat(s):[a[0]].concat(s),a=c.call(a,i),o.push(a.slice(1))}s=[];for(const l of o.slice().reverse())s.push(...l);return[a[0]].concat(s)})}build(e){let i;VM(e)&&(e=e[0]),this.cells.forEach((s,r)=>{md(`RNNCell_${r}`,()=>{s.build(e),i=Array.isArray(s.stateSize)?s.stateSize[0]:s.stateSize,e=[e[0],i]})}),this.built=!0}getConfig(){const e=super.getConfig(),r={cells:this.cells.map(o=>({className:o.getClassName(),config:o.getConfig()}))};return Object.assign(Object.assign({},e),r)}static fromConfig(e,i,s={}){const r=[];for(const o of i.cells)r.push(Wa(o,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const i of this.cells)e.push(...i.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const i of this.cells)e.push(...i.nonTrainableWeights);if(!this.trainable){const i=[];for(const s of this.cells)i.push(...s.trainableWeights);return i.concat(e)}return e}getWeights(){const e=[];for(const i of this.cells)e.push(...i.weights);return zM(e)}setWeights(e){const i=[];for(const s of this.cells){const o=e.splice(s.weights.length);for(let a=0;a<s.weights.length;++a)i.push([s.weights[a],o[a]])}UM(i)}}return n.className="StackedRNNCells",n})();function Hc(n){const{ones:t,rate:e,training:i=!1,count:s=1,dropoutFunc:r}=n,o=()=>null!=r?r(t(),e):b6(t(),e),a=()=>jb(o,t,i);return!s||s<=1?Ra(a().clone()):Array(s).fill(void 0).map(a).map(c=>Ra(c.clone()))}pe(f8);let QTe=(()=>{class n extends Yb{constructor(e){if(e.unroll)throw new _t("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new _t("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Ui({ndim:5})]}call(e,i){return Y(()=>{if(null!=this.cell.dropoutMask&&(It(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(It(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),i&&i.constants)throw new L("ConvRNN2D cell does not support constants");return super.call(e,{mask:null==i?null:i.mask,training:null==i?null:i.training,initialState:null==i?null:i.initialState})})}computeOutputShape(e){let i=this.computeSingleOutputShape(e);return this.returnSequences||(i=[i[0],...i.slice(2)]),this.returnState&&(i=[i,...Array(2).fill([e[0],...i.slice(-3)])]),i}getInitialState(e){return Y(()=>{const{stateSize:i}=this.cell,r=this.computeSingleOutputShape(e.shape),a=ns([r[0],...r.slice(2)]);return Array.isArray(i)?Array(i.length).fill(a):[a]})}resetStates(e,i=!1){Y(()=>{if(!this.stateful)throw new $a("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(null==s[0])throw new L("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(()=>ns(o)):[ns(o)];else if(null==e)It(this.states_),null!=this.keptStates&&(It(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>ns(o)):this.states_[0]=ns(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new L(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);i?this.keptStates.push(this.states_.slice()):It(this.states_);for(let l=0;l<this.states_.length;++l){const c=e[l],u=o;if(!tn(c.shape,u))throw new L(`State ${l} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${c.shape}`);this.states_[l]=c}}this.states_=this.states_.map(l=>Ra(l.clone()))})}computeSingleOutputShape(e){const{dataFormat:i,filters:s,kernelSize:r,padding:o,strides:a,dilationRate:l}=this.cell,c="channelsFirst"===i,d=e[c?4:3],h=na(e[c?3:2],r[0],o,a[0],l[0]),f=na(d,r[1],o,a[1],l[1]);return[...e.slice(0,2),...c?[s,h,f]:[h,f,s]]}}return n.className="ConvRNN2D",n})(),p8=(()=>{class n extends hP{constructor(e){const{filters:i,kernelSize:s,strides:r,padding:o,dataFormat:a,dilationRate:l}=e;super(Object.assign(Object.assign({},e),{units:i})),this.filters=i,is(this.filters,"filters"),this.kernelSize=jf(s,2,"kernelSize"),this.kernelSize.forEach(c=>is(c,"kernelSize")),this.strides=jf(r||1,2,"strides"),this.strides.forEach(c=>is(c,"strides")),this.padding=o||"valid",Wr(this.padding),this.dataFormat=a||"channelsLast",wi(this.dataFormat),this.dilationRate=jf(l||1,2,"dilationRate"),this.dilationRate.forEach(c=>is(c,"dilationRate"))}build(e){var i;e=Xt(e);const s="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[s])throw new L(`The channel dimension of the input should be defined. Found ${e[s]}`);const a=this.kernelSize.concat([e[s],4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const l=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){const u=this.biasInitializer,d=this.filters;c=new((i=class extends wo{apply(f,p){return LM([u.apply([d]),Tl([d]),u.apply([2*d])])}}).className="CustomInit",i)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,i){return Y(()=>{if(3!==e.length)throw new L(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=i.training||!1,r=e[0],o=e[1],a=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Hc({ones:()=>yo(r),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const c=this.dropoutMask,u=(le,he,ue)=>he&&he[ue]?F(he[ue],le):le;let d=u(r,c,0),h=u(r,c,1),f=u(r,c,2),p=u(r,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Hc({ones:()=>yo(o),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const g=this.recurrentDropoutMask;let m=u(o,g,0),b=u(o,g,1),_=u(o,g,2),y=u(o,g,3);const[x,S,E,k]=zr(this.kernel.read(),4,3),[D,M,R,U]=this.useBias?zr(this.bias.read(),4):[null,null,null,null];d=this.inputConv(d,x,D,this.padding),h=this.inputConv(h,S,M,this.padding),f=this.inputConv(f,E,R,this.padding),p=this.inputConv(p,k,U,this.padding);const[X,ee,K,O]=zr(this.recurrentKernel.read(),4,3);m=this.recurrentConv(m,X),b=this.recurrentConv(b,ee),_=this.recurrentConv(_,K),y=this.recurrentConv(y,O);const z=this.recurrentActivation.apply(ge(d,m)),B=this.recurrentActivation.apply(ge(h,b)),q=ge(F(B,a),F(z,this.activation.apply(ge(f,_)))),se=F(this.recurrentActivation.apply(ge(p,y)),this.activation.apply(q));return[se,se,q]})}getConfig(){const s=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]])}return e}(super.getConfig(),["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,i,s,r){const o=ad(e,i,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return s?Jo(o,s,this.dataFormat):o}recurrentConv(e,i){return ad(e,i,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}return n.className="ConvLSTM2DCell",n})();pe(p8),pe((()=>{class n extends QTe{constructor(e){const i=new p8(e);super(Object.assign(Object.assign({},e),{cell:i}))}static fromConfig(e,i){return new e(i)}}return n.className="ConvLSTM2D",n})());let m8=(()=>{class n extends Nt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const i=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(null==this.noiseShape[r]?i[r]:this.noiseShape[r]);return s}call(e,i){return Y(()=>{this.invokeCallHook(e,i);const s=st(e);if(0<this.rate&&this.rate<1){const r=null!=i.training&&i.training,o=this.getNoiseShape(s);return jb(()=>b6(s,this.rate,o,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},i=super.getConfig();return Object.assign(e,i),e}dispose(){return super.dispose()}}return n.className="Dropout",n})();pe(m8),pe((()=>{class n extends m8{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const i=e.shape;return[i[0],1,i[2]]}}return n.className="SpatialDropout1D",n})()),pe((()=>{class n extends Nt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let i=null;null!=e.batchSize&&(i=e.batchSize),this.batchInputShape=[i,e.inputDim]}this.units=e.units,is(this.units,"units"),this.activation=Wc(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Hi(e.kernelConstraint),this.biasConstraint=Hi(e.biasConstraint),this.kernelRegularizer=Gn(e.kernelRegularizer),this.biasRegularizer=Gn(e.biasRegularizer),this.activityRegularizer=Gn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const i=(e=Xt(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:i}}],this.built=!0}computeOutputShape(e){const i=(e=Xt(e)).slice();return i[i.length-1]=this.units,i}call(e,i){return Y(()=>{this.invokeCallHook(e,i);const s=st(e),r=a6(this.activation.getClassName());let o;return null!=r?o=Va(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=Va(s,this.kernel.read()),null!=this.bias&&(o=Jo(o,this.bias.read())),null!=this.activation&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:Uc(this.activation),useBias:this.useBias,kernelInitializer:ni(this.kernelInitializer),biasInitializer:ni(this.biasInitializer),kernelRegularizer:wn(this.kernelRegularizer),biasRegularizer:wn(this.biasRegularizer),activityRegularizer:wn(this.activityRegularizer),kernelConstraint:Wi(this.kernelConstraint),biasConstraint:Wi(this.biasConstraint)},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Dense",n})()),pe((()=>{class n extends Nt{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Xt(e);for(const i of e.slice(1))if(null==i)throw new L(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],$c(e,1)]}call(e,i){return Y(()=>{this.invokeCallHook(e,i);let s=st(e);if("channelsFirst"===this.dataFormat&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=jt(s,r)}return function Mke(n){if(n.rank<=1)throw new L(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const t=[n.shape[0],$c(n.shape,1)];return j(n,t)}(s)})}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const i=super.getConfig();return Object.assign(e,i),e}}return n.className="Flatten",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Wc(e.activation)}call(e,i){return Y(()=>{this.invokeCallHook(e,i);const s=st(e);return this.activation.apply(s)})}getConfig(){const e={activation:Uc(this.activation)},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Activation",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,i){return Y(()=>function Nke(n,t){return Y(()=>{if(2!==n.shape.length)throw new L(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);return $M(Wb(n,1),[1,t,1])})}(e=st(e),this.n))}getConfig(){const e={n:this.n},i=super.getConfig();return Object.assign(e,i),e}}return n.className="RepeatVector",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.targetShape=e.targetShape;for(let i=0;i<this.targetShape.length;++i)this.isUnknown(this.targetShape[i])&&(this.targetShape[i]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,i){const s="Total size of new array must be unchanged.",r=i.slice();let o=1,a=null;for(let c=0;c<r.length;++c){const u=r[c];if(this.isUnknown(u)){if(null!==a)throw new L("Can only specifiy one unknown dimension.");a=c}else o*=u}const l=$c(e);if(null!==a){if(0===o||l%o!=0)throw new L(s);r[a]=l/o}else if(l!==o)throw new L(s);return r}computeOutputShape(e){let i=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){i=!0;break}return i?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,i){return Y(()=>{this.invokeCallHook(e,i);const s=st(e),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return j(s,o)})}getConfig(){const e={targetShape:this.targetShape},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Reshape",n})()),pe((()=>{class n extends Nt{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const i=Zo(1,e.dims.length+1);if(!tn(e.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ui({ndim:this.dims.length+1})]}computeOutputShape(e){const i=(e=Xt(e)).slice();return this.dims.forEach((s,r)=>{i[r+1]=e[s]}),i}call(e,i){return jt(st(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Permute",n})()),pe((()=>{class n extends Nt{constructor(e){super(e??{}),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),i={maskValue:this.maskValue};return Object.assign(i,e),i}computeMask(e,i){const s=st(e);return TA(Nb(s,this.maskValue),-1)}call(e,i){return Y(()=>{this.invokeCallHook(e,i);const s=st(e),a=TA(Nb(s,this.maskValue),-1,!0);return F(s,Te(a,s.dtype))})}}return n.className="Masking",n})()),pe((()=>{class n extends Nt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let i=null;null!=e.batchSize&&(i=e.batchSize),this.batchInputShape=null==e.inputLength?[i,null]:[i].concat(cn(e.inputLength))}this.inputDim=e.inputDim,is(this.inputDim,"inputDim"),this.outputDim=e.outputDim,is(this.outputDim,"outputDim"),this.embeddingsInitializer=jn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Gn(e.embeddingsRegularizer),this.activityRegularizer=Gn(e.activityRegularizer),this.embeddingsConstraint=Hi(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,i){return Y(()=>this.maskZero?(e=st(e),Nb(e,Ht(e))):null)}computeOutputShape(e){if(e=Xt(e),null==this.inputLength)return[...e,this.outputDim];const i=cn(this.inputLength);if(i.length!==e.length-1)throw new L(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<i.length;++r){const o=i[r],a=e[r+1];if(null!=o&&null!=a&&o!==a)throw new L(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==o&&(i[s]=a),s++}}return[e[0],...i,this.outputDim]}call(e,i){return Y(()=>{this.invokeCallHook(e,i);let s=st(e);"int32"!==s.dtype&&(s=Ba(s,"int32"));const r=g6(this.embeddings.read(),j(s,[s.size]));return j(r,Xt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:ni(this.embeddingsInitializer),embeddingsRegularizer:wn(this.embeddingsRegularizer),activityRegularizer:wn(this.activityRegularizer),embeddingsConstraint:Wi(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Embedding",n})());class bd extends Nt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new _t}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const i=t.slice(0,t.length-e.length);for(let s=0;s<e.length;++s){const r=t[t.length-e.length+s],o=e[s];if(null==r||null==o||r<0||o<0)i.push(null);else if(1===r)i.push(o);else if(1===o)i.push(r);else{if(r!==o)throw new L("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));i.push(r)}}return i}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Xt(t)]),t.length<2)throw new L(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const r of t)null!=r&&null!==r[0]&&e.push(r[0]);if(e=Lc(e),e.length>1)throw new L(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let i=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const o=null==t[r]?null:t[r].slice(1);i=this.computeElementwiseOpOutputShape(i,o)}const s=t.map(r=>r.length);this.reshapeRequired=-1!==t.indexOf(null)||1!==Lc(s).length}call(t,e){return Y(()=>{if(this.reshapeRequired){const i=[],s=t.map(r=>r.rank);if(-1===s.indexOf(null)){const r=Bc(s);for(let o of t){const a=o.rank;for(let l=0;l<r-a;++l)o=Wb(o,1);i.push(o)}return this.mergeFunction(i)}{let r=!1;for(const l of t){const c=l.rank;if(null==c){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=j(l,[d].concat($c(u.slice(1))));f=jt(f,[1,0]),f=j(f,h),i.push(f),r=!0}else if(c>1){const u=Zo(1,c).concat([0]);i.push(jt(l,u)),r=!0}else i.push(l)}let o=this.mergeFunction(i);const a=o.rank;if(r)if(null==a){const l=o.shape,u=l[l.length-1],d=[u].concat(l.slice(0,l.length-1));o=j(jt(j(o,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Zo(0,a-1));o=jt(o,l)}return o}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==t[0]?null:t[0].slice(1);for(let s=1;s<t.length;++s){const r=null==t[s]?null:t[s].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}let i=[];for(const s of t)null!=s&&null!==s[0]&&i.push(s[0]);return i=Lc(i),e=1===i.length?i.concat(e):[null].concat(e),e}computeMask(t,e){return Y(()=>{if(null==e)return null;if(!Array.isArray(e))throw new L("`mask` should be an Array");if(!Array.isArray(t))throw new L("`inputs` should be an Array");if(e.length!==t.length)throw new L(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(s=>null==s))return null;let i=(e=e.map(s=>null==s?s:sr(s,0)))[0];for(let s=1;s<e.length-1;++s)i=kl(i,e[s]);return i})}}function Zb(n,t){for(;n<0;)n+=t;return n}function Qb(n,t,e,i,s,r=.001){let o;if(2===n.rank)o=nxe(n,t,e,i,s,r);else if(3===n.rank)o=sxe(n,t,e,i,s,r);else{if(4!==n.rank)throw new _t(`batchNormalization is not implemented for array of rank ${n.rank} yet`);o=oxe(n,t,e,i,s,r)}return o}function mw(n,t,e,i,s,r){return Y(()=>{let o;wi(s),c6(r),Wr(i),null==e&&(e=[1,1]),null==i&&(i="valid"),null==s&&(s="channelsLast"),null==r&&(r="max"),n=uP(n,s);const a="same"===i?"same":"valid";return o="max"===r?$A(n,t,e,a):AA(n,t,e,a),"channelsFirst"===s&&(o=jt(o,[0,3,1,2])),o})}function g8(n,t,e,i,s,r){return Y(()=>{let o;wi(s),c6(r),Wr(i),null==e&&(e=[1,1,1]),null==i&&(i="valid"),null==s&&(s="channelsLast"),null==r&&(r="max"),n=s8(n,s);const a="same"===i?"same":"valid";return o="max"===r?Zxe(n,t,e,a):Qve(n,t,e,a),"channelsFirst"===s&&(o=jt(o,[0,4,1,2,3])),o})}pe((()=>{class n extends bd{constructor(e){super(e)}mergeFunction(e){return Y(()=>{let i=e[0].clone();for(let s=1;s<e.length;++s)i=ge(i,e[s]);return i})}}return n.className="Add",n})()),pe((()=>{class n extends bd{constructor(e){super(e)}mergeFunction(e){return Y(()=>{let i=e[0].clone();for(let s=1;s<e.length;++s)i=F(i,e[s]);return i})}}return n.className="Multiply",n})()),pe((()=>{class n extends bd{constructor(e){super(e)}mergeFunction(e){return Y(()=>{let i=e[0].clone();for(let s=1;s<e.length;++s)i=ge(i,e[s]);return F(1/e.length,i)})}}return n.className="Average",n})()),pe((()=>{class n extends bd{constructor(e){super(e)}mergeFunction(e){return Y(()=>{let i=e[0];for(let s=1;s<e.length;++s)i=Pc(i,e[s]);return i})}}return n.className="Maximum",n})()),pe((()=>{class n extends bd{constructor(e){super(e)}mergeFunction(e){return Y(()=>{let i=e[0];for(let s=1;s<e.length;++s)i=Ff(i,e[s]);return i})}}return n.className="Minimum",n})()),pe((()=>{class n extends bd{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new L("A `Concatenate` layer should be called on a list of at least 2 inputs");let i=!0;for(const r of e)if(null!=r){i=!1;break}if(i)return;const s=[];for(let r=0;r<e.length;++r){const o=e[r].slice();o.splice(this.axis,1);let a=!1;for(const l of s)if(tn(l,o)){a=!0;break}a||s.push(o)}if(s.length>1)throw new L("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Y(()=>LM(e,this.axis))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new L("A `Concatenate` layer should be called on a list of inputs.");const i=e,s=i[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of i.slice(1)){if(null==s[r]||null==o[r]){s[r]=null;break}s[r]+=o[r]}return s}computeMask(e,i){if(null==i)return null;if(!Array.isArray(i))throw new L("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new L("`inputs` should be an array for Concatenate");if(i.length!==e.length)throw new L(`Mismatch in the length of mask (${i.length}) and the legnth of inputs (${e.length})`);return Y(()=>{let s=!0;if(i.forEach(a=>{null==a||(s=!1)}),s)return null;const r=[];for(let a=0;a<e.length;++a)r.push(null==i[a]?Te(yo(e[a]),"bool"):i[a].rank<e[a].rank?sr(i[a],-1):i[a]);const o=ws(r,this.axis);return $j(o,-1,!1)})}getConfig(){const e={axis:this.axis},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Concatenate",n})()),pe((()=>{class n extends bd{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){T(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const i=e[0],s=e[1];if(i.length>3||s.length>3)throw new _t("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(i,s);if(i[r[0]]!==s[r[1]])throw new L(`Dimension incompatibility: ${i[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(2!==e.length)throw new L(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let r,i=e[0],s=e[1];return r=Array.isArray(this.axes)?this.axes.map((o,a)=>Zb(o,e[a].shape.length)):[Zb(this.axes,i.shape.length),Zb(this.axes,s.shape.length)],this.normalize&&(i=sw(i,r[0]),s=sw(s,r[1])),function JTe(n,t,e){if(n.shape.length>3||t.shape.length>3)throw new _t("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),T(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),"number"==typeof e&&(e=[e,e]),"complex64"===n.dtype||"complex64"===t.dtype)throw new _t("batchDot is not implemented for complex64-type Tensors yet.");const i=n.shape.length,s=t.shape.length;null==e&&(e=[i-1,s-2]);const r=e;return Y(()=>{let o,a;if(i>s){o=i-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=j(t,t.shape.concat(l))}else if(s>i){o=s-i;const l=[];for(let c=0;c<o;++c)l.push(1);n=j(n,n.shape.concat(l))}else o=0;if(a=2===n.shape.length&&2===t.shape.length?r[0]===r[1]?We(F(n,t),r[0]):We(F(jt(n,[1,0]),t),r[1]):nn(n,t,r[0]!==n.shape.length-1,r[1]===t.shape.length-1),o>0){let l;l=i>s?i+s-3:i-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=Rb(a,c)}return 1===a.shape.length&&(a=sr(a,1)),a})}(i,s,r)}interpretAxes(e,i){let s;return s=Array.isArray(this.axes)?this.axes:[Zb(this.axes,e.length),Zb(this.axes,i.length)],s}computeOutputShape(e){T(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const i=e[0].slice(),s=e[1].slice();if(i.length>3||s.length>3)throw new _t("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(i,s);i.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=i.concat(s);return 1===o.length&&o.push(1),o}computeMask(e,i){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},i=super.getConfig();return Object.assign(e,i),e}}return n.className="Dot",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),i={stddev:this.stddev};return Object.assign(i,e),i}call(e,i){return Y(()=>{this.invokeCallHook(e,i);const s=st(e);return jb(()=>ge(ZC(s.shape,0,this.stddev),s),()=>s,i.training||!1)})}}return n.className="GaussianNoise",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),i={rate:this.rate};return Object.assign(i,e),i}call(e,i){return Y(()=>{this.invokeCallHook(e,i);const s=st(e);return this.rate>0&&this.rate<1?jb(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return F(s,ZC(s.shape,1,o))},()=>s,i.training||!1):s})}}return n.className="GaussianDropout",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||st(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),i={rate:this.rate};return Object.assign(i,e),i}call(e,i){return Y(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return jb(()=>{const o=st(e),c=-1.7580993408473766;let u=ld(Ab(s),this.rate);u=Ba(u,"float32");const d=((1-this.rate)*(1+this.rate*c**2))**-.5,h=-d*c*this.rate,f=ge(F(o,u),F(ge(u,-1),c));return ge(F(f,d),h)},()=>st(e),i.training||!1)}return e})}}return n.className="AlphaDropout",n})()),pe((()=>{class n extends Nt{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=jn(e.betaInitializer||"zeros"),this.gammaInitializer=jn(e.gammaInitializer||"ones"),this.movingMeanInitializer=jn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=jn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Hi(e.betaConstraint),this.gammaConstraint=Hi(e.gammaConstraint),this.betaRegularizer=Gn(e.betaRegularizer),this.gammaRegularizer=Gn(e.gammaRegularizer)}build(e){e=Xt(e);const i=this.axis>=0?this.axis:this.axis+e.length,s=e[i];if(null==s)throw new L(`Axis ${i} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Ui({ndim:e.length,axes:{[i]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,i){return Y(()=>{const s=null!=i.training&&i.training,r=st(e),o=r.shape,a=o.length,l=Zo(0,a),c=this.axis>=0?this.axis:this.axis+a;l.splice(c,1);const u=hd(1,a);u[c]=o[c];const d=l.slice();d.sort();const h=!tn(d,Zo(0,a).slice(0,a-1));if(!s)return(()=>{if(h){const y=j(this.movingMean.read(),u),v=j(this.movingVariance.read(),u),x=this.center?j(this.beta.read(),u):null,S=this.scale?j(this.gamma.read(),u):null;return Qb(r,y,v,x,S,this.epsilon)}return Qb(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[p,g,m]=function nDe(n,t,e,i,s=.001){return tn(i.slice().sort(),Zo(0,n.rank-1))?function eDe(n,t,e,i,s=.001){return Y(()=>{const r=BA(n,i),o=r.mean,a=r.variance;return[Qb(n,o,a,e,t,s),o,a]})}(n,t,e,i,s):function tDe(n,t,e,i,s=.001){return Y(()=>{const r=BA(n,i),o=r.mean,a=r.variance,l=[];for(const p of Zo(0,n.rank))-1!==i.indexOf(p)?l.push(1):l.push(n.shape[p]);const c=j(o,l),u=j(a,l),d=null==t?null:j(t,l),h=null==e?null:j(e,l);return[Qb(n,c,u,h,d,s),o,a]})}(n,t,e,i,s)}(r,this.gamma.read(),this.beta.read(),l,this.epsilon),b=(y,v,x)=>{Y(()=>{const S=1-x,E=y.read(),k=F(Be(E,v),S);y.write(Be(E,k))})};return(()=>{b(this.movingMean,g,this.momentum),b(this.movingVariance,m,this.momentum)})(),p})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ni(this.betaInitializer),gammaInitializer:ni(this.gammaInitializer),movingMeanInitializer:ni(this.movingMeanInitializer),movingVarianceInitializer:ni(this.movingVarianceInitializer),betaRegularizer:wn(this.betaRegularizer),gammaRegularizer:wn(this.gammaRegularizer),betaConstraint:Wi(this.betaConstraint),gammaConstraint:Wi(this.gammaConstraint)},i=super.getConfig();return Object.assign(e,i),e}}return n.className="BatchNormalization",n})()),pe((()=>{class n extends Nt{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const i of this.axis)if(!Number.isInteger(i))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=jn(e.betaInitializer||"zeros"),this.gammaInitializer=jn(e.gammaInitializer||"ones"),this.betaRegularizer=Gn(e.betaRegularizer),this.gammaRegularizer=Gn(e.gammaRegularizer),this.supportsMasking=!0}build(e){const i=(e=Xt(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=i);for(const o of this.axis)if(o<0||o>=i)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==Lc(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>e[o]);this.gamma=this.scale?this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}call(e,i){const s=st(e),r=s.shape,o=r.length;return Y(()=>{let{mean:l,variance:c}=BA(s,this.axis,!0);const u=hd(1,o);for(const m of this.axis)u[m]=r[m];const d=m=>null!=m&&m.shape.length!==o?j(m,u):m;let h=this.scale?d(this.gamma.read()):null,f=this.center?d(this.beta.read()):null;const p=[],g=[];for(let m=0;m<o;++m)-1!==this.axis.indexOf(m)?(p.push(r[m]),g.push(1)):(p.push(1),g.push(r[m]));return l=Xo(l,p),c=Xo(c,p),null!=h&&(h=Xo(h,g)),null!=f&&(f=Xo(f,g)),Qb(s,l,c,f,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ni(this.betaInitializer),gammaInitializer:ni(this.gammaInitializer),betaRegularizer:wn(this.betaRegularizer),gammaRegularizer:wn(this.gammaRegularizer)},i=super.getConfig();return Object.assign(e,i),e}}return n.className="LayerNormalization",n})()),pe((()=>{class n extends Nt{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new L(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let i,s;if("number"==typeof e.padding[0])i=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new L(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(i=e.padding[0],2!==e.padding[1].length)throw new L(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[i,s]}this.inputSpec=[new Ui({ndim:4})]}computeOutputShape(e){let i,s;return e=Xt(e),"channelsFirst"===this.dataFormat?(i=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,s=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],i,s]):(i=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,s=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],i,s,e[3]])}call(e,i){return Y(()=>function iDe(n,t,e){return Y(()=>{if(4!==n.rank)throw new L(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new L("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==e&&(e="channelsLast"),"channelsLast"!==e&&"channelsFirst"!==e)throw new L(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let i;return i="channelsFirst"===e?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],VA(n,i)})}(st(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},i=super.getConfig();return Object.assign(e,i),e}}return n.className="ZeroPadding2D",n})());class b8 extends Nt{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new L(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);this.poolSize=t.poolSize}if(is(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new L(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);this.strides=t.strides}is(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,Wr(this.padding),this.inputSpec=[new Ui({ndim:3})]}computeOutputShape(t){const e=na((t=Xt(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Y(()=>{this.invokeCallHook(t,e),t=Wb(st(t),2);const i=this.poolingFunction(st(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Rb(i,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}pe((()=>{class n extends b8{constructor(e){super(e)}poolingFunction(e,i,s,r,o){return wi(o),Wr(r),mw(e,i,s,r,o,"max")}}return n.className="MaxPooling1D",n})()),pe((()=>{class n extends b8{constructor(e){super(e)}poolingFunction(e,i,s,r,o){return wi(o),Wr(r),mw(e,i,s,r,o,"avg")}}return n.className="AveragePooling1D",n})());class _8 extends Nt{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new L(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];is(this.poolSize,"poolSize"),is(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,wi(this.dataFormat),Wr(this.padding),this.inputSpec=[new Ui({ndim:4})]}computeOutputShape(t){t=Xt(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],i="channelsFirst"===this.dataFormat?t[3]:t[2];return e=na(e,this.poolSize[0],this.padding,this.strides[0]),i=na(i,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,i]:[t[0],e,i,t[3]]}call(t,e){return Y(()=>(this.invokeCallHook(t,e),this.poolingFunction(st(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}pe((()=>{class n extends _8{constructor(e){super(e)}poolingFunction(e,i,s,r,o){return wi(o),Wr(r),mw(e,i,s,r,o,"max")}}return n.className="MaxPooling2D",n})()),pe((()=>{class n extends _8{constructor(e){super(e)}poolingFunction(e,i,s,r,o){return wi(o),Wr(r),mw(e,i,s,r,o,"avg")}}return n.className="AveragePooling2D",n})());class y8 extends Nt{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new L(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];is(this.poolSize,"poolSize"),is(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,wi(this.dataFormat),Wr(this.padding),this.inputSpec=[new Ui({ndim:5})]}computeOutputShape(t){t=Xt(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],i="channelsFirst"===this.dataFormat?t[3]:t[2],s="channelsFirst"===this.dataFormat?t[4]:t[3];return e=na(e,this.poolSize[0],this.padding,this.strides[0]),i=na(i,this.poolSize[1],this.padding,this.strides[1]),s=na(s,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,i,s]:[t[0],e,i,s,t[4]]}call(t,e){return Y(()=>(this.invokeCallHook(t,e),this.poolingFunction(st(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}pe((()=>{class n extends y8{constructor(e){super(e)}poolingFunction(e,i,s,r,o){return wi(o),Wr(r),g8(e,i,s,r,o,"max")}}return n.className="MaxPooling3D",n})()),pe((()=>{class n extends y8{constructor(e){super(e)}poolingFunction(e,i,s,r,o){return wi(o),Wr(r),g8(e,i,s,r,o,"avg")}}return n.className="AveragePooling3D",n})());class v8 extends Nt{constructor(t){super(t),this.inputSpec=[new Ui({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new _t}}pe((()=>{class n extends v8{constructor(e){super(e||{})}call(e,i){return Y(()=>{const s=st(e);return Ci(s,1)})}}return n.className="GlobalAveragePooling1D",n})()),pe((()=>{class n extends v8{constructor(e){super(e||{})}call(e,i){return Y(()=>{const s=st(e);return Yo(s,1)})}}return n.className="GlobalMaxPooling1D",n})());class x8 extends Nt{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,wi(this.dataFormat),this.inputSpec=[new Ui({ndim:4})]}computeOutputShape(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new _t}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}pe((()=>{class n extends x8{call(e,i){return Y(()=>{const s=st(e);return Ci(s,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}return n.className="GlobalAveragePooling2D",n})()),pe((()=>{class n extends x8{call(e,i){return Y(()=>{const s=st(e);return Yo(s,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}return n.className="GlobalMaxPooling2D",n})());class C8 extends Nt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,i={}){const r=Wa(e.layer,i);delete e.layer;const o={layer:r};return Object.assign(o,e),new t(o)}}pe((()=>{class n extends C8{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=Xt(e)).length<3)throw new L(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const i=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(i),this.layer.built=!0),super.build(e)}computeOutputShape(e){const i=[(e=Xt(e))[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(i);return[s[0],e[1]].concat(s.slice(1))}call(e,i){return Y(()=>u8((a,l)=>[st(this.layer.call(a,i)),[]],e=st(e),[],!1,null,null,!1,!0)[1])}}return n.className="TimeDistributed",n})()),pe((()=>{class n extends C8{constructor(e){super(e);const i=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=i,this.forwardLayer=Wa(s),i.goBackwards=!0!==i.goBackwards;const r={};if(r.className=e.layer.getClassName(),r.config=i,this.backwardLayer=Wa(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function sDe(n){pd(wke,"BidirectionalMergeMode",n)}(this.mergeMode),e.weights)throw new _t("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const s=Math.floor(e.length/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let s,r,o,i=this.forwardLayer.computeOutputShape(e);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),this.returnState&&(o=i.slice(1)),s=i[0],"concat"===this.mergeMode?(s[s.length-1]*=2,r=[s]):r=null==this.mergeMode?[s,s.slice()]:[s],this.returnState?null==this.mergeMode?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):or(r)}apply(e,i){let s=null==i?null:i.initialState,r=null==i?null:i.constants;null==i&&(i={});const o=c8(e,s,r,this.numConstants);if(e=o.inputs,s=o.initialState,r=o.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(null==s||0===s.length)&&null==r)return super.apply(e,i);const a=[],l=[];if(null!=s){const u=s.length;if(u%2>0)throw new L("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");i.initialState=s,a.push(...s);const d=s.map(h=>new Ui({shape:h.shape}));this.forwardLayer.stateSpec=d.slice(0,u/2),this.backwardLayer.stateSpec=d.slice(u/2),l.push(...d)}if(null!=r)throw new _t("Support for constants in Bidirectional layers is not implemented yet.");const c=a[0]instanceof Ua;for(const u of a)if(u instanceof Ua!==c)throw new L("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){const u=[e].concat(a),d=this.inputSpec.concat(l),h=this.inputSpec;this.inputSpec=d;const f=super.apply(u,i);return this.inputSpec=h,f}return super.apply(e,i)}call(e,i){return Y(()=>{const s=i.initialState;let r,o,a,l;if(null==s)r=this.forwardLayer.call(e,i),o=this.backwardLayer.call(e,i);else{const c=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(i,{initialState:c})),o=this.backwardLayer.call(e,Object.assign(i,{initialState:u}))}return this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=cd(o,1)),"concat"===this.mergeMode?l=LM([r,o]):"sum"===this.mergeMode?l=ge(r,o):"ave"===this.mergeMode?l=F(.5,ge(r,o)):"mul"===this.mergeMode?l=F(r,o):null==this.mergeMode&&(l=[r,o]),this.returnState?null==this.mergeMode?l.concat(a):[l].concat(a):l})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){md(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),md(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,i){let s;if(Array.isArray(i)&&(i=i[0]),s=this.returnSequences?null==this.mergeMode?[i,i]:i:null==this.mergeMode?[null,null]:null,this.returnState){const o=this.forwardLayer.states.map(a=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},i=super.getConfig();return Object.assign(e,i),e}static fromConfig(e,i){const s=Wa(i.layer);if(delete i.layer,null!=i.numConstants)throw new _t("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=i;return r.layer=s,new e(r)}}return n.className="Bidirectional",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.scale=e.scale,this.offset=e.offset?e.offset:0}getConfig(){const e={scale:this.scale,offset:this.offset},i=super.getConfig();return Object.assign(e,i),e}call(e,i){return Y(()=>("float32"!==(e=st(e)).dtype&&(e=Ba(e,"float32")),ge(F(e,this.scale),this.offset)))}}return n.className="Rescaling",n})());const{resizeBilinear:oDe,cropAndResize:aDe}=Ml;pe((()=>{class n extends Nt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,i,s,r,o,a,l,c){return Y(()=>{let u,d=!1;const m=[i/a,s/l,(r+i)/a,(o+s)/l],b=[];3===e.rank?(d=!0,u=Nl([e])):u=e;for(let S=0;S<u.shape[0];S++)b.push(m);const _=wb(b,[b.length,4]),y=Mb(0,b.length,1,"int32"),x=aDe(u,_,y,[r,o],"nearest");return Ba(d?st(ud(x)):x,c)})}upsize(e,i,s,r){return Y(()=>Ba(oDe(e,[i,s]),r))}call(e,i){return Y(()=>{const s=st(e),r=s.dtype,o=s.shape,a=o[o.length-3],l=o[o.length-2];let c=0;a!==this.height&&(c=Math.floor((a-this.height)/2));let u=0;return l!==this.width&&(u=Math.floor((l-this.width)/2),0===u&&(u=1)),c>=0&&u>=0?this.centerCrop(s,c,u,this.height,this.width,a,l,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},i=super.getConfig();return Object.assign(e,i),e}computeOutputShape(e){const s=(e=Xt(e)).length-2;return e[e.length-3]=this.height,e[s]=this.width,e}}return n.className="CenterCrop",n})()),pe((()=>{class n extends Nt{constructor(e){super(e),this.numTokens=e.numTokens,this.outputMode=e.outputMode?e.outputMode:"multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},i=super.getConfig();return Object.assign(e,i),e}computeOutputShape(e){return null==(e=Xt(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,i){return Y(()=>{let s;if("int32"!==(e=st(e)).dtype&&(e=Ba(e,"int32")),typeof i.countWeights<"u"){if("count"!==this.outputMode)throw new L(`countWeights is not used when outputMode !== count.\n              Received countWeights=${i.countWeights}`);s=st(i.countWeights)}const r=Yo(e),o=MC(e),a=Vr(this.numTokens,r).bufferSync().get(0),l=ld(o,0).bufferSync().get(0);if(!a||!l)throw new L(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function lDe(n,t,e,i){let s=st(n);if("int32"!==s.dtype&&(s=Ba(s,"int32")),"int"===t)return s;const r=s.shape;if(0===s.rank&&(s=sr(s,-1)),"oneHot"===t&&1!==s.shape[s.shape.length-1]&&(s=sr(s,-1)),s.rank>2)throw new L(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${r} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(t);let l;if(l=Uj(s,typeof i<"u"&&"count"===t?i:[],e,o),"tfIdf"!==t)return l;if(i)return F(l,i);throw new L("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,s)})}}return n.className="CategoryEncoding",n})());const w8=new Set(["bilinear","nearest"]);pe((()=>{class n extends Nt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!w8.has(e.interpolation))throw new L(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){return e=Xt(e),[this.height,this.width,e[2]]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},i=super.getConfig();return Object.assign(e,i),e}call(e,i){return Y(()=>{const s=[this.height,this.width];if("bilinear"===this.interpolation)return Ml.resizeBilinear(e,s,!this.cropToAspectRatio);if("nearest"===this.interpolation)return Ml.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...w8]} are supported`)})}}return n.className="Resizing",n})());let uDe=(()=>{class n{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}return n.className="RandomSeed",n})(),dDe=(()=>{class n extends Nt{constructor(e){super(e),this.randomGenerator=new uDe(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},i=super.getConfig();return Object.assign(e,i),e}}return n.className="BaseRandomLayer",n})();const S8=new Set(["bilinear","nearest"]);var D8;pe((()=>{class n extends dDe{constructor(e){super(e);const{factor:i,interpolation:s="bilinear"}=e;if(this.factor=i,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new L(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new L(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new L(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(s){if(!S8.has(s))throw new L(`Invalid interpolation parameter: ${s} is not implemented`);this.interpolation=s}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},i=super.getConfig();return Object.assign(e,i),e}computeOutputShape(e){return e=Xt(e),[this.imgHeight,-1,e[2]]}call(e,i){return Y(()=>{const s=st(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Ab([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*r;o=Math.round(o);const a=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return Ml.resizeBilinear(e,a);case"nearest":return Ml.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...S8]} are supported`)}})}}return n.className="RandomWidth",n})()),J().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),function(n){let t;var e;(e=t=n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(D8||(D8={}));class _w extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}function Ue(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{null!=e&&T("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the CPU backend.`)})}Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");const eNe=zG;let tNe=(()=>{class n extends zD{nextDataId(){return n.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new rH(this,Pa())}write(e,i,s){this.firstUse&&(this.firstUse=!1,J().get("IS_NODE")&&Lr("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,i,s){let r;if("string"===i&&null!=s&&s.length>0&&wg(s[0])){const o=s.map(a=>Tc(a));r=this.write(o,e,i)}else r=this.write(s,e,i);return{dataId:r,shape:e,dtype:i}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){this.data.has(e)&&this.data.get(e).refCount--}move(e,i,s,r,o){this.data.set(e,{values:i,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}read(e){var i=this;return Q(function*(){return i.readSync(e)})()}readSync(e){const{dtype:i,complexTensorInfos:s}=this.data.get(e);return"complex64"===i?Pl(this.readSync(s.real.dataId),this.readSync(s.imag.dataId)):function Gye(n,t){if(Array.isArray(n))return n;if("float32"===t)return n instanceof Float32Array?n:new Float32Array(n);if("int32"===t)return n instanceof Int32Array?n:new Int32Array(n);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${t}`)}(this.data.get(e).values,i)}bufferSync(e){const i=this.readSync(e.dataId);if("string"===e.dtype)try{const s=i.map(r=>Dc(r));return Dt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Dt(e.shape,e.dtype,i)}makeOutput(e,i,s){return Pa().makeTensorFromTensorInfo(this.makeTensorInfo(i,s,e),this)}disposeData(e,i=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!i&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);null!=s&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}time(e){return Q(function*(){const i=nr();return e(),{kernelMs:nr()-i}})()}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ue([e],"where");const i=this.readSync(e.dataId);return eNe(e.shape,i)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}return n.nextDataId=0,n})();function ja(n){return(t,e,i)=>{const s=yi(e,t.length);for(let r=0;r<t.length;++r)s[r]=n(t[r],i);return s}}function gn(n,t,e){return jc(n,ja(t),e)}function jc(n,t,e){return({inputs:i,attrs:s,backend:r})=>{const{x:o}=i;Ue(o,n);const a=r,l=a.data.get(o.dataId).values;let c;if("string"===o.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Rl(l)}else c=l;const u=e||o.dtype,d=t(c,u,s);return a.makeTensorInfo(o.shape,u,d)}}YH("cpu",()=>new tNe,1);const a7=gn(Lg,n=>n>=0?n:Math.exp(n)-1),iNe={kernelName:Lg,backendName:"cpu",kernelFunc:a7};function Ga(n){const{inputs:t,backend:e}=n,{x:i}=t;return e.incRef(i.dataId),{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}const sNe={kernelName:Hg,backendName:"cpu",kernelFunc:Ga};function l7(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{alpha:r}=i;Ue([s],"leakyRelu");const o=te(s.shape),a=e.data.get(s.dataId).values,l=vs("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?r*a[c]:a[c];return e.makeTensorInfo(s.shape,"float32",l)}const rNe={kernelName:Dx,backendName:"cpu",kernelFunc:l7};function Si(n){return(t,e,i,s,r)=>{const o=ft(t,e),a=o.length,l=Ye(o),u=vs(r,te(o)),d=t.length,h=e.length,f=Ye(t),p=Ye(e),g=Rf(t,o),m=Rf(e,o);if(g.length+m.length===0)for(let b=0;b<u.length;++b)u[b]=n(i[b%i.length],s[b%s.length]);else for(let b=0;b<u.length;++b){const _=Sf(b,a,l),y=_.slice(-d);g.forEach(E=>y[E]=0);const v=Aa(y,d,f),x=_.slice(-h);m.forEach(E=>x[E]=0);const S=Aa(x,h,p);u[b]=n(i[v],s[S])}return[u,o]}}const oNe=Si((n,t)=>n<0?t*n:n);function c7(n){const{inputs:t,backend:e}=n,{x:i,alpha:s}=t;Ue([i,s],"prelu");const r=e.data.get(i.dataId).values,o=e.data.get(s.dataId).values,[a,l]=oNe(i.shape,s.shape,r,o,"float32");return e.makeTensorInfo(l,"float32",a)}const aNe={kernelName:Kx,backendName:"cpu",kernelFunc:c7},u7=gn(nb,n=>Math.max(0,n)),lNe={kernelName:nb,backendName:"cpu",kernelFunc:u7},d7=gn(ib,n=>Math.min(Math.max(0,n),6)),cNe={kernelName:ib,backendName:"cpu",kernelFunc:d7},uNe=ja(n=>1/(1+Math.exp(-n))),h7=gn(ub,n=>1/(1+Math.exp(-n))),dNe={kernelName:ub,backendName:"cpu",kernelFunc:h7};function Cw(n,t,e,i,s){if("linear"===e)return Ga({inputs:{x:t},backend:n});if("relu"===e)return u7({inputs:{x:t},backend:n});if("elu"===e)return a7({inputs:{x:t},backend:n});if("relu6"===e)return d7({inputs:{x:t},backend:n});if("prelu"===e)return c7({inputs:{x:t,alpha:i},backend:n});if("leakyrelu"===e)return l7({inputs:{x:t},backend:n,attrs:{alpha:s}});if("sigmoid"===e)return h7({inputs:{x:t},backend:n});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}function _r(n){const{inputs:t,backend:e}=n,{real:i,imag:s}=t,r=e.data.get(i.dataId).values,o=e.data.get(s.dataId).values,a=e.makeTensorInfo(i.shape,"complex64");return e.data.get(a.dataId).complexTensorInfos={real:e.makeTensorInfo(i.shape,"float32",r),imag:e.makeTensorInfo(s.shape,"float32",o)},a}const hNe={kernelName:sN,backendName:"cpu",kernelFunc:_r};function ww(n,t,e="float32"){if("complex64"===e)return _r({inputs:{real:ww(n,t,"float32"),imag:ww(n,t,"float32")},backend:n});const i=xs(te(t),e);return n.makeTensorInfo(t,e,i)}function yd(n){const{inputs:t,backend:e}=n,{input:i}=t,s=e.data.get(i.dataId).complexTensorInfos.real,r=e.data.get(s.dataId).values;return e.makeTensorInfo(s.shape,s.dtype,r)}const fNe={kernelName:NN,backendName:"cpu",kernelFunc:yd};function f7(n,t,e,i){if("int32"===i)return[t,"int32",Int32Array.from(n)];if("bool"===i){const s=Qu([0],e),[r,o]=Si((a,l)=>a!==l?1:0)(t,[],n,s,"bool");return[o,"bool",r]}throw new Error(`Error in Cast: failed to cast ${e} to ${i}`)}function Gc(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{dtype:r}=i;if("complex64"===r){if("complex64"===s.dtype)return Ga({inputs:{x:s},backend:e});const u=ww(e,s.shape,s.dtype),d=Gc({inputs:{x:s},backend:e,attrs:{dtype:"float32"}}),h=_r({inputs:{real:d,imag:u},backend:e});return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(d),h}if("complex64"===s.dtype){const u=yd({inputs:{input:s},backend:e}),d=Gc({inputs:{x:u},backend:e,attrs:{dtype:r}});return e.disposeIntermediateTensorInfo(u),d}if(!uH(s.dtype,r)){const u=Ga({inputs:{x:s},backend:e});return{dataId:u.dataId,shape:u.shape,dtype:r}}const o=e.data.get(s.dataId).values,[a,l,c]=f7(o,s.shape,s.dtype,r);return e.makeTensorInfo(a,l,c)}const pNe={kernelName:Ag,backendName:"cpu",kernelFunc:Gc};function ji(n,t,e,i){return null==e?({inputs:s,backend:r})=>{const{a:o,b:a}=s,l=r;Ue([o,a],n);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d="string"===o.dtype?Rl(c):c,h="string"===o.dtype?Rl(u):u,f=i||o.dtype,[p,g]=t(o.shape,a.shape,d,h,f);return l.makeTensorInfo(g,f,p)}:({inputs:s,backend:r})=>{const{a:o,b:a}=s,l=r;if("complex64"===o.dtype||"complex64"===a.dtype){const c=Gc({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.imag,f=l.data.get(u.complexTensorInfos.real.dataId).values,p=l.data.get(h.dataId).values,g=Gc({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),m=l.data.get(g.dataId),_=m.complexTensorInfos.imag,y=l.data.get(m.complexTensorInfos.real.dataId).values,v=l.data.get(_.dataId).values,[x,S,E]=e(o.shape,a.shape,f,p,y,v),k=l.makeTensorInfo(E,"float32",x),D=l.makeTensorInfo(E,"float32",S),M=_r({inputs:{real:k,imag:D},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(k),l.disposeIntermediateTensorInfo(D),M}{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=i||o.dtype,[h,f]=t(o.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function DP(n){return(t,e,i,s,r,o)=>{const a=ft(t,e),l=te(a),c=a.length,u=Ye(a),d=vs("float32",l),h=vs("float32",l),f=Rf(t,a),p=Rf(e,a),g=Pl(i,s),m=Pl(r,o),b=t.length,_=Ye(t),y=e.length,v=Ye(e);if(f.length+p.length===0)for(let x=0;x<d.length;x++){const S=x%g.length,E=x%m.length,k=n(g[2*S],g[2*S+1],m[2*E],m[2*E+1]);d[x]=k.real,h[x]=k.imag}else for(let x=0;x<d.length;x++){const S=Sf(x,c,u),E=S.slice(-b);f.forEach(U=>E[U]=0);const k=Aa(E,b,_),D=S.slice(-y);p.forEach(U=>D[U]=0);const M=Aa(D,y,v),R=n(g[2*k],g[2*k+1],m[2*M],m[2*M+1]);d[x]=R.real,h[x]=R.imag}return[d,h,a]}}const p7=Si((n,t)=>n+t),mNe=DP((n,t,e,i)=>({real:n+e,imag:t+i})),qf=ji(If,p7,mNe),gNe={kernelName:If,backendName:"cpu",kernelFunc:qf};function Tn(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{shape:r}=i,o=te(s.shape),a=cH(r,o),l=te(a);T(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),e.incRef(s.dataId);const c=e.data.get(s.dataId);if(null!=c.complexTensorInfos){const d=c.complexTensorInfos.imag;c.complexTensorInfos.real.shape=a,d.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const bNe={kernelName:Yx,backendName:"cpu",kernelFunc:Tn};function m7(n){const{inputs:t,backend:e,attrs:i}=n,{a:s,b:r}=t,{transposeA:o,transposeB:a}=i;Ue([s,r],"matMul");const l=s.shape.length,c=r.shape.length,u=o?s.shape[l-2]:s.shape[l-1],d=a?r.shape[c-1]:r.shape[c-2],h=o?s.shape[l-1]:s.shape[l-2],f=a?r.shape[c-2]:r.shape[c-1],p=s.shape.slice(0,-2),g=r.shape.slice(0,-2),m=te(p),b=te(g),y=ft(s.shape.slice(0,-2),r.shape.slice(0,-2)).concat([h,f]);T(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${s.shape} and ${r.shape} and transposeA=${o} and transposeB=${a} must match.`);const x=a?[b,f,d]:[b,d,f],S=Tn({inputs:{x:s},backend:e,attrs:{shape:o?[m,u,h]:[m,h,u]}}),E=Tn({inputs:{x:r},backend:e,attrs:{shape:x}}),k=o?S.shape[1]:S.shape[2],D=o?S.shape[2]:S.shape[1],M=a?E.shape[1]:E.shape[2],R=Math.max(m,b),U=e.data.get(S.dataId).values,X=e.data.get(E.dataId).values,ee=Ye(S.shape),K=Ye(E.shape),[O,z,B]=o?[ee[0],1,ee[1]]:[ee[0],ee[1],1],[q,se,le]=a?[1,K[1],K[0]]:[K[1],1,K[0]],he=D*M,ue=Dt([R,D,M],S.dtype),de=ue.values,ve=e.blockSize;for(let Ee=0;Ee<R;Ee++){const Me=Ee%m,Xe=Ee%b;for(let Ve=0;Ve<D;Ve+=ve){const ut=Math.min(Ve+ve,D);for(let pt=0;pt<M;pt+=ve){const bn=Math.min(pt+ve,M);for(let Dn=0;Dn<k;Dn+=ve){const ui=Math.min(Dn+ve,k);for(let Nn=Ve;Nn<ut;Nn++)for(let xn=pt;xn<bn;xn++){let si=0;for(let Xn=Dn;Xn<ui;Xn++)si+=U[Me*O+Nn*z+Xn*B]*X[Xn*q+xn*se+Xe*le];de[Ee*he+(Nn*M+xn)]+=si}}}}}return e.disposeIntermediateTensorInfo(S),e.disposeIntermediateTensorInfo(E),e.makeTensorInfo(y,ue.dtype,ue.values)}const _Ne={kernelName:px,backendName:"cpu",kernelFunc:m7},vNe={kernelName:uC,backendName:"cpu",kernelFunc:function yNe(n){const{inputs:t,backend:e,attrs:i}=n,{a:s,b:r,bias:o,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=i;let h,f,p;const g=[];h=m7({inputs:{a:s,b:r},attrs:{transposeA:l,transposeB:c},backend:e}),o&&(f=qf({inputs:{a:h,b:o},backend:e}),g.push(h),h=f),u&&(p=Cw(e,h,u,a,d),g.push(h),h=p);for(const b of g)e.disposeIntermediateTensorInfo(b);return h}};function g7(n){const t=new Float32Array(n.length);for(let e=0;e<n.length;++e)t[e]=Math.abs(n[e]);return t}const xNe={kernelName:cx,backendName:"cpu",kernelFunc:n=>{const{x:t}=n.inputs,e=n.backend;Ue(t,"abs");let i=new Float32Array(te(t.shape));return i=g7(e.data.get(t.dataId).values),e.makeOutput(i,t.shape,t.dtype)}},CNe=gn(Sg,n=>Math.acos(n)),wNe={kernelName:Sg,backendName:"cpu",kernelFunc:CNe},SNe=gn(Ig,n=>Math.acosh(n)),INe={kernelName:Ig,backendName:"cpu",kernelFunc:SNe},kNe={kernelName:ZD,backendName:"cpu",kernelFunc:function ENe(n){const{inputs:t,backend:e}=n,i=t;Ue(t,"addN");const s=i.map(a=>e.data.get(a.dataId).values),r=Dt(i[0].shape,i[0].dtype),o=r.values;for(let a=0;a<i.length;a++){const l=s[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return e.makeTensorInfo(r.shape,r.dtype,r.values)}};function NP(n,t,e,i,s){const r=t.length,o=te(t),a=Ye(t),l=Ye(s),c=vs(e,te(s));for(let u=0;u<o;++u){const d=Sf(u,r,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[i[p]];c[Aa(h,r,l)]=n[u]}return c}function ar(n){const{inputs:t,attrs:e,backend:i}=n,{x:s}=t,{perm:r}=e;Ue(s,"transpose");const a=new Array(s.shape.length);for(let d=0;d<a.length;d++)a[d]=s.shape[r[d]];const c=NP(i.data.get(s.dataId).values,s.shape,s.dtype,r,a);return{dataId:i.write(c,a,s.dtype),shape:a,dtype:s.dtype}}const TNe={kernelName:Ef,backendName:"cpu",kernelFunc:ar},NNe={kernelName:"All",backendName:"cpu",kernelFunc:function DNe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i;Ue(s,"all");const a=Tt(r,s.shape);let l=a;const c=ti(l,s.shape.length);let u=s;null!=c&&(u=ar({inputs:{x:s},backend:e,attrs:{perm:c}}),l=xi(l.length,s.shape.length)),fs("all",l,u.shape.length);const[d,h]=ts(u.shape,l),f=te(h),p=xs(te(d),u.dtype),g=e.data.get(u.dataId).values;for(let b=0;b<p.length;++b){const _=b*f;let y=g[_];for(let v=0;v<f;++v)y=y&&g[_+v];p[b]=y}null!=c&&e.disposeIntermediateTensorInfo(u);const m=e.makeTensorInfo(d,u.dtype,p);if(o){const _=Tn({inputs:{x:m},backend:e,attrs:{shape:vi(d,a)}});return e.disposeIntermediateTensorInfo(m),_}return m}},MNe={kernelName:"Any",backendName:"cpu",kernelFunc:function ANe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i;Ue(s,"any");const a=Tt(r,s.shape);let l=a;const c=ti(l,s.shape.length);let u=s;null!=c&&(u=ar({inputs:{x:s},backend:e,attrs:{perm:c}}),l=xi(l.length,s.shape.length)),fs("any",l,u.shape.length);const[d,h]=ts(u.shape,l),f=te(h),p=xs(te(d),u.dtype),g=e.data.get(u.dataId).values;for(let b=0;b<p.length;++b){const _=b*f;let y=g[_];for(let v=0;v<f;++v)y=y||g[_+v];p[b]=y}null!=c&&e.disposeIntermediateTensorInfo(u);const m=e.makeTensorInfo(d,u.dtype,p);if(o){const _=Tn({inputs:{x:m},backend:e,attrs:{shape:vi(d,a)}});return e.disposeIntermediateTensorInfo(m),_}return m}},RNe={kernelName:ux,backendName:"cpu",kernelFunc:function PNe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r}=i;Ue(s,"argMax");let o=Tt(r,s.shape);const a=ti(o,s.shape.length);let l=s;const c=[];null!=a&&(l=ar({inputs:{x:s},backend:e,attrs:{perm:a}}),c.push(l),o=xi(o.length,l.shape.length)),o=[o[0]],fs("argMax",o,l.shape.length);const[u,d]=ts(l.shape,o),f=xs(te(u),"int32"),p=te(d),g=e.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const b=m*p;let _=g[b],y=0;for(let v=0;v<p;++v){const x=g[b+v];x>_&&(_=x,y=v)}f[m]=y}return c.forEach(m=>e.disposeIntermediateTensorInfo(m)),e.makeTensorInfo(u,"int32",f)}},FNe={kernelName:dx,backendName:"cpu",kernelFunc:function ONe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r}=i;Ue(s,"argMin");let o=Tt(r,s.shape);const a=ti(o,s.shape.length);let l=s;const c=[];null!=a&&(l=ar({inputs:{x:s},backend:e,attrs:{perm:a}}),c.push(l),o=xi(o.length,l.shape.length)),o=[o[0]],fs("argMin",o,l.shape.length);const[u,d]=ts(l.shape,o),f=xs(te(u),"int32"),p=te(d),g=e.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const b=m*p;let _=g[b],y=0;for(let v=0;v<p;++v){const x=g[b+v];x<_&&(_=x,y=v)}f[m]=y}return c.forEach(m=>e.disposeIntermediateTensorInfo(m)),e.makeTensorInfo(u,"int32",f)}},LNe=gn(Eg,n=>Math.asin(n)),$Ne={kernelName:Eg,backendName:"cpu",kernelFunc:LNe},BNe=gn(kg,n=>Math.asinh(n)),VNe={kernelName:kg,backendName:"cpu",kernelFunc:BNe},zNe=gn(Tg,n=>Math.atan(n)),UNe={kernelName:Tg,backendName:"cpu",kernelFunc:zNe},WNe=Si((n,t)=>Math.atan2(n,t)),HNe=ji(Ng,WNe),jNe={kernelName:Ng,backendName:"cpu",kernelFunc:HNe},GNe=gn(Dg,n=>Math.atanh(n)),qNe={kernelName:Dg,backendName:"cpu",kernelFunc:GNe};function AP(n,t,e,i,s,r){const o=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,c=s.dilationWidth,u=s.effectiveFilterHeight,d=s.effectiveFilterWidth,h=s.padInfo.top,f=s.padInfo.left,p="max"===r?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Dt(s.outShape,e),m=g.values,b=s.outShape[1]*s.outShape[2]*s.outShape[3],_=s.outShape[2]*s.outShape[3],y=s.outShape[3];for(let v=0;v<s.batchSize;++v){const x=v*b,S=v*i[0];for(let E=0;E<s.inChannels;++E)for(let k=0;k<s.outHeight;++k){const D=k*o-h,M=Math.max(0,D),R=Math.min(s.inHeight,u+D),U=x+k*_;for(let X=0;X<s.outWidth;++X){const ee=X*a-f,K=Math.max(0,ee),O=Math.min(s.inWidth,d+ee);let z=p,B=0,q=0;for(let le=M;le<R;le+=l){const he=S+le*i[1];for(let ue=K;ue<O;ue+=c){const ve=n[he+ue*i[2]+E];"max"===r&&ve>z?z=ve:"avg"===r&&(B+=ve,q++)}if(isNaN(z))break}m[U+X*y+E]="avg"===r?B/q:z}}}return g}function b7(n,t,e,i,s=!1,r=!1){const o=Dt(i.outShape,"int32"),a=i.strideHeight,l=i.strideWidth,c=i.dilationHeight,u=i.dilationWidth,d=i.effectiveFilterHeight,h=i.effectiveFilterWidth,f=i.padInfo.top,p=i.padInfo.left,g=Dt(t,e,n);for(let m=0;m<i.batchSize;++m)for(let b=0;b<i.inChannels;++b)for(let _=0;_<i.outHeight;++_){const y=_*a-f;let v=y;for(;v<0;)v+=c;const x=Math.min(i.inHeight,d+y);for(let S=0;S<i.outWidth;++S){const E=S*l-p;let k=E;for(;k<0;)k+=u;const D=Math.min(i.inWidth,h+E);let M=Number.NEGATIVE_INFINITY,R=-1;for(let U=v;U<x;U+=c){const X=U-y;for(let ee=k;ee<D;ee+=u){const K=ee-E,O=g.get(m,U,ee,b);O>M&&(M=O,R=s?r?((m*i.inHeight+U)*i.inWidth+ee)*i.inChannels+b:(U*i.inWidth+ee)*i.inChannels+b:X*h+K)}}o.set(R,m,_,S,b)}}return o}function _7(n,t,e,i,s,r){const o=s.strideDepth,a=s.strideHeight,l=s.strideWidth,c=s.dilationDepth,u=s.dilationHeight,d=s.dilationWidth,h=s.effectiveFilterDepth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,g=s.padInfo.front,m=s.padInfo.top,b=s.padInfo.left,_="max"===r?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=Dt(s.outShape,e),v=y.values,x=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],S=s.outShape[2]*s.outShape[3]*s.outShape[4],E=s.outShape[3]*s.outShape[4],k=s.outShape[4];for(let D=0;D<s.batchSize;++D){const M=D*x,R=D*i[0];for(let U=0;U<s.inChannels;++U)for(let X=0;X<s.outDepth;++X){const ee=X*o-g;let K=ee;for(;K<0;)K+=c;const O=Math.min(s.inDepth,h+ee),z=M+X*S;for(let B=0;B<s.outHeight;++B){const q=B*a-m;let se=q;for(;se<0;)se+=u;const le=Math.min(s.inHeight,f+q),he=z+B*E;for(let ue=0;ue<s.outWidth;++ue){const de=ue*l-b;let ve=de;for(;ve<0;)ve+=d;const Ee=Math.min(s.inWidth,p+de),Me=he+ue*k;let Xe=_,Ve=0,ut=0;for(let bn=K;bn<O;bn+=c){const Dn=R+bn*i[1];for(let ui=se;ui<le;ui+=u){const Nn=Dn+ui*i[2];for(let xn=ve;xn<Ee;xn+=d){const Xn=n[Nn+xn*i[3]+U];if("max"===r&&Xn>Xe?Xe=Xn:"avg"===r&&(Ve+=Xn,ut++),isNaN(Xe))break}if(isNaN(Xe))break}if(isNaN(Xe))break}v[Me+U]="avg"===r?Ve/Math.max(ut,1):Xe}}}}return y}const YNe={kernelName:hx,backendName:"cpu",kernelFunc:function XNe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t;Ue(s,"avgPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=i;T(hs(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const u=bo(s.shape,r,o,1,a,l);let d;if(1===u.filterWidth&&1===u.filterHeight&&tn(u.inShape,u.outShape))d=Ga({inputs:{x:s},backend:e});else{const h=e.data.get(s.dataId).values,f=Ye(s.shape),p=AP(h,0,s.dtype,f,u,"avg");d=e.makeTensorInfo(u.outShape,s.dtype,p.values)}return d}},QNe={kernelName:fx,backendName:"cpu",kernelFunc:function ZNe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{filterSize:r,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=i;Ue(s,"avgPool3d");const u=Il(s.shape,r,o,1,a,l,c),h=_7(e.data.get(s.dataId).values,0,s.dtype,Ye(s.shape),u,"avg");return e.makeTensorInfo(h.shape,"float32",h.values)}},eAe={kernelName:tN,backendName:"cpu",kernelFunc:function JNe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r}=t,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=i;Ue([s,r],"avgPool3DGrad");const u=Il(r.shape,o,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,g=u.filterHeight,m=u.filterWidth,b=u.dilationDepth,_=u.dilationHeight,y=u.dilationWidth,v=u.effectiveFilterDepth,x=u.effectiveFilterHeight,S=u.effectiveFilterWidth,E=v-1-u.padInfo.front,k=S-1-u.padInfo.left,D=x-1-u.padInfo.top,M=Dt(r.shape,"float32"),R=1/(p*g*m),U=e.bufferSync(s);for(let X=0;X<u.batchSize;++X)for(let ee=0;ee<u.inChannels;++ee)for(let K=0;K<u.inDepth;++K)for(let O=0;O<u.inHeight;++O)for(let z=0;z<u.inWidth;++z){const B=K-E,q=O-D,se=z-k;let le=0;for(let he=0;he<v;he+=b){const ue=(B+he)/d;if(!(ue<0||ue>=u.outDepth||Math.floor(ue)!==ue))for(let de=0;de<x;de+=_){const ve=(q+de)/h;if(!(ve<0||ve>=u.outHeight||Math.floor(ve)!==ve))for(let Ee=0;Ee<S;Ee+=y){const Me=(se+Ee)/f;Me<0||Me>=u.outWidth||Math.floor(Me)!==Me||(le+=U.get(X,ue,ve,Me,ee))}}}M.set(le*R,X,K,O,z,ee)}return e.makeTensorInfo(M.shape,M.dtype,M.values)}},nAe={kernelName:eN,backendName:"cpu",kernelFunc:function tAe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r}=t,o=r;Ue([s,r],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=i,u=bo(o.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,g=u.dilationHeight,m=u.dilationWidth,b=u.effectiveFilterHeight,_=u.effectiveFilterWidth,y=_-1-u.padInfo.left,v=b-1-u.padInfo.top,x=Dt(o.shape,"float32"),S=1/(f*p),E=e.data.get(s.dataId).values,k=Dt(s.shape,"float32",E);for(let D=0;D<u.batchSize;++D)for(let M=0;M<u.inChannels;++M)for(let R=0;R<u.inHeight;++R)for(let U=0;U<u.inWidth;++U){const X=R-v,ee=U-y;let K=0;for(let O=0;O<b;O+=g){const z=(X+O)/d;if(!(z<0||z>=u.outHeight||Math.floor(z)!==z))for(let B=0;B<_;B+=m){const q=(ee+B)/h;q<0||q>=u.outWidth||Math.floor(q)!==q||(K+=k.get(D,z,q,M))}}x.set(K*S,D,R,U,M)}return e.makeTensorInfo(x.shape,x.dtype,x.values)}},sAe={kernelName:Ex,backendName:"cpu",kernelFunc:function iAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,scale:r,offset:o,mean:a,variance:l}=t;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(null==o||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(null==r||a.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ue([s,a,l,r,o],"batchNorm");let{varianceEpsilon:c}=i;null==c&&(c=.001);const u=e.data.get(s.dataId).values,d=e.data.get(a.dataId).values,h=e.data.get(l.dataId).values,f=r?e.data.get(r.dataId).values:new Float32Array([1]),p=o?e.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),m=p.length,b=f.length,_=h.length,y=d.length;let v=0,x=0,S=0,E=0;for(let k=0;k<u.length;++k)g[k]=p[v++]+(u[k]-d[x++])*f[S++]/Math.sqrt(h[E++]+c),v>=m&&(v=0),x>=y&&(x=0),S>=b&&(S=0),E>=_&&(E=0);return e.makeTensorInfo(s.shape,s.dtype,g)}};function y7(n,t,e,i,s){const r=IA(i,t,e),o=te(e),a=Ye(i);if(r){const d=EA(t,a);return"string"===s?n.slice(d,d+o):n.subarray(d,d+o)}const c=Dt(i,s,"string"===s?Rl(n):n),u=Dt(e,s);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,g)=>p+t[g]);u.set(c.get(...f),...h)}return"string"===s?VG(u.values):u.values}function vd(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{begin:r,size:o}=i;Ue(s,"slice");const[a,l]=kC(s,r,o);wA(s,a,l);const u=y7(e.data.get(s.dataId).values,a,l,s.shape,s.dtype);return e.makeTensorInfo(l,s.dtype,u)}const rAe={kernelName:tC,backendName:"cpu",kernelFunc:vd},aAe={kernelName:mx,backendName:"cpu",kernelFunc:function oAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{blockShape:r,crops:o}=i;Ue([s],"batchToSpaceND");const a=r.reduce((b,_)=>b*_),l=$b(s.shape,r,a),c=Bb(l.length,r.length),u=Vb(s.shape,r,a),d=lM(o,r.length),h=cM(u,o,r.length),f=Tn({inputs:{x:s},backend:e,attrs:{shape:l}}),p=ar({inputs:{x:f},backend:e,attrs:{perm:c}}),g=Tn({inputs:{x:p},backend:e,attrs:{shape:u}}),m=vd({inputs:{x:g},backend:e,attrs:{begin:d,size:h}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(g),m}};function MP(n,t,e,i,s){const r=te(i),o=xs(s,e);for(let a=0;a<n.length;a++){const l=n[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o[l]+=r>0?t[a]:1)}return o}function v7(n,t,e,i=!1){const s=n.shape[0],r=n.shape[1],o=Dt([s,e],t.dtype);for(let a=0;a<s;a++)for(let l=0;l<r;l++){const c=n.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=e||o.set(i?1:t.size>0?o.get(a,c)+t.get(a,l):o.get(a,c)+1,a,c)}return o}const cAe={kernelName:nN,backendName:"cpu",kernelFunc:function lAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,weights:r}=t,{size:o}=i,c=MP(e.data.get(s.dataId).values,e.data.get(r.dataId).values,r.dtype,r.shape,o);return e.makeTensorInfo([o],r.dtype,c)}},x7=Si((n,t)=>n&t),dAe={kernelName:iN,backendName:"cpu",kernelFunc:ji(iN,x7)},fAe={kernelName:gH,backendName:"cpu",kernelFunc:function hAe(n){const{inputs:t,backend:e}=n,{s0:i,s1:s}=t,r=e.data.get(i.dataId).values,o=e.data.get(s.dataId).values,a=ft(Array.from(r),Array.from(o));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}},C7=ja(n=>Math.ceil(n)),pAe=jc(Mg,C7),mAe={kernelName:Mg,backendName:"cpu",kernelFunc:pAe},gAe=gn(Pg,(n,t)=>n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n),bAe={kernelName:Pg,backendName:"cpu",kernelFunc:gAe},_Ae={kernelName:gx,backendName:"cpu",kernelFunc:n=>{const{x:t}=n.inputs,e=n.backend,i=new Float32Array(te(t.shape)),s=e.data.get(t.dataId),o=s.complexTensorInfos.imag,a=e.data.get(s.complexTensorInfos.real.dataId).values,l=e.data.get(o.dataId).values;for(let c=0;c<a.length;c++)i[c]=Math.hypot(a[c],l[c]);return e.makeOutput(i,t.shape,"float32")}};function w7(n,t,e,i){const s=yi(e,te(t));if(i&&"string"!==e){let r=0;n.forEach(o=>{const a=te(o.shape);s.set(o.vals,r),r+=a})}else{let r=0;n.forEach(o=>{const a="string"===e?Rl(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*t[1]+r;for(let d=0;d<o.shape[1];++d)s[u+d]=a[l++]}r+=o.shape[1]})}return s}function Kf(n){const{inputs:t,backend:e}=n,{input:i}=t,s=e.data.get(i.dataId).complexTensorInfos.imag,r=e.data.get(s.dataId).values;return e.makeTensorInfo(s.shape,s.dtype,r)}const yAe={kernelName:CN,backendName:"cpu",kernelFunc:Kf};function Xf(n){const{inputs:t,backend:e,attrs:i}=n,{axis:s}=i,r=Tt(s,t[0].shape)[0];rM(t.map(g=>g.shape),r);let a=La(t.map(g=>g.shape),r);if(0===te(a))return e.makeTensorInfo(a,t[0].dtype,[]);const l=t.filter(g=>te(g.shape)>0);if(1===l.length)return Ga({inputs:{x:l[0]},backend:e});if("complex64"===l[0].dtype){const g=l.map(v=>yd({inputs:{input:v},backend:e})),m=l.map(v=>Kf({inputs:{input:v},backend:e})),b=Xf({inputs:g,backend:e,attrs:{axis:r}}),_=Xf({inputs:m,backend:e,attrs:{axis:r}}),y=_r({inputs:{real:b,imag:_},backend:e});return g.forEach(v=>e.disposeIntermediateTensorInfo(v)),m.forEach(v=>e.disposeIntermediateTensorInfo(v)),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(_),y}const c=l.map(g=>{const b=[-1,te(g.shape.slice(r))];return Tn({inputs:{x:g},backend:e,attrs:{shape:b}})}),u=c.map(g=>({vals:e.data.get(g.dataId).values,shape:g.shape}));a=La(c.map(g=>g.shape),1);const h=w7(u,a,t[0].dtype,1===c[0].shape[0]),f=La(l.map(g=>g.shape),r),p=e.makeTensorInfo(f,t[0].dtype,h);return c.forEach(g=>e.disposeIntermediateTensorInfo(g)),p}const vAe={kernelName:bx,backendName:"cpu",kernelFunc:Xf};function S7(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r}=t,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=i;Ue([s,r],"conv2d");const d=El(l),h=es(s.shape,r.shape,o,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,g=h.dilationHeight,m=h.dilationWidth,b=h.padInfo.left,_=h.padInfo.top,y="channelsLast"===h.dataFormat,v=new ds(h.outShape,s.dtype),x=Ye(s.shape),S=Ye(r.shape),E=x[0],k=y?x[1]:x[2],D=y?x[2]:1,M=y?1:x[1],R=v.strides[0],U=y?v.strides[1]:v.strides[2],X=y?v.strides[2]:1,ee=y?1:v.strides[1],K=e.data.get(s.dataId).values,O=e.data.get(r.dataId).values,z=v.values;for(let B=0;B<h.batchSize;++B){const q=B*E,se=B*R;for(let le=0;le<h.outHeight;++le){const he=se+le*U,ue=le*h.strideHeight-_;for(let de=0;de<f;++de){const ve=ue+de*g;if(ve<0||ve>=h.inHeight)continue;const Ee=de*S[0],Me=q+ve*k;for(let Xe=0;Xe<h.outWidth;++Xe){const Ve=he+Xe*X,ut=Xe*h.strideWidth-b;for(let pt=0;pt<p;++pt){const bn=ut+pt*m;if(bn<0||bn>=h.inWidth)continue;const ui=Me+bn*D;let Nn=Ee+pt*S[1];for(let xn=0;xn<h.inChannels;++xn){const si=K[ui+xn*M];for(let Xn=0;Xn<h.outChannels;++Xn)z[Ve+Xn*ee]+=si*O[Nn+Xn];Nn+=h.outChannels}}}}}}return e.makeTensorInfo(v.shape,v.dtype,z)}const xAe={kernelName:_x,backendName:"cpu",kernelFunc:S7},wAe={kernelName:rN,backendName:"cpu",kernelFunc:function CAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,dy:r}=t,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=i;Ue([s,r],"conv2dBackpropFilter");const d=El(l),h=es(s.shape,u,o,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:m}=h,b="channelsLast"===h.dataFormat,_=new ds(h.filterShape,"float32"),y=h.padInfo.left,v=h.padInfo.top,x=e.data.get(s.dataId).values,S=e.data.get(r.dataId).values,E=new ds(s.shape,s.dtype,x),k=new ds(r.shape,r.dtype,S);for(let D=0;D<g;++D){const M=Math.max(0,Math.ceil((v-D)/f)),R=Math.min(h.outHeight,(h.inHeight+v-D)/f);for(let U=0;U<m;++U){const X=Math.max(0,Math.ceil((y-U)/p)),ee=Math.min(h.outWidth,(h.inWidth+y-U)/p);for(let K=0;K<h.inChannels;++K)for(let O=0;O<h.outChannels;++O){let z=0;for(let B=0;B<h.batchSize;++B)for(let q=M;q<R;++q){const se=D+q*f-v;for(let le=X;le<ee;++le){const he=U+le*p-y;z+=b?E.get(B,se,he,K)*k.get(B,q,le,O):E.get(B,K,se,he)*k.get(B,O,q,le)}}_.set(z,D,U,K,O)}}}return e.makeTensorInfo(_.shape,_.dtype,_.values)}},IAe={kernelName:yx,backendName:"cpu",kernelFunc:function SAe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,filter:r}=t,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=i;Ue([s,r],"conv2dBackpropInput");const d=Ye(r.shape),h=Ye(s.shape);let f=El(c);const p=es(o,r.shape,a,1,l,u,!1,f),g=new ds(p.inShape,"float32"),m=g.values,b=e.data.get(s.dataId).values,_=e.data.get(r.dataId).values,[y,v,x]=d,{batchSize:S,filterHeight:E,filterWidth:k,inChannels:D,inHeight:M,inWidth:R,outChannels:U,outHeight:X,outWidth:ee,strideHeight:K,strideWidth:O}=p;f=p.dataFormat;const z=E-1-p.padInfo.top,B=k-1-p.padInfo.left,q="channelsLast"===f,se=g.strides[0],le=q?g.strides[1]:g.strides[2],he=q?g.strides[2]:1,ue=q?1:g.strides[1],de=h[0],ve=q?h[1]:h[2],Ee=q?h[2]:1,Me=q?1:h[1];for(let Xe=0;Xe<S;++Xe)for(let Ve=0;Ve<D;++Ve)for(let ut=0;ut<M;++ut){const pt=ut-z,bn=Math.max(0,Math.ceil(pt/K)),Dn=Math.min(X,(E+pt)/K);for(let ui=0;ui<R;++ui){const Nn=ui-B,xn=Math.max(0,Math.ceil(Nn/O)),si=Math.min(ee,(k+Nn)/O);let Xn=0;for(let gs=bn;gs<Dn;++gs){const au=gs*K-pt;for(let Xr=xn;Xr<si;++Xr){const oa=de*Xe+ve*gs+Ee*Xr,Kl=y*(E-1-au)+v*(k-1-(Xr*O-Nn))+x*Ve;for(let lu=0;lu<U;++lu)Xn+=b[oa+Me*lu]*_[Kl+lu]}}m[se*Xe+le*ut+he*ui+ue*Ve]=Xn}}return e.makeTensorInfo(g.shape,g.dtype,g.values)}},kAe={kernelName:vx,backendName:"cpu",kernelFunc:function EAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r}=t,{strides:o,pad:a,dilations:l}=i;Ue([s,r],"conv3d");const c=Rc(s.shape,r.shape,o,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:g,padInfo:m}=c,b=m.front,_=m.left,y=m.top,v=new ds(c.outShape,s.dtype),x=e.data.get(s.dataId).values,S=e.data.get(r.dataId).values,E=v.values,k=Ye(s.shape),D=Ye(r.shape);for(let M=0;M<c.batchSize;++M){const R=M*k[0],U=M*v.strides[0];for(let X=0;X<c.outDepth;++X){const ee=U+X*v.strides[1],K=X*c.strideDepth-b;for(let O=0;O<u;++O){const z=K+O*f;if(z<0||z>=c.inDepth)continue;const B=O*D[0],q=R+z*k[1];for(let se=0;se<c.outHeight;++se){const le=ee+se*v.strides[2],he=se*c.strideHeight-y;for(let ue=0;ue<d;++ue){const de=he+ue*p;if(de<0||de>=c.inHeight)continue;const ve=B+ue*D[1],Ee=q+de*k[2];for(let Me=0;Me<c.outWidth;++Me){const Xe=le+Me*c.outChannels,Ve=Me*c.strideWidth-_;for(let ut=0;ut<h;++ut){const pt=Ve+ut*g;if(pt<0||pt>=c.inWidth)continue;const Dn=Ee+pt*c.inChannels;let ui=ve+ut*D[2];for(let Nn=0;Nn<c.inChannels;++Nn){const xn=x[Dn+Nn];for(let si=0;si<c.outChannels;++si)E[Xe+si]+=xn*S[ui+si];ui+=c.outChannels}}}}}}}}return e.makeTensorInfo(v.shape,v.dtype,v.values)}},DAe={kernelName:oN,backendName:"cpu",kernelFunc:function TAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,dy:r}=t,{strides:o,pad:a,filterShape:l}=i;Ue([s,r],"conv3dBackpropFilterV2");const c=Ye(s.shape),u=Ye(r.shape),d=Rc(s.shape,l,o,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,g=d.filterDepth,m=d.filterHeight,b=d.filterWidth,_=new ds(d.filterShape,"float32"),y=_.values,[v,x,S,E]=_.strides,k=e.data.get(r.dataId).values,[D,M,R,U]=u,X=e.data.get(s.dataId).values,[ee,K,O,z]=c,B=d.padInfo.front,q=d.padInfo.left,se=d.padInfo.top;for(let le=0;le<g;++le){const he=Math.max(0,Math.ceil((B-le)/h)),ue=Math.min(d.outDepth,(d.inDepth+B-le)/h),de=le*v;for(let ve=0;ve<m;++ve){const Ee=Math.max(0,Math.ceil((se-ve)/f)),Me=Math.min(d.outHeight,(d.inHeight+se-ve)/f),Xe=ve*x+de;for(let Ve=0;Ve<b;++Ve){const ut=Math.max(0,Math.ceil((q-Ve)/p)),pt=Math.min(d.outWidth,(d.inWidth+q-Ve)/p),bn=Ve*S+Xe;for(let Dn=0;Dn<d.inChannels;++Dn){const ui=Dn*E+bn;for(let Nn=0;Nn<d.outChannels;++Nn){let xn=0;for(let si=0;si<d.batchSize;++si){const Xn=si*ee,ql=si*D;for(let gs=he;gs<ue;++gs){const Xr=(le+gs*h-B)*K+Xn,Wd=gs*M+ql;for(let oa=Ee;oa<Me;++oa){const lu=(ve+oa*f-se)*O+Xr,cu=oa*R+Wd;for(let uu=ut;uu<pt;++uu)xn+=X[(Ve+uu*p-q)*z+lu+Dn]*k[uu*U+cu+Nn]}}}y[ui+Nn]=xn}}}}}return e.makeTensorInfo(_.shape,_.dtype,_.values)}},AAe={kernelName:aN,backendName:"cpu",kernelFunc:function NAe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,filter:r}=t,{pad:o,strides:a,inputShape:l}=i;Ue([s],"conv3dBackpropInputV2");const c=Ye(s.shape),u=Ye(r.shape),d=Rc(l,r.shape,a,1,o),h=new ds(d.inShape,"float32"),f=h.values,[p,g,m,b]=h.strides,_=e.data.get(s.dataId).values,[y,v,x,S]=c,E=e.data.get(r.dataId).values,[k,D,M,R]=u,{batchSize:U,filterDepth:X,filterHeight:ee,filterWidth:K,inChannels:O,inDepth:z,inHeight:B,inWidth:q,outChannels:se,outDepth:le,outHeight:he,outWidth:ue,strideDepth:de,strideHeight:ve,strideWidth:Ee}=d,Me=X-1-d.padInfo.front,Xe=ee-1-d.padInfo.top,Ve=K-1-d.padInfo.left;for(let ut=0;ut<U;++ut)for(let pt=0;pt<O;++pt)for(let bn=0;bn<z;++bn){const Dn=bn-Me,ui=Math.max(0,Math.ceil(Dn/de)),Nn=Math.min(le,(X+Dn)/de);for(let xn=0;xn<B;++xn){const si=xn-Xe,Xn=Math.max(0,Math.ceil(si/ve)),ql=Math.min(he,(ee+si)/ve);for(let gs=0;gs<q;++gs){const au=gs-Ve,Xr=Math.max(0,Math.ceil(au/Ee)),Wd=Math.min(ue,(K+au)/Ee);let oa=0;for(let Kl=ui;Kl<Nn;++Kl){const lu=Kl*de-Dn;for(let cu=Xn;cu<ql;++cu){const uu=cu*ve-si;for(let G_=Xr;G_<Wd;++G_){const PR=y*ut+v*Kl+x*cu+S*G_,UKe=k*(X-1-lu)+D*(ee-1-uu)+M*(K-1-(G_*Ee-au))+R*pt;for(let X1=0;X1<se;++X1)oa+=_[PR+X1]*E[UKe+X1]}}}f[p*ut+g*bn+m*xn+b*gs+pt]=oa}}}return e.makeTensorInfo(h.shape,h.dtype,h.values)}},MAe=gn(Rg,n=>Math.cos(n)),PAe={kernelName:Rg,backendName:"cpu",kernelFunc:MAe},RAe=gn(Og,n=>Math.cosh(n)),OAe={kernelName:Og,backendName:"cpu",kernelFunc:RAe},LAe={kernelName:cN,backendName:"cpu",kernelFunc:function FAe(n){const{inputs:t,backend:e,attrs:i}=n,{image:s,boxes:r,boxInd:o}=t,{cropSize:a,method:l,extrapolationValue:c}=i,[u,d,h,f]=s.shape,p=r.shape[0],[g,m]=a,b=Dt([p,g,m,f],"float32"),_=e.data.get(r.dataId).values,y=e.data.get(o.dataId).values,v=e.data.get(s.dataId).values,x=Ye(s.shape),S=Ye(b.shape);for(let E=0;E<p;E++){const k=4*E,D=_[k],M=_[k+1],R=_[k+2],U=_[k+3],X=y[E];if(X>=u)continue;const ee=g>1?(R-D)*(d-1)/(g-1):0,K=m>1?(U-M)*(h-1)/(m-1):0;for(let O=0;O<g;O++){const z=g>1?D*(d-1)+O*ee:.5*(D+R)*(d-1);if(z<0||z>d-1)for(let B=0;B<m;B++)for(let q=0;q<f;q++)b.values[q+B*S[2]+O*S[1]+E*S[0]]=c;else if("bilinear"===l){const B=Math.floor(z),q=Math.ceil(z),se=z-B;for(let le=0;le<m;le++){const he=m>1?M*(h-1)+le*K:.5*(M+U)*(h-1);if(he<0||he>h-1){for(let Ee=0;Ee<f;Ee++)b.values[Ee+le*S[2]+O*S[1]+E*S[0]]=c;continue}const ue=Math.floor(he),de=Math.ceil(he),ve=he-ue;for(let Ee=0;Ee<f;Ee++){let Me=Ee+ue*x[2]+B*x[1]+X*x[0];const Xe=v[Me];Me=Ee+de*x[2]+B*x[1]+X*x[0];const Ve=v[Me];Me=Ee+ue*x[2]+q*x[1]+X*x[0];const ut=v[Me];Me=Ee+de*x[2]+q*x[1]+X*x[0];const pt=v[Me],bn=Xe+(Ve-Xe)*ve;Me=Ee+le*S[2]+O*S[1]+E*S[0],b.values[Me]=bn+(ut+(pt-ut)*ve-bn)*se}}}else for(let B=0;B<m;++B){const q=m>1?M*(h-1)+B*K:.5*(M+U)*(h-1);if(q<0||q>h-1){for(let he=0;he<f;he++)b.values[he+B*S[2]+O*S[1]+E*S[0]]=c;continue}const se=Math.round(q),le=Math.round(z);for(let he=0;he<f;he++)b.values[he+B*S[2]+O*S[1]+E*S[0]]=v[he+se*x[2]+le*x[1]+X*x[0]]}}}return e.makeTensorInfo(b.shape,b.dtype,b.values)}},BAe={kernelName:lN,backendName:"cpu",kernelFunc:function $Ae(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,exclusive:o,reverse:a}=i;Ue(s,"cumprod");const l=ti([r],s.shape.length);let c=s;null!=l&&(c=ar({inputs:{x:s},backend:e,attrs:{perm:l}}));const u=xi(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=br(c.dtype,"int32"),h=qD(te(c.shape),d),f=e.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(b,_)=>b+p-_-1:(b,_)=>b+_;for(let b=0;b<f.length;b+=p)for(let _=0;_<p;_++){const y=g(b,_);if(0===_)h[y]=o?1:f[y];else{const v=g(b,_-1);h[y]=o?f[v]*h[v]:f[y]*h[v]}}const m=e.makeTensorInfo(c.shape,d,h);if(null!=l){const _=ar({inputs:{x:m},backend:e,attrs:{perm:Fc(l)}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(c),_}return m}},zAe={kernelName:xx,backendName:"cpu",kernelFunc:function VAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,exclusive:o,reverse:a}=i;Ue(s,"cumsum");const l=ti([r],s.shape.length);let c=s;null!=l&&(c=ar({inputs:{x:s},backend:e,attrs:{perm:l}}));const u=xi(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=br(c.dtype,"int32"),h=xs(te(c.shape),d),f=e.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(b,_)=>b+p-_-1:(b,_)=>b+_;for(let b=0;b<f.length;b+=p)for(let _=0;_<p;_++){const y=g(b,_);if(0===_)h[y]=o?0:f[y];else{const v=g(b,_-1);h[y]=o?f[v]+h[v]:f[y]+h[v]}}const m=e.makeTensorInfo(c.shape,d,h);if(null!=l){const _=ar({inputs:{x:m},backend:e,attrs:{perm:Fc(l)}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(c),_}return m}},WAe={kernelName:uN,backendName:"cpu",kernelFunc:function UAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,weights:r}=t,{size:o,binaryOutput:a}=i;if(1===s.shape.length){const u=MP(e.data.get(s.dataId).values,e.data.get(r.dataId).values,r.dtype,r.shape,o);return e.makeTensorInfo([o],r.dtype,u)}if(2===s.shape.length){const u=v7(e.bufferSync(s),e.bufferSync(r),o,a);return e.makeTensorInfo(u.shape,r.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}},jAe={kernelName:dN,backendName:"cpu",kernelFunc:function HAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{blockSize:r,dataFormat:o}=i;T("NHWC"===o,()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],l=s.shape[1],c=s.shape[2],u=s.shape[3],d=l*r,h=c*r,f=u/(r*r),p=e.data.get(s.dataId).values,g=new Float32Array(a*d*h*f);let m=0;for(let b=0;b<a;++b)for(let _=0;_<d;++_){const y=Math.floor(_/r),v=_%r;for(let x=0;x<h;++x){const S=Math.floor(x/r),k=(v*r+x%r)*f;for(let D=0;D<f;++D)g[m++]=p[D+k+u*(S+c*(y+l*b))]}}return e.makeTensorInfo([a,d,h,f],s.dtype,g)}};function I7(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r}=t,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=i;Ue([s,r],"depthwiseConv2DNative");const u=Ye(s.shape),d=Ye(r.shape);let h=l;null==h&&(h=[1,1]),T(hs(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=es(s.shape,r.shape,o,h,a,c,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:b,padInfo:_}=f,y=_.left,v=_.top,x=f.outChannels/f.inChannels,S=new ds(f.outShape,s.dtype),E=e.data.get(s.dataId).values,k=e.data.get(r.dataId).values,D=S.values;for(let M=0;M<f.batchSize;++M){const R=M*u[0],U=M*S.strides[0];for(let X=0;X<f.outHeight;++X){const ee=U+X*S.strides[1],K=X*f.strideHeight-v;for(let O=0;O<p;++O){const z=K+O*m;if(z<0||z>=f.inHeight)continue;const B=O*d[0],q=R+z*u[1];for(let se=0;se<f.outWidth;++se){const le=ee+se*S.strides[2],he=se*f.strideWidth-y;for(let ue=0;ue<g;++ue){const de=he+ue*b;if(de<0||de>=f.inWidth)continue;const Ee=q+de*f.inChannels;let Me=le,Xe=B+ue*d[1];for(let Ve=0;Ve<f.inChannels;++Ve){const ut=E[Ee+Ve];for(let pt=0;pt<x;++pt)D[Me+pt]+=ut*k[Xe+pt];Me+=x,Xe+=x}}}}}}return e.makeTensorInfo(S.shape,S.dtype,S.values)}const GAe={kernelName:Cx,backendName:"cpu",kernelFunc:I7},KAe={kernelName:hN,backendName:"cpu",kernelFunc:function qAe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,dy:r}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=i;Ue([s,r],"depthwiseConv2dNativeBackpropFilter");const d=es(s.shape,u,o,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:g}=d,m=new ds(d.filterShape,"float32"),b=d.padInfo.left,_=d.padInfo.top,y=d.outChannels/d.inChannels,v=e.data.get(s.dataId).values,x=new ds(s.shape,s.dtype,v),S=e.data.get(r.dataId).values,E=new ds(r.shape,r.dtype,S);for(let k=0;k<p;++k){const D=Math.max(0,Math.ceil((_-k)/h)),M=Math.min(d.outHeight,(d.inHeight+_-k)/h);for(let R=0;R<g;++R){const U=Math.max(0,Math.ceil((b-R)/f)),X=Math.min(d.outWidth,(d.inWidth+b-R)/f);for(let ee=0;ee<d.outChannels;++ee){const K=Math.trunc(ee/y),O=ee%y;let z=0;for(let B=0;B<d.batchSize;++B)for(let q=D;q<M;++q){const se=k+q*h-_;for(let le=U;le<X;++le)z+=x.get(B,se,R+le*f-b,K)*E.get(B,q,le,ee)}m.set(z,k,R,K,O)}}}return e.makeTensorInfo(m.shape,m.dtype,m.values)}},YAe={kernelName:fN,backendName:"cpu",kernelFunc:function XAe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,filter:r}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=i;Ue([s,r],"depthwiseConv2DNativeBackpropInput");const d=Ye(s.shape),h=Ye(r.shape),f=es(u,r.shape,o,a,l,c,!0),p=new ds(f.inShape,"float32"),g=p.values,[m,b,_]=p.strides,y=e.data.get(s.dataId).values,[v,x,S]=d,E=e.data.get(r.dataId).values,[k,D,M]=h,{batchSize:R,filterHeight:U,filterWidth:X,inChannels:ee,inHeight:K,inWidth:O,outChannels:z,outHeight:B,outWidth:q,strideHeight:se,strideWidth:le}=f,he=U-1-f.padInfo.top,ue=X-1-f.padInfo.left,de=z/ee;for(let ve=0;ve<R;++ve)for(let Ee=0;Ee<ee;++Ee)for(let Me=0;Me<K;++Me){const Xe=Me-he,Ve=Math.max(0,Math.ceil(Xe/se)),ut=Math.min(B,(U+Xe)/se);for(let pt=0;pt<O;++pt){const bn=pt-ue,Dn=Math.max(0,Math.ceil(bn/le)),ui=Math.min(q,(X+bn)/le);let Nn=0;for(let xn=Ve;xn<ut;++xn){const si=xn*se-Xe;for(let Xn=Dn;Xn<ui;++Xn){const gs=v*ve+x*xn+S*Xn,au=k*(U-1-si)+D*(X-1-(Xn*le-bn))+M*Ee;for(let Xr=0;Xr<de;++Xr)Nn+=y[gs+(Ee*de+Xr)]*E[au+Xr]}}g[m*ve+b*Me+_*pt+Ee]=Nn}}return e.makeTensorInfo(p.shape,p.dtype,p.values)}},QAe={kernelName:"Diag",backendName:"cpu",kernelFunc:function ZAe(n){const{inputs:t,backend:e}=n,{x:i}=t,s=te(i.shape),r=e.data.get(i.dataId).values,o=Dt([s,s],i.dtype),a=o.values;for(let c=0;c<r.length;c++)a[c*s+c]=r[c];const l=[...i.shape,...i.shape];return e.makeTensorInfo(l,o.dtype,o.values)}},JAe={kernelName:wx,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:i,filter:s}=n,{strides:r,pad:o,dilations:a}=e,l=t,c=l.data.get(i.dataId).values,u=i.shape.length,d=l.data.get(s.dataId).values,h=s.shape.length,{batchSize:f,inHeight:p,inWidth:g,inChannels:m,outHeight:b,outWidth:_,padInfo:y,strideHeight:v,strideWidth:x,filterHeight:S,filterWidth:E,dilationHeight:k,dilationWidth:D,outShape:M}=Eb(i.shape,s.shape,r,o,"NHWC",a),R=te(M),U=M.length,X=yi(i.dtype,R);for(let K=0;K<f;++K)for(let O=0;O<b;++O){const z=O*v-y.top;for(let B=0;B<_;++B){const q=B*x-y.left;for(let se=0;se<m;++se){let le=Number.MIN_SAFE_INTEGER;for(let ue=0;ue<S;++ue){const de=z+ue*k;if(de>=0&&de<p)for(let ve=0;ve<E;++ve){const Ee=q+ve*D;if(Ee>=0&&Ee<g){const Me=Aa([K,de,Ee,se],u,Ye(i.shape)),Xe=Aa([ue,ve,se],h,Ye(s.shape)),Ve=c[Me]+d[Xe];Ve>le&&(le=Ve)}}}X[Aa([K,O,B,se],U,Ye(M))]=le}}}return{dataId:l.write(Qu(X,i.dtype),M,i.dtype),shape:M,dtype:i.dtype}}},eMe={kernelName:mN,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:i,filter:s,dy:r}=n,{strides:o,pad:a,dilations:l}=e,c=t,u=qo(i.shape,c.data.get(i.dataId).values),d=qo(s.shape,c.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:b,padInfo:_,strideHeight:y,strideWidth:v,filterHeight:x,filterWidth:S,dilationHeight:E,dilationWidth:k,outShape:D}=Eb(i.shape,s.shape,o,a,"NHWC",l);T(r.rank===D.length,()=>`Error in ${mN}, dy must have the same rank as output ${D.length}, but got ${r.rank}`);const M=qo(D,c.data.get(r.dataId).values),R=hH(s.shape,s.dtype);for(let X=0;X<h;++X)for(let ee=0;ee<m;++ee){const K=ee*y-_.top;for(let O=0;O<b;++O){const z=O*v-_.left;for(let B=0;B<g;++B){let q=Number.MIN_SAFE_INTEGER,se=0,le=0;for(let he=0;he<x;++he){const ue=K+he*E;if(ue>=0&&ue<f)for(let de=0;de<S;++de){const ve=z+de*k;if(ve>=0&&ve<p){const Ee=u[X][ue][ve][B]+d[he][de][B];Ee>q&&(q=Ee,se=he,le=de)}}}R[se][le][B]+=M[X][ee][O][B]}}}return{dataId:c.write(Qu(R,i.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},tMe={kernelName:pN,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:i,filter:s,dy:r}=n,{strides:o,pad:a,dilations:l}=e,c=t,u=qo(i.shape,c.data.get(i.dataId).values),d=qo(s.shape,c.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:b,padInfo:_,strideHeight:y,strideWidth:v,filterHeight:x,filterWidth:S,dilationHeight:E,dilationWidth:k,outShape:D}=Eb(i.shape,s.shape,o,a,"NHWC",l);T(r.rank===D.length,()=>`Error in ${pN}, dy must have the same rank as output ${D.length}, but got ${r.rank}`);const M=qo(D,c.data.get(r.dataId).values),R=hH(i.shape,i.dtype);for(let X=0;X<h;++X)for(let ee=0;ee<m;++ee){const K=ee*y-_.top;for(let O=0;O<b;++O){const z=O*v-_.left;for(let B=0;B<g;++B){let q=Number.MIN_SAFE_INTEGER,se=K<0?0:K,le=z<0?0:z;for(let he=0;he<x;++he){const ue=K+he*E;if(ue>=0&&ue<f)for(let de=0;de<S;++de){const ve=z+de*k;if(ve>=0&&ve<p){const Ee=u[X][ue][ve][B]+d[he][de][B];Ee>q&&(q=Ee,se=ue,le=ve)}}}R[X][se][le][B]+=M[X][ee][O][B]}}}return{dataId:c.write(Qu(R,i.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},iMe={kernelName:"Draw",backendName:"cpu",kernelFunc:function nMe(n){const{inputs:t,backend:e,attrs:i}=n,{image:s}=t,{canvas:r,options:o}=i,{contextOptions:a,imageOptions:l}=o||{},c=l?.alpha||1,u=a?.contextType||"2d";if("2d"!==u)throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=r.getContext(u,a?.contextAttributes||{});if(null==d)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=s.shape.slice(0,2),p=2===s.shape.length?1:s.shape[2],g=e.data.get(s.dataId).values,m="float32"===s.dtype?255:1,b=new Uint8ClampedArray(f*h*4);for(let y=0;y<h*f;++y){const v=[0,0,0,255*c];for(let S=0;S<p;S++){const E=g[y*p+S];if("float32"===s.dtype){if(E<0||E>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${E}.`)}else if("int32"===s.dtype&&(E<0||E>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${E}.`);1===p?(v[0]=E*m,v[1]=E*m,v[2]=E*m):v[S]=E*m}const x=4*y;b[x+0]=Math.round(v[0]),b[x+1]=Math.round(v[1]),b[x+2]=Math.round(v[2]),b[x+3]=Math.round(v[3])}r.width=f,r.height=h;const _=new ImageData(b,f,h);return d.putImageData(_,0,0),s}},PP=Si((n,t)=>n*t),sMe=DP((n,t,e,i)=>({real:n*e-t*i,imag:n*i+t*e})),Sw=ji(Jg,PP,sMe),rMe={kernelName:Jg,backendName:"cpu",kernelFunc:Sw};function t_(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i;let a;Ue(s,"sum"),a="bool"===s.dtype?Gc({inputs:{x:s},backend:e,attrs:{dtype:"int32"}}):Ga({inputs:{x:s},backend:e});const l=a.shape.length,c=Tt(r,a.shape),u=ti(c,l);let d=c,h=a;null!=u&&(h=ar({inputs:{x:a},backend:e,attrs:{perm:u}}),d=xi(d.length,l)),fs("sum",d,h.shape.length);const[f,p]=ts(h.shape,d);let m=ww(e,f,br(h.dtype,"int32"));const b=te(p),_=e.data.get(m.dataId).values,y=e.data.get(h.dataId).values;for(let v=0;v<_.length;++v){const x=v*b;let S=0;for(let E=0;E<b;++E)S+=y[x+E];_[v]=S}if(o){const x=m;m=Tn({inputs:{x:m},backend:e,attrs:{shape:vi(m.shape,c)}}),e.disposeIntermediateTensorInfo(x)}return e.disposeIntermediateTensorInfo(a),null!=u&&e.disposeIntermediateTensorInfo(h),m}const oMe={kernelName:nC,backendName:"cpu",kernelFunc:t_},lMe={kernelName:gN,backendName:"cpu",kernelFunc:function aMe(n){const{inputs:t,backend:e,attrs:i}=n,{equation:s}=i,r=t,{allDims:o,summedDims:a,idDims:l}=yM(s,r.length);xM(o.length,l,r);const{path:c,steps:u}=CM(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let g=0;g<d;++g){for(const m of u[g]){const{permutationIndices:b,expandDims:_}=vM(f,l[m]);let y;wM(b)?y=r[m]:(y=ar({inputs:{x:r[m]},backend:e,attrs:{perm:b}}),p.push(y));const v=y.shape.slice();for(let x=0;x<_.length;++x)v.splice(_[x],0,1);tn(y.shape,v)||(y=Tn({inputs:{x:y},backend:e,attrs:{shape:v}}),p.push(y)),null===h?h=y:(h=Sw({inputs:{a:y,b:h},backend:e}),p.push(h))}g<d-1&&(c[g]>=0&&(h=t_({inputs:{x:h},backend:e,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const g of p)g!==h&&e.disposeIntermediateTensorInfo(g);return h}},uMe={kernelName:bN,backendName:"cpu",kernelFunc:function cMe(n){const{inputs:t,backend:e}=n,{dy:i,y:s}=t;Ue([i,s],"eluGrad");const r=new Float32Array(te(s.shape)),o=e.data.get(s.dataId).values,a=e.data.get(i.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];r[l]=c>=0?a[l]:a[l]*(c+1)}return e.makeTensorInfo(s.shape,"float32",r)}},E7=Si((n,t)=>n===t?1:0),k7=ji(Sx,E7,null,"bool"),dMe={kernelName:Sx,backendName:"cpu",kernelFunc:k7},hMe=dM,fMe=hM,pMe=fM,mMe=pM,gMe=mM,bMe=gM,_Me=gn($g,n=>{const t=Math.sign(n),e=Math.abs(n),i=1/(1+hMe*e);return t*(1-((((bMe*i+gMe)*i+mMe)*i+pMe)*i+fMe)*i*Math.exp(-e*e))}),yMe={kernelName:$g,backendName:"cpu",kernelFunc:_Me},T7=ja(n=>Math.exp(n)),D7=jc(Bg,T7,"float32"),vMe={kernelName:Bg,backendName:"cpu",kernelFunc:D7};function Iw(n){const{inputs:t,backend:e,attrs:i}=n,{input:s}=t,{dim:r}=i,o=s.shape.length,a=s.shape.slice();let l=r;return r<0&&(T(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),Tn({inputs:{x:s},backend:e,attrs:{shape:a}})}const xMe={kernelName:Ix,backendName:"cpu",kernelFunc:Iw},N7=ja(n=>Math.expm1(n)),CMe=jc(Vg,N7),wMe={kernelName:Vg,backendName:"cpu",kernelFunc:CMe},SMe=Si((n,t)=>n/t),RP=ji(Fg,SMe),OP={kernelName:Fg,backendName:"cpu",kernelFunc:RP},A7=Si((n,t)=>n-t),IMe=DP((n,t,e,i)=>({real:n-e,imag:t-i})),FP=ji(pb,A7,IMe),EMe={kernelName:pb,backendName:"cpu",kernelFunc:FP};function M7(n,t,e){const i=n.shape,s=i[0],r=i[1],o=e.data.get(n.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[s,r],u=te(c),d=vs("float32",u),h=vs("float32",u);for(let m=0;m<s;m++){const b=vd({inputs:{x:a},backend:e,attrs:{begin:[m,0],size:[1,r]}}),_=vd({inputs:{x:l},backend:e,attrs:{begin:[m,0],size:[1,r]}}),y=_r({inputs:{real:b,imag:_},backend:e}),{real:v,imag:x}=kMe(y,t,e),S=Pl(v,x);for(let E=0;E<r;E++){const k=bM(S,E);d[m*r+E]=k.real,h[m*r+E]=k.imag}e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(y)}const f=e.makeTensorInfo(c,"float32",d),p=e.makeTensorInfo(c,"float32",h),g=_r({inputs:{real:f,imag:p},backend:e});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(p),g}function kMe(n,t,e){const i=te(n.shape),s=e.data.get(n.dataId),r=e.data.get(s.complexTensorInfos.real.dataId).values,o=e.data.get(s.complexTensorInfos.imag.dataId).values;if(function TMe(n){return 0==(n&n-1)}(i)){const a=LP(r,o,i,t,e),l=[n.shape[0],n.shape[1]];if(t){const c=e.makeTensorInfo(l,"float32",a.real),u=e.makeTensorInfo(l,"float32",a.imag),d=e.makeTensorInfo([],"float32",kc(i,"float32")),h=Ga({inputs:{x:d},backend:e}),f=OP.kernelFunc({inputs:{a:c,b:d},backend:e}),p=OP.kernelFunc({inputs:{a:u,b:h},backend:e}),g=e.data.get(f.dataId).values,m=e.data.get(p.dataId).values;return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(p),{real:g,imag:m}}return a}{const l=function DMe(n,t,e){const i=new Float32Array(2*t);for(let s=0;s<t;s++){let r=0,o=0;for(let a=0;a<t;a++){const l=SG(s*a,t,e),c=bM(n,a);r+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}e&&(r/=t,o/=t),CG(i,r,o,s)}return i}(Pl(r,o),i,t);return yG(l)}}function LP(n,t,e,i,s){if(1===e)return{real:n,imag:t};const r=Pl(n,t),o=e/2,a=vG(r),l=a.real,c=a.imag,u=[l.length],d=s.makeTensorInfo(u,"float32",l),h=s.makeTensorInfo(u,"float32",c),f=_r({inputs:{real:d,imag:h},backend:s}),p=xG(r),g=p.real,m=p.imag,b=[g.length],_=s.makeTensorInfo(b,"float32",g),y=s.makeTensorInfo(b,"float32",m),v=_r({inputs:{real:_,imag:y},backend:s}),x=LP(l,c,o,i,s),S=x.real,E=x.imag,k=[S.length],D=s.makeTensorInfo(k,"float32",S),M=s.makeTensorInfo(k,"float32",E),R=_r({inputs:{real:D,imag:M},backend:s}),U=LP(g,m,o,i,s),X=U.real,ee=U.imag,K=[X.length],O=s.makeTensorInfo(K,"float32",X),z=s.makeTensorInfo(K,"float32",ee),B=_r({inputs:{real:O,imag:z},backend:s}),q=wG(e,i),se=[q.real.length],le=s.makeTensorInfo(se,"float32",q.real),he=s.makeTensorInfo(se,"float32",q.imag),ue=_r({inputs:{real:le,imag:he},backend:s}),de=Sw({inputs:{a:ue,b:B},backend:s}),ve=qf({inputs:{a:R,b:de},backend:s}),Ee=FP({inputs:{a:R,b:de},backend:s}),Me=yd({inputs:{input:ve},backend:s}),Xe=yd({inputs:{input:Ee},backend:s}),Ve=Kf({inputs:{input:ve},backend:s}),ut=Kf({inputs:{input:Ee},backend:s}),pt=Xf({inputs:[Me,Xe],backend:s,attrs:{axis:0}}),bn=Xf({inputs:[Ve,ut],backend:s,attrs:{axis:0}}),Dn=s.data.get(pt.dataId).values,ui=s.data.get(bn.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(_),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(R),s.disposeIntermediateTensorInfo(O),s.disposeIntermediateTensorInfo(z),s.disposeIntermediateTensorInfo(B),s.disposeIntermediateTensorInfo(le),s.disposeIntermediateTensorInfo(he),s.disposeIntermediateTensorInfo(ue),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(ve),s.disposeIntermediateTensorInfo(Ee),s.disposeIntermediateTensorInfo(Me),s.disposeIntermediateTensorInfo(Ve),s.disposeIntermediateTensorInfo(Xe),s.disposeIntermediateTensorInfo(ut),s.disposeIntermediateTensorInfo(pt),s.disposeIntermediateTensorInfo(bn),{real:Dn,imag:ui}}const AMe={kernelName:"FFT",backendName:"cpu",kernelFunc:function NMe(n){const{inputs:t,backend:e}=n,{input:i}=t,s=te(i.shape),r=i.shape[i.shape.length-1],a=Tn({inputs:{x:i},backend:e,attrs:{shape:[s/r,r]}}),l=M7(a,!1,e),c=Tn({inputs:{x:l},backend:e,attrs:{shape:i.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}};function $P(n){const{backend:t,attrs:e}=n,{shape:i,value:s,dtype:r}=e,o=r||wf(s),a=yi(o,te(i));return function PMe(n,t,e){n.fill(t)}(a,s),t.makeTensorInfo(i,o,a)}const MMe={kernelName:yN,backendName:"cpu",kernelFunc:$P},RMe={kernelName:vN,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{image:i}=n,s=e,r=vs(i.dtype,te(i.shape)),[o,a,l,c]=i.shape,u=s.data.get(i.dataId).values;for(let h=0;h<o;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const g=p*(l*c);for(let m=0;m<l;m++){const b=m*c;for(let _=0;_<c;_++){const y=Math.round(l-m-1),v=f+g+b+_;let x=u[v];y>=0&&y<l&&(x=u[f+g+y*c+_]),r[v]=x}}}}return{dataId:s.write(r,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},P7=ja(n=>Math.floor(n)),OMe=jc(zg,P7),FMe={kernelName:zg,backendName:"cpu",kernelFunc:OMe},R7=Si((n,t)=>Math.floor(n/t)),LMe=ji(Ug,R7,null,"int32"),$Me={kernelName:Ug,backendName:"cpu",kernelFunc:LMe},VMe={kernelName:dC,backendName:"cpu",kernelFunc:function BMe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=i;let g=S7({inputs:{x:s,filter:r},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const m=g;if("NCHW"===u&&1===o.shape.length&&1!==o.shape[0]){const b=Tn({inputs:{x:o},backend:e,attrs:{shape:[o.shape[0],1,1]}});g=qf({inputs:{a:g,b},backend:e}),e.disposeIntermediateTensorInfo(b)}else g=qf({inputs:{a:g,b:o},backend:e});e.disposeIntermediateTensorInfo(m)}if(f){const m=g;if("NCHW"===u&&"prelu"===f&&1===a.shape.length&&1!==a.shape[0]){const b=Tn({inputs:{x:a},backend:e,attrs:{shape:[a.shape[0],1,1]}});g=Cw(e,g,f,b,p),e.disposeIntermediateTensorInfo(b)}else g=Cw(e,g,f,a,p);e.disposeIntermediateTensorInfo(m)}return g}},UMe={kernelName:hC,backendName:"cpu",kernelFunc:function zMe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=i;let g=I7({inputs:{x:s,filter:r},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const m=g;g=qf({inputs:{a:g,b:o},backend:e}),e.disposeIntermediateTensorInfo(m)}if(f){const m=g;g=Cw(e,g,f,a,p),e.disposeIntermediateTensorInfo(m)}return g}};function O7(n,t,e,i,s,r,o,a,l){const c=Dt([i,r],e);for(let u=0;u<i;u++){const d=[];let h=0;for(let f=0;f<s;f++){const p=n[u*s+f];h+=p*o[f],d.push(p)}if(h<0||h>=l/r)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<r;f++)c.values[u*r+f]=t.get(...t.indexToLoc(h*r+f))}return c}const HMe={kernelName:_H,backendName:"cpu",kernelFunc:function WMe(n){const{inputs:t,backend:e}=n,{params:i,indices:s}=t,r=te(i.shape),o=s.shape,a=o[o.length-1],[l,c,u,d]=uM(i,s);if(0===c)return e.makeTensorInfo(l,i.dtype,[]);const p=O7(e.data.get(s.dataId).values,e.bufferSync(i),i.dtype,c,a,u,d,i.shape,r);return e.makeTensorInfo(l,i.dtype,p.values)}};function F7(n,t,e){const i=Dt(e,n.dtype);for(let s=0;s<i.size;++s){const o=i.indexToLoc(s).slice(),c=t.locToIndex([o[0],o[2]]);o[2]=t.values[c];const u=n.locToIndex(o);0<=u&&u<n.values.length&&(i.values[s]=n.values[u])}return i}const GMe={kernelName:kx,backendName:"cpu",kernelFunc:function jMe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,indices:r}=t,{axis:o,batchDims:a}=i;Ue([s,r],"gatherV2");const l=Tt(o,s.shape)[0],c=e.data.get(r.dataId).values,u=s.shape[l];for(let v=0;v<c.length;++v){const x=c[v];T(x<=u-1&&x>=0,()=>`GatherV2: the index value ${x} is not in [0, ${u-1}]`)}let d=a;null==a&&(d=0);const h=te(r.shape),f=EM(s,r,l,d),p=Tn({inputs:{x:s},backend:e,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=Tn({inputs:{x:r},backend:e,attrs:{shape:[f.batchSize,h/f.batchSize]}}),m=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],b=e.bufferSync(g),y=F7(e.bufferSync(p),b,m);return e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(g),e.makeTensorInfo(f.outputShape,y.dtype,y.values)}},L7=Si((n,t)=>n>t?1:0),qMe=ji(Tx,L7,null,"bool"),KMe={kernelName:Tx,backendName:"cpu",kernelFunc:qMe},$7=Si((n,t)=>n>=t?1:0),XMe=ji(Wg,$7,null,"bool"),YMe={kernelName:Wg,backendName:"cpu",kernelFunc:XMe},QMe={kernelName:xN,backendName:"cpu",kernelFunc:function ZMe(n){const{inputs:t,backend:e}=n,{input:i}=t,s=te(i.shape),r=i.shape[i.shape.length-1],a=Tn({inputs:{x:i},backend:e,attrs:{shape:[s/r,r]}}),l=M7(a,!0,e),c=Tn({inputs:{x:l},backend:e,attrs:{shape:i.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}},JMe=gn(jg,n=>Number.isFinite(n)?1:0,"bool"),ePe={kernelName:jg,backendName:"cpu",kernelFunc:JMe},tPe=gn(Gg,n=>Math.abs(n)===1/0?1:0,"bool"),nPe={kernelName:Gg,backendName:"cpu",kernelFunc:tPe},iPe=gn(qg,n=>Number.isNaN(n)?1:0,"bool"),sPe={kernelName:qg,backendName:"cpu",kernelFunc:iPe},B7=Si((n,t)=>n<t?1:0),rPe=ji(Nx,B7,null,"bool"),oPe={kernelName:Nx,backendName:"cpu",kernelFunc:rPe},V7=Si((n,t)=>n<=t?1:0),aPe=ji(Ax,V7,null,"bool"),lPe={kernelName:Ax,backendName:"cpu",kernelFunc:aPe};function z7(n,t,e){const i=(t-n)/(e-1),s=xs(e,"float32");s[0]=n;for(let r=1;r<s.length;r++)s[r]=s[r-1]+i;return s}const uPe={kernelName:yH,backendName:"cpu",kernelFunc:function cPe(n){const{backend:t,attrs:e}=n,{start:i,stop:s,num:r}=e,o=z7(i,s,r);return t.makeTensorInfo([o.length],"float32",o)}},U7=ja(n=>Math.log(n)),dPe=jc(Kg,U7),hPe={kernelName:Kg,backendName:"cpu",kernelFunc:dPe},fPe=gn(Xg,n=>Math.log1p(n)),pPe={kernelName:Xg,backendName:"cpu",kernelFunc:fPe},mPe=Si((n,t)=>n&&t),gPe=ji(Mx,mPe,null,"bool"),bPe={kernelName:Mx,backendName:"cpu",kernelFunc:gPe},_Pe=gn(Px,n=>n?0:1,"bool"),yPe={kernelName:Px,backendName:"cpu",kernelFunc:_Pe},vPe=Si((n,t)=>n||t),xPe=ji(Rx,vPe,null,"bool"),CPe={kernelName:Rx,backendName:"cpu",kernelFunc:xPe},SPe={kernelName:Ox,backendName:"cpu",kernelFunc:function wPe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{depthRadius:r,bias:o,alpha:a,beta:l}=i;Ue(s,"LRN");const c=s.shape[3],u=c-1,d=e.data.get(s.dataId).values,h=te(s.shape),f=new Float32Array(h);function p(g){const m=g%c;let b=g-m+Math.max(0,m-r);const _=g-m+Math.min(m+r,u);let y=0;for(;b<=_;b++){const v=d[b];y+=v*v}return y}for(let g=0;g<h;g++){const m=p(g),b=d[g]*Math.pow(o+a*m,-l);f[g]=b}return e.makeTensorInfo(s.shape,s.dtype,f)}},EPe={kernelName:wN,backendName:"cpu",kernelFunc:function IPe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,y:r,dy:o}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=i;Ue(o,"LRNGrad");const d=te(o.shape),h=o.shape[3],f=e.data.get(o.dataId).values,p=e.data.get(s.dataId).values,g=e.data.get(r.dataId).values,m=new Float32Array(d),b=d;for(let _=0;_<b;_++){const y=_%h,v=_-y+Math.max(0,y-a),x=_-y+Math.min(h,y+a+1);let S=0;for(let E=v;E<x;E++)S+=Math.pow(p[E],2);S=c*S+l;for(let E=v;E<x;E++){let k=-2*c*u*p[E]*g[_]/S;_===E&&(k+=Math.pow(S,-u)),k*=f[_],m[E]+=k}}return e.makeTensorInfo(o.shape,s.dtype,m)}};function W7(n,t,e,i){const s=vs(i,te(e));for(let r=0;r<s.length;++r){const o=r*t;let a=n[o];for(let l=0;l<t;++l){const c=n[o+l];(Number.isNaN(c)||c>a)&&(a=c)}s[r]=a}return s}function H7(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{reductionIndices:r,keepDims:o}=i,a=e;let l=s.shape;const c=l.length,u=Tt(r,l);let d=u;const h=ti(d,c);let f=a.data.get(s.dataId).values;if(null!=h){const v=new Array(c);for(let x=0;x<v.length;x++)v[x]=l[h[x]];f=NP(f,l,s.dtype,h,v),d=xi(d.length,c),l=v}Ue(s,"max"),fs("max",d,c);const[p,g]=ts(l,d),b=W7(f,te(g),p,s.dtype),_=a.write(b,p,s.dtype);let y=p;return o&&(y=vi(p,u)),{dataId:_,shape:y,dtype:s.dtype}}const kPe={kernelName:Fx,backendName:"cpu",kernelFunc:H7},j7=Si((n,t)=>Math.max(n,t)),TPe=ji(Yg,j7),DPe={kernelName:Yg,backendName:"cpu",kernelFunc:TPe},APe={kernelName:Lx,backendName:"cpu",kernelFunc:function NPe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t;Ue(s,"maxPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=i;T(hs(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const u=bo(s.shape,r,o,1,a,l);let d;if(1===u.filterWidth&&1===u.filterHeight&&tn(u.inShape,u.outShape))d=Ga({inputs:{x:s},backend:e});else{const h=e.data.get(s.dataId).values,f=Ye(s.shape),p=AP(h,0,s.dtype,f,u,"max");d=e.makeTensorInfo(u.outShape,s.dtype,p.values)}return d}},PPe={kernelName:$x,backendName:"cpu",kernelFunc:function MPe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{filterSize:r,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=i;Ue(s,"maxPool3d");const u=Il(s.shape,r,o,1,a,l,c),h=_7(e.data.get(s.dataId).values,0,s.dtype,Ye(s.shape),u,"max");return e.makeTensorInfo(h.shape,"float32",h.values)}},OPe={kernelName:IN,backendName:"cpu",kernelFunc:function RPe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r}=t,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=i;Ue([s,r],"maxPool3DGrad");const u=Il(r.shape,o,a,1,l,c),h=function KNe(n,t){const e=Dt(t.outShape,"int32"),i=t.strideDepth,s=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,a=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left;for(let g=0;g<t.batchSize;++g)for(let m=0;m<t.inChannels;++m)for(let b=0;b<t.outDepth;++b){const _=b*i-h;let y=_;for(;y<0;)y+=o;const v=Math.min(t.inDepth,c+_);for(let x=0;x<t.outHeight;++x){const S=x*s-f;let E=S;for(;E<0;)E+=a;const k=Math.min(t.inHeight,u+S);for(let D=0;D<t.outWidth;++D){const M=D*r-p;let R=M;for(;R<0;)R+=l;const U=Math.min(t.inWidth,d+M);let X=Number.NEGATIVE_INFINITY,ee=-1;for(let K=y;K<v;K+=o){const O=K-_;for(let z=E;z<k;z+=a){const B=z-S;for(let q=R;q<U;q+=l){const se=q-M,le=n.get(g,K,z,q,m);le>=X&&(X=le,ee=O*u*d+B*u+se)}}}e.set(ee,g,b,x,D,m)}}}return e}(e.bufferSync(r),u),f=u.strideDepth,p=u.strideHeight,g=u.strideWidth,m=u.dilationDepth,b=u.dilationHeight,_=u.dilationWidth,y=u.effectiveFilterDepth,v=u.effectiveFilterHeight,x=u.effectiveFilterWidth,S=y-1-u.padInfo.front,E=x-1-u.padInfo.left,k=v-1-u.padInfo.top,D=Dt(r.shape,"float32"),M=e.bufferSync(s);for(let R=0;R<u.batchSize;++R)for(let U=0;U<u.inChannels;++U)for(let X=0;X<u.inDepth;++X)for(let ee=0;ee<u.inHeight;++ee)for(let K=0;K<u.inWidth;++K){const O=X-S,z=ee-k,B=K-E;let q=0;for(let se=0;se<y;se+=m){const le=(O+se)/f;if(!(le<0||le>=u.outDepth||Math.floor(le)!==le))for(let he=0;he<v;he+=b){const ue=(z+he)/p;if(!(ue<0||ue>=u.outHeight||Math.floor(ue)!==ue))for(let de=0;de<x;de+=_){const ve=(B+de)/g;if(ve<0||ve>=u.outWidth||Math.floor(ve)!==ve)continue;const Xe=y*v*x-1-h.get(R,le,ue,ve,U)===se*v*x+he*x+de?1:0;0!==Xe&&(q+=M.get(R,le,ue,ve,U)*Xe)}}}D.set(q,R,X,ee,K,U)}return e.makeTensorInfo(D.shape,D.dtype,D.values)}},LPe={kernelName:SN,backendName:"cpu",kernelFunc:function FPe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r,output:o}=t,a=r;Ue([r,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=i,h=bo(a.shape,l,c,1,u,d),f=e.data.get(a.dataId).values,p=Dt(h.outShape,a.dtype,b7(f,a.shape,a.dtype,h).values),g=h.strideHeight,m=h.strideWidth,b=h.dilationHeight,_=h.dilationWidth,y=h.effectiveFilterHeight,v=h.effectiveFilterWidth,x=v-1-h.padInfo.left,S=y-1-h.padInfo.top,E=Dt(a.shape,"float32"),k=e.data.get(s.dataId).values,D=Dt(s.shape,"float32",k);for(let M=0;M<h.batchSize;++M)for(let R=0;R<h.inChannels;++R)for(let U=0;U<h.inHeight;++U)for(let X=0;X<h.inWidth;++X){const ee=U-S,K=X-x;let O=0;for(let z=0;z<y;z+=b){const B=(ee+z)/g;if(!(B<0||B>=h.outHeight||Math.floor(B)!==B))for(let q=0;q<v;q+=_){const se=(K+q)/m;if(se<0||se>=h.outWidth||Math.floor(se)!==se)continue;const ue=y*v-1-p.get(M,B,se,R)===z*v+q?1:0;0!==ue&&(O+=D.get(M,B,se,R)*ue)}}E.set(O,M,U,X,R)}return e.makeTensorInfo(E.shape,E.dtype,E.values)}},BPe={kernelName:vH,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:i}=n,{filterSize:s,strides:r,pad:o,includeBatchInIndex:a}=t,l=e;Ue(i,"MaxPoolWithArgmax");const c=l.data.get(i.dataId).values,u=bo(i.shape,s,r,[1,1],o),[d,h]=function $Pe(n,t,e,i,s){const o=AP(n,0,e,Ye(t),s,"max"),a=b7(n,t,e,s,!0,i);return[o.values,a.values]}(c,i.shape,i.dtype,a,u),f=l.write(d,u.outShape,i.dtype),p=l.write(h,u.outShape,i.dtype);return[{dataId:f,shape:u.outShape,dtype:i.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}},zPe={kernelName:Bx,backendName:"cpu",kernelFunc:function VPe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i,a=Tt(r,s.shape),u=te(ts(s.shape,a)[1]),d=[],h=e.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=Gc({inputs:{x:s},backend:e,attrs:{dtype:"float32"}});d.push(f);const p=RP({inputs:{a:f,b:h},backend:e});d.push(p);const g=t_({inputs:{x:p},backend:e,attrs:{axis:r,keepDims:o}});return d.forEach(m=>e.disposeIntermediateTensorInfo(m)),g}},WPe={kernelName:Vx,backendName:"cpu",kernelFunc:function UPe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i;Ue(s,"min");const a=Tt(r,s.shape);let l=a;const c=ti(l,s.shape.length);let u=s;null!=c&&(u=ar({inputs:{x:s},backend:e,attrs:{perm:c}}),l=xi(l.length,s.shape.length)),fs("min",l,u.shape.length);const[d,h]=ts(u.shape,l),f=te(h),p=xs(te(d),u.dtype),g=e.data.get(u.dataId).values;for(let b=0;b<p.length;++b){const _=b*f;let y=g[_];for(let v=0;v<f;++v){const x=g[_+v];(Number.isNaN(x)||x<y)&&(y=x)}p[b]=y}null!=c&&e.disposeIntermediateTensorInfo(u);const m=e.makeTensorInfo(d,u.dtype,p);if(o){const _=Tn({inputs:{x:m},backend:e,attrs:{shape:vi(d,a)}});return e.disposeIntermediateTensorInfo(m),_}return m}},G7=Si((n,t)=>Math.min(n,t)),HPe=ji(Zg,G7),jPe={kernelName:Zg,backendName:"cpu",kernelFunc:HPe},qPe={kernelName:zx,backendName:"cpu",kernelFunc:function GPe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{paddings:r,mode:o}=i;Ue(s,"mirrorPad");const a=r.map((y,v)=>y[0]+s.shape[v]+y[1]),l=r.map(y=>y[0]),c=r.map((y,v)=>y[0]+s.shape[v]),u="reflect"===o?0:1,d=e.data.get(s.dataId).values,h=s.shape.length,f=Ye(s.shape),p=te(a),g=a.length,m=Ye(a),b=vs(s.dtype,p);for(let y=0;y<p;y++){let v=Sf(y,g,m);for(let S=0;S<g;S++)v[S]<l[S]?v[S]=2*l[S]-v[S]-u:v[S]>=c[S]&&(v[S]=2*(c[S]-1)-v[S]+u);v=v.map((S,E)=>S-l[E]);const x=Aa(v,h,f);b[y]=d[x]}return{dataId:e.write(b,a,s.dtype),shape:a,dtype:s.dtype}}},KPe=Si((n,t)=>{const e=n%t;return n<0&&t<0||n>=0&&t>=0?e:(e+t)%t}),XPe=ji(Qg,KPe),YPe={kernelName:Qg,backendName:"cpu",kernelFunc:XPe};function q7(n){const{inputs:t,backend:e,attrs:i}=n,{logits:s}=t,{dim:r}=i,o=s.shape.length;let a=r;if(-1===a&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Tt([a],s.shape),c=H7({inputs:{x:s},backend:e,attrs:{reductionIndices:l,keepDims:!1}}),u=vi(c.shape,l),d=Tn({inputs:{x:c},backend:e,attrs:{shape:u}}),h=FP({inputs:{a:s,b:d},backend:e}),f=D7({inputs:{x:h},backend:e}),p=t_({inputs:{x:f},backend:e,attrs:{axis:l,keepDims:!1}}),g=Tn({inputs:{x:p},backend:e,attrs:{shape:u}}),m=RP({inputs:{a:f,b:g},backend:e});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(g),m}const ZPe={kernelName:rC,backendName:"cpu",kernelFunc:q7},JPe={kernelName:xH,backendName:"cpu",kernelFunc:function QPe(n){const{inputs:t,backend:e,attrs:i}=n,{logits:s}=t,{numSamples:r,seed:o,normalized:a}=i;Ue(s,"multinomial");const l=a?s:q7({inputs:{logits:s},backend:e,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=e.data.get(l.dataId).values,h=[c,r],f=xs(te(h),"int32");for(let p=0;p<c;++p){const g=p*u,m=new Float32Array(u-1);m[0]=d[g];for(let y=1;y<m.length;++y)m[y]=m[y-1]+d[g+y];const b=UA.alea(o.toString()),_=p*r;for(let y=0;y<r;++y){const v=b();f[_+y]=m.length;for(let x=0;x<m.length;x++)if(v<m[x]){f[_+y]=x;break}}}return a||e.disposeIntermediateTensorInfo(l),e.makeTensorInfo(h,"int32",f)}};function K7(n,t,e){const i=kc(-1,e);return PP([],t,i,n,e)}const t2e={kernelName:Ux,backendName:"cpu",kernelFunc:function e2e(n){const{inputs:t,backend:e}=n,{x:i}=t;Ue(i,"neg");const s=e.data.get(i.dataId).values,[r,o]=K7(s,i.shape,i.dtype);return e.makeTensorInfo(o,i.dtype,r)}},n2e=QA,s2e={kernelName:EN,backendName:"cpu",kernelFunc:function i2e(n){const{inputs:t,backend:e,attrs:i}=n,{boxes:s,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=i;Ue(s,"NonMaxSuppression");const c=e.data.get(s.dataId).values,u=e.data.get(r.dataId).values,{selectedIndices:d}=n2e(c,u,o,a,l);return e.makeTensorInfo([d.length],"int32",new Int32Array(d))}},r2e=JA,a2e={kernelName:kN,backendName:"cpu",kernelFunc:function o2e(n){const{inputs:t,backend:e,attrs:i}=n,{boxes:s,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=i;Ue(s,"NonMaxSuppressionPadded");const u=e.data.get(s.dataId).values,d=e.data.get(r.dataId).values,{selectedIndices:h,validOutputs:f}=r2e(u,d,o,a,l,c);return[e.makeTensorInfo([h.length],"int32",new Int32Array(h)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}},l2e=eM,u2e={kernelName:TN,backendName:"cpu",kernelFunc:function c2e(n){const{inputs:t,backend:e,attrs:i}=n,{boxes:s,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=i;Ue(s,"NonMaxSuppressionWithScore");const u=e.data.get(s.dataId).values,d=e.data.get(r.dataId).values,h=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:b}=l2e(u,d,h,f,p,g);return[e.makeTensorInfo([m.length],"int32",new Int32Array(m)),e.makeTensorInfo([b.length],"float32",new Float32Array(b))]}},X7=Si((n,t)=>n!==t?1:0),d2e=ji(Wx,X7,null,"bool"),h2e={kernelName:Wx,backendName:"cpu",kernelFunc:d2e},p2e={kernelName:jx,backendName:"cpu",kernelFunc:function f2e(n){const{inputs:t,backend:e,attrs:i}=n,{indices:s}=t,{dtype:r,depth:o,onValue:a,offValue:l}=i;Ue(s,"oneHot");const c=te(s.shape),u=new Float32Array(c*o);u.fill(l);const d=e.data.get(s.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return e.makeTensorInfo([...s.shape,o],r,u)}};function Ew(n){const{inputs:t,backend:e}=n,{x:i}=t;if("string"===i.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===i.dtype){const s=yd({inputs:{input:i},backend:e}),r=Ew({inputs:{x:s},backend:e}),o=Kf({inputs:{input:i},backend:e}),a=Ew({inputs:{x:o},backend:e}),l=_r({inputs:{real:r,imag:a},backend:e});return e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),l}return $P({backend:e,attrs:{shape:i.shape,value:0,dtype:i.dtype}})}const m2e={kernelName:cC,backendName:"cpu",kernelFunc:Ew},g2e={kernelName:Hx,backendName:"cpu",kernelFunc:function Y7(n){const{inputs:t,backend:e}=n,{x:i}=t;if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===i.dtype){const s=yd({inputs:{input:i},backend:e}),r=Y7({inputs:{x:s},backend:e}),o=Kf({inputs:{input:i},backend:e}),a=Ew({inputs:{x:o},backend:e}),l=_r({inputs:{real:r,imag:a},backend:e});return e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),l}return $P({backend:e,attrs:{shape:i.shape,value:1,dtype:i.dtype}})}};function Z7(n){const{inputs:t,backend:e,attrs:i}=n,{axis:s}=i;if(1===t.length)return Iw({inputs:{input:t[0]},backend:e,attrs:{dim:s}});const r=t[0].shape,o=t[0].dtype;t.forEach(u=>{po(r,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],c=Xf({inputs:t.map(u=>{const d=Iw({inputs:{input:u},backend:e,attrs:{dim:s}});return a.push(d),d}),backend:e,attrs:{axis:s}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}const b2e={kernelName:Gx,backendName:"cpu",kernelFunc:Z7},Q7={kernelName:qx,backendName:"cpu",kernelFunc:function _2e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{paddings:r,constantValue:o}=i;Ue(s,"pad");const a=r.map((_,y)=>_[0]+s.shape[y]+_[1]),l=r.map(_=>_[0]),c=e.data.get(s.dataId).values,u=te(s.shape),d=s.shape.length,h=Ye(s.shape),f=te(a),p=a.length,g=Ye(a),m=vs(s.dtype,f);0!==o&&m.fill(o);for(let _=0;_<u;_++)m[Aa(Sf(_,d,h).map((S,E)=>S+l[E]),p,g)]=c[_];return{dataId:e.write(m,a,s.dtype),shape:a,dtype:s.dtype}}},y2e=Si((n,t)=>Math.pow(n,t)),v2e=ji(eb,y2e),x2e={kernelName:eb,backendName:"cpu",kernelFunc:v2e};function J7(n,t,e,i){const[s,r]=ts(n,i),o=br(t,"int32"),a=xs(te(s),o),l=te(r);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=e[u+h];a[c]=d}return{outVals:a,outShape:s,outDtype:o}}const w2e={kernelName:Xx,backendName:"cpu",kernelFunc:function C2e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i;Ue(s,"prod");const a=s.shape.length,l=Tt(r,s.shape),c=ti(l,a);let u=l,d=s;const h=[];null!=c&&(d=ar({inputs:{x:s},backend:e,attrs:{perm:c}}),h.push(d),u=xi(u.length,a));const f=e.data.get(d.dataId).values,{outVals:p,outShape:g,outDtype:m}=J7(d.shape,d.dtype,f,u);let b=g;return o&&(b=vi(g,l)),h.forEach(_=>e.disposeIntermediateTensorInfo(_)),e.makeTensorInfo(b,m,p)}};function e9(n,t){const e=n.slice(0,t);for(;e.length<t;)e.push(1);for(let i=t;i<n.length;i++)e[t-1]*=n[i];return e}function t9(n,t,e,i,s,r,o,a){if(0===n.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function S2e(n,t,e){n.forEach((i,s)=>{if(i<0||i>=e){const r=Sf(s,t.length,Ye(t)).join(",");throw new Error(`indices[${r}] = ${i} is not in [0, ${e})`)}})}(r,o,t[0][0]-1),0===i.length)throw new Error("params.rank must be nonzero");const c=i[0],{outSplits:u,valueSlices:d,numValues:h}=function E2e(n,t,e,i){const s=[];let r=0;const a=new Array(t.length-1+e.length).fill(null).map(()=>[0]);!function I2e(n,t){for(let e=0;e<n.length;++e){const i=n[e],s=e===n.length-1?t:n[e+1].length;if(0===i.length)throw new Error("Ragged splits may not be empty");if(i[0]<0)throw new Error("Ragged splits must be non-negative");if(i[i.length-1]>s)throw new Error("Ragged splits must not point past values");for(let r=1;r<i.length;++r)if(i[r-1]>i[r])throw new Error("Ragged splits must be sorted in ascending order")}}(e,i);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const u=t[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<n.length;++c){let u=n[c],d=n[c]+1;for(let h=0;h<e.length;++h){const f=e[h],p=h+t.length-1;if(p>=0){const g=a[p],m=g[g.length-1]-f[u];for(let b=u;b<d;++b)a[p].push(f[b+1]+m)}u=f[u],d=f[d]}d!==u&&(s.push([u,d]),r+=d-u)}return{outSplits:a,valueSlices:s,numValues:r}}(r,o,n,c),f=function k2e(n){const t=[];for(let e=0;e<n.length;++e){const s=yi("int32",n[e].length);t.push(s),n[e].forEach((r,o)=>s[o]=r)}return t}(u),p=function D2e(n,t,e,i,s){const r=t.slice();r[0]=s;const o=yi(e,te(r)),a=n.length;return function T2e(n,t,e,i,s,r){const o=e9(t,2)[1],a=e9(r,2)[1];let l=0;for(const c of e)for(let u=c[0];u<c[1];++u){for(let d=0;d<i;++d)s[l*a+d]=n[u*o+d];++l}}(n,t,i,0===a?0:a/t[0],o,r),[o,r]}(e,i,s,d,h);return[f,p[0],p[1]]}const A2e={kernelName:CH,backendName:"cpu",kernelFunc:function N2e(n){const{inputs:t,backend:e,attrs:i}=n,{paramsNestedSplits:s,paramsDenseValues:r,indices:o}=t,l=s.map(b=>e.data.get(b.dataId).values),c=s.map(b=>b.shape),u=e.data.get(r.dataId).values,d=e.data.get(o.dataId).values,[h,f,p]=t9(l,c,u,r.shape,r.dtype,d,o.shape),g=h.map(b=>e.makeTensorInfo([b.length],"int32",b)),m=e.makeTensorInfo(p,r.dtype,f);return g.concat([m])}},n9=2147483647;function i9(n,t,e,i,s,r,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=0===t.length,l=0===s.length,c=0===o.length,u=[];a||u.push(t[0]),l||u.push(s[0]),c||u.push(o[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const d=0===u.length?1:u[0],h=yi("int32",d+1);h[0]=0;for(let m=0;m<d;++m){const b=a?n[0]:n[m],_=l?i[0]:i[m],y=c?r[0]:r[m];if(0===y)throw new Error("Requires delta != 0");let v;if(y>0&&_<b||y<0&&_>b)v=0;else if(v=Math.ceil(Math.abs((_-b)/y)),v>n9)throw new Error(`Requires ((limit - start) / delta) <= ${n9}`);h[m+1]=h[m]+v}const p=yi(e,h[d]);let g=0;for(let m=0;m<d;++m){const b=h[m+1]-h[m];let _=a?n[0]:n[m];const y=c?r[0]:r[m];for(let v=0;v<b;++v)p[g++]=_,_+=y}return[h,p]}const P2e={kernelName:wH,backendName:"cpu",kernelFunc:function M2e(n){const{inputs:t,backend:e}=n,{starts:i,limits:s,deltas:r}=t,o=e.data.get(i.dataId).values,a=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,[c,u]=i9(o,i.shape,i.dtype,a,s.shape,l,r.shape);return[e.makeTensorInfo([c.length],"int32",c),e.makeTensorInfo([u.length],i.dtype,u)]}};var So=vo;class kw{constructor(t,e,i,s,r,o,a,l,c,u){this.shape=t,this.shapeShape=e,this.values=i,this.valuesShape=s,this.valuesDType=r,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=mG(u),this.raggedRank=gG(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===So.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===So.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case So.VALUE_ROWIDS:return kw.getMaxWidthValueRowID(e);case So.ROW_SPLITS:return kw.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${So[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let i=0;for(let s=0;s<e-1;++s){const r=t[s+1]-t[s];r>i&&(i=r)}return i}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let i=0,s=t[0],r=0;for(let o=1;o<e;++o){const a=t[o];a!==s&&(s=a,r=Math.max(o-i,r),i=o)}return Math.max(e-i,r)}tensorShapeFromTensor(t,e,i=!0){if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return r9(t,i)}calculateOutputSize(t){const e=this.valuesShape;bG(this.defaultValueShape,e);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=pG(this.raggedRank,s,e);o[0]<0&&(o[0]=t);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(t,e,i){const s=Math.min(t,i),r=[];let o=0;for(let a=0;a<s;++a,o+=e)r.push(o);for(let a=s;a<t;++a)r.push(-1);return T(r.length===t,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(t,e,i,s){const r=t.length,o=[];for(let a=0;a<r-1;++a){const l=t[a+1]-t[a];let c=Math.min(s,l),u=e[a];-1===u&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=i;for(let d=0;d<l-c;++d)o.push(-1)}if(r>0&&o.length!==t[r-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,e,i,s){const r=t.length,o=[];if(0===r)return[];let a=0,l=t[0];if(l>=e.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${e.length}`);let c=e[l];o.push(c);for(let u=1;u<r;++u){const d=t[u];if(d===l)c>=0&&(++a,a<s?c+=i:c=-1);else{if(a=0,l=d,d>=e.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${e.length}`);c=e[d]}o.push(c)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,e,i,s){const r=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case So.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,e,i,s);case So.ROW_SPLITS:if(r.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${r.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(r,e,i,s);default:throw new Error(`Unsupported partition type: ${So[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case So.FIRST_DIM_SIZE:return t[0];case So.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case So.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${So[e]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),i=this.calculateOutputSize(e),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*i[l+1];const r=r9(i,!1),o=yi(this.valuesDType,te(r));if(s[0]*i[0]>0){let l=this.calculateFirstParentOutputIndex(e,s[0],i[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,s[c],i[c]);this.setOutput(this.raggedRank,l,o,r)}return[r,o]}setOutput(t,e,i,s){if(0===i.length)return;const r=this.values,o=i;let a=s.slice();a=a.slice(t+1);const l=te(a),c=e.length;let u=this.defaultValue;if(u.length!==l&&1!==u.length){const p=this.defaultValueShape;Y(()=>{const g=j(u,p);u=Db(g,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let g=p<c?e[p]:-1;if(g!==f){if(h<f){const m=r.subarray(d*l);s9(o.subarray(h*l),m,(f-h)*l)}if(p>=c&&(g=Math.floor(i.length/l)),g>f)if(1===this.defaultValue.length)o.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;)s9(o.slice(f*l),u,l),++f;g<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}else++f}}}function s9(n,t,e){for(let i=0;i<e;i++)n[i]=t[i]}function r9(n,t){const e=[];for(let i of n){if(i<0){if(!t)throw new Error(`Dimension ${i} must be >= 0`);if(i<-1)throw new Error(`Dimension ${i} must be >= -1`);i=-1}e.push(i)}return e}function o9(n,t,e,i,s,r,o,a,l,c){return new kw(n,t,e,i,s,r,o,a,l,c).compute()}const O2e={kernelName:SH,backendName:"cpu",kernelFunc:function R2e(n){const{inputs:t,backend:e,attrs:i}=n,{shape:s,values:r,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=i,c=e.data.get(s.dataId).values,u=e.data.get(r.dataId).values,d=e.data.get(o.dataId).values,h=a.map(m=>e.data.get(m.dataId).values),f=a.map(m=>m.shape),[p,g]=o9(c,s.shape,u,r.shape,r.dtype,d,o.shape,h,f,l);return e.makeTensorInfo(p,r.dtype,g)}};function a9(n,t,e,i){if(n===t||n<t&&e<0||t<n&&e>1)return xs(0,i);const l=xs(Math.abs(Math.ceil((t-n)/e)),i);t<n&&1===e&&(e=-1),l[0]=n;for(let c=1;c<l.length;c++)l[c]=l[c-1]+e;return l}const L2e={kernelName:DN,backendName:"cpu",kernelFunc:function F2e(n){const{backend:t,attrs:e}=n,{start:i,stop:s,dtype:r,step:o}=e,a=a9(i,s,o,r);return t.makeTensorInfo([a.length],r,a)}},$2e=gn(tb,n=>1/n),B2e={kernelName:tb,backendName:"cpu",kernelFunc:$2e},z2e={kernelName:Qx,backendName:"cpu",kernelFunc:function V2e(n){const{inputs:t,backend:e,attrs:i}=n,{images:s}=t,{alignCorners:r,halfPixelCenters:o,size:a}=i;Ue(s,"resizeBilinear");const l=Ye(s.shape),[c,u]=a,[d,h,f,p]=s.shape,g=e.data.get(s.dataId).values,m=new Float32Array(te([d,c,u,p])),b=[r&&c>1?h-1:h,r&&u>1?f-1:f],_=[r&&c>1?c-1:c,r&&u>1?u-1:u];let y=0;const v=b[0]/_[0],x=b[1]/_[1];for(let S=0;S<d;S++)for(let E=0;E<c;E++){let k;k=o?v*(E+.5)-.5:v*E;const D=Math.max(0,Math.floor(k)),M=k-D,R=Math.min(h-1,Math.ceil(k)),U=S*l[0]+D*l[1],X=S*l[0]+R*l[1];for(let ee=0;ee<u;ee++){let K;K=o?x*(ee+.5)-.5:x*ee;const O=Math.max(0,Math.floor(K)),z=K-O,B=Math.min(f-1,Math.ceil(K)),q=U+O*l[2],se=X+O*l[2],le=U+B*l[2],he=X+B*l[2];for(let ue=0;ue<p;ue++){const de=g[q+ue],ve=g[se+ue],Xe=de+(g[le+ue]-de)*z;m[y++]=Xe+(ve+(g[he+ue]-ve)*z-Xe)*M}}}return e.makeTensorInfo([d,c,u,p],"float32",m)}},W2e={kernelName:MN,backendName:"cpu",kernelFunc:function U2e(n){const{inputs:t,backend:e,attrs:i}=n,{images:s,dy:r}=t,{alignCorners:o}=i;Ue([r,s],"resizeBilinearGrad");const a=Ye(s.shape),[l,c,u,d]=s.shape,[,h,f]=r.shape,p=new Float32Array(l*c*u*d),g=[o&&h>1?c-1:c,o&&f>1?u-1:u],m=[o&&h>1?h-1:h,o&&f>1?f-1:f],b=g[0]/m[0],_=g[1]/m[1],y=e.data.get(r.dataId).values;let v=0;for(let x=0;x<l;x++){const S=x*a[0];for(let E=0;E<h;E++){const k=E*b,D=Math.floor(k),M=Math.min(Math.ceil(k),c-1),R=S+D*a[1],U=S+M*a[1],X=k-D,ee=1-X;for(let K=0;K<f;K++){const O=K*_,z=Math.floor(O),B=Math.min(Math.ceil(O),u-1),q=O-z,se=1-q,le=R+z*a[2],he=R+B*a[2],ue=U+z*a[2],de=U+B*a[2],ve=ee*se,Ee=ee*q,Me=X*se,Xe=X*q;for(let Ve=0;Ve<d;Ve++){const ut=y[v++];p[le+Ve]+=ut*ve,p[he+Ve]+=ut*Ee,p[ue+Ve]+=ut*Me,p[de+Ve]+=ut*Xe}}}}return e.makeTensorInfo([l,u,c,d],"float32",p)}},j2e={kernelName:Zx,backendName:"cpu",kernelFunc:function H2e(n){const{inputs:t,backend:e,attrs:i}=n,{images:s}=t,{alignCorners:r,halfPixelCenters:o,size:a}=i;Ue(s,"resizeNearestNeighbor");const l=Ye(s.shape),[c,u]=a,[d,h,f,p]=s.shape,g=e.data.get(s.dataId).values,m=new Float32Array(d*c*u*p),b=[r&&c>1?h-1:h,r&&u>1?f-1:f],_=[r&&c>1?c-1:c,r&&u>1?u-1:u],y=b[0]/_[0],v=b[1]/_[1];let x=0;for(let S=0;S<d;S++){const E=S*l[0];for(let k=0;k<c;k++){const D=o?y*(k+.5):y*k;let M=Math.min(h-1,r?Math.round(D):Math.floor(D));o&&(M=Math.max(0,M));const R=E+M*l[1];for(let U=0;U<u;U++){const X=o?v*(U+.5):v*U;let ee=Math.min(f-1,r?Math.round(X):Math.floor(X));o&&(ee=Math.max(0,ee));const K=R+ee*l[2];for(let O=0;O<p;O++)m[x++]=g[K+O]}}}return e.makeTensorInfo([d,c,u,p],s.dtype,m)}},q2e={kernelName:AN,backendName:"cpu",kernelFunc:function G2e(n){const{inputs:t,backend:e,attrs:i}=n,{images:s,dy:r}=t,{alignCorners:o}=i;Ue([r,s],"resizeNearestNeighborGrad");const a=Ye(s.shape),l=Ye(r.shape),[c,u,d,h]=s.shape,[,f,p]=r.shape,g=new Float32Array(c*u*d*h),m=e.data.get(r.dataId).values,b=[o&&f>1?u-1:u,o&&p>1?d-1:d],_=[o&&f>1?f-1:f,o&&p>1?p-1:p],y=b[0]/_[0],v=b[1]/_[1],x=1/y,S=1/v,E=2*Math.ceil(x)+2,k=2*Math.ceil(S)+2;for(let D=0;D<c;D++){const M=D*a[0];for(let R=0;R<u;R++){const U=M+R*a[1],X=Math.floor(R*x),ee=Math.floor(X-E/2);for(let K=0;K<d;K++){const O=U+K*a[2],z=Math.floor(K*S),B=Math.floor(z-k/2);for(let q=0;q<h;q++){let se=0;for(let le=0;le<E;le++){const he=le+ee;if(he<0||he>=f)continue;const ue=M+he*l[1],de=he*y;if(R===Math.min(u-1,o?Math.round(de):Math.floor(de)))for(let Ee=0;Ee<k;Ee++){const Me=Ee+B;if(Me<0||Me>=p)continue;const Xe=ue+Me*l[2],Ve=Me*v;K===Math.min(d-1,o?Math.round(Ve):Math.floor(Ve))&&(se+=m[Xe+q])}}g[O+q]=se}}}}return e.makeTensorInfo(s.shape,s.dtype,g)}},X2e={kernelName:Jx,backendName:"cpu",kernelFunc:function K2e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{dims:r}=i;Ue(s,"reverse");const o=s.shape.length,a=Tt(r,s.shape);if(0===o)return Ga({inputs:{x:s},backend:e});const l=new ds(s.shape,s.dtype),c=e.bufferSync(s);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=s.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return e.makeTensorInfo(l.shape,l.dtype,l.values)}},Y2e={kernelName:jN,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:i}=n,{radians:s,fillValue:r,center:o}=t,a=e,l=vs(i.dtype,te(i.shape)),[c,u,d,h]=i.shape,[f,p]=aM(o,u,d),m=Math.sin(s),b=Math.cos(s),_=a.data.get(i.dataId).values;for(let v=0;v<c;v++){const x=v*d*u*h;for(let S=0;S<u;S++){const E=S*(d*h);for(let k=0;k<d;k++){const D=k*h;for(let M=0;M<h;M++){const R=[c,S,k,M],U=R[2],X=R[1];let ee=(U-f)*b-(X-p)*m,K=(U-f)*m+(X-p)*b;ee=Math.round(ee+f),K=Math.round(K+p);let O=r;"number"!=typeof r&&(O=3===M?255:r[M]),ee>=0&&ee<d&&K>=0&&K<u&&(O=_[x+K*(d*h)+ee*h+M]),l[x+E+D+M]=O}}}}return{dataId:a.write(l,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Z2e=gn(sb,n=>{const t=Math.floor(n);return n-t<.5?Math.floor(n):n-t>.5?Math.ceil(n):t%2==0?t:t+1}),Q2e={kernelName:sb,backendName:"cpu",kernelFunc:Z2e},l9=ja(n=>1/Math.sqrt(n)),J2e=jc(rb,l9),eRe={kernelName:rb,backendName:"cpu",kernelFunc:J2e};function xd(n,t,e,i,s,r,o,a,l,c){const u=[i/s,s],d=n.values,h=t.values;if(0===i)return Dt(e,t.dtype);const f=l instanceof ds?l:Dt(u,t.dtype);"string"==typeof l||"number"==typeof l?f.values.fill(l):"boolean"==typeof l&&f.values.fill(+l);for(let p=0;p<r;p++){const g=[];let m=0;for(let b=0;b<o;b++){const _=d[p*o+b];g.push(_),m+=_*a[b]}if(m<0||m>=i/s)throw new Error(`Invalid indices: ${g} does not index into ${e}`);for(let b=0;b<s;b++)c?f.values[m*s+b]+=h[p*s+b]:f.values[m*s+b]=0===t.rank?h[0]:h[p*s+b]}return f}const nRe={kernelName:IH,backendName:"cpu",kernelFunc:function tRe(n){const{inputs:t,backend:e,attrs:i}=n,{indices:s,updates:r}=t,{shape:o}=i,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=dd(0,s,o),g=xd(e.bufferSync(s),e.bufferSync(r),o,d,c,l,a,u,0,!0);return e.makeTensorInfo(o,g.dtype,g.values)}};function iRe(n,t){let e=0,i=n.length,s=0;for(;e<i;)s=Math.floor((e+i)/2),n[s]<t?e=s+1:i=s;return i}function sRe(n,t){let e=0,i=n.length,s=0;for(;e<i;)s=Math.floor((e+i)/2),n[s]<=t?e=s+1:i=s;return i}const aRe={kernelName:kH,backendName:"cpu",kernelFunc:function oRe(n){const{inputs:t,backend:e,attrs:i}=n,{sortedSequence:s,values:r}=t,{side:o}=i,c=function rRe(n,t,e,i,s,r){const o=yi("int32",e*s);for(let a=0;a<e;++a){const l=n.slice(a*i,(a+1)*i),c=a*s;for(let u=0;u<s;++u)o[c+u]="left"===r?iRe(l,t[u+c]):sRe(l,t[u+c])}return o}(e.data.get(s.dataId).values,e.data.get(r.dataId).values,s.shape[0],s.shape[1],r.shape[1],o);return e.makeTensorInfo(r.shape,"int32",c)}},cRe={kernelName:eC,backendName:"cpu",kernelFunc:function lRe(n){const{inputs:t,backend:e}=n,{condition:i,t:s,e:r}=t;Ue([i,s,r],"select");const o=i.shape.length,a=e.data.get(i.dataId).values,l=e.data.get(s.dataId).values,c=e.data.get(r.dataId).values,u=br(s.dtype,r.dtype),d=xs(te(s.shape),u);let h=0;const f=0===o||o>1||1===s.shape.length?1:te(s.shape.slice(1));for(let p=0;p<a.length;p++)for(let g=0;g<f;g++)d[h++]=1===a[p]?l[p]:c[p];return e.makeTensorInfo(s.shape,u,d)}},uRe=HC,dRe=jC,hRe=gn(ob,n=>n>=0?dRe*n:uRe*(Math.exp(n)-1)),fRe={kernelName:ob,backendName:"cpu",kernelFunc:hRe},pRe=gn(cb,n=>n<0?-1:n>0?1:0),mRe={kernelName:cb,backendName:"cpu",kernelFunc:pRe},gRe=gn(ab,n=>Math.sin(n)),bRe={kernelName:ab,backendName:"cpu",kernelFunc:gRe},_Re=gn(lb,n=>Math.sinh(n)),yRe={kernelName:lb,backendName:"cpu",kernelFunc:_Re},c9=Math.log(1.1920928955078125e-7)+2,vRe=gn(db,n=>{const t=n>-c9,e=n<c9,i=Math.exp(n);let s;return s=e?i:t?n:Math.log(1+i),s}),xRe={kernelName:db,backendName:"cpu",kernelFunc:vRe},wRe={kernelName:iC,backendName:"cpu",kernelFunc:function CRe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{blockShape:r,paddings:o}=i;Ue([s],"spaceToBatchND");const a=te(r),l=[[0,0]];l.push(...o);for(let S=1+r.length;S<s.shape.length;++S)l.push([0,0]);const c=Q7.kernelFunc({inputs:{x:s},backend:e,attrs:{paddings:l,constantValue:0}}),u=$b(c.shape,r,a,!1),d=Bb(u.length,r.length,!1),h=Vb(c.shape,r,a,!1),g=Tn({inputs:{x:c},backend:e,attrs:{shape:u}}),_=ar({inputs:{x:g},backend:e,attrs:{perm:d}}),x=Tn({inputs:{x:_},backend:e,attrs:{shape:h}});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(_),x}};function u9(n,t,e,i,s,r,o){const a=t[0],l=r[0],c=new Array(l),u=new Array(a),d=t[1];if(0===l){if(0!==a)throw new Error(kG(a));return[yi(e,0),[0,d],yi(s,0),c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let m=0;m<a;++m){const b=n[m*d];if(b<0)throw new Error(TG(m,b));if(b>=l)throw new Error(DG(m,b,l));++p[b],h=h&&b>=f,f=b}let g=!0;for(let m=0;m<l;++m){const b=0===p[m];c[m]=b,g=g&&!b,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&h){const m=n,b=i;for(let _=0;_<a;++_)u[_]=_;return[m,[a,d],b,c,u]}{const m=p[l-1],b=yi(e,m*d),_=yi(s,m),y=new Array(l).fill(0);for(let v=0;v<a;++v){const x=n[v*d],E=(0===x?0:p[x-1])+y[x];y[x]++;for(let k=0;k<d;++k)b[E*d+k]=n[v*d+k];_[E]=i[v],u[v]=E}for(let v=0;v<l;++v)if(0===y[v]){const S=0===v?0:p[v-1];b[S*d+0]=v;for(let E=1;E<d;++E)b[S*d+E]=0;_[S]=o}return[b,[m,d],_,c,u]}}const IRe={kernelName:PN,backendName:"cpu",kernelFunc:function SRe(n){const{inputs:t,backend:e}=n,{indices:i,values:s,denseShape:r,defaultValue:o}=t;if(1!==r.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${r.shape}`);if(2!==i.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${i.shape}`);if(1!==s.shape.length)throw new Error(`Values must be a vector, saw:\n        ${s.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const a=e.data.get(i.dataId).values,l=e.data.get(s.dataId).values,c=e.data.get(r.dataId).values,u=e.data.get(o.dataId).values[0],[d,h,f,p,g]=u9(a,i.shape,i.dtype,l,s.dtype,c,u);return[e.makeTensorInfo(h,i.dtype,d),e.makeTensorInfo([h[0]],s.dtype,f),e.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),e.makeTensorInfo([g.length],i.dtype,new Int32Array(g))]}};function d9(n,t,e,i,s){const r=te(i),o=t[0],a=s.length,l=[];let c=1,u=-1;for(let m=0;m<a;++m){const b=s[m];if(-1===b){if(-1!==u)throw new Error(NG(u,m));u=m,l.push(1)}else{if(b<0)throw new Error(AG(m,b));c*=b,l.push(b)}}if(-1!==u){if(c<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const m=Math.trunc(r/c);if(c*m!==r)throw new Error(PG(i,l));l[u]=m}if(te(l)!==r)throw new Error(RG(i,l));const h=i.length,f=[];if(h>0){f[h-1]=1;for(let m=h-2;m>=0;--m)f[m]=f[m+1]*i[m+1]}const p=[];if(a>0){p[a-1]=1;for(let m=a-2;m>=0;--m)p[m]=p[m+1]*l[m+1]}const g=yi(e,o*a);for(let m=0;m<o;++m){let b=0;for(let _=0;_<h;++_)b+=n[m*h+_]*f[_];for(let _=0;_<a;++_)g[m*a+_]=Math.trunc(b/p[_]),b%=p[_]}return[g,[o,a],l]}const kRe={kernelName:RN,backendName:"cpu",kernelFunc:function ERe(n){const{inputs:t,backend:e}=n,{inputIndices:i,inputShape:s,newShape:r}=t;if(2!==i.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${i.shape}`);if(1!==s.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${s.shape}`);if(1!==r.shape.length)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const o=Array.from(e.data.get(s.dataId).values),a=e.data.get(i.dataId).values,l=Array.from(e.data.get(r.dataId).values),[c,u,d]=d9(a,i.shape,i.dtype,o,l);return[e.makeTensorInfo(u,i.dtype,c),e.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}};function BP(n,t,e,i,s,r=!1,o=0){const a=i.length,l=[t[0],n.length/t[0]],c=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error("segment ids must be >= 0");const h=t.slice();h[0]=d;const p=yi(e,h.reduce((y,v)=>y*v,1));if(0===a)return d>0&&p.fill(o),[p,h];if(d<=0)throw new Error("segment ids must be >= 0");let g=0,m=1,b=0,_=s[g];for(;;){let y=0;if(m<a){if(y=s[m],_===y){++m;continue}if(_>=y)throw new Error("segment ids are not increasing")}if(_<0||_>=d)throw new Error(FG(_,d));_>b&&p.fill(o,b*c,_*c);for(let v=g;v<m;++v){const x=i[v];if(x<0||x>=l[0])throw new Error(LG(v,i[v],l[0]));for(let S=0;S<c;S++)p[_*c+S]+=n[x*c+S]}if(r)for(let v=0;v<c;v++)p[_*c+v]/=m-g;if(g=m,++m,b=_+1,_=y,m>a)break}return b<d&&p.fill(o,b*c,d*c),[p,h]}const DRe={kernelName:ON,backendName:"cpu",kernelFunc:function TRe(n){const{inputs:t,backend:e}=n,{data:i,indices:s,segmentIds:r}=t;if(i.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${s.shape}`);if(1!==r.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${r.shape}`);if(s.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const o=e.data.get(i.dataId).values,a=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,[c,u]=BP(o,i.shape,i.dtype,a,l,!0);return e.makeTensorInfo(u,i.dtype,c)}},ARe={kernelName:FN,backendName:"cpu",kernelFunc:function NRe(n){const{inputs:t,backend:e}=n,{data:i,indices:s,segmentIds:r}=t;if(i.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${s.shape}`);if(1!==r.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${r.shape}`);if(s.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const o=e.data.get(i.dataId).values,a=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,[c,u]=BP(o,i.shape,i.dtype,a,l);return e.makeTensorInfo(u,i.dtype,c)}},PRe={kernelName:TH,backendName:"cpu",kernelFunc:function MRe(n){const{inputs:t,backend:e,attrs:i}=n,{sparseIndices:s,sparseValues:r,defaultValue:o}=t,{outputShape:a}=i,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=dd(0,s,a),f=!1,p=e.bufferSync(s);let g;switch(r.dtype){case"bool":g=xd(p,e.bufferSync(r),a,h,u,c,l,d,Boolean(e.data.get(o.dataId).values[0]),f);break;case"float32":case"int32":g=xd(p,e.bufferSync(r),a,h,u,c,l,d,e.data.get(o.dataId).values[0],f);break;case"string":g=xd(p,e.bufferSync(r),a,h,u,c,l,d,Dc(e.data.get(o.dataId).values[0]),f);break;default:throw new Error(`Unsupported type ${r.dtype}`)}return e.makeTensorInfo(a,g.dtype,g.values)}},ORe={kernelName:sC,backendName:"cpu",kernelFunc:function RRe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{numOrSizeSplits:r,axis:o}=i,a=Tt(o,s.shape)[0],l=SM(s,r,a),c=new Array(s.shape.length).fill(0),u=s.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=vd({inputs:{x:s},backend:e,attrs:{begin:c,size:h}});return c[a]+=d,f})}},FRe=ja(n=>Math.sqrt(n)),LRe=gn(hb,n=>Math.sqrt(n)),$Re={kernelName:hb,backendName:"cpu",kernelFunc:LRe},BRe={kernelName:LN,backendName:"cpu",kernelFunc:({inputs:n,backend:t})=>{const{x:e}=n,i=t;Ue(e,"square");const s=i.data.get(e.dataId).values,r=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];r[a]=l*l}return{dataId:i.write(r,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}},h9=Si((n,t)=>{const e=n-t;return e*e}),VRe=ji(fb,h9),zRe={kernelName:fb,backendName:"cpu",kernelFunc:VRe},f9=ja((n,t)=>{const{pattern:e,replaceGlobal:i,rewrite:s}=t;return n.replace(new RegExp(e,i?"g":""),s)}),WRe={kernelName:oC,backendName:"cpu",kernelFunc:jc(oC,f9)},HRe=gn(_b,(n,t)=>{const e=t;return isNaN(n)?NaN:n>0?1:e.alpha}),jRe={kernelName:_b,backendName:"cpu",kernelFunc:HRe};function p9(n,t,e,i){const s=Dt(n,t.dtype);for(let r=0;r<s.size;r++){const o=s.indexToLoc(r),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*e[l]+i[l];s.set(t.get(...a),...o)}return s}const qRe={kernelName:$N,backendName:"cpu",kernelFunc:function GRe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{begin:r,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=i;Ue(s,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:b,begin:_,end:y,strides:v}=kA(s.shape,r,o,a,l,c,u,d,h);let x;if(g)x=Tn({inputs:{x:s},backend:e,attrs:{shape:p}});else if(m||b){T(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const S=SA(_,y,v),E=vd({inputs:{x:s},backend:e,attrs:{begin:_,size:S}});x=Tn({inputs:{x:E},backend:e,attrs:{shape:p}}),e.disposeIntermediateTensorInfo(E)}else{const E=p9(f,e.bufferSync(s),v,_);x=e.makeTensorInfo(p,E.dtype,E.values)}return x}};class KRe{constructor(t,e,i,s,r,o){this.separator=Tc(t),this.nGramWidths=e,this.leftPad=Tc(i),this.rightPad=Tc(s),this.padWidth=r,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const i=this.getPadWidth(e);return Math.max(0,t+2*i-e+1)}createNGrams(t,e,i,s,r,o){for(let a=0;a<r;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(r-(a+1))),d=o-(c+u),h=e+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let _=0;_<d;++_)f+=t[h+_].length;f+=u*this.rightPad.length,f+=(c+u+d-1)*this.separator.length,i[s+a]=new Uint8Array(f);const g=i[s+a];let m=0;const b=_=>_.forEach(y=>g[m++]=y);for(let _=0;_<c;++_)b(this.leftPad),b(this.separator);for(let _=0;_<d-1;++_)b(t[h+_]),b(this.separator);if(d>0){b(t[h+d-1]);for(let _=0;_<u;++_)b(this.separator),b(this.rightPad)}else{for(let _=0;_<u-1;++_)b(this.rightPad),b(this.separator);b(this.rightPad)}}}compute(t,e){const i=t.length,s=e.length;if(s>0){let l=e[0];if(0!==l)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<s;++c){let u=e[c]>=l;if(u=u&&e[c]<=i,!u)throw new Error(`Invalid split value ${e[c]}, must be in [${l}, ${i}]`);l=e[c]}if(l!==i)throw new Error(`Last split value must be data size. Expected ${i}, got ${l}`)}const r=s-1,o=yi("int32",s);if(0===i||0===s){const l=new Array(i);for(let c=0;c<=r;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=r;++l){const c=e[l]-e[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&0===u&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[r]);for(let l=0;l<r;++l){const c=e[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const f=this.getNumNGrams(e[l+1]-e[l],d);this.createNGrams(t,c,a,u,f,d),u+=f}),this.preserveShort&&u===o[l]){const d=e[l+1]-e[l];if(0===d)continue;this.createNGrams(t,c,a,u,1,d+2*this.padWidth)}}return[a,o]}}function m9(n,t,e,i,s,r,o,a){return new KRe(e,i,s,r,o,a).compute(n,t)}const YRe={kernelName:BN,backendName:"cpu",kernelFunc:function XRe(n){const{inputs:t,backend:e,attrs:i}=n,{separator:s,nGramWidths:r,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=i,{data:u,dataSplits:d}=t,h=e.data.get(u.dataId).values,f=e.data.get(d.dataId).values,[p,g]=m9(h,f,s,r,o,a,l,c);return[e.makeTensorInfo([p.length],"string",p),e.makeTensorInfo(d.shape,"int32",g)]}};function ZRe(n,t,e,i){if(!n.length)return;if(0===t.length){for(let r=0;r<n.length;++r)i.push(n.subarray(r,r+1));return}if(1===t.length){const r=t[0];let o=n.indexOf(r);for(;-1!==o;){const a=n.subarray(0,o);(!e||0!==a.length)&&i.push(a),o=(n=n.subarray(o+1)).indexOf(r)}return void((!e||0!==n.length)&&i.push(n))}let s=0;for(let r=0;r<n.length+1;r++)if(r===n.length||-1!==t.indexOf(n[r])){const o=n.subarray(s,r);(!e||0!==o.length)&&i.push(o),s=r+1}}function g9(n,t,e){const i=n.length,s=[];let r=0,o=0;const a=new Array(i);for(let h=0;h<i;++h){const f=s.length;ZRe(n[h],t,e,s);const p=s.length-f;a[h]=p,r+=p,o=Math.max(o,p)}const l=yi("int32",2*r),c=new Array(r),u=[i,o];let d=0;for(let h=0;h<i;++h)for(let f=0;f<a[h];++f)l[2*d]=h,l[2*d+1]=f,c[d]=s[d],++d;return[l,c,u]}const JRe={kernelName:VN,backendName:"cpu",kernelFunc:function QRe(n){const{inputs:t,backend:e,attrs:i}=n,{skipEmpty:s}=i,{input:r,delimiter:o}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(1!==r.shape.length)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=e.data.get(r.dataId).values,l=e.data.get(o.dataId).values[0],[c,u,d]=g9(a,l,s),h=u.length;return[e.makeTensorInfo([h,2],"int32",c),e.makeTensorInfo([h],"string",u),e.makeTensorInfo([2],"int32",new Int32Array(d))]}};function b9(n,t){const e=yi("int32",n.length);for(let i=0;i<n.length;++i)e[i]=u0e(n[i]).modulo(t).getLowBitsUnsigned();return e}const tOe={kernelName:zN,backendName:"cpu",kernelFunc:function eOe(n){const{inputs:t,backend:e,attrs:i}=n,{numBuckets:s}=i,{input:r}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=b9(e.data.get(r.dataId).values,s);return e.makeTensorInfo(r.shape,"int32",a)}},nOe=gn(mb,n=>Math.tan(n)),iOe={kernelName:mb,backendName:"cpu",kernelFunc:nOe},sOe=gn(gb,n=>Math.tanh(n));function _9(n,t){const e=new Array(n.rank);for(let s=0;s<e.length;s++)e[s]=n.shape[s]*t[s];const i=Dt(e,n.dtype);for(let s=0;s<i.values.length;++s){const r=i.indexToLoc(s),o=new Array(n.rank);for(let l=0;l<o.length;l++)o[l]=r[l]%n.shape[l];const a=n.locToIndex(o);i.values[s]=n.values[a]}return i}const n_=(n,t)=>{const e=t.value-n.value;return 0===e?n.index-t.index:e};function y9(n,t,e=0,i=n.length-1){for(;i>e;){if(i-e>600){const a=i-e+1,l=t-e+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2);y9(n,t,Math.max(e,Math.floor(t-l*u/a+d)),Math.min(i,Math.floor(t+(a-l)*u/a+d)))}const s=n[t];let r=e,o=i;for(Sc(n,e,t),n_(n[i],s)>0&&Sc(n,e,i);r<o;){for(Sc(n,r,o),r++,o--;n_(n[r],s)<0;)r+=1;for(;n_(n[o],s)>0;)o-=1}0===n_(n[e],s)?Sc(n,e,o):(o+=1,Sc(n,o,i)),o<=t&&(e=o+1),t<=o&&(i=o-1)}}function v9(n,t,e,i,s){const r=t[t.length-1],[o,a]=[n.length/r,r],l=vs(e,o*i),c=vs("int32",o*i);for(let d=0;d<o;d++){const h=d*a,f=n.subarray(h,h+a);let p=new Array(f.length);f.forEach((_,y)=>p[y]={value:_,index:y}),i<p.length&&(y9(p,i),p=p.slice(0,i)),s&&p.sort(n_);const g=d*i,m=l.subarray(g,g+i),b=c.subarray(g,g+i);for(let _=0;_<i;_++)m[_]=p[_].value,b[_]=p[_].index}const u=t.slice();return u[u.length-1]=i,[Dt(u,e,l),Dt(u,"int32",c)]}function x9(n,t,e){switch(e){case"reflect":return function pOe(n,t){let e=n;if(e<0)if(t<=1)e=0;else{const i=2*t;e<i&&(e=i*Math.trunc(-e/i)+e),e=e<-t?e+i:-e-1}else if(e>t-1)if(t<=1)e=0;else{const i=2*t;e-=i*Math.trunc(e/i),e>=t&&(e=i-e-1)}return Xu(0,e,t-1)}(n,t);case"wrap":return function mOe(n,t){let e=n;return e<0?t<=1?e=0:e+=t*(Math.trunc(-e/(t-1))+1):e>t-1&&(t<=1?e=0:e-=t*Math.trunc(e/(t-1))),Xu(0,e,t-1)}(n,t);case"nearest":return function bOe(n,t){return Xu(0,n,t-1)}(n,t);default:return function gOe(n,t){return n}(n)}}function i_(n,t,e,i,s,r,o,a,l,c,u){return 0<=a&&a<t&&0<=l&&l<e?n[o*i+a*s+l*r+c]:u}function _Oe(n,t,e,i,s,r,o,a,l,c,u){return i_(n,t,e,i,s,r,o,Math.round(a),Math.round(l),c,u)}function yOe(n,t,e,i,s,r,o,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1;return(f-a)*((p-l)*i_(n,t,e,i,s,r,o,d,h,c,u)+(l-h)*i_(n,t,e,i,s,r,o,d,p,c,u))+(a-d)*((p-l)*i_(n,t,e,i,s,r,o,f,h,c,u)+(l-h)*i_(n,t,e,i,s,r,o,f,p,c,u))}function C9(n,t,e,i){const s=Tt(t,e)[0],r=[1,e[0],1];for(let p=0;p<s;p++)r[0]*=e[p];r[1]=e[s];for(let p=s+1;p<e.length;p++)r[2]*=e[p];const o=new Map,a=new Int32Array(e[s]),l=new ds(r,i,n),c=[],u=1===r[0]&&1===r[2];for(let p=0;p<e[s];p++){let g;if(u)g=n[p].toString();else{const b=[];for(let _=0;_<r[0];_++)for(let y=0;y<r[2];y++)b.push(l.get(_,p,y));g=b.join(",")}const m=o.get(g);if(null!=m)a[p]=m;else{const b=o.size;o.set(g,b),a[p]=b,c.push(p)}}const d=r.slice();d[1]=o.size;const h=new ds(d,i);c.forEach((p,g)=>{for(let m=0;m<r[0];m++)for(let b=0;b<r[2];b++)h.set(l.get(m,p,b),m,g,b)});const f=e.slice();return f[s]=d[1],{outputValues:h.values,outputShape:f,indices:a}}const EOe=[vNe,xNe,wNe,INe,gNe,kNe,NNe,MNe,RNe,FNe,$Ne,VNe,UNe,jNe,qNe,YNe,QNe,eAe,nAe,_Ne,sAe,aAe,cAe,dAe,fAe,pNe,mAe,bAe,hNe,_Ae,vAe,xAe,wAe,IAe,kAe,DAe,AAe,PAe,OAe,LAe,BAe,zAe,WAe,jAe,GAe,KAe,YAe,QAe,JAe,eMe,tMe,iMe,lMe,iNe,uMe,dMe,yMe,vMe,xMe,wMe,AMe,MMe,RMe,FMe,$Me,VMe,UMe,HMe,GMe,KMe,YMe,sNe,QMe,yAe,ePe,nPe,sPe,rNe,oPe,lPe,uPe,hPe,pPe,bPe,yPe,CPe,SPe,EPe,kPe,DPe,APe,PPe,OPe,LPe,BPe,zPe,WPe,jPe,qPe,YPe,JPe,rMe,t2e,s2e,a2e,u2e,h2e,p2e,g2e,b2e,Q7,x2e,aNe,w2e,A2e,P2e,O2e,L2e,fNe,OP,B2e,lNe,cNe,bNe,z2e,W2e,j2e,q2e,X2e,Y2e,Q2e,eRe,nRe,aRe,cRe,fRe,dNe,mRe,bRe,yRe,rAe,ZPe,xRe,wRe,IRe,kRe,DRe,ARe,PRe,ORe,$Re,BRe,zRe,WRe,jRe,qRe,YRe,JRe,tOe,EMe,oMe,iOe,{kernelName:gb,backendName:"cpu",kernelFunc:sOe},{kernelName:EH,backendName:"cpu",kernelFunc:function oOe(n){const{inputs:t,backend:e}=n,{tensor:i,indices:s,updates:r}=t,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=dd(0,s,i.shape),h=e.bufferSync(s),f=e.bufferSync(r),p=e.bufferSync(i),g=xd(h,f,i.shape,u,l,a,o,c,p,!1);return e.makeTensorInfo(i.shape,g.dtype,g.values)}},{kernelName:bb,backendName:"cpu",kernelFunc:function lOe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{reps:r}=i;Ue(s,"tile");const o=_9(e.bufferSync(s),r);return e.makeTensorInfo(o.shape,o.dtype,o.values)}},{kernelName:UN,backendName:"cpu",kernelFunc:function uOe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{k:r,sorted:o}=i;Ue(s,"topk");const a=e.data.get(s.dataId).values,[l,c]=v9(a,s.shape,s.dtype,r,o);return[e.makeTensorInfo(l.shape,l.dtype,l.values),e.makeTensorInfo(c.shape,c.dtype,c.values)]}},{kernelName:WN,backendName:"cpu",kernelFunc:function hOe(n){const{inputs:t,attrs:e,backend:i}=n,{image:s,transforms:r}=t,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=e,[u,d,h,f]=s.shape,[p,g]=c??[d,h],m=[u,p,g,f],b=Ye(s.shape),_=b[0],y=b[1],v=b[2],x=Ye(m),S=x[0],E=x[1],k=x[2],D=vs(s.dtype,te(m));D.fill(l);const M=i.data.get(s.dataId).values,R=i.data.get(r.dataId).values;for(let X=0;X<u;++X){const ee=1===r.shape[0]?R:R.subarray(8*X,8*X+8);for(let K=0;K<p;++K)for(let O=0;O<g;++O)for(let z=0;z<f;++z){let B;const q=ee[6]*O+ee[7]*K+1;if(0===q)continue;const le=(ee[3]*O+ee[4]*K+ee[5])/q,he=x9((ee[0]*O+ee[1]*K+ee[2])/q,h,a),ue=x9(le,d,a);switch(o){case"nearest":B=_Oe(M,d,h,_,y,v,X,ue,he,z,l);break;case"bilinear":B=yOe(M,d,h,_,y,v,X,ue,he,z,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}D[X*S+K*E+O*k+z]=B}return i.makeTensorInfo(m,s.dtype,D)}return{dataId:i.write(D,m,s.dtype),shape:s.shape,dtype:s.dtype}}},TNe,{kernelName:HN,backendName:"cpu",kernelFunc:function vOe(n){const{inputs:t,attrs:e,backend:i}=n,{axis:s}=e,{x:r}=t;Ue(r,"unique");const o=i.data.get(r.dataId).values,{outputValues:a,outputShape:l,indices:c}=C9(o,s,r.shape,r.dtype);return[i.makeTensorInfo(l,r.dtype,a),i.makeTensorInfo([c.length],"int32",c)]}},{kernelName:aC,backendName:"cpu",kernelFunc:function COe(n){const{inputs:t,backend:e,attrs:i}=n,{value:s}=t;let{axis:r}=i;r<0&&(r+=s.shape.length);const o=s.shape.length,a=s.shape[r],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==r&&(l[c++]=s.shape[f]);const u=new Array(o).fill(0),d=s.shape.slice();d[r]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[r]=f;const p=vd({inputs:{x:s},backend:e,attrs:{begin:u,size:d}});h[f]=Tn({inputs:{x:p},backend:e,attrs:{shape:l}}),e.disposeIntermediateTensorInfo(p)}return h}},{kernelName:lC,backendName:"cpu",kernelFunc:function SOe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,segmentIds:r}=t,{numSegments:o}=i;Ue(s,"unsortedSegmentSum");const c=[],u=[],d=s.shape.length-r.shape.length;let h=r;for(let p=0;p<d;++p){const g=Iw({inputs:{input:h},backend:e,attrs:{dim:p+1}});h=g,u.push(g)}for(let p=0;p<o;++p){const g=kc(p,"int32"),m=e.makeTensorInfo([],"int32",g),b=k7({inputs:{a:m,b:h},backend:e}),_=Gc({inputs:{x:b},backend:e,attrs:{dtype:"float32"}}),y=Sw({inputs:{a:_,b:s},backend:e}),v=t_({inputs:{x:y},backend:e,attrs:{axis:0,keepDims:!1}});c.push(v),u.push(m),u.push(b),u.push(_),u.push(y),u.push(v)}const f=Z7({inputs:c,backend:e,attrs:{axis:0}});return u.forEach(p=>e.disposeIntermediateTensorInfo(p)),f}},m2e];for(const n of EOe)qN(n);const qc={},Tw={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function ia(n,t){if(!(n in qc)||null!=t){const i=function DOe(n,t){if(1!==n&&2!==n)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=t??function TOe(n){if(!J().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&2===n)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return e.addEventListener("webglcontextlost",i=>{i.preventDefault(),delete qc[n]},!1),J().getBool("SOFTWARE_WEBGL_ENABLED")&&(Tw.failIfMajorPerformanceCaveat=!1),1===n?e.getContext("webgl",Tw)||e.getContext("experimental-webgl",Tw):e.getContext("webgl2",Tw)}(n,t);if(null===i)return console.log("Could not get context for WebGL version",n),null;qc[n]=i}const e=qc[n];return null==e||e.isContextLost()?(delete qc[n],ia(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),qc[n])}var Yf=(()=>{return(n=Yf||(Yf={}))[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH",Yf;var n})(),yr=(()=>{return(n=yr||(yr={}))[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD",yr;var n})(),ss=(()=>{return(n=ss||(ss={}))[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16",ss;var n})();function s_(n,t){return[t,n]}function Dw(n){const t=te(n);return WD(Math.ceil(t/4))}function Zf(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function VP(n,t){const e=n;let i,s,r,o,a,l,c,u,d,h;return 2===J().getNumber("WEBGL_VERSION")?(i=e.R32F,s=e.R16F,r=e.RGBA16F,o=e.RGBA32F,a=e.RED,c=4,u=1,d=e.HALF_FLOAT,h=e.FLOAT,l=e.RGBA8):(i=n.RGBA,s=n.RGBA,r=n.RGBA,o=e.RGBA,a=n.RGBA,c=4,u=4,d=null!=t?t.HALF_FLOAT_OES:null,h=n.FLOAT,l=n.RGBA),{internalFormatFloat:i,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}function ke(n,t){const e=t();return J().getBool("DEBUG")&&function MOe(n){const t=n.getError();if(t!==n.NO_ERROR)throw new Error("WebGL Error: "+function FOe(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}(n,t))}(n),e}const POe=5.96e-8,ROe=65504;function OOe(n){return!!(J().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===n||POe<Math.abs(n)&&Math.abs(n)<ROe)}function Nw(n,t){return Fl(n,()=>n.getExtension(t),'Extension "'+t+'" not supported on this browser.')}const BOe=/ERROR: [0-9]+:([0-9]+):/g;function w9(n,t){const e=BOe.exec(t);if(null==e)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(n);const i=+e[1],s=n.split("\n"),r=s.length.toString().length+2,o=s.map((d,h)=>Cf((h+1).toString(),r)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,i-1),c=o.slice(i-1,i),u=o.slice(i);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${Cf(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function zP(n,t){if(ke(n,()=>n.validateProgram(t)),!1===n.getProgramParameter(t,n.VALIDATE_STATUS))throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function S9(n,t,e,i,s,r,o){const a=n.getAttribLocation(t,e);return-1!==a&&(ke(n,()=>n.bindBuffer(n.ARRAY_BUFFER,i)),ke(n,()=>n.vertexAttribPointer(a,s,n.FLOAT,!1,r,o)),ke(n,()=>n.enableVertexAttribArray(a)),!0)}function YOe(n,t,e,i){ke(n,()=>function qOe(n,t,e){(function E9(n,t){const e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,i=t+n.TEXTURE0;if(i<n.TEXTURE0||i>e)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${e}].`)})(n,e),ke(n,()=>n.activeTexture(n.TEXTURE0+e)),ke(n,()=>n.bindTexture(n.TEXTURE_2D,t))}(n,t,i)),ke(n,()=>n.uniform1i(e,i))}function UP(n,t,e){ke(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),ke(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0))}function I9(n,t){ke(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),ke(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function Aw(n){const t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function ZOe(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}(n,t))}function Fl(n,t,e){const i=ke(n,()=>t());if(null==i)throw new Error(e);return i}function Qf(n,t=2){return te(n.slice(0,n.length-t))}function Jf(n){if(0===n.length)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Mw(n){let t=[1,1,1];return 0===n.length||1===n.length&&1===n[0]||(t=[Qf(n),...Jf(n)]),t}function Pw(n){return n%2==0}function Rw(n,t){if(tn(n=n.slice(-2),t=t.slice(-2))||!n.length||!t.length||0===n[0]||0===n[1]||0===t[0]||0===t[1])return!0;if(n.length!==t.length){const e=n[n.length-1],i=t[t.length-1];if(e===i||Pw(e)&&Pw(i)&&(1===n[0]||1===t[0]))return!0}return n[1]===t[1]&&Pw(n[0])&&Pw(t[0])}let Ow,Fw;function Io(n,t){return null!=n.getExtension(t)}function k9(n){try{if(null!=ia(n))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function WP(n){const t=VP(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(r),o}function r_(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{null!=e&&T("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}const He=J();function Bs(){let n,t,e,i,s,r,o,a,l,c;return 2===J().getNumber("WEBGL_VERSION")?(n="#version 300 es",t="in",e="out",i="in",s="texture",r="outputColor",o="out vec4 outputColor;",a=J().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(n="",t="attribute",e="varying",i="varying",s="texture2D",r="gl_FragColor",o="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:n,attribute:t,varyingVs:e,varyingFs:i,texture2D:s,output:r,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}function Cd(n,t,e="index"){const i=Ye(t);return i.map((s,r)=>`int ${n[r]} = ${e} / ${s}; ${r===i.length-1?`int ${n[r+1]} = ${e} - ${n[r]} * ${s}`:`index -= ${n[r]} * ${s}`};`).join("")}function Lw(n,t,e="index"){const i=Ye(t);return i.map((s,r)=>`int ${n[r]} = ${e} / outShapeStrides[${r}]; ${r===i.length-1?`int ${n[r+1]} = ${e} - ${n[r]} * outShapeStrides[${r}]`:`index -= ${n[r]} * outShapeStrides[${r}]`};`).join("")}function HP(n){const t=Ye(n).map(e=>e.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}He.registerFlag("HAS_WEBGL",()=>He.getNumber("WEBGL_VERSION")>0),He.registerFlag("WEBGL_VERSION",()=>k9(2)?2:k9(1)?1:0),He.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),He.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===He.get("WEBGL_VERSION")),He.registerFlag("WEBGL_CPU_FORWARD",()=>!0),He.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),He.registerFlag("WEBGL_PACK",()=>He.getBool("HAS_WEBGL")),He.registerFlag("WEBGL_PACK_NORMALIZATION",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_CLIP",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_REDUCE",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_LAZILY_UNPACK",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_CONV_IM2COL",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>He.getBool("WEBGL_PACK")),He.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function JOe(n){if(null==Ow){const t=ia(n);Ow=t.getParameter(t.MAX_TEXTURE_SIZE)}return Ow}(He.getNumber("WEBGL_VERSION"))),He.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function eFe(n){if(null==Fw){const t=ia(n);Fw=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Fw)}(He.getNumber("WEBGL_VERSION"))),He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=He.getNumber("WEBGL_VERSION");return 0===n?0:function tFe(n){if(0===n)return 0;let t;const e=ia(n);return t=Io(e,"EXT_disjoint_timer_query_webgl2")&&2===n?2:Io(e,"EXT_disjoint_timer_query")?1:0,t}(n)}),He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>He.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!jH()),He.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function nFe(n){if(0===n)return!1;const t=ia(n);if(1===n){if(!Io(t,"OES_texture_float"))return!1}else if(!Io(t,"EXT_color_buffer_float"))return!1;return WP(t)}(He.getNumber("WEBGL_VERSION"))),He.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!He.getBool("WEBGL_FORCE_F16_TEXTURES")&&He.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),He.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>function iFe(n){if(0===n)return!1;const t=ia(n);if(1!==n){if(Io(t,"EXT_color_buffer_float"))return WP(t);const i="EXT_color_buffer_half_float";if(Io(t,i)){const s=t.getExtension(i);return function sFe(n,t){const e=VP(n,t),i=n.createTexture();n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,i,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(i),n.deleteFramebuffer(o),a}(t,s)}return!1}return!(!Io(t,"OES_texture_float")||!Io(t,"WEBGL_color_buffer_float"))&&WP(t)}(He.getNumber("WEBGL_VERSION"))),He.registerFlag("WEBGL_FENCE_API_ENABLED",()=>function rFe(n){return 2===n&&null!=ia(n).fenceSync}(He.getNumber("WEBGL_VERSION"))),He.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>He.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),He.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if("number"!=typeof n)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&-1!==n)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)}),He.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>jH()?1:-1,n=>{if("number"!=typeof n)throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&-1!==n)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)}),He.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),He.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),He.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),He.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),He.registerFlag("WEBGL_EXP_CONV",()=>!1),He.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>He.getBool("IS_TEST")),He.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),He.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),He.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),He.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);const T9="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:D9}=rt;function lFe(n,t,e){const i=[];if(n.forEach(f=>{const p=te(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?i.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(i.push(`uniform sampler2D ${f.name};`),i.push(`uniform int offset${f.name};`)),e.enableShapeUniforms){const{uniformShape:g}=GP(e.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:i.push(`uniform int ${f.name}Shape;`);break;case 2:i.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:i.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:i.push(`uniform ivec4 ${f.name}Shape;`)}i.push(`uniform ivec2 ${f.name}TexShape;`)}}),e.enableShapeUniforms){switch(t.logicalShape.length){case 1:i.push("uniform int outShape;");break;case 2:i.push("uniform ivec2 outShape;"),i.push("uniform int outShapeStrides;");break;case 3:i.push("uniform ivec3 outShape;"),i.push("uniform ivec2 outShapeStrides;");break;case 4:i.push("uniform ivec4 outShape;"),i.push("uniform ivec3 outShapeStrides;")}i.push("uniform ivec2 outTexShape;")}e.customUniforms&&e.customUniforms.forEach(f=>{i.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=i.join("\n"),r=n.map(f=>function cFe(n,t,e=!1,i){let s="";s+=e?N9(n,i):ep(n,i);return n.shapeInfo.logicalShape.length<=t.logicalShape.length&&(s+=e?function UFe(n,t){const e=n.name,i=e.charAt(0).toUpperCase()+e.slice(1),s="get"+i+"AtOutCoords",r=n.shapeInfo.logicalShape.length,o=t.logicalShape.length,a=D9(n.shapeInfo.logicalShape,t.logicalShape),l=yn(o),c=o-r;let u;const d=["x","y","z","w","u","v"];u=0===r?"":o<2&&a.length>=1?"coords = 0;":a.map(_=>`coords.${d[_+c]} = 0;`).join("\n");let h="";h=o<2&&r>0?"coords":n.shapeInfo.logicalShape.map((_,y)=>`coords.${d[y+c]}`).join(", ");let f="return outputValue;";const g=1===te(n.shapeInfo.logicalShape),b=1===te(t.logicalShape);if(1!==r||g||b){if(g&&!b)f=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(a.length){const _=r-2,y=r-1;a.indexOf(_)>-1&&a.indexOf(y)>-1?f="return vec4(outputValue.x);":a.indexOf(_)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(y)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${s}() {\n      ${l} coords = getOutputCoords();\n      ${u}\n      vec4 outputValue = get${i}(${h});\n      ${f}\n    }\n  `}(n,t):function WFe(n,t){const e=n.name,i=e.charAt(0).toUpperCase()+e.slice(1),s="get"+i+"AtOutCoords",a=n.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!n.shapeInfo.isUniform&&a===l&&null==n.shapeInfo.flatOffset&&tn(n.shapeInfo.texShape,t.texShape))return`\n      float ${s}() {\n        return sampleTexture(${e}, resultUV);\n      }\n    `;const c=yn(l),u=D9(n.shapeInfo.logicalShape,t.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];h=0===a?"":l<2&&u.length>=1?"coords = 0;":u.map(g=>`coords.${f[g+d]} = 0;`).join("\n");let p="";return p=l<2&&a>0?"coords":n.shapeInfo.logicalShape.map((g,m)=>`coords.${f[m+d]}`).join(", "),`\n    float ${s}() {\n      ${c} coords = getOutputCoords();\n      ${h}\n      return get${i}(${p});\n    }\n  `}(n,t)),s}(f,t,e.packedInputs,e.enableShapeUniforms)).join("\n"),o=t.texShape,a=Bs(),l=function hFe(n){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${n.texture2D}(textureSampler, uv).r;\n    }\n  `}(a);let c,u,d=function mFe(n){return`${n.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${n.varyingFs} vec2 resultUV;\n    ${n.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${n.defineSpecialNaN}\n    ${n.defineSpecialInf}\n    ${n.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${gFe}\n    ${bFe}\n    ${_Fe}\n  `}(a);return t.isPacked?(c=function uFe(n,t,e){switch(n.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function vFe(n,t,e){const i=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===i[0]?e?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${i[1]}.0);\n      }\n    `:1===i[1]?e?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${i[0]}.0);\n      }\n    `:e?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${i[0]}, ${i[1]}));\n      return 2 * (resTexRC.x * ${i[1]} + resTexRC.y);\n    }\n  `}(0,t,e);case 2:return function TFe(n,t,e){const i=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(tn(n,t))return e?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${i[0]}, ${i[1]}));\n      }\n    `;const s=Math.ceil(n[1]/2);return e?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${i[0]}, ${i[1]}));\n\n      int index = resTexRC.x * ${i[1]} + resTexRC.y;\n      int r = 2 * (index / ${s});\n      int c = imod(index, ${s}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(n,t,e);case 3:return function CFe(n,t,e){if(e)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const i=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],s=Math.ceil(n[2]/2),r=s*Math.ceil(n[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${i[0]}, ${i[1]}));\n      int index = resTexRC.x * ${i[1]} + resTexRC.y;\n\n      int b = index / ${r};\n      index -= b * ${r};\n\n      int r = 2 * (index / ${s});\n      int c = imod(index, ${s}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(n,t,e);default:return function SFe(n,t,e){if(e)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const i=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],s=Math.ceil(n[n.length-1]/2),r=s*Math.ceil(n[n.length-2]/2);let o=r,a="",l="b, r, c";for(let c=2;c<n.length-1;c++)o*=n[n.length-c-1],a=`\n      int b${c} = index / ${o};\n      index -= b${c} * ${o};\n    `+a,l=`b${c}, `+l;return`\n    ivec${n.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${i[0]}, ${i[1]}));\n      int index = resTexRC.x * ${i[1]} + resTexRC.y;\n\n      ${a}\n\n      int b = index / ${r};\n      index -= b * ${r};\n\n      int r = 2 * (index / ${s});\n      int c = imod(index, ${s}) * 2;\n\n      return ivec${n.length}(${l});\n    }\n  `}(n,t,e)}}(t.logicalShape,o,e.enableShapeUniforms),u=function pFe(n){return`\n    void setOutput(vec4 val) {\n      ${n.output} = val;\n    }\n  `}(a)):(c=function dFe(n,t,e){switch(n.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function xFe(n,t,e){return 1===t[0]?e?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `:1===t[1]?e?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `:e?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,e);case 2:return function DFe(n,t,e){return tn(n,t)?e?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `:1===n[1]?e?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===n[0]?e?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:e?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${n[1]};\n      int c = index - r * ${n[1]};\n      return ivec2(r, c);\n    }\n  `}(n,t,e);case 3:return function wFe(n,t,e){if(e)return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${Lw(["r","c","d"],n)}\n    return ivec3(r, c, d);\n  }\n`;const i=Cd(["r","c","d"],n);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${i}\n      return ivec3(r, c, d);\n    }\n  `}(n,t,e);case 4:return function IFe(n,t,e){if(e)return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${Lw(["r","c","d","d2"],n)}\n      return ivec4(r, c, d, d2);\n    }\n  `;const i=Cd(["r","c","d","d2"],n);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${i}\n      return ivec4(r, c, d, d2);\n    }\n  `}(n,t,e);case 5:return function EFe(n,t){const e=Cd(["r","c","d","d2","d3"],n);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${e}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(n,t);case 6:return function kFe(n,t){const e=Cd(["r","c","d","d2","d3","d4"],n);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${e}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(n,t);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}(t.logicalShape,o,e.enableShapeUniforms),u=function fFe(n){return`\n    void setOutput(float val) {\n      ${n.output} = vec4(val, 0, 0, 0);\n    }\n  `}(a)),e.packedInputs&&(d+=yFe),[d,l,u,s,c,r,e.userCode].join("\n")}function ep(n,t=!1){const e=n.shapeInfo.logicalShape;switch(e.length){case 0:return function AFe(n,t){const e=n.name,i="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`float ${i}() {return ${e};}`;const[s,r]=n.shapeInfo.texShape;if(1===s&&1===r)return`\n      float ${i}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const o=wd(e);if(t)return`\n    float ${i}() {\n      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `;const[a,l]=n.shapeInfo.texShape;return`\n    float ${i}() {\n      vec2 uv = uvFromFlat(${a}, ${l}, ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `}(n,t);case 1:return function PFe(n,t){const e=n.name,i="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`\n      float ${i}(int index) {\n        ${tp(n)}\n      }\n    `;const s=n.shapeInfo.texShape,r=s[0],o=s[1];if(1===o&&1===r)return`\n      float ${i}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const a=wd(e);return 1===o?t?`\n      float ${i}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${e}TexShape[0]));\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n      float ${i}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${r}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `:1===r?t?`\n      float ${i}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${e}TexShape[1]), 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n      float ${i}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:t?`\n    float ${i}(int index) {\n      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], index + ${a});\n      return sampleTexture(${e}, uv);\n    }\n  `:`\n    float ${i}(int index) {\n      vec2 uv = uvFromFlat(${r}, ${o}, index + ${a});\n      return sampleTexture(${e}, uv);\n    }\n  `}(n,t);case 2:return function OFe(n,t){const e=n.shapeInfo.logicalShape,i=n.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),r=n.shapeInfo.texShape;if(null!=r&&tn(e,r))return t?`\n      float ${s}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}TexShape[1], ${i}TexShape[0]);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n    float ${s}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${r[1]}.0, ${r[0]}.0);\n      return sampleTexture(${i}, uv);\n    }\n  `;const{newShape:o,keptDims:a}=Ic(e);if(o.length<e.length){const f=["row","col"];return`\n      ${ep(np(n,o),t)}\n      float ${s}(int row, int col) {\n        return ${s}(${ip(f,a)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${s}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));\n        ${tp(n)}\n      }\n    `;const c=r[0],u=r[1],d=wd(i);return 1===u?t?`\n      float ${s}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${i}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${i}TexShape[0]));\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n    float ${s}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);\n      return sampleTexture(${i}, uv);\n    }\n  `:1===c?t?`\n      float ${s}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${i}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${i}TexShape[1]), 0.5);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n    float ${s}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);\n      return sampleTexture(${i}, uv);\n    }\n  `:t?`\n      float ${s}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${i}Shape[1] + col + ${d};\n        vec2 uv = uvFromFlat(${i}TexShape[0], ${i}TexShape[1], index);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n  float ${s}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${e[1]} + col + ${d};\n    vec2 uv = uvFromFlat(${c}, ${u}, index);\n    return sampleTexture(${i}, uv);\n  }\n`}(n,t);case 3:return function LFe(n,t){const e=n.shapeInfo.logicalShape,i=n.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),r=e[1]*e[2],o=e[2],{newShape:a,keptDims:l}=Ic(e);if(a.length<e.length){const m=["row","col","depth"];return`\n        ${ep(np(n,a),t)}\n        float ${s}(int row, int col, int depth) {\n          return ${s}(${ip(m,l)});\n        }\n      `}if(n.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${r}, ${o}, 1)));\n        ${tp(n)}\n      }\n    `;const u=n.shapeInfo.texShape,d=u[0],h=u[1],f=n.shapeInfo.flatOffset;if(h===r&&null==f)return t?`\n      float ${s}(int row, int col, int depth) {\n        int stride1 = ${i}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${i}TexShape[1], ${i}TexShape[0]);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n        float ${s}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${o}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${h}.0, ${d}.0);\n          return sampleTexture(${i}, uv);\n        }\n      `;if(h===o&&null==f)return t?`\n      float ${s}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${i}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}TexShape[1], ${i}TexShape[0]);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n    float ${s}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);\n      return sampleTexture(${i}, uv);\n    }\n  `;const p=wd(i);return t?`\n    float ${s}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${i}Shape[1] * ${i}Shape[2];\n      int stride1 = ${i}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${p};\n      vec2 uv = uvFromFlat(${i}TexShape[0], ${i}TexShape[1], index);\n      return sampleTexture(${i}, uv);\n    }\n    `:`\n      float ${s}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r} + col * ${o} + depth + ${p};\n        vec2 uv = uvFromFlat(${d}, ${h}, index);\n        return sampleTexture(${i}, uv);\n      }\n  `}(n,t);case 4:return function BFe(n,t){const e=n.shapeInfo.logicalShape,i=n.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),r=e[3],o=e[2]*r,a=e[1]*o,{newShape:l,keptDims:c}=Ic(e);if(l.length<e.length){const y=["row","col","depth","depth2"];return`\n      ${ep(np(n,l),t)}\n      float ${s}(int row, int col, int depth, int depth2) {\n        return ${s}(${ip(y,c)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${a}, ${o}, ${r}, 1)));\n        ${tp(n)}\n      }\n    `;const u=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${i}Shape[3];`,g=`int stride1 = ${i}Shape[2] * stride2;`,m=`int stride0 = ${i}Shape[1] * stride1;`;if(f===a&&null==u)return t?`\n      float ${s}(int row, int col, int depth, int depth2) {\n        ${p}\n        ${g}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${i}TexShape[1], ${i}TexShape[0]);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${o}, ${r}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${h}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `;if(f===r&&null==u)return t?`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${i}Shape[1] * ${i}Shape[2], ${i}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${i}TexShape[1], ${i}TexShape[0]);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${e[1]*e[2]}, ${e[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${h}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `;const b=wd(i);return t?`\n    float ${s}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${p}\n      ${g}\n      ${m}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${i}TexShape[0], ${i}TexShape[1], index + ${b});\n      return sampleTexture(${i}, uv);\n    }\n  `:`\n    float ${s}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} +\n          depth * ${r} + depth2;\n      vec2 uv = uvFromFlat(${h}, ${f}, index + ${b});\n      return sampleTexture(${i}, uv);\n    }\n  `}(n,t);case 5:return function VFe(n){const t=n.shapeInfo.logicalShape,e=n.name,i="get"+e.charAt(0).toUpperCase()+e.slice(1),s=t[4],r=t[3]*s,o=t[2]*r,a=t[1]*o,{newShape:l,keptDims:c}=Ic(t);if(l.length<t.length){const m=["row","col","depth","depth2","depth3"];return`\n      ${ep(np(n,l))}\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        return ${i}(${ip(m,c)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${a}, ${o}, ${r}, ${s})) +\n          depth3;\n        ${tp(n)}\n      }\n    `;const u=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&null==u)return`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${o}, ${r}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${h}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(f===s&&null==u)return`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${h}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${i}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} + depth * ${r} +\n          depth2 * ${s} + depth3 + ${wd(e)};\n      vec2 uv = uvFromFlat(${h}, ${f}, index);\n      return sampleTexture(${e}, uv);\n    }\n  `}(n);case 6:return function zFe(n){const t=n.shapeInfo.logicalShape,e=n.name,i="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:s,keptDims:r}=Ic(t);if(s.length<t.length){const b=["row","col","depth","depth2","depth3","depth4"];return`\n      ${ep(np(n,s))}\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${i}(${ip(b,r)});\n      }\n    `}const o=t[5],a=t[4]*o,l=t[3]*a,c=t[2]*l,u=t[1]*c;if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${u}, ${c}, ${l}, ${a})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${o}, 1)));\n        ${tp(n)}\n      }\n    `;const d=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&null==d)return`\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${c}, ${l}, ${a}, ${o})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${f}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(p===o&&null==d)return`\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${f}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${i}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${u} + col * ${c} + depth * ${l} +\n          depth2 * ${a} + depth3 * ${o} + depth4 + ${wd(e)};\n      vec2 uv = uvFromFlat(${f}, ${p}, index);\n      return sampleTexture(${e}, uv);\n    }\n  `}(n);default:throw new Error(`${e.length}-D input sampling is not yet supported`)}}function N9(n,t){switch(n.shapeInfo.logicalShape.length){case 0:return function NFe(n){const t=n.name;return`\n    vec4 ${"get"+t.charAt(0).toUpperCase()+t.slice(1)}() {\n      return ${Bs().texture2D}(${t}, halfCR);\n    }\n  `}(n);case 1:return function MFe(n,t){const e=n.name,i="get"+e.charAt(0).toUpperCase()+e.slice(1),s=n.shapeInfo.texShape,r=Bs();if(t)return`\n    vec4 ${i}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${r.texture2D}(${e}, uv);\n    }\n  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`\n    vec4 ${i}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${o[0]}, ${o[1]}, index);\n      return ${r.texture2D}(${e}, uv);\n    }\n  `}(n,t);case 2:return function RFe(n,t){const e=n.shapeInfo.logicalShape,i=n.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),r=n.shapeInfo.texShape,o=r[0],a=r[1],l=Bs();if(null!=r&&tn(e,r))return t?`\n      vec4 ${s}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}TexShape[1], ${i}TexShape[0]);\n\n        return ${l.texture2D}(${i}, uv);\n      }\n    `:`\n      vec4 ${s}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);\n\n        return ${l.texture2D}(${i}, uv);\n      }\n    `;if(t)return`\n    vec4 ${s}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${i}TexShape[0]) / 2.0), ceil(float(${i}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${i}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${l.texture2D}(${i}, uv);\n    }\n  `;const c=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`\n    vec4 ${s}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(e[1]/2)}, ${c[0]}, ${c[1]}, row, col);\n      return ${l.texture2D}(${i}, uv);\n    }\n  `}(n,t);case 3:return function FFe(n,t){const e=n.shapeInfo.logicalShape,i=n.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),r=n.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(1===e[0]){const f=[1,2],g=["b","row","col"];return`\n        ${N9(np(n,e.slice(1)),t)}\n        vec4 ${s}(int b, int row, int col) {\n          return ${s}(${ip(g,f)});\n        }\n      `}const a=Bs();if(t)return`\n    vec4 ${s}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${i}TexShape[0]) / 2.0), ceil(float(${i}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${i}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${i}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${a.texture2D}(${i}, uv);\n    }\n  `;const l=o[0],c=o[1],u=Math.ceil(e[2]/2);return`\n    vec4 ${s}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${l}, ${c}, ${u*Math.ceil(e[1]/2)}, ${u}, b, row, col);\n      return ${a.texture2D}(${i}, uv);\n    }\n  `}(n,t);default:return function $Fe(n,t){const e=n.name,i="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Bs();if(t)return`\n    vec4 ${i}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${e}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${e}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${e}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${e}, uv);\n    }\n  `;const r=n.shapeInfo.logicalShape,o=r.length,a=n.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(r[o-1]/2);let h=d*Math.ceil(r[o-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<o-1;g++)f=`int b${g}, `+f,h*=r[o-g-1],p=`b${g} * ${h} + `+p;return`\n    vec4 ${i}(${f}) {\n      int index = ${p};\n      int texR = index / ${u};\n      int texC = index - texR * ${u};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});\n      return ${s.texture2D}(${e}, uv);\n    }\n  `}(n,t)}}const gFe="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",bFe="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",_Fe="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",yFe="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function wd(n){return`offset${n}`}function tp(n){const t=n.name,e=te(n.shapeInfo.logicalShape);return e<2?`return ${t};`:`\n    for (int i = 0; i < ${e}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function yn(n){if(n<=1)return"int";if(2===n)return"ivec2";if(3===n)return"ivec3";if(4===n)return"ivec4";if(5===n)return"ivec5";if(6===n)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function GP(n,t,e){const{newShape:i,keptDims:s}=Ic(t),r=t.length,o=n&&3===r&&1===t[0],a=o?t.slice(1):i,l=!n&&r>1&&!tn(t,e)&&i.length<r||o;return{useSqueezeShape:l,uniformShape:l?a:t,keptDims:s}}function np(n,t){const e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function ip(n,t){return t.map(e=>n[e]).join(", ")}function M9(n,t,e){const i=[],s=[];let r,o,a,l=null,c=null;c=n.getUniformLocation(e,"NAN",!1),1===J().getNumber("WEBGL_VERSION")&&(l=n.getUniformLocation(e,"INFINITY",!1));const u=!1;for(const d of t.variableNames){const h={name:d,uniform:n.getUniformLocation(e,d,u),offset:n.getUniformLocation(e,`offset${d}`,u)};t.enableShapeUniforms&&(h.shape=n.getUniformLocation(e,`${d}Shape`,u),h.texShape=n.getUniformLocation(e,`${d}TexShape`,u)),i.push(h)}if(t.enableShapeUniforms&&(r=n.getUniformLocation(e,"outShape",u),a=n.getUniformLocation(e,"outShapeStrides",u),o=n.getUniformLocation(e,"outTexShape",u)),t.customUniforms)for(const d of t.customUniforms)s.push(n.getUniformLocation(e,d.name,u));return{variablesLocations:i,customUniformLocations:s,infLoc:l,nanLoc:c,outShapeLocation:r,outShapeStridesLocation:a,outTexShapeLocation:o}}function P9(n,t){if(n.length!==t.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${t.length} inputs`);n.forEach((e,i)=>{const s=e.logicalShape,r=t[i],o=r.shape;if(!tn(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(e.isUniform&&r.isUniform)return;const a=e.texShape,l=r.isUniform?null:r.texData.texShape;if(!tn(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Is(n){return J().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}class qFe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Yf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=Bs();this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?Lw(["r","c","d"],t):Cd(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${e.output} = result;\n      }\n    `}}class KFe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Yf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=Bs();this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?Lw(["r","c","d"],t):Cd(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${e.output} = result;\n      }\n    `}}class XFe{constructor(t){this.variableNames=["A"],this.outTexUsage=yr.DOWNLOAD;const e=Bs();this.outputShape=t,this.userCode=`\n      ${T9}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}class YFe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=yr.DOWNLOAD;const e=Bs();this.outputShape=t,this.userCode=`\n      ${T9}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}const ZFe={R:0,G:1,B:2,A:3};class R9{constructor(t,e=!1,i="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Bs();this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length);let r="result";e&&(r="floor(result * 255. + 0.5)");let o="";for(let a=0;a<i.length;a++)o+=`\n          if(offset == ${a}) {\n            result = values[${ZFe[i[a]]}];\n          }`;this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":HP(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${i.length});\n\n        flatIndex = idiv(flatIndex, ${i.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${s.texture2D}(A, uv);\n          ${o}\n        }\n        ${s.output} = vec4(${r}, 0., 0., 0.);\n      }\n    `}}class QFe{constructor(t,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=Bs();this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length);let s="",r="result";e&&(r="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=2*o+a;s+=`\n          localCoords = coords;\n          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {\n          localCoords[2] += ${a};\n          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {\n            localCoords[1] += ${o};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${i.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${l}] = values[0];\n            } else if (offset == 1) {\n              result[${l}] = values[1];\n            } else if (offset == 2) {\n              result[${l}] = values[2];\n            } else {\n              result[${l}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":HP(t)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${s}\n\n          ${i.output} = ${r};\n        }\n    `}}function o_(n,t,e,i,s,r){!function jOe(n,t){const e=J().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0)throw new Error(`Requested texture size [${n}x${t}] is invalid.`);if(n>e||t>e)throw new Error(`Requested texture size [${n}x${t}] greater than WebGL maximum on this browser / GPU [${e}x${e}].`)}(t,e);const o=function HOe(n){return Fl(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}(n),a=n.TEXTURE_2D;return ke(n,()=>n.bindTexture(a,o)),ke(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),ke(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),ke(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),ke(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),1===J().getNumber("WEBGL_VERSION")?ke(n,()=>n.texImage2D(a,0,i,t,e,0,s,r,null)):ke(n,()=>n.texStorage2D(a,1,i,t,e)),ke(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:o,texShape:[e,t]}}function O9(n){return n.internalFormatFloat}function F9(n){return n.internalFormatHalfFloat}function L9(n){return n.downloadTextureFormat}function $9(n){return n.internalFormatPackedFloat}function B9(n){return n.internalFormatPackedHalfFloat}class qP{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=J().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function kOe(n,t){qc[n]=t}(e,t)):this.gl=ia(e),t=this.gl,2===J().getNumber("WEBGL_VERSION")){const r=t;this.createVertexArray=()=>ke(r,()=>r.createVertexArray()),this.bindVertexArray=o=>ke(r,()=>r.bindVertexArray(o)),this.deleteVertexArray=o=>ke(r,()=>r.deleteVertexArray(o)),this.getVertexArray=()=>ke(r,()=>r.getParameter(r.VERTEX_ARRAY_BINDING))}else if(null!=t){const r=t.getExtension("OES_vertex_array_object");if(null==r)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ke(t,()=>r.createVertexArrayOES()),this.bindVertexArray=o=>ke(t,()=>r.bindVertexArrayOES(o)),this.deleteVertexArray=o=>ke(t,()=>r.deleteVertexArrayOES(o)),this.getVertexArray=()=>ke(t,()=>t.getParameter(r.VERTEX_ARRAY_BINDING_OES))}let i="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===J().getNumber("WEBGL_VERSION")){const o="OES_texture_half_float";if(this.textureFloatExtension=Nw(this.gl,"OES_texture_float"),Io(this.gl,o))this.textureHalfFloatExtension=Nw(this.gl,o);else if(J().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(i),Io(this.gl,s))this.colorBufferHalfFloatExtension=Nw(this.gl,s);else if(J().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(i="EXT_color_buffer_float",Io(this.gl,i))this.colorBufferFloatExtension=this.gl.getExtension(i);else{if(!Io(this.gl,s))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(s)}this.vertexBuffer=function eLe(n){return function UOe(n,t){const e=Fl(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return ke(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),ke(n,()=>n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)),e}(n,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl),this.indexBuffer=function tLe(n){return function WOe(n,t){const e=Fl(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return ke(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e)),ke(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)),e}(n,new Uint16Array([0,1,2,2,1,3]))}(this.gl),this.framebuffer=function GOe(n){return Fl(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=VP(this.gl,this.textureHalfFloatExtension)}get debug(){return J().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;ke(t,()=>t.finish()),ke(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),ke(t,()=>t.deleteFramebuffer(this.framebuffer)),ke(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),ke(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),ke(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function nLe(n,t,e,i){const[s,r]=s_(t,e);return o_(n,s,r,O9(i),i.textureFormatFloat,n.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function iLe(n,t,e,i){const[s,r]=s_(t,e);return o_(n,s,r,F9(i),i.textureFormatFloat,i.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function sLe(n,t,e,i){const[s,r]=s_(t,e);return o_(n,s,r,L9(i),n.RGBA,n.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function cLe(n,t,e){ke(n,()=>n.bindTexture(n.TEXTURE_2D,t)),e.data instanceof Uint8Array?2===J().getNumber("WEBGL_VERSION")?ke(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.width,e.height,n.RGBA,n.UNSIGNED_BYTE,e.data)):ke(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,e.data)):2===J().getNumber("WEBGL_VERSION")?ke(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,e)):ke(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e)),ke(n,()=>n.bindTexture(n.TEXTURE_2D,null))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,i,s){this.throwIfDisposed(),function lLe(n,t,e,i,s,r){let o,a,l;ke(n,()=>n.bindTexture(n.TEXTURE_2D,t)),s instanceof Uint8Array?(o=new Uint8Array(e*i*4),a=n.UNSIGNED_BYTE,l=n.RGBA):(o=new Float32Array(e*i*4),a=n.FLOAT,l=r.internalFormatPackedFloat),o.set(s),2===J().getNumber("WEBGL_VERSION")?ke(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,i,n.RGBA,a,o)):ke(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,e,i,0,n.RGBA,a,o)),ke(n,()=>n.bindTexture(n.TEXTURE_2D,null))}(this.gl,t,e,i,s,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function oLe(n,t,e,i){const[s,r]=Zf(t,e);return o_(n,s,r,B9(i),n.RGBA,i.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function rLe(n,t,e,i){const[s,r]=Zf(t,e);return o_(n,s,r,$9(i),n.RGBA,n.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(I9(this.gl,this.framebuffer),this.outputTexture=null),ke(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,i){return this.downloadMatrixDriver(t,()=>function hLe(n,t,e,i){const[s,r]=s_(t,e),a=new Uint8Array(function NOe(n,t){return n*t}(t*e,4));return ke(n,()=>n.readPixels(0,0,s,r,i.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}(this.gl,e,i,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,i,s,r,o){return function fLe(n,t,e,i,s,r,o,a){const l=n,c=new Float32Array(function AOe(n,t){const[e,i]=Zf(n,t);return e*i*4}(r,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}(this.gl,t,0,0,0,r,o)}downloadFloat32MatrixFromBuffer(t,e){return function dLe(n,t,e){const i=n,s=new Float32Array(e);return i.bindBuffer(i.PIXEL_PACK_BUFFER,t),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,s),i.bindBuffer(i.PIXEL_PACK_BUFFER,null),s}(this.gl,t,e)}createBufferFromTexture(t,e,i){this.bindTextureToFrameBuffer(t);const s=function uLe(n,t,e,i){const s=n.createBuffer();ke(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,s));const a=16*t*e;return ke(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),ke(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,0)),ke(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),s}(this.gl,e,i);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,i;if(J().getBool("WEBGL_FENCE_API_ENABLED")){const s=t,r=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),i=()=>{const o=s.clientWaitSync(r,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},e=r}else J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),i=()=>this.isQueryAvailable(e,J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):i=()=>!0;return{query:e,isFencePassed:i}}downloadMatrixFromPackedTexture(t,e,i){return this.downloadMatrixDriver(t,()=>function pLe(n,t,e){const i=new Float32Array(t*e*4);return ke(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,i)),i}(this.gl,e,i))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=function JFe(n){const t=Bs();return function LOe(n,t){const e=Fl(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ke(n,()=>n.shaderSource(e,t)),ke(n,()=>n.compileShader(e)),!1===n.getShaderParameter(e,n.COMPILE_STATUS))throw console.log(n.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}(n,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}(e));const i=function VOe(n){return Fl(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}(e);ke(e,()=>e.attachShader(i,this.vertexShader)),ke(e,()=>e.attachShader(i,t)),function zOe(n,t){if(ke(n,()=>n.linkProgram(t)),!J().get("ENGINE_COMPILE_ONLY")&&!1===n.getProgramParameter(t,n.LINK_STATUS))throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(e,i);const s=Object.assign(i,{vao:this.createVertexArray()});return this.debug&&zP(e,s),s}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;ke(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),function aLe(n,t,e){ke(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),S9(n,t,"clipSpacePos",e,3,20,0)&&S9(n,t,"uv",e,2,20,12)}(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(ke(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&zP(this.gl,this.program),ke(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,i=!0){return this.throwIfDisposed(),i?function KOe(n,t,e){return Fl(n,()=>n.getUniformLocation(t,e),'uniform "'+e+'" not present in program.')}(this.gl,t,e):function XOe(n,t,e){return n.getUniformLocation(t,e)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),ke(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,i){this.throwIfDisposed(),this.throwIfNoProgram(),YOe(this.gl,t,e,i)}setOutputMatrixTexture(t,e,i){this.setOutputMatrixTextureDriver(t,i,e)}setOutputPackedMatrixTexture(t,e,i){this.throwIfDisposed();const[s,r]=Zf(e,i);this.setOutputMatrixTextureDriver(t,s,r)}setOutputMatrixWriteRegion(t,e,i,s){this.setOutputMatrixWriteRegionDriver(i,t,s,e)}setOutputPackedMatrixWriteRegion(t,e,i,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&zP(this.gl,this.program),Aw(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ke(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ke(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Nw(this.gl,2===J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const i=this.gl,s=this.getQueryTimerExtensionWebGL2(),r=i.createQuery();return i.beginQuery(s.TIME_ELAPSED_EXT,r),r}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,i=this.getQueryTimerExtensionWebGL2();return void e.endQuery(i.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){var e=this;return Q(function*(){return yield lH(()=>e.disposed||e.isQueryAvailable(t,J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),e.getQueryTime(t,J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})()}getQueryTime(t,e){if(0===e)return null;if(2===e){const i=this.gl;return i.getQueryParameter(t,i.QUERY_RESULT)/1e6}{const i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const i=this.gl,s=this.getQueryTimerExtensionWebGL2(),r=i.getQueryParameter(t,i.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const i=this.getQueryTimerExtensionWebGL1(),s=i.getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function mLe(n){let t=0;for(;t<n.length&&n[t]();++t);return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:i}=this.itemsToPoll[e];i()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let i;"setTimeoutCustom"in J().platform&&(i=J().platform.setTimeoutCustom.bind(J().platform)),lH(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,i)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),UP(this.gl,t,this.framebuffer),this.debug&&Aw(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(UP(this.gl,this.outputTexture,this.framebuffer),this.debug&&Aw(this.gl)):I9(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const i=e();return this.unbindTextureToFrameBuffer(),i}setOutputMatrixTextureDriver(t,e,i){this.throwIfDisposed();const s=this.gl;UP(s,t,this.framebuffer),this.debug&&Aw(s),this.outputTexture=t,ke(s,()=>s.viewport(0,0,e,i)),ke(s,()=>s.scissor(0,0,e,i))}setOutputMatrixWriteRegionDriver(t,e,i,s){this.throwIfDisposed(),ke(this.gl,()=>this.gl.scissor(t,e,i,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{addImpl:gLe,bincountImpl:V9,bincountReduceImpl:bLe,bitwiseAndImpl:_Le,castImpl:yLe,ceilImpl:vLe,concatImpl:xLe,equalImpl:CLe,expImpl:wLe,expm1Impl:SLe,floorImpl:ILe,gatherNdImpl:ELe,gatherV2Impl:kLe,greaterImpl:TLe,greaterEqualImpl:DLe,lessImpl:NLe,lessEqualImpl:ALe,linSpaceImpl:MLe,logImpl:PLe,maxImpl:RLe,maximumImpl:OLe,minimumImpl:FLe,multiplyImpl:LLe,negImpl:$Le,notEqualImpl:BLe,prodImpl:VLe,raggedGatherImpl:zLe,raggedRangeImpl:ULe,raggedTensorToTensorImpl:WLe,rangeImpl:HLe,rsqrtImpl:jLe,scatterImpl:GLe,sigmoidImpl:qLe,simpleAbsImpl:z9,sliceImpl:KLe,sparseFillEmptyRowsImpl:XLe,sparseReshapeImpl:YLe,sparseSegmentReductionImpl:U9,sqrtImpl:ZLe,staticRegexReplaceImpl:QLe,stridedSliceImpl:JLe,stringNGramsImpl:e$e,stringSplitImpl:t$e,stringToHashBucketFastImpl:n$e,subImpl:i$e,tileImpl:s$e,topKImpl:r$e,transposeImpl:KP,uniqueImpl:o$e}=Ln;function W9(n,t){return["x","y","z","w","u","v"].slice(0,t).map(e=>`${n}.${e}`)}function Vs(n,t){return 1===t?[n]:W9(n,t)}class l$e{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Is(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=Vs("rc",this.rank),i=yn(this.rank),s=this.getOutOfBoundsCondition(e),r=this.getSetup(e),o=this.getOutput(e);this.userCode=`\n        void main() {\n          ${i} rc = getOutputCoords();\n\n          if(${s}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${o}));\n          }\n        }\n      `}}getSourceCoordsArr(t){const e=[];for(let i=0;i<=1;i++)for(let s=0;s<=1;s++){let r=`${0===i?"r":"rp1"}, ${0===s?"c":"cp1"}`;for(let o=2;o<this.rank;o++)r=`${t[t.length-1-o]},`+r;e.push(r)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let i=this.rank-2;i<this.rank;i++)e+=`${t[i]} >= ${this.enableShapeUniforms?`outShape[${i}]`:this.outputShape[i]}`,i<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2);return`\n      int r = ${e[0]};\n      int c = ${e[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1]};\n      bool rEdge = rp1 >= ${this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2]};\n    `}getOutput(t){const e=this.getSourceCoordsArr(t);return 1===this.rank?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${e[0]}),\n            cEdge ? 0. : getA(${e[1]}),\n            rEdge ? 0. : getA(${e[2]}),\n            rEdge || cEdge ? 0. : getA(${e[3]})`}}class H9{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length);let i="";for(let s=0;s<4;s++){let r="thisRC = rc;";s%2==1&&(r+="thisRC.z += 1;"),s>1&&(r+="thisRC.y += 1;"),i+=`\n        ${r}\n        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${s}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${s>0?"}":""}\n      `}this.userCode=`\n      ${function c$e(n,t){return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${t?function aFe(n,t,e="index"){const s=function oFe(n,t){const e=n.length,i=n.map(r=>`${t}[${r}]`),s=new Array(e-1);s[e-2]=i[e-1];for(let r=e-3;r>=0;--r)s[r]=`(${s[r+1]} * ${i[r+1]})`;return s}(n.map((r,o)=>o),t);return s.map((r,o)=>`int ${n[o]} = ${e} / ${s[o]}; ${o===s.length-1?`int ${n[o+1]} = ${e} - ${n[o]} * ${s[o]}`:`index -= ${n[o]} * ${s[o]}`};`).join("")}(["r","c","d"],"inputShape"):Cd(["r","c","d"],n)}\n      return ivec3(r, c, d);\n    }\n  `}(e,this.enableShapeUniforms)}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":HP(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};\n\n        ${i}\n\n        setOutput(result);\n      }\n    `}}class u$e{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,i){const s=G9(e,i),r=q9(t,s,i);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const o=j9(t,s,this.gpgpu.gl,this.gpgpu.textureConfig,i);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[r].pop();return this.usedTextures[r].push(l),l}let a;return s===ss.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):s===ss.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):s===ss.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):s===ss.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):s===ss.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[r].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(t,e,i,s){if(null==this.freeTextures)return;const r=G9(i,s),o=q9(e,r,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=j9(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=J().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==l&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(t);if(null==u||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${this.numFreeTextures+this.numUsedTextures})`);const e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function j9(n,t,e,i,s){const r=function h$e(n,t){switch(n){case ss.PACKED_2X2_FLOAT32:return $9(t);case ss.PACKED_2X2_FLOAT16:return B9(t);case ss.UNPACKED_FLOAT32:return O9(t);case ss.UNPACKED_FLOAT16:return F9(t);case ss.PACKED_4X1_UNSIGNED_BYTE:return L9(t);default:throw new Error(`Unknown physical texture type ${n}`)}}(t,i);let o;if(s){const[l,c]=Zf(n[0],n[1]);o=l*c}else{const[l,c]=s_(n[0],n[1]);o=l*c}const a=function d$e(n,t){if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===n.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(e,r);return o*a}function G9(n,t){if(n===yr.UPLOAD)return ss.PACKED_2X2_FLOAT32;if(n===yr.RENDER||null==n)return function f$e(n){return J().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?ss.PACKED_2X2_FLOAT32:ss.UNPACKED_FLOAT32:n?ss.PACKED_2X2_FLOAT16:ss.UNPACKED_FLOAT16}(t);if(n===yr.DOWNLOAD||n===yr.PIXELS)return ss.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function q9(n,t,e){return`${n[0]}_${n[1]}_${t}_${e}`}class qa{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const jr="if (isnan(x)) return x;",p$e="return x;",K9="return abs(x);",m$e="return (x >= 0.0) ? x : (exp(x) - 1.0);",g$e=jr+"\n  return (x < 0.0) ? 0.0 : x;\n",b$e=jr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Kc="return x;",_$e="return 1.0 / (1.0 + exp(-1.0 * x));",y$e="return x;",v$e="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",x$e="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",C$e="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",w$e="return 1.0 / (1.0 + exp(-1.0 * x));";class Xc{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class S$e{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length);const e=t.length,i=Vs("rc",e),s=yn(e),r=function a$e(n,t){if(1===n)return"rc";let e="";for(let i=0;i<n;i++)e+=t[i],i<n-1&&(e+=",");return e}(e,i),o=i.slice(-2),a=e<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`\n      void main() {\n        ${s} rc = getOutputCoords();\n        vec4 packedInput = getA(${r});\n\n        setOutput(getChannel(packedInput, ${a}));\n      }\n    `}}const I$e=zG,Bw={},D$e=J().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");let M$e=(()=>{class n extends zD{nextDataId(){return n.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!J().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let i;if(null!=e){if(e instanceof qP)i=e;else{const s=ia(J().getNumber("WEBGL_VERSION"),e);i=new qP(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=ia(J().getNumber("WEBGL_VERSION"));i=new qP(s),this.binaryCache=function T$e(n){return n in Bw||(Bw[n]={}),Bw[n]}(J().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=i,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new u$e(this.gpgpu),this.numMBBeforeWarning=function A$e(){return null==J().global.screen?1024:J().global.screen.height*J().global.screen.width*window.devicePixelRatio*600/1024/1024}(),this.texData=new rH(this,Pa())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,i,s,r,o,a){const l=this.makeTensorInfo(i,s),c=this.texData.get(l.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[r,o]},c.texShape=[r,o];const u=Mw(i),d=new R9(u,!1,a),h=this.runWebGLProgram(d,[l],s,[[r,o]]);return h.shape=i,c.texture=null,this.disposeIntermediateTensorInfo(l),h.dataId}write(e,i,s){if((J().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||J().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===s&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:i,dtype:s,values:e,usage:yr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){this.texData.has(e)&&this.texData.get(e).refCount--}move(e,i,s,r,o){if(J().getBool("DEBUG")&&this.checkNumericalProblems(i),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:i,usage:yr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const i=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:o,slice:a,shape:l,isPacked:c}=i;if(null!=a){let f;f=c?new Xc(l,Kc):new qa(l,Kc);const p=this.runWebGLProgram(f,[{dataId:e,shape:l,dtype:r}],r),g=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),g}if(null!=s)return this.convertAndCacheOnCPU(e);if("string"===r)return s;const u=null!=this.activeTimers;let d,h;return u&&(d=nr()),h="complex64"===r?Pl(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.getValuesFromTexture(e),u&&(this.downloadWaitMs+=nr()-d),this.convertAndCacheOnCPU(e,h)}read(e){var i=this;return Q(function*(){if(i.pendingRead.has(e)){const m=i.pendingRead.get(e);return new Promise(b=>m.push(b))}const s=i.texData.get(e),{values:r,shape:o,slice:a,dtype:l,complexTensorInfos:c,isPacked:u}=s;if(null!=a){let m;m=u?new Xc(o,Kc):new qa(o,Kc);const b=i.runWebGLProgram(m,[{dataId:e,shape:o,dtype:l}],l),_=i.read(b.dataId);return i.disposeIntermediateTensorInfo(b),_}if(null!=r)return i.convertAndCacheOnCPU(e);if(J().getBool("DEBUG")&&!J().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===J().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let h,f,d=null;if("complex64"!==l&&J().get("WEBGL_BUFFER_SUPPORTED")){h=i.decode(e);const m=i.texData.get(h.dataId);d=i.gpgpu.createBufferFromTexture(m.texture.texture,...Dw(o))}if(i.pendingRead.set(e,[]),"complex64"!==l&&(yield i.gpgpu.createAndWaitForFence()),"complex64"===l){const m=yield Promise.all([i.read(c.real.dataId),i.read(c.imag.dataId)]);f=Pl(m[0],m[1])}else if(null==d)f=i.getValuesFromTexture(e);else{const m=te(o);f=i.gpgpu.downloadFloat32MatrixFromBuffer(d,m)}if(null!=h&&i.disposeIntermediateTensorInfo(h),null!=d){const m=i.gpgpu.gl;ke(m,()=>m.deleteBuffer(d))}const p=i.convertAndCacheOnCPU(e,f),g=i.pendingRead.get(e);return i.pendingRead.delete(e),g.forEach(m=>m(p)),i.pendingDisposal.has(e)&&(i.pendingDisposal.delete(e),i.disposeData(e)&&Pa().removeDataId(e,i),i.pendingDeletes--),p})()}readToGPU(e,i={}){const s=this.texData.get(e),{values:r,shape:o,slice:a,dtype:l,isPacked:c,texture:u}=s;if("complex64"===l)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=a){let p;p=c?new Xc(o,Kc):new qa(o,Kc);const g=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:l}],l),m=this.readToGPU(g,i);return this.disposeIntermediateTensorInfo(g),m}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const d=this.decode(e,i.customTexShape),h=Pa().makeTensorFromTensorInfo(d),f=this.texData.get(d.dataId);return Object.assign({tensorRef:h},f.texture)}bufferSync(e){const i=this.readSync(e.dataId);if("string"===e.dtype)try{const s=i.map(r=>Dc(r));return Dt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Dt(e.shape,e.dtype,i)}checkNumericalProblems(e){if(null!=e)for(let i=0;i<e.length;i++){const s=e[i];if(!OOe(s))throw J().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:i,dtype:s,isPacked:r}=this.texData.get(e),o=te(i);if(J().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),p=this.texData.get(f.dataId),g=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...Dw(i)).subarray(0,o);return this.disposeIntermediateTensorInfo(f),g}const a=J().getBool("WEBGL_PACK")&&!0===r,l=a?Mw(i):i,c=a?new YFe(l):new XFe(l),u=this.runWebGLProgram(c,[{shape:l,dtype:s,dataId:e}],"float32"),d=this.texData.get(u.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),h}timerAvailable(){return J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){var i=this;const s=this.activeTimers,r=[];let o=!1;null==this.programTimersStack?(this.programTimersStack=r,o=!0):this.activeTimers.push(r),this.activeTimers=r,e();const a=Ju(this.activeTimers.map(u=>u.query)).filter(u=>null!=u),l=Ju(this.activeTimers.map(u=>u.name)).filter(u=>null!=u);this.activeTimers=s,o&&(this.programTimersStack=null);const c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return Q(function*(){if(J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=yield Promise.all(a);c.kernelMs=function zye(n){let t=0;for(let e=0;e<n.length;e++)t+=n[e];return t}(u),c.getExtraProfileInfo=()=>u.map((d,h)=>({name:l[h],ms:d})).map(d=>`${d.name}: ${d.ms}`).join(", ")}else c.kernelMs={error:"WebGL query timers are not supported in this environment."};return i.uploadWaitMs=0,i.downloadWaitMs=0,c})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:nr(),endMs:null}}endTimer(e){return J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=nr(),e)}getQueryTime(e){var i=this;return Q(function*(){return J().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?i.gpgpu.waitForQueryAndGetTime(e):e.endMs-e.startMs})()}disposeData(e,i=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(i?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!i&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return null!=s&&(this.disposeData(s.real.dataId,i),this.disposeData(s.imag.dataId,i)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:i,dtype:s,texShape:r,usage:o,isPacked:a,slice:l}=this.texData.get(e),c=l&&l.origDataId||e,u=this.dataRefCount.get(c);u>1?this.dataRefCount.set(c,u-1):(this.dataRefCount.delete(c),null!=i&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(i,r,o,a)));const d=this.texData.get(e);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,i=D$e){return J().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>null==this.texData.get(s.dataId).texture&&te(s.shape)<i)}getGPGPUContext(){return this.gpgpu}where(e){Lr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const i=e.dataSync();return I$e(e.shape,i)}packedUnaryOp(e,i,s){const r=new Xc(e.shape,i),o=this.compileAndRun(r,[e],s);return Pa().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const r=z9(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(J().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,K9,e.dtype);const i=new qa(e.shape,K9),s=this.compileAndRun(i,[e]);return Pa().makeTensorFromTensorInfo(s)}makeTensorInfo(e,i,s){let r;if("string"===i&&null!=s&&s.length>0&&wg(s[0])){const o=s.map(a=>Tc(a));r=this.write(o,e,i)}else r=this.write(s,e,i);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:i}}makeOutput(e,i,s){return Pa().makeTensorFromTensorInfo(this.makeTensorInfo(e,i,s),this)}unpackTensor(e){const i=new S$e(e.shape);return this.runWebGLProgram(i,[e],e.dtype)}packTensor(e){const i=new l$e(e.shape);return this.runWebGLProgram(i,[e],e.dtype,null,!0)}packedReshape(e,i){const s=[Qf(e.shape),...Jf(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[Qf(i),...Jf(i)],a=new H9(o,s),u=this.runWebGLProgram(a,[r],e.dtype,[s],!0);return{dataId:u.dataId,shape:i,dtype:u.dtype}}decode(e,i){const s=this.texData.get(e),{isPacked:r,shape:o,dtype:a}=s;null!=i&&T(te(o)<=i[0]*i[1]*4,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.");const l=Mw(o);let c;c=r?new KFe(l):new qFe(l);const d=[i??Dw(l)];return{dtype:a,shape:o,dataId:this.runWebGLProgram(c,[{shape:l,dtype:a,dataId:e}],a,d,!0,i).dataId}}runWebGLProgram(e,i,s,r,o=!1,a){const l=this.makeTensorInfo(e.outputShape,s),c=this.texData.get(l.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===Yf.DENSE){const _=a??Dw(e.outputShape);c.texShape=_.map(y=>2*y)}if(null!=e.outTexUsage&&(c.usage=e.outTexUsage),0===te(l.shape))return c.values=vs(l.dtype,0),l;const u=[],d=i.map(_=>{if("complex64"===_.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(_.dataId);if(null==y.texture){if(!e.packedInputs&&te(_.shape)<=J().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:_.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=_.shape)}if(this.uploadToGPU(_.dataId),!!y.isPacked!=!!e.packedInputs)_=y.isPacked?this.unpackTensor(_):this.packTensor(_),u.push(_),y=this.texData.get(_.dataId);else if(y.isPacked&&!Rw(y.shape,_.shape)){const v=_,x=_.shape;_.shape=y.shape,_=this.packedReshape(_,x),u.push(_),y=this.texData.get(_.dataId),v.shape=x}return{shape:_.shape,texData:y,isUniform:!1}});this.uploadToGPU(l.dataId);const h={shape:l.shape,texData:c,isUniform:!1},f=function GFe(n,t,e){let i="";t.concat(e).forEach(o=>{const a=null!=o.texData&&null!=o.texData.slice&&o.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=GP(n.packedInputs,o.shape,l);let h="",f="",p="";if(1===u.length&&n.packedInputs){const x=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${x[0]>1}_${x[1]>1}`}else if(2!==u.length||n.packedInputs){if(u.length>2&&!n.packedInputs){const x=Ye(u);p=`${x[0]===l[1]}_${x[x.length-1]===l[1]}`}}else f=`${u[0]>1}_${u[1]>1}`;const g=o.shape.length,m=2===u.length&&tn(o.shape,l),b=1===te(o.shape),_=Rf(o.shape,e.shape),y=!n.packedInputs&&g===e.shape.length&&tn(l,e.texData.texShape);i+=`${g}_${y}_${c?d:""}_${u.length}_${b}_${_}_${m}_${h}_${f}_${p}_${n.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`}_${a}`}else i+=`${o.shape}_${o.isUniform?"uniform":o.texData.texShape}_${a}`});let r=n.constructor.name;return r+="_"+i+"_"+n.userCode+`${J().getNumber("WEBGL_VERSION")}`,r}(e,d,h),p=this.getAndSaveBinary(f,()=>function HFe(n,t,e,i){const s=e.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:!u.isUniform&&u.texData.isPacked,flatOffset:null};return null!=u.texData&&null!=u.texData.slice&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:t.variableNames[d],shapeInfo:h}}),r=s.map(u=>u.shapeInfo),o={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},a=lFe(s,o,t),l=function $Oe(n,t){const e=Fl(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ke(n,()=>n.shaderSource(e,t)),ke(n,()=>n.compileShader(e)),J().get("ENGINE_COMPILE_ONLY"))return e;if(!1===n.getShaderParameter(e,n.COMPILE_STATUS))throw w9(t,n.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}(n.gl,a),c=n.createProgram(l);return J().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:r,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(c),Object.assign({program:t,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:r,outShapeInfo:o},M9(n,t,c)))}(this.gpgpu,e,d,h)),g=null!=this.activeTimers;let m;g&&(m=this.startTimer()),J().get("ENGINE_COMPILE_ONLY")||function jFe(n,t,e,i,s){t.program.enableShapeUniforms||(P9(t.inShapeInfos,e),P9([t.outShapeInfo],[i]));const r=i.texData.texture,o=i.texData.texShape;i.texData.isPacked?n.setOutputPackedMatrixTexture(r.texture,o[0],o[1]):n.setOutputMatrixTexture(r.texture,o[0],o[1]),n.setProgram(t.webGLProgram),n.bindVertexArray(t.webGLProgram.vao),1===J().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&n.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&n.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<e.length;++l){const c=e[l],{uniform:u,offset:d,shape:h,texShape:f}=t.variablesLocations[l];if(h){const{uniformShape:p}=GP(t.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:n.gl.uniform1iv(h,new Int32Array(p));break;case 2:n.gl.uniform2iv(h,new Int32Array(p));break;case 3:n.gl.uniform3iv(h,new Int32Array(p));break;case 4:n.gl.uniform4iv(h,new Int32Array(p))}}if(f&&n.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),null!=u){if(c.isUniform){if(te(c.shape)<2)n.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),n.gl.uniform1fv(u,p)}continue}null!=c.texData.slice&&null!=d&&n.gl.uniform1i(d,c.texData.slice.flatOffset),n.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=t.outShapeLocation;if(a)switch(i.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(i.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(i.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(i.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(i.shape))}if(t.outShapeStridesLocation){const l=Ye(i.shape);switch(i.shape.length){case 2:n.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l))}}if(t.outTexShapeLocation&&n.gl.uniform2i(t.outTexShapeLocation,i.texData.texShape[0],i.texData.texShape[1]),t.program.customUniforms&&s)for(let l=0;l<t.program.customUniforms.length;++l){const c=t.program.customUniforms[l],u=t.customUniformLocations[l],d=s[l];if("float"===c.type)n.gl.uniform1fv(u,d);else if("vec2"===c.type)n.gl.uniform2fv(u,d);else if("vec3"===c.type)n.gl.uniform3fv(u,d);else if("vec4"===c.type)n.gl.uniform4fv(u,d);else if("int"===c.type)n.gl.uniform1iv(u,d);else if("ivec2"===c.type)n.gl.uniform2iv(u,d);else if("ivec3"===c.type)n.gl.uniform3iv(u,d);else{if("ivec4"!==c.type)throw Error(`uniform type ${c.type} is not supported yet.`);n.gl.uniform4iv(u,d)}}n.executeProgram()}(this.gpgpu,p,d,h,r),u.forEach(_=>this.disposeIntermediateTensorInfo(_)),g&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const b=J().getNumber("WEBGL_FLUSH_THRESHOLD");if(b>0){const _=nr();_-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=_)}if(!J().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&!1===o){const _=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),_}return l}compileAndRun(e,i,s,r,o=!1){return this.runWebGLProgram(e,i,s=s||i[0].dtype,r,o)}getAndSaveBinary(e,i){return e in this.binaryCache||(this.binaryCache[e]=i()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(J().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(i=>{this.gpgpu.deleteProgram(this.binaryCache[i].webGLProgram),delete this.binaryCache[i]}),this.textureManager.dispose(),null!=this.canvas&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Y(()=>{if(!J().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=J().getBool("DEBUG");J().set("DEBUG",!1);const i=this.abs(ct(1e-8)).dataSync()[0];if(J().set("DEBUG",e),i>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const i=this.texData.get(e),{shape:s,dtype:r,values:o,texture:a,usage:l,isPacked:c}=i;if(null!=a)return;const u=null!=this.activeTimers;let d;u&&(d=nr());let h=i.texShape;if(null==h&&(h=function QOe(n,t=!1){let e=J().getNumber("WEBGL_MAX_TEXTURE_SIZE"),i=J().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");i===1/0&&J().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(i=e/2),t&&(e*=2,i*=2,1===(n=n.map((a,l)=>l>=n.length-2?UD(n[l]):n[l])).length&&(n=[2,n[0]])),2!==n.length&&(n=Ic(n).newShape);let s=te(n),r=null;n.length<=1&&s<=e?r=[1,s]:2===n.length&&n[0]<=e&&n[1]<=e?r=n:3===n.length&&n[0]*n[1]<=e&&n[2]<=e?r=[n[0]*n[1],n[2]]:3===n.length&&n[0]<=e&&n[1]*n[2]<=e?r=[n[0],n[1]*n[2]]:4===n.length&&n[0]*n[1]*n[2]<=e&&n[3]<=e?r=[n[0]*n[1]*n[2],n[3]]:4===n.length&&n[0]<=e&&n[1]*n[2]*n[3]<=e&&(r=[n[0],n[1]*n[2]*n[3]]);const o=null!=r&&Math.max(...r)>i&&Math.min(...r)<=(t?2:1)&&Math.min(...r)>0;if(null==r||o)if(t){const a=Qf(n);let l=2,c=2;n.length&&([l,c]=Jf(n)),s=a*(l/2)*(c/2),r=WD(s).map(u=>2*u)}else r=WD(s);return r}(s,c),i.texShape=h),null!=o){const f=Mw(s);let p,g=h[1],m=h[0];const b=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(c||!b)&&([g,m]=Zf(h[0],h[1])),p=c?new QFe(f,b):new R9(f,b);const _=b?[m,g]:h,y=this.makeTensorInfo(_,r),v=this.texData.get(y.dataId);v.usage=b?yr.PIXELS:yr.UPLOAD,v.texShape=_,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),g,m,o);const E=this.runWebGLProgram(p,[y],r,[[m,g]],!0),k=this.texData.get(E.dataId);i.texShape=k.texShape,i.isPacked=k.isPacked,i.usage=k.usage,J().get("ENGINE_COMPILE_ONLY")?this.disposeData(E.dataId):(i.texture=k.texture,i.values=null,this.texData.delete(E.dataId)),this.disposeIntermediateTensorInfo(y),u&&(this.uploadWaitMs+=nr()-d)}else{const f=this.acquireTexture(h,l,r,c);i.texture=f}}convertAndCacheOnCPU(e,i){const s=this.texData.get(e),{dtype:r}=s;return null!=i&&(s.values=function P$e(n,t){if("float32"===t||"complex64"===t)return n;if("int32"===t||"bool"===t){const e="int32"===t?new Int32Array(n.length):new Uint8Array(n.length);for(let i=0;i<e.length;++i)e[i]=Math.round(n[i]);return e}throw new Error(`Unknown dtype ${t}`)}(i,r)),s.values}acquireTexture(e,i,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,i,r)}computeBytes(e,i){return e[0]*e[1]*lx(i)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}checkCompileCompletionAsync(){var e=this;return Q(function*(){const i=[];if(e.gpgpu.parallelCompilationExtension){for(const[,s]of Object.entries(e.binaryCache))i.push(e.checkCompletionAsync_(s));return Promise.all(i)}for(const[,s]of Object.entries(e.binaryCache)){const r=new Promise(o=>{try{e.checkCompletion_(s),o(!0)}catch(a){throw a}});i.push(r)}return Promise.all(i)})()}checkCompletionAsync_(e){var i=this;return Q(function*(){return i.gpgpu.gl.getProgramParameter(e.webGLProgram,i.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?i.checkCompletion_(e):(yield fG(),i.checkCompletionAsync_(e))})()}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS))throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)?(w9(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:i,customUniformLocations:s,infLoc:r,nanLoc:o,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:c}=M9(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=i,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=o,e.outShapeLocation=a,e.outShapeStridesLocation=l,e.outTexShapeLocation=c}}createTensorFromGPUData(e,i,s){e.channels=e.channels||"RGBA";const{texture:r,height:o,width:a,channels:l}=e,c=Pa().backend;if(!c.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=c.writeTexture(r,i,s,o,a,l);return Pa().makeTensorFromDataId(u,i,s,c)}}return n.nextDataId=0,n})();GH()&&YH("webgl",()=>new M$e,2);const XP="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Sd{constructor(t,e,i){this.variableNames=["A","B"],this.outputShape=ft(e,i),this.enableShapeUniforms=Is(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const Id="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class sp{constructor(t,e,i,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ft(e,i);const r=this.outputShape.length;this.enableShapeUniforms=Is(r);let o="";if(s)if(0===r||1===te(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o=`\n          ${yn(r)} coords = getOutputCoords();\n        `,1===r)o+=this.enableShapeUniforms?"\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const l=Vs("coords",r);o+=this.enableShapeUniforms?`\n            bool nextRowOutOfBounds =\n              (${l[r-2]} + 1) >= outShape[${r} - 2];\n            bool nextColOutOfBounds =\n              (${l[r-1]} + 1) >= outShape[${r} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:`\n            bool nextRowOutOfBounds =\n              (${l[r-2]} + 1) >= ${this.outputShape[r-2]};\n            bool nextColOutOfBounds =\n              (${l[r-1]} + 1) >= ${this.outputShape[r-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}function vr(n){const{inputs:t,backend:e}=n,{x:i}=t;return e.incRef(i.dataId),{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}const F$e={kernelName:Hg,backendName:"webgl",kernelFunc:vr};function Yc(n){const{inputs:t,backend:e}=n,{real:i,imag:s}=t,r=e.makeTensorInfo(i.shape,"complex64"),o=e.texData.get(r.dataId),a=vr({inputs:{x:i},backend:e}),l=vr({inputs:{x:s},backend:e});return o.complexTensorInfos={real:a,imag:l},r}const L$e={kernelName:sN,backendName:"webgl",kernelFunc:Yc},X9="return (a < 0.) ? b * a : a;",Y9="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",B$e={kernelName:Dx,backendName:"webgl",kernelFunc:function $$e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{alpha:r}=i,o=e.makeTensorInfo([],"float32",kc(r,"float32")),a=J().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sp(Y9,s.shape,o.shape):new Sd(X9,s.shape,o.shape),l=e.runWebGLProgram(a,[s,o],"float32");return e.disposeIntermediateTensorInfo(o),l}},Z9="return (a < 0.) ? b * a : a;",Q9="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",z$e={kernelName:Kx,backendName:"webgl",kernelFunc:function V$e(n){const{inputs:t,backend:e}=n,{x:i,alpha:s}=t,r=J().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sp(Q9,i.shape,s.shape):new Sd(Z9,i.shape,s.shape);return e.runWebGLProgram(r,[i,s],"float32")}},rp="if (isnan(x)) return x;";function Gt({opSnippet:n,packedOpSnippet:t,cpuKernelImpl:e,dtype:i}){return({inputs:s,backend:r})=>{const{x:o}=s,a=r,l=i||o.dtype;if(a.shouldExecuteOnCPU([o])&&null!=e){const d=a.texData.get(o.dataId),h=e(d.values,l);return a.makeTensorInfo(o.shape,l,h)}let u;return u=J().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new Xc(o.shape,t):new qa(o.shape,n),a.runWebGLProgram(u,[o],l)}}function ps({opSnippet:n,packedOpSnippet:t,checkOutOfBounds:e=!1,supportsComplex:i=!1,cpuKernelImpl:s,dtype:r}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(i&&"complex64"===l.dtype){const p=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[m,b]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(y=>{const[v,x]=y,S={dataId:v.dataId,dtype:v.dtype,shape:l.shape},E={dataId:x.dataId,dtype:x.dtype,shape:c.shape},k=new Sd(n,l.shape,c.shape);return u.runWebGLProgram(k,[S,E],br(v.dtype,x.dtype))}),_=Yc({inputs:{real:m,imag:b},backend:u});return u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(b),_}const d=r||br(l.dtype,c.dtype);if(("string"===l.dtype||"string"===c.dtype||u.shouldExecuteOnCPU([l,c]))&&null!=s){const p=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,m="string"===l.dtype?Rl(p):p,b="string"===l.dtype?Rl(g):g,[_,y]=s(l.shape,c.shape,m,b,d),v=u.makeTensorInfo(y,d);return u.texData.get(v.dataId).values=_,v}let f;return f=J().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new sp(t,l.shape,c.shape,e):new Sd(n,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function a_(n,t=!1){if("linear"===n)return t?y$e:p$e;if("relu"===n)return t?x$e:g$e;if("elu"===n)return t?v$e:m$e;if("relu6"===n)return t?C$e:b$e;if("prelu"===n)return t?Q9:Z9;if("leakyrelu"===n)return t?Y9:X9;if("sigmoid"===n)return t?w$e:_$e;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}class J9{constructor(t,e,i,s=!1,r=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i,this.enableShapeUniforms=Is(this.outputShape.length);const d=Math.ceil((s?t[1]:t[2])/2),h=s?"i * 2, rc.y":"rc.y, i * 2",f=r?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",b="";a&&(m=l?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${a}\n        }`:c?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${a}\n        }`:`vec4 activation(vec4 x) {\n          ${a}\n        }`,b="result = activation(result);");const _=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let y="rc.x",v="rc.x";t[0]<e[0]?y=`imod(rc.x, ${t[0]})`:e[0]<t[0]&&(v=`imod(rc.x, ${e[0]})`),this.userCode=`\n      ${m}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${d}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${y};\n        int batchB = ${v};\n        for (int i = 0; i < ${d}; i++) {\n          vec4 a = getMatrixA(batchA, ${h});\n          vec4 b = getMatrixB(batchB, ${f});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${p[0]} * ${g[0]});\n          result += (${p[1]} * ${g[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${_}\n\n        ${b}\n\n        setOutput(result);\n      }\n    `}}const eq={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class tq{constructor(t,e,i){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ft(e,i),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const nq="return a * b;";function YP(n){const{inputs:t,backend:e}=n,{a:i,b:s}=t,r=br(i.dtype,s.dtype);if("complex64"===i.dtype){const a=e.texData.get(i.dataId),l=e.texData.get(s.dataId),c=new tq(eq.REAL,i.shape,s.shape),u=new tq(eq.IMAG,i.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:i.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:i.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],h=e.runWebGLProgram(c,d,"float32"),f=e.runWebGLProgram(u,d,"float32"),p=Yc({inputs:{real:h,imag:f},backend:e});return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(f),p}if(e.shouldExecuteOnCPU([i,s])){const a=e.texData.get(i.dataId),l=e.texData.get(s.dataId),[c,u]=LLe(i.shape,s.shape,a.values,l.values,r),d=e.makeTensorInfo(u,r);return e.texData.get(d.dataId).values=c,d}let o;return o=J().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sp(nq,i.shape,s.shape):new Sd(nq,i.shape,s.shape),e.runWebGLProgram(o,[i,s],r)}const U$e={kernelName:Jg,backendName:"webgl",kernelFunc:YP};function Se(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{shape:r}=i,o=e,a=te(s.shape),l=cH(r,a),c=te(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(s.dataId);return!u.isPacked||Rw(s.shape,l)||null!==u.texture&&Rw(u.shape,l)?(o.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype}):function W$e(n,t,e){const i=[Qf(n.shape),...Jf(n.shape)],s={dtype:n.dtype,shape:i,dataId:n.dataId},r=[Qf(t),...Jf(t)],o=new H9(r,i),c=e.runWebGLProgram(o,[s],n.dtype,[i],!0);return{dataId:c.dataId,shape:t,dtype:c.dtype}}(s,l,o)}const H$e={kernelName:Yx,backendName:"webgl",kernelFunc:Se};class iq{constructor(t,e){this.variableNames=["x"];const{windowSize:i,batchSize:s,inSize:r,outSize:o}=t;this.outputShape=[s,o];const a=4*Math.floor(i/4),l=i%4;let c="sumValue += dot(values, ones);";if(null!=e){const d=1/e;c=`sumValue += dot(values * ${xf(d)?d.toPrecision(2):d}, ones);`}let u="";r%i>0&&(u=`\n        if (inIdx < 0 || inIdx >= ${r}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${u}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${i};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${a}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${c}\n        }\n\n        int inIdx = inOffset + ${a};\n        if (${1===l}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${c}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${c}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${c}\n        }\n        setOutput(sumValue);\n      }\n    `}}class j$e{constructor(t,e){this.variableNames=["x"];const{windowSize:i,batchSize:s,inSize:r,outSize:o}=t;this.outputShape=[s,o];let a="0.0",l="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",l="min"):"max"===e&&(a="-1.0 / 1e-20",l="max");let c=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?c="sumValue":"prod"===e?c="prodValue":"all"===e?c="allValue":"any"===e&&(c="anyValue");const u=4*Math.floor(i/4),d=i%4;let h=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${l}(values, minMaxValue);\n        if (${"min"===e} || ${"max"===e}) {\n          minMaxValue = ${l}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,f="vec4";"all"===e?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===e&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");let p="";r%i>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${r}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${a};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${i};\n\n        vec4 minMaxValue = vec4(${a});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===d}) {\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${2===d}) {\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${3===d}) {\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${h}\n        }\n        setOutput(${c});\n      }\n    `}}function Ed(n,t,e,i){const s=function G$e(n){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const e=t.length?t[t.length-1].outSize:n[1],i=WC(e);t.push({inSize:e,windowSize:i,outSize:Math.ceil(e/i)})}return t}(n.shape);let r=n;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:l,outSize:c}=s[o];let u,d;u="mean"===e?0===o?new iq({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:c},a):new iq({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:c}):new j$e({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:c},e),d=r,r=i.runWebGLProgram(u,[r],t),d.dataId!==n.dataId&&i.disposeIntermediateTensorInfo(d)}return r}class q$e{constructor(t,e){this.variableNames=["A"];const i=new Array(t.length);for(let o=0;o<i.length;o++)i[o]=t[e[o]];this.outputShape=i,this.rank=i.length;const s=yn(this.rank),r=function K$e(n){const t=n.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],i=new Array(t);for(let s=0;s<n.length;s++)i[n[s]]=e[s];return i.join()}(e);this.userCode=`\n    void main() {\n      ${s} resRC = getOutputCoords();\n      setOutput(getA(${r}));\n    }\n    `}}class X$e{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const i=new Array(t.length);for(let u=0;u<i.length;u++)i[u]=t[e[u]];if(this.outputShape=i,this.rank=i.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=yn(this.rank),r=W9("rc",this.rank),o=new Array(this.rank);for(let u=0;u<e.length;u++)o[e[u]]=r[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${r[this.rank-1]} < ${i[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`\n    void main() {\n      ${s} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${c};\n      if(${l}) {\n        result[1] = ${c};\n      }\n      --${r[this.rank-1]};\n      if(++${r[this.rank-2]} < ${i[this.rank-2]}) {\n        result[2] = ${c};\n        if(${l}) {\n          result[3] = ${c};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function Vw(n,t,e){const i=J().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new X$e(n.shape,t):new q$e(n.shape,t);return e.runWebGLProgram(i,[n],n.dtype)}function zw(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i;return function Y$e(n,t,e,i){const r=n.shape.length,o=Tt(t,n.shape);let a=o;const l=ti(a,r),c=null!=l;let u=n;c&&(u=Vw(n,l,i),a=xi(a.length,r)),fs("sum",a,r);const[d,h]=ts(u.shape,a);let f=d;e&&(f=vi(d,o));const p=te(h),b=Se({inputs:{x:u},attrs:{shape:[te(n.shape)/p,p]},backend:i}),y=Ed(b,ZN(n.dtype),"sum",i),v=Se({inputs:{x:y},attrs:{shape:f},backend:i});return i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(y),c&&i.disposeIntermediateTensorInfo(u),v}(s,r,o,e)}const Z$e={kernelName:nC,backendName:"webgl",kernelFunc:zw};function zs(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{perm:r}=i,o=e,l=new Array(s.shape.length);for(let u=0;u<l.length;u++)l[u]=s.shape[r[u]];let c;if(o.shouldExecuteOnCPU([s])){const d=o.texData.get(s.dataId).values,h=KP(d,s.shape,s.dtype,r,l);c=o.makeTensorInfo(l,s.dtype),o.texData.get(c.dataId).values=h}else c=Vw(s,r,o);return c}const Q$e={kernelName:Ef,backendName:"webgl",kernelFunc:zs},sq=1e3;function Uw({a:n,b:t,transposeA:e,transposeB:i,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=n.shape.length,u=t.shape.length,d=e?n.shape[c-2]:n.shape[c-1],h=i?t.shape[u-1]:t.shape[u-2],f=e?n.shape[c-1]:n.shape[c-2],p=i?t.shape[u-2]:t.shape[u-1],g=n.shape.slice(0,-2),m=t.shape.slice(0,-2),b=te(g),_=te(m),v=ft(n.shape.slice(0,-2),t.shape.slice(0,-2)).concat([f,p]);T(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${n.shape} and ${t.shape} and transposeA=${e} and transposeB=${i} must match.`);const x=e?[b,d,f]:[b,f,d],S=i?[_,p,h]:[_,h,p],E=Se({inputs:{x:n},backend:s,attrs:{shape:x}}),k=Se({inputs:{x:t},backend:s,attrs:{shape:S}}),D=[E,k],M=Math.max(b,_),R=e?E.shape[1]:E.shape[2],U=null!=r,X=null!=o,ee="leakyrelu"===l,K=null!=l?a_(l,!0):null;let z;if((1===f||1===p)&&R>sq&&!1===(U||X||ee||null!=K)){let q=E,se=k;e&&(q=zs({inputs:{x:E},backend:s,attrs:{perm:[0,2,1]}}),D.push(q)),i&&(se=zs({inputs:{x:k},backend:s,attrs:{perm:[0,2,1]}}),D.push(se));const he=1===p;let ue=q;1!==p&&(ue=Se({inputs:{x:q},backend:s,attrs:{shape:[M,R,1]}}),D.push(ue));const de=1===p?2:1;let ve=se;he&&(ve=Se({inputs:{x:se},backend:s,attrs:{shape:[M,1,R]}}),D.push(ve));const Ee=YP({inputs:{a:ue,b:ve},backend:s});z=zw({inputs:{x:Ee},backend:s,attrs:{axis:de,keepDims:!0}}),D.push(Ee)}else{const q=br(n.dtype,t.dtype),se=new J9(x,S,[M,f,p],e,i,U,K,X,ee),le=[E,k];if(null!=r&&le.push(r),X&&le.push(o),ee){const he=s.makeTensorInfo([],"float32",kc(a,"float32"));le.push(he),D.push(he)}z=s.runWebGLProgram(se,le,q)}const B=Se({inputs:{x:z},backend:s,attrs:{shape:v}});D.push(z);for(const q of D)s.disposeIntermediateTensorInfo(q);return B}const eBe={kernelName:uC,backendName:"webgl",kernelFunc:function J$e(n){const{inputs:t,backend:e,attrs:i}=n,{a:s,b:r,bias:o,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=i;return Uw({a:s,b:r,transposeA:l,transposeB:c,backend:e,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}},rq="return abs(x);",nBe={kernelName:cx,backendName:"webgl",kernelFunc:function tBe(n){const{inputs:t,backend:e}=n,{x:i}=t;if(e.shouldExecuteOnCPU([i])&&"complex64"!==i.dtype){const r=e.texData.get(i.dataId),o=z9(r.values);return e.makeTensorInfo(i.shape,i.dtype,o)}let s;return s=J().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Xc(i.shape,rq):new qa(i.shape,rq),e.runWebGLProgram(s,[i],i.dtype)}},sBe=Gt({opSnippet:jr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),rBe={kernelName:Sg,backendName:"webgl",kernelFunc:sBe},aBe=Gt({opSnippet:jr+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),lBe={kernelName:Ig,backendName:"webgl",kernelFunc:aBe},oq="return a + b;",cBe=ps({opSnippet:oq,packedOpSnippet:oq,supportsComplex:!0,cpuKernelImpl:gLe}),uBe={kernelName:If,backendName:"webgl",kernelFunc:cBe};class dBe{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((r,o)=>`T${o}`);const i=[];this.variableNames.forEach(r=>{i.push(`float v${r} = get${r}AtOutCoords();`)});const s=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`\n      void main() {\n        ${i.join("\n        ")}\n\n        float result = ${s};\n        setOutput(result);\n      }\n    `}}class hBe{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((r,o)=>`T${o}`);const i=[];this.variableNames.forEach(r=>{i.push(`vec4 v${r} = get${r}AtOutCoords();`)});const s=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`\n      void main() {\n        ${i.join("\n        ")}\n\n        vec4 result = ${s};\n        setOutput(result);\n      }\n    `}}const fBe={kernelName:ZD,backendName:"webgl",kernelFunc:function Ww(n){const{inputs:t,backend:e}=n,i=t;if(1===i.length)return vr({inputs:{x:i[0]},backend:e});if(i.length>J().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(i.length/2),c=Ww({inputs:i.slice(0,l),backend:e}),u=Ww({inputs:i.slice(l),backend:e});return Ww({inputs:[c,u],backend:e})}const s=i.map(l=>l.dtype).reduce((l,c)=>br(l,c)),r=i.map(l=>l.shape),a=J().getBool("WEBGL_PACK")?new hBe(i[0].shape,r):new dBe(i[0].shape,r);return e.runWebGLProgram(a,i,s)}},mBe={kernelName:"All",backendName:"webgl",kernelFunc:function pBe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i,a=s.shape.length,l=Tt(r,s.shape);let c=l;const u=ti(c,a);let d=s;null!=u&&(d=zs({inputs:{x:s},backend:e,attrs:{perm:u}}),c=xi(c.length,a)),fs("all",c,a);const[h,f]=ts(d.shape,c),g=Se({inputs:{x:d},backend:e,attrs:{shape:[-1,te(f)]}}),m=Ed(g,g.dtype,"all",e);let b;return b=Se(o?{inputs:{x:m},backend:e,attrs:{shape:vi(h,l)}}:{inputs:{x:m},backend:e,attrs:{shape:h}}),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(m),null!=u&&e.disposeIntermediateTensorInfo(d),b}},bBe={kernelName:"Any",backendName:"webgl",kernelFunc:function gBe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i,a=s.shape.length,l=Tt(r,s.shape);let c=l;const u=ti(c,a);let d=s;null!=u&&(d=zs({inputs:{x:s},backend:e,attrs:{perm:u}}),c=xi(c.length,a)),fs("any",c,a);const[h,f]=ts(d.shape,c),g=Se({inputs:{x:d},backend:e,attrs:{shape:[-1,te(f)]}}),m=Ed(g,g.dtype,"any",e);let b;return b=Se(o?{inputs:{x:m},backend:e,attrs:{shape:vi(h,l)}}:{inputs:{x:m},backend:e,attrs:{shape:h}}),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(m),null!=u&&e.disposeIntermediateTensorInfo(d),b}};class _Be{constructor(t,e,i){this.variableNames=["A"];const{windowSize:s,batchSize:r,outSize:o}=t;i||this.variableNames.push("bestIndicesA"),this.outputShape=[r,o],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${s};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${s}; i++) {\n          int inIdx = ${i?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${"max"===e?">":"<"} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class yBe{constructor(t,e,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(t.length>2,()=>`Packed arg${i.charAt(0).toUpperCase()+i.slice(1)} supports only inputs with rank above 2.`);const o=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=yn(l),u=Vs("coords",l);let d,h;if(1===o){h=l+1;const k=yn(h);d=`\n        ${k} sourceLocR = ${k}(${u.join()}, 0);\n        ++${u[l-1]};\n        ${k} sourceLocG = ${k}(${u.join()}, 0);\n        ++${u[l-2]};\n        ${k} sourceLocA = ${k}(${u.join()}, 0);\n        --${u[l-1]};\n        ${k} sourceLocB = ${k}(${u.join()}, 0);\n        --${u[l-2]};`}else h=l,d=`\n        ${c} sourceLocR = coords;\n        ++${u[l-1]};\n        ${c} sourceLocG = coords;\n        ++${u[l-2]};\n        ${c} sourceLocA = coords;\n        --${u[l-1]};\n        ${c} sourceLocB = coords;\n        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],g=f.map(k=>"int "+k),m=Vs("sourceLocR",h-1).concat("inIdx.r"),b=Vs("sourceLocG",h-1).concat("inIdx.g"),_=Vs("sourceLocB",h-1).concat("inIdx.b"),y=Vs("sourceLocA",h-1).concat("inIdx.a"),v="max"===i?"greaterThan":"lessThan",x=s?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${b.join()}),\n                             getBestIndicesAChannel(${_.join()}),\n                             getBestIndicesAChannel(${y.join()})));`,S=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${b.join()}) : 0.,\n            hasNextRow ? getAChannel(${_.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${y.join()}) : 0.)`,E=s?"":`\n      float getBestIndicesAChannel(${g.join()}) {\n        return getChannel(getBestIndicesA(${f.join()}),\n                                          vec2(${f.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${g.join()}) {\n        return getChannel(getA(${f.join()}),\n                               vec2(${f.slice(-2).join()}));\n      }\n      ${E}\n      void main() {\n        ${c} coords = getOutputCoords();\n        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};\n        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};\n        ${d}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${S};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${S};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function aq(n,t,e,i=null){let s=t.shape[0],r=t.shape[1];null!=i&&(s=i.shape[0],r=i.shape[1]);const o=WC(r),a={windowSize:o,inSize:r,batchSize:s,outSize:Math.ceil(r/o)},l=new _Be(a,e,null==i),c=[t];null!=i&&c.push(i);const u=n.runWebGLProgram(l,c,"int32");if(1===u.shape[1])return u;const d=aq(n,t,e,u);return n.disposeIntermediateTensorInfo(u),d}function lq(n,t,e,i=null){const s=null!=i?i.shape:t.shape,o=WC(s[s.length-1]),a=new yBe(s,o,e,null==i),c=n.runWebGLProgram(a,null==i?[t]:[t,i],"int32");if(c.shape.length===t.shape.length){const u=lq(n,t,e,c);return n.disposeIntermediateTensorInfo(c),u}return c}function cq(n,t,e,i){const s=[e];if(fs("arg"+i.charAt(0).toUpperCase()+i.slice(1),s,t.shape.length),!J().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const r=[],o=n.texData.get(t.dataId);let l=t;null!==o&&o.isPacked&&(l=n.unpackTensor(t),r.push(l));const[c,u]=ts(l.shape,s),d=te(u),h=Se({inputs:{x:l},backend:n,attrs:{shape:[-1,d]}});r.push(h);const f=aq(n,h,i);r.push(f);const p=Se({inputs:{x:f},backend:n,attrs:{shape:c}});return r.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}return lq(n,t,i)}const xBe={kernelName:ux,backendName:"webgl",kernelFunc:function vBe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r}=i;let o=Tt(r,s.shape);const a=ti(o,s.shape.length);let l=s;const c=[];null!=a&&(l=zs({inputs:{x:s},backend:e,attrs:{perm:a}}),c.push(l),o=xi(o.length,l.shape.length)),fs("argMax",[o[0]],l.shape.length);const u=cq(e,l,o[0],"max");return c.forEach(d=>e.disposeIntermediateTensorInfo(d)),u}},wBe={kernelName:dx,backendName:"webgl",kernelFunc:function CBe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r}=i;let o=Tt(r,s.shape);const a=ti(o,s.shape.length);let l=s;const c=[];null!=a&&(l=zs({inputs:{x:s},backend:e,attrs:{perm:a}}),c.push(l),o=xi(o.length,l.shape.length)),fs("argMin",[o[0]],l.shape.length);const u=cq(e,l,o[0],"min");return c.forEach(d=>e.disposeIntermediateTensorInfo(d)),u}},IBe=Gt({opSnippet:jr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),EBe={kernelName:Eg,backendName:"webgl",kernelFunc:IBe},TBe=Gt({opSnippet:jr+"return log(x + sqrt(x * x + 1.0));"}),DBe={kernelName:kg,backendName:"webgl",kernelFunc:TBe},ABe=Gt({opSnippet:jr+"\n  return atan(x);\n"}),MBe={kernelName:Tg,backendName:"webgl",kernelFunc:ABe},OBe=ps({opSnippet:XP+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Id+"\n  return result;\n"}),FBe={kernelName:Ng,backendName:"webgl",kernelFunc:OBe},$Be=Gt({opSnippet:jr+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),BBe={kernelName:Dg,backendName:"webgl",kernelFunc:$Be};class l_{constructor(t,e,i,s=!1,r=!1){if(this.variableNames=["x"],"avg"===e&&i)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,u=t.dilationWidth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const g="avg"===e;let _="0.0";if(g||(_="-1.0 / 1e-20"),i)return void(this.userCode=`\n        const ivec2 strides = ivec2(${a}, ${l});\n        const ivec2 pads = ivec2(${f}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${d};\n              wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${s?r?`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`:`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`:`wR * ${h} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let v=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(v="avgValue / max(count, 1.0)");const x=4*Math.floor(o/4),S=o%4,E=`\n      if (${g}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${a}, ${l});\n      const ivec2 pads = ivec2(${f}, ${p});\n      const float initializationValue = ${_};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${_});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${d};\n            wR += ${c}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${x}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${E}\n          }\n\n          int xC = xCCorner + ${x};\n          if (${1===S}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${E}\n          } else if (${2===S}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${E}\n          } else if (${3===S}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${E}\n          }\n        }\n        setOutput(${v});\n      }\n    `}}class ZP{constructor(t,e,i,s=!1,r=!1){if(this.variableNames=["x"],"avg"===e&&i)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideDepth,l=t.strideHeight,c=t.strideWidth,u=t.dilationDepth,d=t.dilationHeight,h=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.front,b=t.padInfo.top,_=t.padInfo.left;this.outputShape=t.outShape;const y="avg"===e;let v="0.0";if(y||(v="-1.0 / 1e-20"),i)return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${a}, ${l}, ${c});\n        const ivec3 pads = ivec3(${m}, ${b}, ${_});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${f};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${d}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${g};\n                  wC += ${h}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${s?r?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${g} +\n                      wR * ${g} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let S=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(S="avgValue / max(count, 1.0)");const E=4*Math.floor(o/4),k=o%4,D=`\n      if (${y}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${a}, ${l}, ${c});\n      const ivec3 pads = ivec3(${m}, ${b}, ${_});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${f};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${d}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${E}; wC += 4) {\n              int xC = xCCorner + wC * ${h};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${h}, ch)\n              );\n\n              ${D}\n            }\n\n            int xC = xCCorner + ${E};\n            if (${1===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${D}\n            } else if (${2===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${D}\n            } else if (${3===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                initializationValue\n              );\n\n              ${D}\n            }\n          }\n        }\n        setOutput(${S});\n      }\n    `}}const zBe={kernelName:hx,backendName:"webgl",kernelFunc:function VBe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t;r_(s,"avgPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=i;T(hs(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const u=bo(s.shape,r,o,1,a,l);if(1===u.filterWidth&&1===u.filterHeight&&tn(u.inShape,u.outShape))return vr({inputs:{x:s},backend:e});const d=new l_(u,"avg",!1);return e.runWebGLProgram(d,[s],"float32")}},WBe={kernelName:fx,backendName:"webgl",kernelFunc:function UBe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{filterSize:r,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=i,d=Il(s.shape,r,o,[1,1,1],a,l,c),h=new ZP(d,"avg",!1);return e.runWebGLProgram(h,[s],"float32")}};class HBe{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const l=t.effectiveFilterHeight,c=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${l-1-t.padInfo.top}, ${c-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${l};\n            wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${c};\n            wC+= ${t.dilationWidth}) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class jBe{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const d=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${d-1-t.padInfo.front}, ${h-1-t.padInfo.top}, ${f-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterDepth*t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${h};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${f};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const qBe={kernelName:tN,backendName:"webgl",kernelFunc:function GBe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r}=t,o=r,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=i,h=Il(o.shape,a,l,[1,1,1],c,u),f=new jBe(h);return e.runWebGLProgram(f,[s],o.dtype)}},XBe={kernelName:eN,backendName:"webgl",kernelFunc:function KBe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r}=t,o=r;r_([s,r],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=i,u=bo(o.shape,a,l,1,c),d=new HBe(u);return e.runWebGLProgram(d,[s],o.dtype)}},ZBe={kernelName:px,backendName:"webgl",kernelFunc:function YBe(n){const{inputs:t,backend:e,attrs:i}=n,{a:s,b:r}=t,{transposeA:o,transposeB:a}=i;return Uw({a:s,b:r,transposeA:o,transposeB:a,backend:e})}};class QBe{constructor(t,e,i,s,r,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ft(t,e),ft(t,i);let a="0.0";null!=s&&(ft(t,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";null!=r&&(ft(t,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${a};\n        float scale = ${l};\n        float inv = scale * inversesqrt(variance + float(${o}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class JBe{constructor(t,e,i,s,r,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ft(t,e),ft(t,i);let a="vec4(0.0)";null!=s&&(ft(t,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";null!=r&&(ft(t,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${a};\n        vec4 scale = ${l};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${o}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const e3e={kernelName:Ex,backendName:"webgl",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:i,mean:s,variance:r,offset:o,scale:a}=n;T(s.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(null==o||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(null==a||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=e;null==l&&(l=.001);const c=[i,s,r];let u=null;null!=o&&(u=o.shape,c.push(o));let d=null;null!=a&&(d=a.shape,c.push(a));const h=J().getBool("WEBGL_PACK_NORMALIZATION")?new JBe(i.shape,s.shape,r.shape,u,d,l):new QBe(i.shape,s.shape,r.shape,u,d,l);return t.runWebGLProgram(h,c,c[0].dtype)}};class t3e{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=yn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const i=function n3e(n){if(1===n)return"sourceLoc";if(n<=6)return QP.slice(0,n).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}(this.rank);let s;s=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((o,a)=>`sourceLoc.${QP[a]} = start[${a}] + coords.${QP[a]};`).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${s}\n        setOutput(getSource(${i}));\n      }\n    `}}const QP=["x","y","z","w","u","v"];class i3e{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=yn(this.rank),i=Vs("coords",this.rank),s=Vs("sourceLoc",this.rank),r=1===this.rank?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${r})`,a=`\n      result.x = ${o};\n      if (++${i[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${s[this.rank-1]};\n        result.y = ${o};\n        --${s[this.rank-1]};\n      }\n    `,l=1===this.rank?"":`\n      --${i[this.rank-1]};\n      if (++${i[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${s[this.rank-2]};\n        result.z = ${o};\n        if (++${i[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${s[this.rank-1]};\n          result.w = ${o};\n        }\n      }\n    `,c=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((u,d)=>`start[${d}]`).join()});`:t.map((u,d)=>`${s[d]} = ${i[d]} + start[${d}];`).join("\n");this.userCode=`\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${c}\n        vec4 result = vec4(0.);\n        ${a}\n        ${l}\n        setOutput(result);\n      }\n    `}}function op(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{begin:r,size:o}=i,[a,l]=kC(s,r,o);if(wA(s,a,l),0===te(l))return e.makeTensorInfo(l,s.dtype,[]);if(e.shouldExecuteOnCPU([s])||"string"===s.dtype){const d=e.texData.get(s.dataId),h=KLe(d.values,a,l,s.shape,s.dtype);return e.makeTensorInfo(l,s.dtype,h)}const{isPacked:c}=e.texData.get(s.dataId),u=IA(s.shape,a,l);if(c||!u){const d=J().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new i3e(l):new t3e(l);return e.runWebGLProgram(d,[s],s.dtype,[a])}return e.uploadToGPU(s.dataId),function s3e(n,t,e,i){const s=i.texData.get(n.dataId),r=i.makeTensorInfo(e,n.dtype),o=i.texData.get(r.dataId);Object.assign(o,s),o.refCount=1,o.shape=e,o.dtype=n.dtype;let a=EA(t,Ye(n.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||n.dataId};const l=i.dataRefCount.get(o.slice.origDataId)||1;return i.dataRefCount.set(o.slice.origDataId,l+1),r}(s,a,l,e)}const r3e={kernelName:tC,backendName:"webgl",kernelFunc:op},o3e={kernelName:mx,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{blockShape:r,crops:o}=i;T(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((_,y)=>_*y),l=$b(s.shape,r,a),c=Bb(l.length,r.length),u=Vb(s.shape,r,a),d=lM(o,r.length),h=cM(u,o,r.length),f=[],p=Se({inputs:{x:s},backend:e,attrs:{shape:l}}),g=zs({inputs:{x:p},backend:e,attrs:{perm:c}}),m=Se({inputs:{x:g},backend:e,attrs:{shape:u}}),b=op({inputs:{x:m},backend:e,attrs:{begin:d,size:h}});return f.push(p),f.push(g),f.push(m),f.forEach(_=>e.disposeIntermediateTensorInfo(_)),b}},l3e={kernelName:nN,backendName:"webgl",kernelFunc:function a3e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,weights:r}=t,{size:o}=i,a=e.readSync(s.dataId),l=e.readSync(r.dataId),c=V9(a,l,r.dtype,r.shape,o);return e.makeTensorInfo([o],r.dtype,c)}},h3e={kernelName:iN,backendName:"webgl",kernelFunc:function d3e(n){const{inputs:t,backend:e}=n,{a:i,b:s}=t,r=J().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=J().getNumber("WEBGL_VERSION");if(e.shouldExecuteOnCPU([i,s])||1===o){const l=e.texData.get(i.dataId).values,c=e.texData.get(s.dataId).values,[u,d]=_Le(i.shape,s.shape,l,c,i.dtype),h=e.makeTensorInfo(d,i.dtype);return e.texData.get(h.dataId).values=u,h}let a;return a=r?new sp("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",i.shape,s.shape,!1):new Sd("\n  return float(int(a.r) & int(b.r));\n",i.shape,s.shape),e.runWebGLProgram(a,[i,s],i.dtype)}},p3e={kernelName:gH,backendName:"webgl",kernelFunc:function f3e(n){const{inputs:t,backend:e}=n,{s0:i,s1:s}=t,r=e.readSync(i.dataId),o=e.readSync(s.dataId),a=ft(Array.from(r),Array.from(o));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}},uq=ps({opSnippet:"return float(a != b);",cpuKernelImpl:BLe,dtype:"bool"}),m3e={kernelName:Wx,backendName:"webgl",kernelFunc:uq};function c_(n){const{inputs:t,backend:e}=n,{input:i}=t;return vr({inputs:{x:e.texData.get(i.dataId).complexTensorInfos.real},backend:e})}const g3e={kernelName:NN,backendName:"webgl",kernelFunc:c_},y3e={kernelName:Ag,backendName:"webgl",kernelFunc:function JP(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{dtype:r}=i;if("complex64"===r){if("complex64"===s.dtype)return vr({inputs:{x:s},backend:e});const o=ns(s.shape),a=JP({inputs:{x:s},backend:e,attrs:{dtype:"float32"}}),l=Yc({inputs:{real:a,imag:o},backend:e});return o.dispose(),e.disposeIntermediateTensorInfo(a),l}if("complex64"===s.dtype){const o=c_({inputs:{input:s},backend:e}),a=JP({inputs:{x:o},backend:e,attrs:{dtype:r}});return e.disposeIntermediateTensorInfo(o),a}if(!uH(s.dtype,r)){const o=vr({inputs:{x:s},backend:e});return{dataId:o.dataId,shape:o.shape,dtype:r}}if(e.shouldExecuteOnCPU([s])){const o=e.texData.get(s.dataId).values,[a,l,c]=yLe(o,s.shape,s.dtype,r);return e.makeTensorInfo(a,l,c)}if("int32"===r)return function _3e(n,t){const e=new qa(n.shape,"return float(int(x));"),i=t.runWebGLProgram(e,[n],"int32");return{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}(s,e);if("bool"===r){const o=e.makeTensorInfo([],"bool",vs("bool",1)),l=uq({inputs:{a:s,b:o},backend:e});return e.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${r}`)}},dq="return ceil(x);",v3e=Gt({opSnippet:dq,packedOpSnippet:dq,cpuKernelImpl:vLe}),x3e={kernelName:Mg,backendName:"webgl",kernelFunc:v3e};class C3e{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class w3e{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const I3e={kernelName:Pg,backendName:"webgl",kernelFunc:function S3e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{clipValueMin:r,clipValueMax:o}=i;let a;return a=J().getBool("WEBGL_PACK_CLIP")?new w3e(s.shape):new C3e(s.shape),e.runWebGLProgram(a,[s],s.dtype,[[r],[o]])}};class E3e{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function hq(n,t){return{dataId:t.dataId,dtype:t.dtype,shape:n.shape}}const T3e={kernelName:gx,backendName:"webgl",kernelFunc:function k3e(n){const{inputs:t,backend:e}=n,{x:i}=t,s=e.texData.get(i.dataId),r=new E3e(i.shape),o=[hq(i,s.complexTensorInfos.real),hq(i,s.complexTensorInfos.imag)];return e.runWebGLProgram(r,o,o[0].dtype)}};class D3e{constructor(t){this.outputShape=[],this.outputShape=La(t,1),this.variableNames=t.map((o,a)=>`T${a}`);const e=new Array(t.length-1);e[0]=t[0][1];for(let o=1;o<e.length;o++)e[o]=e[o-1]+t[o][1];const i=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<e.length;o++)i.push(`else if (yC < ${e[o]}) setOutput(getT${o}(yR, yC-${e[o-1]}));`);i.push(`else setOutput(getT${e.length}(yR, yC-${e[e.length-1]}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${i.join("\n        ")}\n      }\n    `}}class N3e{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=La(t,e);const i=this.outputShape,s=i.length,r=yn(s),o=Vs("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=t.map((g,m)=>`T${m}`);const l=new Array(t.length-1);l[0]=t[0][e];for(let g=1;g<l.length;g++)l[g]=l[g-1]+t[g][e];const c=a[e],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {\n        return getChannel(\n            getT0(${d}), vec2(${u.join()}));\n        }`;for(let g=1;g<l.length;g++){const m=l[g-1];h+=`\n        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {\n          return getChannel(\n            getT${g}(${Hw(a,c,m)}),\n            vec2(${Hw(u,c,m)}));\n        }`}const p=l[l.length-1];h+=`\n        return getChannel(\n          getT${l.length}(${Hw(a,c,p)}),\n          vec2(${Hw(u,c,p)}));`,this.userCode=`\n      float getValue(${a.map(g=>"int "+g)}) {\n        ${h}\n      }\n\n      void main() {\n        ${r} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[s-1]} = ${o[s-1]} + 1;\n        if (${o[s-1]} < ${i[s-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[s-2]} = ${o[s-2]} + 1;\n        if (${o[s-2]} < ${i[s-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[s-1]} = ${o[s-1]} - 1;\n        if (${o[s-2]} < ${i[s-2]} &&\n            ${o[s-1]} < ${i[s-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function Hw(n,t,e){const i=n.indexOf(t);return n.map((r,o)=>o===i?`${r} - ${e}`:r).join()}function jw(n){const{inputs:t,backend:e}=n,{input:i}=t;return vr({inputs:{x:e.texData.get(i.dataId).complexTensorInfos.imag},backend:e})}const A3e={kernelName:CN,backendName:"webgl",kernelFunc:jw};function u_(n,t,e){const i=n[0].dtype;if("complex64"===i){const f=n.map(_=>c_({inputs:{input:_},backend:e})),p=n.map(_=>jw({inputs:{input:_},backend:e})),g=u_(f,t,e),m=u_(p,t,e),b=Yc({inputs:{real:g,imag:m},backend:e});return f.forEach(_=>e.disposeIntermediateTensorInfo(_)),p.forEach(_=>e.disposeIntermediateTensorInfo(_)),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(m),b}let s=e.shouldExecuteOnCPU(n);if("string"===i&&(s=!0),s){const f=n.map(v=>{const S=[-1,te(v.shape.slice(t))];return Se({inputs:{x:v},backend:e,attrs:{shape:S}})}),p=f.map(v=>({vals:e.readSync(v.dataId),shape:v.shape})),g=La(f.map(v=>v.shape),1),b=xLe(p,g,i,1===f[0].shape[0]),_=La(n.map(v=>v.shape),t),y=e.makeTensorInfo(_,i,b);return f.forEach(v=>e.disposeIntermediateTensorInfo(v)),y}const r=n.filter(f=>te(f.shape)>0),o=J().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1;if(1===r.length){const f=o?new qa(n[0].shape,Kc):new Xc(n[0].shape,Kc);return e.runWebGLProgram(f,n,i)}const a=J().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>a){const f=[];for(let g=0;g<r.length;g+=a){const m=r.slice(g,g+a);f.push(u_(m,t,e))}const p=u_(f,t,e);for(const g of f)e.disposeIntermediateTensorInfo(g);return p}if(o){const f=new N3e(r.map(p=>p.shape),t);return e.runWebGLProgram(f,r,i)}const{tensors2D:l,outShape:c}=function M3e(n,t,e){const i=La(n.map(r=>r.shape),t);return{tensors2D:n.map(r=>Se({inputs:{x:r},attrs:{shape:[-1,te(r.shape.slice(t))]},backend:e})),outShape:i}}(r,t,e),u=new D3e(l.map(f=>f.shape)),d=e.runWebGLProgram(u,l,i);l.forEach(f=>e.disposeIntermediateTensorInfo(f));const h=Se({inputs:{x:d},attrs:{shape:c},backend:e});return e.disposeIntermediateTensorInfo(d),h}function fq(n){const{inputs:t,backend:e,attrs:i}=n,{axis:s}=i,r=Tt(s,t[0].shape)[0];rM(t.map(c=>c.shape),r);const a=La(t.map(c=>c.shape),r);if(0===te(a))return e.makeTensorInfo(a,t[0].dtype,[]);const l=t.filter(c=>te(c.shape)>0);return 1===l.length?vr({inputs:{x:l[0]},backend:e}):u_(l,r,e)}const P3e={kernelName:bx,backendName:"webgl",kernelFunc:fq};class pq{constructor(t,e=!1,i=null,s=!1,r=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,a=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,d=t.dilationWidth,h=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),g=t.inChannels%4,m="channelsLast"===t.dataFormat,b=m?1:2,_=m?2:3,y=m?3:1;let v="",x="";i&&(v=s?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${i}\n        }`:r?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${i}\n        }`:`\n          float activation(float x) {\n            ${i}\n          }\n        `,x="result = activation(result);");const S=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${l}, ${c});\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${b}], coords[${_}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${h}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${f}; wC++) {\n            int xC = xCCorner + wC * ${d};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===g}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===g}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===g}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${S}\n        ${x}\n        setOutput(result);\n      }\n    `}}class R3e{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,i=t.padInfo.top,s=t.padInfo.left,r=t.strideDepth,o=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,d=t.filterDepth,h=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),g=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${r}, ${o}, ${a});\n      const ivec3 pads = ivec3(${e}, ${i}, ${s});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${d}; wF++) {\n          int xF = xFCorner + wF * ${l};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h}; wR++) {\n            int xR = xRCorner + wR * ${c};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${f}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===g}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===g}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===g}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class mq{constructor(t,e=!1,i=null,s=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Is(this.outputShape.length);const o=t.padInfo.left,a=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,u=t.filterWidth,d=u;let h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<u;m++)h+=`\n           vec4 xTexelC${2*m};\n           int xTexelC${2*m}Ready;\n           vec4 xTexelC${2*m+1};\n           int xTexelC${2*m+1}Ready;\n           vec4 xC${m};`;h+=`\n     for (int r = 0; r < ${c}; r++) {\n      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {\n       `;for(let m=0;m<u;m++)h+=`\n           xTexelC${2*m} = vec4(0.0);\n           xTexelC${2*m}Ready = 0;\n           xTexelC${2*m+1} = vec4(0.0);\n           xTexelC${2*m+1}Ready = 0;\n           xC${m} = vec4(0.0);`;h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(d+1)/2;m++){const b=2*m;if(h+=`\n           xC = xCCorner + ${b*l};\n           `,1===a){if(b<u&&(o%2==1?(h+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {\n                   xTexelC${b} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${b}.zw = vec2(0.0);\n                   }\n                   xTexelC${b}Ready = 1;\n                 }\n               `,h+=1===l&&b>0?`\n                 xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${b} = vec4(previous.zw, xTexelC${b}.xy);\n                   } else {\n                     xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);\n                   }\n                   `):h+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {\n                   xTexelC${b} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${b}.zw = vec2(0.0);\n                   }\n                   xTexelC${b}Ready = 1;\n                 }\n\n                 xC${b} = xTexelC${b};\n                 `,b+1<u)){const _=o%2==0?UD(l):l;l%2==0&&o%2==1||l%2!=0&&o%2!=1?(h+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${_};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {\n                     xTexelC${b+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${b+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${b+1}Ready = 1;\n                   }\n                   `,h+=l>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);\n                     } else {\n                      xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);\n                     }\n                     `:`\n                     xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);\n                     `):h+=1===_?`\n                     xC${b+1} = xTexelC${b};\n                     `:`\n                     xCOffset = xC + ${_};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {\n                       xTexelC${b+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${b+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${b+1}Ready = 1;\n                     }\n\n                     xC${b+1} = xTexelC${b+1};\n                     `}}else b<u&&(o%2==1?(h+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {\n                   xTexelC${b} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${b}.zw = vec2(0.0);\n                   }\n                   xTexelC${b}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {\n                   xTexelC${b+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${b+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${b+1}Ready = 1;\n                 }\n\n                 xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);\n               `,b+1<u&&(h+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);\n                 `)):(h+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {\n                   xTexelC${b} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${b}.zw = vec2(0.0);\n                   }\n                   xTexelC${b}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {\n                   xTexelC${b+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${b+1}.zw = vec2(0.);\n                   }\n                   xTexelC${b+1}Ready = 1;\n                 }\n\n                 xC${b} = vec4(\n                   xTexelC${b}.xy, xTexelC${b+1}.xy);\n               `,b+1<u&&(h+=`\n                   xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);\n                 `)));b<u&&(h+=`\n             wTexel = getW(r, ${b}, d1, d2);\n             dotProd += xC${b}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${t.inChannels}) {\n               dotProd += xC${b}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,b+1<u&&(h+=`\n               wTexel = getW(r, ${b+1}, d1, d2);\n               dotProd += xC${b+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${t.inChannels}) {\n                 dotProd += xC${b+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";let f="",p="";i&&(f=s?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${i}\n         }`:r?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${i}\n         }`:`vec4 activation(vec4 x) {\n           ${i}\n         }`,p="result = activation(result);");const g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${f}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${h}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${g}\n         ${p}\n         setOutput(result);\n       }\n     `}}class O3e{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Is(this.outputShape.length);const{dataFormat:i}=e,s=Bs(),r="channelsLast"===i,o=r?1:2,a=r?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`\n          blockIndex = rc.z + ${d};\n          pos = rc.y + ${u};\n\n          ${l}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${o}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${a}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${r}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*u+d}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*u+d}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${c}\n\n        ${s.output} = result;\n      }\n    `}}function Gw(n,t){const e=n.length;return e>=3?t?[...n.slice(0,-3),n[e-3]*n[e-2],n[e-1]]:[...n.slice(0,-3),n[e-3],n[e-2]*n[e-1]]:!t&&1===e&&n[0]>1?[n[0],1]:null}function gq({x:n,filter:t,convInfo:e,backend:i,bias:s=null,preluActivationWeights:r=null,leakyreluAlpha:o=0,activation:a=null}){const l=n.shape,c=i.texData.get(n.dataId),u=e.inChannels,d=l[0]*l[1]*l[2],h=e.outChannels,f="channelsLast"===e.dataFormat;let m;const b=[];if(null!=r){const v=Gw(r.shape,f);null!=v&&(r=Se({inputs:{x:r},backend:i,attrs:{shape:v}}),b.push(r))}if(null!=s){const v=Gw(s.shape,f);null!=v&&(s=Se({inputs:{x:s},backend:i,attrs:{shape:v}}),b.push(s))}if((1!==d&&1!==h||!(u>sq))&&c.isPacked&&f&&null!=c.texture&&l[2]%2!=0&&tn(c.shape.slice(-3),l.slice(-3))){const x={dataId:n.dataId,shape:[1,l[0]*l[1]*(l[2]+1),e.inChannels],dtype:n.dtype},S=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(Rw(c.shape,x.shape),()=>`packed reshape ${c.shape} to ${x.shape} isn't free`);const E=Se({inputs:{x:t},backend:i,attrs:{shape:[1,e.inChannels,e.outChannels]}});b.push(E);const k=Uw({a:x,b:E,backend:i,transposeA:!1,transposeB:!1,bias:s,activation:a,preluActivationWeights:r,leakyreluAlpha:o}),D=i.texData.get(k.dataId);T(D.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=S,D.shape=e.outShape,m=vr({inputs:{x:k},backend:i}),m.shape=e.outShape,b.push(k)}else{const v=e.outHeight*e.outWidth,x=Se({inputs:{x:n},backend:i,attrs:{shape:f?[e.batchSize,v,e.inChannels]:[e.batchSize,e.inChannels,v]}}),S=Se({inputs:{x:t},backend:i,attrs:{shape:[1,e.inChannels,e.outChannels]}}),E=Uw({a:f?x:S,b:f?S:x,transposeA:!f,transposeB:!1,backend:i,bias:s,activation:a,preluActivationWeights:r,leakyreluAlpha:o});m=Se({inputs:{x:E},backend:i,attrs:{shape:e.outShape}}),b.push(x),b.push(S),b.push(E)}for(const v of b)i.disposeIntermediateTensorInfo(v);return m}function bq({x:n,filter:t,convInfo:e,backend:i,bias:s=null,preluActivationWeights:r=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=e,p="channelsLast"===f,g=l*c*u,m=h*d,b=[e.batchSize,g,m],v=[];if(null!=r){const B=Gw(r.shape,p);null!=B&&(r=Se({inputs:{x:r},backend:i,attrs:{shape:B}}),v.push(r))}if(null!=s){const B=Gw(s.shape,p);null!=B&&(s=Se({inputs:{x:s},backend:i,attrs:{shape:B}}),v.push(s))}const x=Se({inputs:{x:t},backend:i,attrs:{shape:[1,g,te(t.shape)/g]}});v.push(x);const S=new O3e(b,e),k=i.runWebGLProgram(S,[n],"float32",[n.shape,[e.padInfo.top,e.padInfo.left],[e.strideHeight,e.strideWidth],[e.dilationHeight,e.dilationWidth],[e.inChannels],[e.filterWidth*e.inChannels],[e.outWidth]]),D=Se({inputs:{x:k},backend:i,attrs:{shape:b}});v.push(k),v.push(D);const M=null!=s,R=null!=r,U="leakyrelu"===a,X=a?a_(a,!0):null,ee=new J9(p?D.shape:x.shape,p?x.shape:D.shape,p?[e.batchSize,m,e.outChannels]:[e.batchSize,e.outChannels,m],!0,!1,M,X,R,U),K=p?[D,x]:[x,D];if(s&&K.push(s),R&&K.push(r),U){const B=i.makeTensorInfo([],"float32",kc(o,"float32"));K.push(B),v.push(B)}const O=i.runWebGLProgram(ee,K,"float32"),z=Se({inputs:{x:O},backend:i,attrs:{shape:e.outShape}});v.push(O);for(const B of v)i.disposeIntermediateTensorInfo(B);return z}const L3e={kernelName:_x,backendName:"webgl",kernelFunc:function F3e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r}=t,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=i,d=El(l),h=es(s.shape,r.shape,o,c,a,u,!1,d);let f;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&J().getBool("WEBGL_EXP_CONV")){const g=new mq(h);f=e.runWebGLProgram(g,[s,r],"float32",[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]])}else if(J().getBool("WEBGL_CONV_IM2COL"))f=bq({x:s,filter:r,convInfo:h,backend:e});else{const g=new pq(h);f=e.runWebGLProgram(g,[s,r],"float32")}else f=gq({x:s,filter:r,convInfo:h,backend:e});const p=Se({inputs:{x:f},backend:e,attrs:{shape:h.outShape}});return e.disposeIntermediateTensorInfo(f),p}};class $3e{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              ${"channelsLast"===t.dataFormat?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class B3e{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,i=t.filterWidth,o="channelsLast"===t.dataFormat;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${o?3:1}];\n\n        ivec2 dyCorner = ivec2(coords[${o?1:2}], coords[${o?2:3}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${i}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${i} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${o}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class V3e{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${t.strideDepth} - ${t.padInfo.front};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class z3e{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,i=t.filterHeight,s=t.filterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${i-1-t.padInfo.top}, ${s-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${t.strideDepth}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${i}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${i} - 1 - wR;\n\n            for (int wC = 0; wC < ${s}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${s} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const W3e={kernelName:rN,backendName:"webgl",kernelFunc:function U3e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,dy:r}=t,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=i,d=El(l),h=es(s.shape,u,o,1,a,c,!1,d),f=new $3e(h);return e.runWebGLProgram(f,[s,r],"float32")}};class H3e{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Is(this.outputShape.length);const e=t.filterHeight,i=t.filterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${i}; wC++) {\n            int wCPerm = ${i} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}const G3e={kernelName:yx,backendName:"webgl",kernelFunc:function j3e(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,filter:r}=t,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=i,d=El(c),h=es(o,r.shape,a,1,l,u,!1,d);if(J().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){const f=[[h.strideHeight,h.strideWidth]],p=new H3e(h);return e.runWebGLProgram(p,[s,r],"float32",f)}{const f=new B3e(h);return e.runWebGLProgram(f,[s,r],"float32")}}},K3e={kernelName:vx,backendName:"webgl",kernelFunc:function q3e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r}=t,{strides:o,pad:a,dilations:l}=i,c=Rc(s.shape,r.shape,o,l,a),u=new R3e(c);return e.runWebGLProgram(u,[s,r],"float32")}},Y3e={kernelName:oN,backendName:"webgl",kernelFunc:function X3e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,dy:r}=t,{strides:o,pad:a,filterShape:l}=i,c=Rc(s.shape,l,o,1,a),u=new V3e(c);return e.runWebGLProgram(u,[s,r],"float32")}},Q3e={kernelName:aN,backendName:"webgl",kernelFunc:function Z3e(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,filter:r}=t,{pad:o,strides:a,inputShape:l}=i,c=Rc(l,r.shape,a,1,o),u=new z3e(c);return e.runWebGLProgram(u,[s,r],"float32")}},tVe=Gt({opSnippet:rp+"\n  return cos(x);\n",packedOpSnippet:`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${Id}\n  return result;\n`}),nVe={kernelName:Rg,backendName:"webgl",kernelFunc:tVe},iVe=Gt({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),sVe={kernelName:Og,backendName:"webgl",kernelFunc:iVe};class rVe{constructor(t,e,i,s,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=t,[u]=e,[d,h]=i;this.outputShape=[u,d,h,c];const f="bilinear"===s?1:0,[p,g]=[a-1+".0",l-1+".0"],[m,b,_]=d>1?[""+(a-1)/(d-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[y,v,x]=h>1?[""+(l-1)/(h-1),"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${y});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${o}) {\n          return;\n        }\n\n        float height_scale = ${b};\n        float width_scale = ${v};\n\n        float in_y = ${_};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${r}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${g} ) {\n          setOutput(float(${r}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${f} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const oVe={kernelName:cN,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:i}=n,{image:s,boxes:r,boxInd:o}=t,{cropSize:a,method:l,extrapolationValue:c}=i,u=new rVe(s.shape,r.shape,a,l,c);return e.runWebGLProgram(u,[s,r,o],"float32")}};var ap=(()=>{return(n=ap||(ap={})).Prod="*",n.Sum="+",ap;var n})();class _q{constructor(t,e,i,s){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const r=this.outputShape.length,a=i?this.op===ap.Prod?"1.0":"0.0":`getX(${yq(r,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";i?(c=s?"end != "+(l-1):"end != 0",u=s?"end + 1":"end - 1"):(c=s?`end + pow2 < ${l}`:"end >= pow2",u=s?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${yn(r)} coords = getOutputCoords();\n        int end = ${vq(r,"coords",this.op)};\n        float val = ${a};\n        int pow2 = int(pow(2.0, index));\n        if (${c}) {\n          int idx = ${u};\n          ${vq(r,"coords",this.op)} = idx;\n          val ${this.op}= getX(${yq(r,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function yq(n,t,e){if(1===n)return`${t}`;if(2===n)return`${t}.x, ${t}.y`;if(3===n)return`${t}.x, ${t}.y, ${t}.z`;if(4===n)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function vq(n,t,e){if(1===n)return`${t}`;if(2===n)return`${t}.y`;if(3===n)return`${t}.z`;if(4===n)return`${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function xq(n,t,e,i,s,r){const o=t.shape.length,a=ti([i],o);let l=t;null!=a&&(l=zs({inputs:{x:t},backend:e,attrs:{perm:a}}));const c=xi(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${i}`);const u=l.shape[c];let d=vr({inputs:{x:l},backend:e});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new _q(n,l.shape,!1,r),g=d;d=e.runWebGLProgram(f,[d],d.dtype,[[h]]),e.disposeIntermediateTensorInfo(g)}if(s){const h=new _q(n,l.shape,s,r),f=d;d=e.runWebGLProgram(h,[d],d.dtype),e.disposeIntermediateTensorInfo(f)}if(null!=a){const f=zs({inputs:{x:d},backend:e,attrs:{perm:Fc(a)}});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(l),f}return d}const lVe={kernelName:lN,backendName:"webgl",kernelFunc:function aVe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,exclusive:o,reverse:a}=i;return xq(ap.Prod,s,e,r,o,a)}},uVe={kernelName:xx,backendName:"webgl",kernelFunc:function cVe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,exclusive:o,reverse:a}=i;return xq(ap.Sum,s,e,r,o,a)}},hVe={kernelName:uN,backendName:"webgl",kernelFunc:function dVe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,weights:r}=t,{size:o,binaryOutput:a}=i;if(1===s.shape.length){const l=e.readSync(s.dataId),c=e.readSync(r.dataId),u=V9(l,c,r.dtype,r.shape,o);return e.makeTensorInfo([o],r.dtype,u)}if(2===s.shape.length){const l=e.bufferSync(s),c=e.bufferSync(r),u=bLe(l,c,o,a);return e.makeTensorInfo(u.shape,r.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}};class fVe{constructor(t,e,i){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=i,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const mVe={kernelName:dN,backendName:"webgl",kernelFunc:function pVe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{blockSize:r,dataFormat:o}=i,a=s.shape[0],d=("NHWC"===o?s.shape[1]:s.shape[2])*r,h=("NHWC"===o?s.shape[2]:s.shape[3])*r,f=("NHWC"===o?s.shape[3]:s.shape[1])/(r*r),g=new fVe("NHWC"===o?[a,d,h,f]:[a,f,d,h],r,o);return e.runWebGLProgram(g,[s],s.dtype)}};class Cq{constructor(t,e=!1,i=null,s=!1,r=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Is(this.outputShape.length);const o=t.filterHeight,a=t.filterWidth,l=t.outChannels/t.inChannels;let c="",u="";i&&(c=s?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${i}\n        }`:r?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${i}\n        }`:`\n          float activation(float x) {\n            ${i}\n          }\n        `,u="result = activation(result);");const d=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${c}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${l};\n        int q = d2 - d1 * ${l};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${o}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${a}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${d}\n        ${u}\n        setOutput(result);\n      }\n    `}}class wq{constructor(t,e=!1,i=null,s=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Is(this.outputShape.length);const o=t.outChannels/t.inChannels,a=t.padInfo.left,l=t.strideWidth,c=t.dilationWidth,u=t.filterHeight,d=t.filterWidth,h=d;let f="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let b=0;b<d;b++)f+=`\n          vec4 xTexelC${2*b};\n          int xTexelC${2*b}Ready;\n          vec4 xTexelC${2*b+1};\n          int xTexelC${2*b+1}Ready;\n          vec4 xC${b};`;f+=`\n    for (int r = 0; r < ${u}; r++) {\n      `;for(let b=0;b<d;b++)f+=`\n          xTexelC${2*b} = vec4(0.0);\n          xTexelC${2*b}Ready = 0;\n          xTexelC${2*b+1} = vec4(0.0);\n          xTexelC${2*b+1}Ready = 0;\n          xC${b} = vec4(0.0);`;f+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let b=0;b<(h+1)/2;b++){const _=2*b;if(f+=`\n          xC = xCCorner + ${_*c};\n          `,1===l){if(_<d&&(a%2==1?(f+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_}Ready == 0) {\n                  xTexelC${_} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${_}.zw = vec2(0.0);\n                  }\n                  xTexelC${_}Ready = 1;\n                }\n              `,f+=1===c&&_>0?`\n                xC${_} = vec4(xTexelC${_-2}.zw, xTexelC${_}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${_} = vec4(previous.zw, xTexelC${_}.xy);\n                  } else {\n                    xC${_} = vec4(0.0, 0.0, xTexelC${_}.xy);\n                  }\n                  `):f+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${_}Ready == 0) {\n                  xTexelC${_} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${_}.zw = vec2(0.0);\n                  }\n                  xTexelC${_}Ready = 1;\n                }\n\n                xC${_} = xTexelC${_};\n                `,_+1<d)){const y=a%2==0?UD(c):c;c%2==0&&a%2==1||c%2!=0&&a%2!=1?(f+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${y};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_+1}Ready == 0) {\n                    xTexelC${_+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${_+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${_+1}Ready = 1;\n                  }\n                  `,f+=c>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${_+1} = vec4(previous.zw, xTexelC${_+1}.xy);\n                    } else {\n                     xC${_+1} = vec4(0.0, 0.0, xTexelC${_+1}.xy);\n                    }\n                    `:`\n                    xC${_+1} = vec4(xTexelC${_}.zw, xTexelC${_+1}.xy);\n                    `):f+=1===y?`\n                    xC${_+1} = xTexelC${_};\n                    `:`\n                    xCOffset = xC + ${y};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_+1}Ready == 0) {\n                      xTexelC${_+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${_+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${_+1}Ready = 1;\n                    }\n\n                    xC${_+1} = xTexelC${_+1};\n                    `}}else _<d&&(a%2==1?(f+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_}Ready == 0) {\n                  xTexelC${_} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${_}.zw = vec2(0.0);\n                  }\n                  xTexelC${_}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${_+1}Ready == 0) {\n                  xTexelC${_+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${_+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${_+1}Ready = 1;\n                }\n\n                xC${_} = vec4(xTexelC${_}.zw, xTexelC${_+1}.zw);\n              `,_+1<d&&(f+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${_+1} = vec4(xTexelC${_+1}.xy, final.xy);\n                `)):(f+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${_}Ready == 0) {\n                  xTexelC${_} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${_}.zw = vec2(0.0);\n                  }\n                  xTexelC${_}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_+1}Ready == 0) {\n                  xTexelC${_+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${_+1}.zw = vec2(0.);\n                  }\n                  xTexelC${_+1}Ready = 1;\n                }\n\n                xC${_} = vec4(\n                  xTexelC${_}.xy, xTexelC${_+1}.xy);\n              `,_+1<d&&(f+=`\n                  xC${_+1} = vec4(xTexelC${_}.zw, xTexelC${_+1}.zw);\n                `)));_<d&&(f+=`\n            wTexel = getW(r, ${_}, d1, q);\n            dotProd += xC${_} * vec4(wTexel.xz, wTexel.xz);\n          `,_+1<d&&(f+=`\n              wTexel = getW(r, ${_+1}, d1, q);\n              dotProd += xC${_+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}f+="\n    }\n  ",f+="\n      }\n    ";let p="",g="";i&&(p=s?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${i}\n        }`:r?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${i}\n        }`:`vec4 activation(vec4 x) {\n          ${i}\n        }`,g="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${p}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${f}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${m}\n        ${g}\n        setOutput(result);\n      }\n    `}}const bVe={kernelName:Cx,backendName:"webgl",kernelFunc:function gVe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r}=t,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=i;let u=l;null==u&&(u=[1,1]),T(hs(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=es(s.shape,r.shape,o,u,a,c,!0);let h;return h=J().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels==1?new wq(d):new Cq(d),e.runWebGLProgram(h,[s,r],"float32",[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]])}};class _Ve{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${t.outChannels/t.inChannels} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class yVe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,i=t.filterWidth,l=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${i}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${i} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${l}; dm++) {\n              int d2 = d1 * ${l} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const xVe={kernelName:hN,backendName:"webgl",kernelFunc:function vVe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,dy:r}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=i,d=es(s.shape,u,o,a,l,c,!0),h=new _Ve(d);return e.runWebGLProgram(h,[s,r],"float32")}},wVe={kernelName:fN,backendName:"webgl",kernelFunc:function CVe(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,filter:r}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=i,d=es(u,r.shape,o,a,l,c,!0),h=new yVe(d);return e.runWebGLProgram(h,[s,r],"float32")}};class SVe{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const EVe={kernelName:"Diag",backendName:"webgl",kernelFunc:function IVe(n){const{inputs:t,backend:e}=n,{x:i}=t,s=[...i.shape,...i.shape],r=te(i.shape),o=Se({inputs:{x:i},backend:e,attrs:{shape:[r]}}),a=new SVe(r),l=e.runWebGLProgram(a,[o],o.dtype),c=Se({inputs:{x:l},backend:e,attrs:{shape:s}});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(l),c}};class kVe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:i,padInfo:s,strideHeight:r,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=t,{top:d,left:h}=s;this.userCode=`\n      const ivec2 strides = ivec2(${r}, ${o});\n      const ivec2 pads = ivec2(${d}, ${h});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${a}; h++) {\n          int hIn = hBeg + h * ${c};\n\n          if (hIn >= 0 && hIn < ${e}) {\n            for (int w = 0; w < ${l}; w++) {\n              int wIn = wBeg + w * ${u};\n\n              if (wIn >= 0 && wIn < ${i}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const DVe={kernelName:wx,backendName:"webgl",kernelFunc:function TVe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r}=t,{strides:o,pad:a,dilations:l}=i,c=Eb(s.shape,r.shape,o,a,"NHWC",l);let u;const d=new kVe(c);u=e.runWebGLProgram(d,[s,r],"float32");const h=Se({inputs:{x:u},backend:e,attrs:{shape:c.outShape}});return e.disposeIntermediateTensorInfo(u),h}},AVe={kernelName:gN,backendName:"webgl",kernelFunc:function NVe(n){const{inputs:t,backend:e,attrs:i}=n,{equation:s}=i,r=t,{allDims:o,summedDims:a,idDims:l}=yM(s,r.length);xM(o.length,l,r);const{path:c,steps:u}=CM(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let g=0;g<d;++g){for(const m of u[g]){const{permutationIndices:b,expandDims:_}=vM(f,l[m]);let y;wM(b)?y=r[m]:(y=zs({inputs:{x:r[m]},backend:e,attrs:{perm:b}}),p.push(y));const v=y.shape.slice();for(let x=0;x<_.length;++x)v.splice(_[x],0,1);tn(y.shape,v)||(y=Se({inputs:{x:y},backend:e,attrs:{shape:v}}),p.push(y)),null===h?h=y:(h=YP({inputs:{a:y,b:h},backend:e}),p.push(h))}g<d-1&&(c[g]>=0&&(h=zw({inputs:{x:h},backend:e,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const g of p)g!==h&&e.disposeIntermediateTensorInfo(g);return h}},MVe=Gt({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),PVe={kernelName:Lg,backendName:"webgl",kernelFunc:MVe},FVe={kernelName:bN,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e}=n,{dy:i,y:s}=t,r=J().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sp("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",i.shape,s.shape):new Sd("return (b >= 0.0) ? a : a * (b + 1.0);",i.shape,s.shape);return e.runWebGLProgram(r,[i,s],i.dtype)}},LVe=ps({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:CLe}),$Ve={kernelName:Sx,backendName:"webgl",kernelFunc:LVe},VVe=Gt({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${dM};\n  float a1 = ${hM};\n  float a2 = ${fM};\n  float a3 = ${pM};\n  float a4 = ${mM};\n  float a5 = ${gM};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),zVe={kernelName:$g,backendName:"webgl",kernelFunc:VVe},Sq=Gt({opSnippet:rp+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:wLe,dtype:"float32"}),WVe={kernelName:Bg,backendName:"webgl",kernelFunc:Sq};function e2(n){const{inputs:t,attrs:e,backend:i}=n,{dim:s}=e,{input:r}=t,o=r.shape.length,a=r.shape.slice();let l=s;return s<0&&(T(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),Se({inputs:{x:r},backend:i,attrs:{shape:a}})}const HVe={kernelName:Ix,backendName:"webgl",kernelFunc:e2},Iq="return exp(x) - 1.0;",jVe=Gt({opSnippet:Iq,packedOpSnippet:Iq,cpuKernelImpl:SLe}),GVe={kernelName:Vg,backendName:"webgl",kernelFunc:jVe};class Eq{constructor(t,e,i){this.variableNames=["real","imag"];const s=e[1];this.outputShape=e;const r=i?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=i?`${s}.0`:"1.0";let a;if("real"===t)a="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);a="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${r};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${a}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${s});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${s}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${o};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function kq(n,t,e){const i=e.texData.get(n.dataId),s=te(n.shape),r=n.shape[n.shape.length-1],a=Se({inputs:{x:n},backend:e,attrs:{shape:[s/r,r]}}),l=a.shape,c=new Eq("real",l,t),u=new Eq("imag",l,t),d=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:l},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:l}],h=e.runWebGLProgram(c,d,"float32"),f=e.runWebGLProgram(u,d,"float32"),p=Yc({inputs:{real:h,imag:f},backend:e});e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(f);const g=Se({inputs:{x:p},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(p),g}const KVe={kernelName:"FFT",backendName:"webgl",kernelFunc:function qVe(n){const{inputs:t,backend:e}=n,{input:i}=t;return kq(i,!1,e)}};class XVe{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function d_(n){const{backend:t,attrs:e}=n,{shape:i,value:s}=e;let{dtype:r}=e;if(r=r||wf(s),"string"===r){const o=yi(r,te(i));return o.fill(s),t.makeTensorInfo(i,r,o)}{const o=new XVe(i,s);return t.runWebGLProgram(o,[],r,[[s]])}}const YVe={kernelName:yN,backendName:"webgl",kernelFunc:d_};class ZVe{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${e} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${e}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const QVe={kernelName:vN,backendName:"webgl",kernelFunc:({inputs:n,backend:t})=>{const{image:e}=n,i=t,s=new ZVe(e.shape);return i.runWebGLProgram(s,[e],e.dtype)}},Tq="return floor(x);",JVe=Gt({opSnippet:Tq,packedOpSnippet:Tq,cpuKernelImpl:ILe}),eze={kernelName:zg,backendName:"webgl",kernelFunc:JVe},tze=ps({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),nze={kernelName:Ug,backendName:"webgl",kernelFunc:tze};class ize{constructor(t){this.variableNames=["A"];const e=Bs(),[i,s]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${i}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class sze{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=Bs(),[i,s]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${s}.0, ${i}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}const rze={kernelName:"FromPixels",backendName:"webgl",kernelFunc:function oze(n){const{inputs:t,backend:e,attrs:i}=n;let{pixels:s}=t;const{numChannels:r}=i,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,c]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=[c,l],d=[c,l,r];if(a||o){const g=J().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==lp||g!==t2)&&(t2=g,lp=document.createElement("canvas").getContext("2d",{willReadFrequently:t2})),lp.canvas.width=l,lp.canvas.height=c,lp.drawImage(s,0,0,l,c),s=lp.canvas}const h=e.makeTensorInfo(u,"int32");e.texData.get(h.dataId).usage=yr.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(h.dataId),s);const f=J().getBool("WEBGL_PACK")?new sze(d):new ize(d),p=e.runWebGLProgram(f,[h],"int32");return e.disposeData(h.dataId),p}};let lp,t2=J().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const lze={kernelName:dC,backendName:"webgl",kernelFunc:function aze(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=i,g=El(u),m=es(s.shape,r.shape,l,d,c,h,!1,g);let b;const _=[],y=null!=o,v=null!=a,x="leakyrelu"===f,S=()=>{const k=[s,r],D=(M,R)=>{if("NCHW"===R&&1===M.shape.length&&1!==M.shape[0]){const U=Se({inputs:{x:M},backend:e,attrs:{shape:[M.shape[0],1,1]}});return _.push(U),U}return M};if(y&&k.push(D(o,u)),v&&k.push(D(a,u)),x){const M=e.makeTensorInfo([],"float32",kc(p,"float32"));k.push(M),_.push(M)}return k};if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(m.strideWidth<=2&&"channelsLast"===g&&J().getBool("WEBGL_EXP_CONV")){const k=f?a_(f,!0):null,D=new mq(m,y,k,v,x),M=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],R=S();b=e.runWebGLProgram(D,R,"float32",M)}else if(J().getBool("WEBGL_CONV_IM2COL"))b=bq({x:s,filter:r,convInfo:m,backend:e,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const k=f?a_(f,!1):null,D=new pq(m,y,k,v,x),M=S();b=e.runWebGLProgram(D,M,"float32")}else b=gq({x:s,filter:r,convInfo:m,backend:e,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});const E=Se({inputs:{x:b},backend:e,attrs:{shape:m.outShape}});return _.push(b),_.forEach(k=>e.disposeIntermediateTensorInfo(k)),E}},uze={kernelName:hC,backendName:"webgl",kernelFunc:function cze(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,filter:r,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=i,p=[];let g=u;null==g&&(g=[1,1]),T(hs(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const m=es(s.shape,r.shape,l,g,c,d,!0),b=J().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels==1,_=h?a_(h,b):null,y=[s,r],v=null!=o,x=null!=a,S="leakyrelu"===h;if(v&&y.push(o),x&&y.push(a),S){const M=e.makeTensorInfo([],"float32",kc(f,"float32"));y.push(M),p.push(M)}let E;E=b?new wq(m,v,_,x,S):new Cq(m,v,_,x,S);const D=e.runWebGLProgram(E,y,"float32",[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]]);return p.forEach(M=>e.disposeIntermediateTensorInfo(M)),D}};class dze{constructor(t,e,i,s){this.sliceDim=t,this.strides=e,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=i;const r=yn(i.length);let o="\n    int index;";for(let a=0;a<this.sliceDim;a++)o+=`\n          index = round(getIndices(coords[0], ${a}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};\n          flattenIndex += index * ${this.strides[a]};`;this.userCode=`\n         void main() {\n          ${r} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${o}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}const fze={kernelName:_H,backendName:"webgl",kernelFunc:function hze(n){const{inputs:t,backend:e}=n,{params:i,indices:s}=t,r=s.shape,o=r[r.length-1],a=te(i.shape),[l,c,u,d]=uM(i,s),h=Se({inputs:{x:s},backend:e,attrs:{shape:[c,o]}}),f=Se({inputs:{x:i},backend:e,attrs:{shape:[te(i.shape)/u,u]}});if(e.shouldExecuteOnCPU([i,s])||"string"===i.dtype){const b=e.readSync(s.dataId),_=e.bufferSync(i),y=ELe(b,_,i.dtype,c,o,u,d,i.shape,a);return e.makeTensorInfo(l,i.dtype,y.values)}const p=new dze(o,d,[c,u],i.shape),g=e.runWebGLProgram(p,[f,h],f.dtype),m=Se({inputs:{x:g},backend:e,attrs:{shape:l}});return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(g),m}};class pze{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const i=yn(this.rank),s=function mze(n,t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[];for(let s=0;s<n.length;s++)i.push(2===s?"index":`${e[s]}`);return i.join()}(t);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${s}));\n      }\n    `}}function Dq(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,indices:r}=t,{axis:o,batchDims:a}=i,l=Tt(o,s.shape)[0];if(J().get("DEBUG")){const _=e.readSync(r.dataId),y=s.shape[l];for(let v=0;v<_.length;++v){const x=_[v];T(x<=y-1&&x>=0,()=>`GatherV2: the index value ${x} is not in [0, ${y-1}]`)}}const c=EM(s,r,l,a),u=te(r.shape),d=[],h=Se({inputs:{x:s},backend:e,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=Se({inputs:{x:r},backend:e,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(e.shouldExecuteOnCPU([s,r])||"string"===s.dtype){const _=e.bufferSync(f),y=e.bufferSync(h),v=kLe(y,_,p);return d.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.makeTensorInfo(c.outputShape,v.dtype,v.values)}const g=new pze(h.shape,p),m=e.runWebGLProgram(g,[h,f],h.dtype);d.push(m);const b=Se({inputs:{x:m},backend:e,attrs:{shape:c.outputShape}});return d.forEach(_=>e.disposeIntermediateTensorInfo(_)),b}const gze={kernelName:kx,backendName:"webgl",kernelFunc:Dq},bze=ps({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:TLe,dtype:"bool"}),_ze={kernelName:Tx,backendName:"webgl",kernelFunc:bze},yze=ps({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:DLe}),vze={kernelName:Wg,backendName:"webgl",kernelFunc:yze},Cze={kernelName:xN,backendName:"webgl",kernelFunc:function xze(n){const{inputs:t,backend:e}=n,{input:i}=t;return kq(i,!0,e)}},wze=Gt({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Sze={kernelName:jg,backendName:"webgl",kernelFunc:wze},Ize=Gt({opSnippet:"return float(isinf(x));",dtype:"bool"}),Eze={kernelName:Gg,backendName:"webgl",kernelFunc:Ize},kze=Gt({opSnippet:"return float(isnan(x));",dtype:"bool"}),Tze={kernelName:qg,backendName:"webgl",kernelFunc:kze},Dze=ps({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:NLe,dtype:"bool"}),Nze={kernelName:Nx,backendName:"webgl",kernelFunc:Dze},Aze=ps({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:ALe,dtype:"bool"}),Mze={kernelName:Ax,backendName:"webgl",kernelFunc:Aze},Rze={kernelName:yH,backendName:"webgl",kernelFunc:function Pze(n){const{backend:t,attrs:e}=n,{start:i,stop:s,num:r}=e,o=MLe(i,s,r);return t.makeTensorInfo([o.length],"float32",o)}},Fze=Gt({opSnippet:rp+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:PLe}),Lze={kernelName:Kg,backendName:"webgl",kernelFunc:Fze},Bze=Gt({opSnippet:rp+"\n  return log(1.0 + x);\n"}),Vze={kernelName:Xg,backendName:"webgl",kernelFunc:Bze},zze=ps({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Uze={kernelName:Mx,backendName:"webgl",kernelFunc:zze},Wze=Gt({opSnippet:"return float(!(x >= 1.0));"}),Hze={kernelName:Px,backendName:"webgl",kernelFunc:Wze},jze=ps({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Gze={kernelName:Rx,backendName:"webgl",kernelFunc:jze};class qze{constructor(t,e,i,s,r){this.variableNames=["x"],this.outputShape=[];const o=e,a=t[3]-1;let l;this.outputShape=t;const c=`float(${i}) + float(${s}) * sum`;l=.5===r?`inversesqrt(${c})`:1===r?`1.0/(${c})`:`exp(log(${c}) * float(-${r}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${o}; j <= ${o}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${a}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${l};\n        setOutput(val);\n      }\n    `}}class Kze{constructor(t,e,i,s,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=e,a=t[3]-1;let l;this.outputShape=t;const c=`float(${i}) + float(${s}) * sum`;l=.5===r?`inversesqrt(${c})`:1===r?`1.0/(${c})`:`exp(log(${c}) * float(-${r}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${o};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${o}; j <= ${o}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${l};\n        setOutput(result);\n      }\n    `}}const Xze={kernelName:Ox,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{depthRadius:r,bias:o,alpha:a,beta:l}=i,c=J().getBool("WEBGL_PACK_NORMALIZATION")?new Kze(s.shape,r,o,a,l):new qze(s.shape,r,o,a,l);return e.runWebGLProgram(c,[s],s.dtype)}};class Yze{constructor(t,e,i,s,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=i,this.alpha=s,this.beta=r,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${s}) * norm + float(${i});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${s})\n                * float(${r})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${r});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const Zze={kernelName:wN,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:i}=n,{x:s,y:r,dy:o}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=i,d=new Yze(s.shape,a,l,c,u);return e.runWebGLProgram(d,[s,r,o],s.dtype)}};function Nq(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{reductionIndices:r,keepDims:o}=i,a=s.shape.length,l=Tt(r,s.shape);let c=l;const u=ti(c,a),d=null!=u,h=e.shouldExecuteOnCPU([s]);let f=s;if(d){if(h){const y=e.texData.get(f.dataId).values,v=new Array(a);for(let E=0;E<v.length;E++)v[E]=s.shape[u[E]];const x=KP(y,s.shape,s.dtype,u,v);f=e.makeTensorInfo(v,s.dtype),e.texData.get(f.dataId).values=x}else f=Vw(s,u,e);c=xi(c.length,a)}fs("max",c,a);const[p,g]=ts(f.shape,c);let b,m=p;if(o&&(m=vi(p,l)),h){const y=e.texData.get(f.dataId).values,v=RLe(y,te(g),m,s.dtype);b=e.makeTensorInfo(m,s.dtype),e.texData.get(b.dataId).values=v}else b=function Qze(n,t,e,i){const s=te(t),a=Se({inputs:{x:n},attrs:{shape:[te(n.shape)/s,s]},backend:i}),l=Ed(a,n.dtype,"max",i),c=Se({inputs:{x:l},attrs:{shape:e},backend:i});return i.disposeIntermediateTensorInfo(a),i.disposeIntermediateTensorInfo(l),c}(f,g,m,e);return d&&e.disposeIntermediateTensorInfo(f),b}const Jze={kernelName:Fx,backendName:"webgl",kernelFunc:Nq},n4e=ps({opSnippet:XP+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Id+"\n  return result;\n",cpuKernelImpl:OLe}),i4e={kernelName:Yg,backendName:"webgl",kernelFunc:n4e},r4e={kernelName:Lx,backendName:"webgl",kernelFunc:function s4e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t;r_(s,"maxPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=i;T(hs(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const u=bo(s.shape,r,o,1,a,l);if(1===u.filterWidth&&1===u.filterHeight&&tn(u.inShape,u.outShape))return vr({inputs:{x:s},backend:e});const d=new l_(u,"max",!1);return e.runWebGLProgram(d,[s],s.dtype)}},a4e={kernelName:$x,backendName:"webgl",kernelFunc:function o4e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{filterSize:r,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=i,d=Il(s.shape,r,o,[1,1,1],a,c,l),h=new ZP(d,"max",!1);return e.runWebGLProgram(h,[s],s.dtype)}};class l4e{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const r=t.effectiveFilterHeight,o=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${r-1-t.padInfo.top}, ${o-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${r};\n          wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${o}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${r*o-1} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${o} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class c4e{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,u=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${l-1-t.padInfo.front}, ${c-1-t.padInfo.top}, ${u-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${l};\n           wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${c};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${u};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${l*c*u-1} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${c} * ${u} +\n                  wR * ${u} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const d4e={kernelName:IN,backendName:"webgl",kernelFunc:function u4e(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r}=t,o=r,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=i,h=Il(o.shape,a,l,[1,1,1],c,u),f=new ZP(h,"max",!0),p=e.runWebGLProgram(f,[o],o.dtype),g=new c4e(h),m=e.runWebGLProgram(g,[s,p],o.dtype);return e.disposeIntermediateTensorInfo(p),m}},f4e={kernelName:SN,backendName:"webgl",kernelFunc:function h4e(n){const{inputs:t,backend:e,attrs:i}=n,{dy:s,input:r,output:o}=t,a=r;r_([r,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=i,h=bo(a.shape,l,c,1,u,d),p=new l_(h,"max",!0),g=e.runWebGLProgram(p,[a],a.dtype),m=new l4e(h),b=e.runWebGLProgram(m,[s,g],a.dtype);return e.disposeIntermediateTensorInfo(g),b}},m4e={kernelName:vH,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:i}=n,{filterSize:s,strides:r,pad:o,includeBatchInIndex:a}=t,l=e;T(4===i.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${i.shape.length}.`);const c=[1,1];T(hs(r,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${c}'`);const u=bo(i.shape,s,r,c,o),[d,h]=function p4e(n,t,e,i){let s=new l_(e,"max",!1);const r=i.runWebGLProgram(s,[n],"float32");return s=new l_(e,"max",!0,!0,t),[r,i.runWebGLProgram(s,[n],"float32")]}(i,a,u,l);return[d,h]}},b4e={kernelName:Bx,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:i}=n,{keepDims:s,axis:r}=t,o=e,a=i.shape.length,l=Tt(r,i.shape);let c=l;const u=ti(c,a),d=null!=u,h=o.shouldExecuteOnCPU([i]),f=[];let p=i;if(d){if(h){const v=o.texData.get(p.dataId).values,x=new Array(a);for(let k=0;k<x.length;k++)x[k]=i.shape[u[k]];const S=KP(v,i.shape,i.dtype,u,x);p=o.makeTensorInfo(x,i.dtype),o.texData.get(p.dataId).values=S}else p=Vw(i,u,o);f.push(p),c=xi(c.length,a)}fs("sum",c,a);const[g,m]=ts(p.shape,c);let b=g;s&&(b=vi(g,l));const _=function g4e(n,t,e,i){const s=te(t),a=Se({inputs:{x:n},attrs:{shape:[te(n.shape)/s,s]},backend:i}),l=Ed(a,"float32","mean",i),c=Se({inputs:{x:l},attrs:{shape:e},backend:i});return i.disposeIntermediateTensorInfo(a),i.disposeIntermediateTensorInfo(l),c}(p,m,b,o);for(const y of f)o.disposeIntermediateTensorInfo(y);return _}},y4e={kernelName:Vx,backendName:"webgl",kernelFunc:function _4e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i,a=s.shape.length,l=Tt(r,s.shape);let c=l;const u=ti(c,a);let d=s;null!=u&&(d=zs({inputs:{x:s},backend:e,attrs:{perm:u}}),c=xi(c.length,s.shape.length)),fs("min",c,a);const[h,f]=ts(d.shape,c),g=Se({inputs:{x:d},backend:e,attrs:{shape:[-1,te(f)]}}),m=Ed(g,g.dtype,"min",e);let b;return b=Se(o?{inputs:{x:m},backend:e,attrs:{shape:vi(h,l)}}:{inputs:{x:m},backend:e,attrs:{shape:h}}),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(m),null!=u&&e.disposeIntermediateTensorInfo(d),b}},C4e=ps({opSnippet:XP+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Id+"\n  return result;\n",cpuKernelImpl:FLe}),w4e={kernelName:Zg,backendName:"webgl",kernelFunc:C4e};class S4e{constructor(t,e,i){this.variableNames=["x"],this.outputShape=e.map((u,d)=>u[0]+t[d]+u[1]);const s=t.length,r=yn(s),o=e.map(u=>u[0]).join(","),a=e.map((u,d)=>u[0]+t[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),c="reflect"===i?0:1;this.userCode=1!==s?`\n      ${r} start = ${r}(${o});\n      ${r} end = ${r}(${a});\n\n      void main() {\n        ${r} outC = getOutputCoords();\n        for (int i = 0; i < ${s}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${c};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};\n          }\n        }\n        ${r} coords = outC - start;\n        setOutput(getX(${l}));\n      }\n    `:`\n        int start = ${o};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${c};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${c};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class I4e{constructor(t,e,i){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((p,g)=>p[0]+t[g]+p[1]);const s=t.length,r=yn(s),o=e.map(p=>p[0]).join(","),a=e.map((p,g)=>p[0]+t[g]).join(","),l=Vs("rc",s),c=Vs("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,d=1===s?"source":`vec2(${c.slice(-2).join()})`,h="reflect"===i?0:1;let f="";if(1===s){const p=`\n        ${r} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${h};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${h};\n        }\n        source -= start;\n      `;f=`\n        ${r} rc = outputLoc;\n        ${p}\n        result[0] = getChannel(getX(${c.join()}), ${d});\n        ${l[s-1]} += 1;\n        if(${u}) {\n          ${p}\n          result[1] = getChannel(getX(${c.join()}), ${d});\n        }\n      `}else{const p=`\n        ${r} source = rc;\n        ${r} lt = ${r}(lessThan(source, start));\n        ${r} gte = ${r}(greaterThanEqual(source, end));\n        ${r} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${h}) +\n                gte * ((end - 1) * 2 - source + ${h});\n        source -= start;\n      `;f=`\n        ${r} rc = outputLoc;\n        ${p}\n        result[0] = getChannel(getX(${c.join()}), ${d});\n        ${l[s-1]} += 1;\n        if(${u}) {\n          ${p}\n          result[1] = getChannel(getX(${c.join()}), ${d});\n        }\n        rc = outputLoc;\n        ${l[s-2]} += 1;\n        if(${l[s-2]} < ${this.outputShape[s-2]}) {\n          ${p}\n          result[2] = getChannel(getX(${c.join()}), ${d});\n          ${l[s-1]} += 1;\n          if(${u}) {\n            ${p}\n            result[3] = getChannel(getX(${c.join()}), ${d});\n          }\n        }\n      `}this.userCode=`\n      const ${r} start = ${r}(${o});\n      const ${r} end = ${r}(${a});\n\n      void main() {\n        ${r} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${f}\n        setOutput(result);\n      }\n    `}}const E4e={kernelName:zx,backendName:"webgl",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:i}=n,{paddings:s,mode:r}=e,o=J().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I4e(i.shape,s,r):new S4e(i.shape,s,r);return t.runWebGLProgram(o,[i],i.dtype)}},D4e=ps({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Id+"\n  return result;\n"}),N4e={kernelName:Qg,backendName:"webgl",kernelFunc:D4e};class A4e{constructor(t,e,i){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,i],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}}const Aq=ps({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),M4e={kernelName:Fg,backendName:"webgl",kernelFunc:Aq},Mq="return a - b;",Pq=ps({opSnippet:Mq,packedOpSnippet:Mq,supportsComplex:!0,cpuKernelImpl:i$e}),P4e={kernelName:pb,backendName:"webgl",kernelFunc:Pq};function Rq(n){const{inputs:t,backend:e,attrs:i}=n,{logits:s}=t,{dim:r}=i,o=Tt([r],s.shape),a=Nq({inputs:{x:s},backend:e,attrs:{reductionIndices:o,keepDims:!1}}),l=vi(a.shape,o),c=Se({inputs:{x:a},backend:e,attrs:{shape:l}}),u=Pq({inputs:{a:s,b:c},backend:e}),d=Sq({inputs:{x:u},backend:e}),h=zw({inputs:{x:d},backend:e,attrs:{axis:o,keepDims:!1}}),f=Se({inputs:{x:h},backend:e,attrs:{shape:l}}),p=Aq({inputs:{a:d,b:f},backend:e});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(f),p}const R4e={kernelName:rC,backendName:"webgl",kernelFunc:Rq},F4e={kernelName:xH,backendName:"webgl",kernelFunc:function O4e(n){const{inputs:t,backend:e,attrs:i}=n,{logits:s}=t,{numSamples:r,seed:o,normalized:a}=i,l=a?s:Rq({inputs:{logits:s},backend:e,attrs:{dim:s.shape.length-1}}),d=new A4e(l.shape[0],l.shape[1],r),f=e.runWebGLProgram(d,[l],"int32",[[o]]);return a||e.disposeIntermediateTensorInfo(l),f}},L4e=jr+"\n  return -x;\n",V4e={kernelName:Ux,backendName:"webgl",kernelFunc:function B4e(n){const{inputs:t,backend:e}=n,{x:i}=t;if(e.shouldExecuteOnCPU([i])){const r=e.texData.get(i.dataId),[o,a]=$Le(r.values,i.shape,i.dtype);return e.makeTensorInfo(a,i.dtype,o)}let s;return s=J().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Xc(i.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new qa(i.shape,L4e),e.runWebGLProgram(s,[i],i.dtype)}},z4e=QA,W4e={kernelName:EN,backendName:"webgl",kernelFunc:function U4e(n){Lr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:i}=n,{boxes:s,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=i,c=e.readSync(s.dataId),u=e.readSync(r.dataId),{selectedIndices:d}=z4e(c,u,o,a,l);return e.makeTensorInfo([d.length],"int32",new Int32Array(d))}},H4e=JA,G4e={kernelName:kN,backendName:"webgl",kernelFunc:function j4e(n){Lr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:i}=n,{boxes:s,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=i,u=e.readSync(s.dataId),d=e.readSync(r.dataId),{selectedIndices:h,validOutputs:f}=H4e(u,d,o,a,l,c);return[e.makeTensorInfo([h.length],"int32",new Int32Array(h)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}},q4e=eM,X4e={kernelName:TN,backendName:"webgl",kernelFunc:function K4e(n){Lr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:i}=n,{boxes:s,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=i,u=e.readSync(s.dataId),d=e.readSync(r.dataId),h=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:b}=q4e(u,d,h,f,p,g);return[e.makeTensorInfo([m.length],"int32",new Int32Array(m)),e.makeTensorInfo([b.length],"float32",new Float32Array(b))]}};class Y4e{constructor(t,e,i,s){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${s}), float(${i}),\n                      float(index == coords.y)));\n      }\n    `}}const Z4e={kernelName:jx,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:i}=n,{indices:s}=t,{dtype:r,depth:o,onValue:a,offValue:l}=i,c=te(s.shape),u=new Y4e(c,o,a,l),d=Se({inputs:{x:s},backend:e,attrs:{shape:[c]}}),h=e.runWebGLProgram(u,[d],r);e.disposeIntermediateTensorInfo(d);const p=Se({inputs:{x:h},backend:e,attrs:{shape:[...s.shape,o]}});return e.disposeIntermediateTensorInfo(h),p}};function qw(n){const{inputs:t,backend:e}=n,{x:i}=t;if("complex64"===i.dtype){const s=c_({inputs:{input:i},backend:e}),r=qw({inputs:{x:s},backend:e}),o=jw({inputs:{input:i},backend:e}),a=qw({inputs:{x:o},backend:e}),l=Yc({inputs:{real:r,imag:a},backend:e});return e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),l}return d_({attrs:{shape:i.shape,dtype:i.dtype,value:"string"===i.dtype?"":0},backend:e})}const Q4e={kernelName:cC,backendName:"webgl",kernelFunc:qw},J4e={kernelName:Hx,backendName:"webgl",kernelFunc:function Oq(n){const{inputs:t,backend:e}=n,{x:i}=t;if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===i.dtype){const s=c_({inputs:{input:i},backend:e}),r=Oq({inputs:{x:s},backend:e}),o=jw({inputs:{input:i},backend:e}),a=qw({inputs:{x:o},backend:e}),l=Yc({inputs:{real:r,imag:a},backend:e});return e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),l}return d_({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:e})}},tUe={kernelName:Gx,backendName:"webgl",kernelFunc:function eUe(n){const{inputs:t,backend:e,attrs:i}=n,{axis:s}=i;if(1===t.length)return e2({inputs:{input:t[0]},backend:e,attrs:{dim:s}});const r=t[0].shape,o=t[0].dtype;t.forEach(u=>{po(r,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],c=fq({inputs:t.map(u=>{const d=e2({inputs:{input:u},backend:e,attrs:{dim:s}});return a.push(d),d}),backend:e,attrs:{axis:s}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}};class nUe{constructor(t,e,i){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((c,u)=>c[0]+t[u]+c[1]);const s=t.length,r=yn(s),o=e.map(c=>c[0]).join(","),a=e.map((c,u)=>c[0]+t[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);this.userCode=1!==s?`\n      ${r} start = ${r}(${o});\n      ${r} end = ${r}(${a});\n\n      void main() {\n        ${r} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${r} coords = outC - start;\n          setOutput(getX(${l}));\n        }\n      }\n    `:`\n        int start = ${o};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class iUe{constructor(t,e,i){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((g,m)=>g[0]+t[m]+g[1]);const s=t.length,r=yn(s),o=e.map(g=>g[0]).join(","),a=e.map((g,m)=>g[0]+t[m]).join(","),l=Vs("rc",s),c=Vs("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,d=1===s?"source":`vec2(${c.slice(-2).join()})`,h=[`${r} rc = outputLoc;`,`${l[s-1]} += 1;\n       if(${u}) {\n      `,1===s?"":`}\n       rc = outputLoc;\n       ${l[s-2]} += 1;\n       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,1===s?"":`  ${l[s-1]} += 1;\n         if(${u}) {`],f=1===s?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,m=1===s?2:4;g<m;g++)p+=`\n        ${h[g]}\n        if (${f}) {\n          result[${g}] = float(value);\n        } else {\n          ${r} source = rc - start;\n          result[${g}] = getChannel(getX(${c.join()}), ${d});\n        }\n      `;p+=1===s?"} ":"}}",this.userCode=`\n      const ${r} start = ${r}(${o});\n      const ${r} end = ${r}(${a});\n\n      void main() {\n        ${r} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}const Fq=n=>{const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{paddings:r,constantValue:o}=i;if(0===te(s.shape))return d_({backend:e,attrs:{shape:r.map((u,d)=>u[0]+s.shape[d]+u[1]),value:o,dtype:s.dtype}});const a=J().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new iUe(s.shape,r,o):new nUe(s.shape,r,o);return e.runWebGLProgram(a,[s],s.dtype,[[o]])},sUe={kernelName:qx,backendName:"webgl",kernelFunc:Fq},aUe=ps({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Id+"\n  return result;\n"}),lUe={kernelName:eb,backendName:"webgl",kernelFunc:aUe},uUe={kernelName:Xx,backendName:"webgl",kernelFunc:function cUe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{axis:r,keepDims:o}=i,a=s.shape.length,l=[],c=Tt(r,s.shape);let u=c;const d=ti(u,a);let f,h=s;if(null!=d&&(h=zs({inputs:{x:s},backend:e,attrs:{perm:d}}),u=xi(u.length,a),l.push(h)),fs("prod",u,a),e.shouldExecuteOnCPU([h])){const p=e.texData.get(h.dataId).values,{outVals:g,outShape:m,outDtype:b}=VLe(h.shape,h.dtype,p,u);f=e.makeTensorInfo(m,b,g)}else{const[p,g]=ts(h.shape,u),m=te(g),b=Se({inputs:{x:h},backend:e,attrs:{shape:[-1,m]}}),y=Ed(b,ZN(s.dtype),"prod",e);f=Se({inputs:{x:y},backend:e,attrs:{shape:p}}),l.push(b),l.push(y)}if(o){l.push(f);const p=vi(f.shape,c);f=Se({inputs:{x:f},backend:e,attrs:{shape:p}})}return l.forEach(p=>e.disposeIntermediateTensorInfo(p)),f}},hUe={kernelName:CH,backendName:"webgl",kernelFunc:function dUe(n){const{inputs:t,backend:e,attrs:i}=n,{paramsNestedSplits:s,paramsDenseValues:r,indices:o}=t,{outputRaggedRank:a}=i,l=s.map(b=>e.readSync(b.dataId)),c=s.map(b=>b.shape),u=e.readSync(r.dataId),d=e.readSync(o.dataId),[h,f,p]=zLe(l,c,u,r.shape,r.dtype,d,o.shape,a),g=h.map(b=>e.makeTensorInfo([b.length],"int32",b)),m=e.makeTensorInfo(p,r.dtype,f);return g.concat([m])}},pUe={kernelName:wH,backendName:"webgl",kernelFunc:function fUe(n){const{inputs:t,backend:e}=n,{starts:i,limits:s,deltas:r}=t,o=e.readSync(i.dataId),a=e.readSync(s.dataId),l=e.readSync(r.dataId),[c,u]=ULe(o,i.shape,i.dtype,a,s.shape,l,r.shape);return[e.makeTensorInfo([c.length],"int32",c),e.makeTensorInfo([u.length],i.dtype,u)]}},gUe={kernelName:SH,backendName:"webgl",kernelFunc:function mUe(n){const{inputs:t,backend:e,attrs:i}=n,{shape:s,values:r,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=i,c=e.readSync(s.dataId),u=e.readSync(r.dataId),d=e.readSync(o.dataId),h=a.map(m=>e.readSync(m.dataId)),f=a.map(m=>m.shape),[p,g]=WLe(c,s.shape,u,r.shape,r.dtype,d,o.shape,h,f,l);return e.makeTensorInfo(p,r.dtype,g)}},Lq=n=>{const{backend:t,attrs:e}=n,{start:i,stop:s,step:r,dtype:o}=e,a=HLe(i,s,r,o);return t.makeTensorInfo([a.length],o,a)},bUe={kernelName:DN,backendName:"webgl",kernelFunc:Lq},_Ue=Gt({opSnippet:"return 1.0 / x;"}),yUe={kernelName:tb,backendName:"webgl",kernelFunc:_Ue},xUe=Gt({opSnippet:jr+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),CUe={kernelName:nb,backendName:"webgl",kernelFunc:xUe},SUe=Gt({opSnippet:jr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),IUe={kernelName:ib,backendName:"webgl",kernelFunc:SUe};class EUe{constructor(t,e,i,s,r){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,e,i,c];const u=[s&&e>1?a-1:a,s&&i>1?l-1:l],d=[s&&e>1?e-1:e,s&&i>1?i-1:i];let h;h=r?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/d[0]},\n          ${u[1]/d[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class kUe{constructor(t,e,i,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,e,i,c];const u=[s&&e>1?a-1:a,s&&i>1?l-1:l],d=[s&&e>1?e-1:e,s&&i>1?i-1:i];let h;h=r?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/d[0]},\n          ${u[1]/d[1]},\n          ${u[1]/d[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,\n                                     ${l}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${c-1};\n        bool hasNextRow = coords.z < ${i-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const DUe={kernelName:Qx,backendName:"webgl",kernelFunc:function TUe(n){const{inputs:t,backend:e,attrs:i}=n,{images:s}=t,{alignCorners:r,halfPixelCenters:o,size:a}=i,[l,c]=a,u=J().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kUe(s.shape,l,c,r,o):new EUe(s.shape,l,c,r,o);return e.runWebGLProgram(u,[s],"float32")}};class NUe{constructor(t,e,i){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,s,r]=e,[,o,a]=t,l=[i&&o>1?s-1:s,i&&a>1?r-1:r],c=[i&&o>1?o-1:o,i&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=2*Math.ceil(h)+2,g=2*Math.ceil(f)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${d});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${f});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${g});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${r-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const MUe={kernelName:MN,backendName:"webgl",kernelFunc:function AUe(n){const{inputs:t,backend:e,attrs:i}=n,{images:s,dy:r}=t,{alignCorners:o}=i,a=new NUe(r.shape,s.shape,o);return e.runWebGLProgram(a,[r],r.dtype)}};class PUe{constructor(t,e,i,s,r){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,e,i,c];const u=[s&&e>1?a-1:a,s&&i>1?l-1:l],d=[s&&e>1?e-1:e,s&&i>1?i-1:i];let f;f=r?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/d[0]},\n          ${u[1]/d[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${f};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${s?"0.5":"0.0"})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class RUe{constructor(t,e,i,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,e,i,c];const u=[s&&e>1?a-1:a,s&&i>1?l-1:l],d=[s&&e>1?e-1:e,s&&i>1?i-1:i];let f;f=r?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/d[0]},\n          ${u[1]/d[1]},\n          ${u[1]/d[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,\n                                     ${l}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${f};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${s?"0.5":"0.0"})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${c-1};\n        bool hasNextRow = coords.z < ${i-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}const FUe={kernelName:Zx,backendName:"webgl",kernelFunc:function OUe(n){const{inputs:t,backend:e,attrs:i}=n,{images:s}=t,{alignCorners:r,halfPixelCenters:o,size:a}=i,[l,c]=a,u=J().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new RUe(s.shape,l,c,r,o):new PUe(s.shape,l,c,r,o);return e.runWebGLProgram(u,[s],s.dtype)}};class LUe{constructor(t,e,i){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,s,r]=e,[,o,a]=t,l=[i&&o>1?s-1:s,i&&a>1?r-1:r],c=[i&&o>1?o-1:o,i&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=2*Math.ceil(h)+2,g=2*Math.ceil(f)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${d});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${f});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${g});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${l[0]}) *\n                (float(dyR) / float(${c[0]}));\n\n            float sourceFracCol =\n                float(${l[1]}) *\n                  (float(dyC) / float(${c[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${s}) - 1),\n                ${i} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${r}) - 1),\n                ${i} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const BUe={kernelName:AN,backendName:"webgl",kernelFunc:function $Ue(n){const{inputs:t,backend:e,attrs:i}=n,{images:s,dy:r}=t,{alignCorners:o}=i,a=new LUe(r.shape,s.shape,o);return e.runWebGLProgram(a,[r],r.dtype)}};class VUe{constructor(t,e){this.variableNames=["x"];const i=t.length;if(i>4)throw new Error(`WebGL backend: Reverse of rank-${i} tensor is not yet supported`);if(this.outputShape=t,1===i)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const r=t.map((a,l)=>(a=>-1!==e.indexOf(a)&&1!==t[a]?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`)(l)).join(","),o=yn(i);this.userCode=`\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}class zUe{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const i=t.length;if(i>4)throw new Error(`WebGL backend: Reverse of rank-${i} tensor is not yet supported`);this.outputShape=t;const s=Vs("rc",i),r=`${s[i-1]} + 1 < ${this.outputShape[i-1]}`,o=`${s[i-2]} + 1 < ${this.outputShape[i-2]}`,a=yn(i);function h(p){const g=t.map((_,y)=>function f(p,g){return-1!==e.indexOf(p)&&1!==t[p]?`${t[p]} - ${g[p]} - 1`:`${g[p]}`}(y,p));return`getChannel(getX(${g.join(",")}), vec2(${g.slice(-2).join(",")}))`}this.userCode=1===i?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${r}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${a} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function l(p){return h(p)}(s.slice())};\n          if(${r}){\n            result.g = ${function c(p){return p[i-1]="("+p[i-1]+" + 1)",h(p)}(s.slice())};\n          }\n          if(${o}) {\n            result.b = ${function u(p){return p[i-2]="("+p[i-2]+" + 1)",h(p)}(s.slice())};\n            if(${r}) {\n              result.a = ${function d(p){return p[i-1]="("+p[i-1]+" + 1)",p[i-2]="("+p[i-2]+" + 1)",h(p)}(s.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const WUe={kernelName:Jx,backendName:"webgl",kernelFunc:function UUe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{dims:r}=i,o=s.shape.length,a=Tt(r,s.shape);if(0===o)return vr({inputs:{x:s},backend:e});const l=J().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zUe(s.shape,a):new VUe(s.shape,a);return e.runWebGLProgram(l,[s],s.dtype)}};class HUe{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const i=t[1],s=t[2];this.outputShape=t;let r="";r="number"==typeof e?`float outputValue = ${e.toFixed(2)};`:`\n        vec3 fill = vec3(${e.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${r}\n          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${i}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const jUe={kernelName:jN,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:i}=n,{radians:s,fillValue:r,center:o}=t,a=e,l=new HUe(i.shape,r),[c,u]=aM(o,i.shape[1],i.shape[2]),d=[[c,u,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[i],i.dtype,d)}},GUe=Gt({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),qUe={kernelName:sb,backendName:"webgl",kernelFunc:GUe},KUe=Gt({opSnippet:"return inversesqrt(x);",cpuKernelImpl:jLe}),XUe={kernelName:rb,backendName:"webgl",kernelFunc:KUe};class n2{constructor(t,e,i,s,r,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=yn(r.length),u=yn(o.length);let d="";1===i?d="i":2===i&&(d="i, j");let f="";1===s?f="i":2===s&&(f="i, coords[1]");let g="";l&&(g="coords[0], coords[1]"),this.userCode=`\n        ${c} strides = ${c}(${r});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(getIndices(${d}));\n              flattenedIndex += index * ${e>1?"strides[j]":"strides"};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates(${f});\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(${g}), sum, float(found)));\n        }\n      `}}class YUe{constructor(t,e,i,s,r,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=yn(r.length),u=yn(o.length);let d="";1===i?d="i":2===i&&(d="i, j");let f="";1===s?f="i":2===s&&(f="i, coords[1]");let g="";l&&(g="coords[0], coords[1]"),this.userCode=`\n        ${c} strides = ${c}(${r});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${t}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${e}; j+=2) {\n              ivec4 index = round(getIndices(${d}));\n              flattenedIndex += index.xz * ${e>1?"strides[j]":"strides"};\n              if (j + 1 < ${e}) {\n                flattenedIndex += index.yw * ${e>1?"strides[j + 1]":"strides"};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = getUpdates(${f});\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(getDefaultValue(${g}), sum, found));\n        }\n      `}}const QUe={kernelName:IH,backendName:"webgl",kernelFunc:function ZUe(n){const{inputs:t,backend:e,attrs:i}=n,{indices:s,updates:r}=t,{shape:o}=i,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=dd(0,s,o),h=[d/c,c];if(0===d)return e.makeTensorInfo(o,s.dtype);const f=Se({inputs:{x:s},backend:e,attrs:{shape:[l,a]}}),p=Se({inputs:{x:r},backend:e,attrs:{shape:[l,c]}}),g=e.makeTensorInfo([],"float32",new Float32Array([0]));let m;m=J().getBool("WEBGL_PACK")?new YUe(l,a,f.shape.length,p.shape.length,u,h):new n2(l,a,f.shape.length,p.shape.length,u,h);const b=e.runWebGLProgram(m,[p,f,g],p.dtype),_=Se({inputs:{x:b},backend:e,attrs:{shape:o}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(g),_}};class JUe{constructor(t,e,i,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,i];const o=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,a=2===J().getNumber("WEBGL_VERSION")?"while (left < right) {":o;this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${a}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${"left"===s?"<":"<="} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}const t5e={kernelName:kH,backendName:"webgl",kernelFunc:function e5e(n){const{inputs:t,backend:e,attrs:i}=n,{sortedSequence:s,values:r}=t,{side:o}=i,a=new JUe(s.shape[0],s.shape[1],r.shape[1],o);return e.runWebGLProgram(a,[s,r],"int32",[[s.shape[1]]])}};class n5e{constructor(t,e,i){let s,r;if(this.variableNames=["c","a","b"],this.outputShape=e,i>4)throw Error(`Where for rank ${i} is not yet supported`);if(1===i)r="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<e.length;u++)c.push(`${a[u]}`),u<t&&l.push(`${a[u]}`);s=l.join(),r=c.join()}const o=yn(i);this.userCode=`\n      void main() {\n        ${o} resRC = getOutputCoords();\n        float cVal = getC(${s});\n        if (cVal >= 1.0) {\n          setOutput(getA(${r}));\n        } else {\n          setOutput(getB(${r}));\n        }\n      }\n    `}}const s5e={kernelName:eC,backendName:"webgl",kernelFunc:function i5e(n){const{inputs:t,backend:e}=n,{condition:i,t:s,e:r}=t,o=new n5e(i.shape.length,s.shape,s.shape.length);return e.runWebGLProgram(o,[i,s,r],br(s.dtype,r.dtype))}},o5e=Gt({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${HC};\n  float scale = ${jC};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),a5e={kernelName:ob,backendName:"webgl",kernelFunc:o5e},c5e=Gt({opSnippet:rp+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:qLe}),u5e={kernelName:ub,backendName:"webgl",kernelFunc:c5e},d5e=Gt({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),h5e={kernelName:cb,backendName:"webgl",kernelFunc:d5e},m5e=Gt({opSnippet:rp+"\n  return sin(x);\n",packedOpSnippet:`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${Id}\n  return result;\n`}),g5e={kernelName:ab,backendName:"webgl",kernelFunc:m5e},b5e=Gt({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),_5e={kernelName:lb,backendName:"webgl",kernelFunc:b5e},y5e=Gt({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),v5e={kernelName:db,backendName:"webgl",kernelFunc:y5e},x5e={kernelName:iC,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{blockShape:r,paddings:o}=i;T(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((b,_)=>b*_),l=[[0,0]];l.push(...o);for(let b=1+r.length;b<s.shape.length;++b)l.push([0,0]);const c=[],u=Fq({inputs:{x:s},backend:e,attrs:{paddings:l,constantValue:0}}),d=$b(u.shape,r,a,!1),h=Bb(d.length,r.length,!1),f=Vb(u.shape,r,a,!1),p=Se({inputs:{x:u},backend:e,attrs:{shape:d}}),g=zs({inputs:{x:p},backend:e,attrs:{perm:h}}),m=Se({inputs:{x:g},backend:e,attrs:{shape:f}});return c.push(u),c.push(p),c.push(g),c.forEach(b=>e.disposeIntermediateTensorInfo(b)),m}},w5e={kernelName:PN,backendName:"webgl",kernelFunc:function C5e(n){const{inputs:t,backend:e}=n,{indices:i,values:s,denseShape:r,defaultValue:o}=t;if(1!==r.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${r.shape}`);if(2!==i.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${i.shape}`);if(1!==s.shape.length)throw new Error(`Values must be a vector, saw:\n         ${s.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const a=e.readSync(i.dataId),l=e.readSync(s.dataId),c=e.readSync(r.dataId),u=e.readSync(o.dataId)[0],[d,h,f,p,g]=XLe(a,i.shape,i.dtype,l,s.dtype,c,u);return[e.makeTensorInfo(h,i.dtype,d),e.makeTensorInfo([h[0]],s.dtype,f),e.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),e.makeTensorInfo([g.length],i.dtype,new Int32Array(g))]}},I5e={kernelName:RN,backendName:"webgl",kernelFunc:function S5e(n){const{inputs:t,backend:e}=n,{inputIndices:i,inputShape:s,newShape:r}=t;if(2!==i.shape.length)throw new Error(`Input indices should be a matrix but received shape ${i.shape}`);if(1!==s.shape.length)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(1!==r.shape.length)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const o=Array.from(e.readSync(s.dataId)),a=e.readSync(i.dataId),l=Array.from(e.readSync(r.dataId)),[c,u,d]=YLe(a,i.shape,i.dtype,o,l);return[e.makeTensorInfo(u,i.dtype,c),e.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}},k5e={kernelName:ON,backendName:"webgl",kernelFunc:function E5e(n){const{inputs:t,backend:e}=n,{data:i,indices:s,segmentIds:r}=t;if(i.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${s.shape}`);if(1!==r.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${r.shape}`);const o=e.readSync(i.dataId),a=e.readSync(s.dataId),l=e.readSync(r.dataId),[c,u]=U9(o,i.shape,i.dtype,a,l,!0);return e.makeTensorInfo(u,i.dtype,c)}},D5e={kernelName:FN,backendName:"webgl",kernelFunc:function T5e(n){const{inputs:t,backend:e}=n,{data:i,indices:s,segmentIds:r}=t;if(i.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${s.shape}`);if(1!==r.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${r.shape}`);const o=e.readSync(i.dataId),a=e.readSync(s.dataId),l=e.readSync(r.dataId),[c,u]=U9(o,i.shape,i.dtype,a,l);return e.makeTensorInfo(u,i.dtype,c)}},A5e={kernelName:TH,backendName:"webgl",kernelFunc:function N5e(n){const{inputs:t,backend:e,attrs:i}=n,{sparseIndices:s,sparseValues:r,defaultValue:o}=t,{outputShape:a}=i,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=dd(0,s,a);if("string"===r.dtype){const b=e.bufferSync(s),_=e.bufferSync(r),y=Dc(e.readSync(o.dataId)[0]),v=GLe(b,_,a,h,u,c,l,d,y,!1);return e.makeTensorInfo(a,v.dtype,v.values)}const p=new n2(c,l,s.shape.length,r.shape.length,d,[h,1],!1),g=e.runWebGLProgram(p,[r,s,o],r.dtype),m=Se({inputs:{x:g},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(g),m}},P5e={kernelName:sC,backendName:"webgl",kernelFunc:function M5e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{numOrSizeSplits:r,axis:o}=i,a=Tt(o,s.shape)[0],l=SM(s,r,a),u=new Array(s.shape.length).fill(0),d=s.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=op({inputs:{x:s},backend:e,attrs:{begin:u,size:f}});return u[a]+=h,p})}},$q="return sqrt(x);",R5e=Gt({opSnippet:$q,packedOpSnippet:$q,cpuKernelImpl:ZLe}),O5e={kernelName:hb,backendName:"webgl",kernelFunc:R5e},L5e={kernelName:LN,backendName:"webgl",kernelFunc:Gt({opSnippet:"return x * x;"})},Bq="return (a - b) * (a - b);",$5e=ps({opSnippet:Bq,packedOpSnippet:Bq}),B5e={kernelName:fb,backendName:"webgl",kernelFunc:$5e},z5e={kernelName:oC,backendName:"webgl",kernelFunc:function V5e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");const o=Rl(e.readSync(s.dataId)),a=QLe(o,"string",i);return e.makeTensorInfo(s.shape,"string",a)}},W5e={kernelName:_b,backendName:"webgl",kernelFunc:function U5e({inputs:n,attrs:t,backend:e}){const{x:i}=n,r=new qa(i.shape,jr+`\n    return x > 0.0 ? 1.0 : float(${t.alpha});\n  `);return e.runWebGLProgram(r,[i],i.dtype)}};class H5e{constructor(t,e,i){this.variableNames=["x"],this.outputShape=i;const s=i.length,r=yn(i.length),o=yn(i.length);let a="";if(1===s)a="coords * strides + begin";else{let l=0;a=i.map((c,u)=>(l++,1===i.length?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`\n      ${r} begin = ${r}(${t});\n      ${r} strides = ${r}(${e});\n\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${a}));\n      }\n    `}}const G5e={kernelName:$N,backendName:"webgl",kernelFunc:function j5e(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{begin:r,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=i,{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:b,begin:_,end:y,strides:v}=kA(s.shape,r,o,a,l,c,u,d,h);let x;if(g)x=Se({inputs:{x:s},backend:e,attrs:{shape:p}});else if(m||b){T(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const E=SA(_,y,v),k=op({inputs:{x:s},backend:e,attrs:{begin:_,size:E}});x=Se({inputs:{x:k},backend:e,attrs:{shape:p}}),e.disposeIntermediateTensorInfo(k)}else if(e.shouldExecuteOnCPU([s])){const k=e.readSync(s.dataId),D=Dt(s.shape,s.dtype,k),M=JLe(f,D,v,_);x=e.makeTensorInfo(p,s.dtype,M.values)}else{const k=new H5e(_,v,f);x=e.runWebGLProgram(k,[s],s.dtype)}const S=Se({inputs:{x},backend:e,attrs:{shape:p}});return e.disposeIntermediateTensorInfo(x),S}},K5e={kernelName:BN,backendName:"webgl",kernelFunc:function q5e(n){const{inputs:t,backend:e,attrs:i}=n,{separator:s,nGramWidths:r,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=i,{data:u,dataSplits:d}=t,h=e.readSync(u.dataId),f=e.readSync(d.dataId),[p,g]=e$e(h,f,s,r,o,a,l,c);return[e.makeTensorInfo([p.length],"string",p),e.makeTensorInfo(d.shape,"int32",g)]}},Y5e={kernelName:VN,backendName:"webgl",kernelFunc:function X5e(n){const{inputs:t,backend:e,attrs:i}=n,{skipEmpty:s}=i,{input:r,delimiter:o}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(1!==r.shape.length)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=e.readSync(r.dataId),l=e.readSync(o.dataId)[0],[c,u,d]=t$e(a,l,s),h=u.length;return[e.makeTensorInfo([h,2],"int32",c),e.makeTensorInfo([h],"string",u),e.makeTensorInfo([2],"int32",new Int32Array(d))]}},Q5e={kernelName:zN,backendName:"webgl",kernelFunc:function Z5e(n){const{inputs:t,backend:e,attrs:i}=n,{numBuckets:s}=i,{input:r}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=e.readSync(r.dataId),a=n$e(o,s);return e.makeTensorInfo(r.shape,"int32",a)}},J5e=Gt({opSnippet:"return tan(x);"}),eWe={kernelName:mb,backendName:"webgl",kernelFunc:J5e},tWe=Gt({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),nWe={kernelName:gb,backendName:"webgl",kernelFunc:tWe},sWe={kernelName:EH,backendName:"webgl",kernelFunc:function iWe(n){const{inputs:t,backend:e}=n,{tensor:s,indices:r,updates:o}=t,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=dd(0,r,s.shape),h=[d/c,c];if(0===d)return e.makeTensorInfo(s.shape,r.dtype);const f=Se({inputs:{x:r},backend:e,attrs:{shape:[l,a]}}),p=Se({inputs:{x:o},backend:e,attrs:{shape:[l,c]}}),g=Se({inputs:{x:s},backend:e,attrs:{shape:h}}),m=new n2(l,a,f.shape.length,p.shape.length,u,h,!1,!0),b=e.runWebGLProgram(m,[p,f,g],g.dtype),_=Se({inputs:{x:b},backend:e,attrs:{shape:s.shape}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(b),_}};class rWe{constructor(t,e){this.variableNames=["A"];const i=new Array(t.length);for(let o=0;o<i.length;o++)i[o]=t[o]*e[o];this.outputShape=i,this.rank=i.length;const s=yn(this.rank),r=function oWe(n){const t=n.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${n[0]})`;const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],i=[];for(let s=0;s<n.length;s++)i.push(`imod(${e[s]}, ${n[s]})`);return i.join()}(t);this.userCode=`\n      void main() {\n        ${s} resRC = getOutputCoords();\n        setOutput(getA(${r}));\n      }\n    `}}function Vq(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{reps:r}=i;if("string"===s.dtype||s.shape.length>5){const l=e.readSync(s.dataId),c="string"===s.dtype?l.map(h=>Dc(h)):l,u=Dt(s.shape,s.dtype,c),d=s$e(u,r);return e.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new rWe(s.shape,r);return e.runWebGLProgram(o,[s],s.dtype)}const aWe={kernelName:bb,backendName:"webgl",kernelFunc:Vq};class lWe{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class cWe{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function kd(n,t){null!==t&&n.disposeIntermediateTensorInfo(t)}function zq(n){let t=1;for(;t<n;)t*=2;return t}const dWe={kernelName:UN,backendName:"webgl",kernelFunc:function uWe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s}=t,{k:r,sorted:o}=i,a=J().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=J().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=s.shape,u=c[c.length-1];if(e.shouldExecuteOnCPU([s])||u<a||r>l){const M=e.readSync(s.dataId),[R,U]=r$e(M,c,s.dtype,r,o);return[e.makeTensorInfo(R.shape,R.dtype,R.values),e.makeTensorInfo(U.shape,U.dtype,U.values)]}if(0===r)return c[c.length-1]=0,[e.makeTensorInfo(c,s.dtype,[]),e.makeTensorInfo(c,"int32",[])];if(1===u)return[s,d_({attrs:{shape:c,dtype:"int32",value:0},backend:e})];const d=e.texData.get(s.dataId),h=null!==d&&d.isPacked,f=h?e.unpackTensor(s):s,g=te(c)/u,m=Se({inputs:{x:f},attrs:{shape:[g,u]},backend:e});h&&kd(e,f);const b=zq(r),_=zq(u);let y=null;const v=()=>null===y?[m,m]:[m,y],x=(M,R,U)=>{const X=v(),ee=new lWe(U),z=y;y=e.runWebGLProgram(ee,X,"int32",[[u],[null===y?1:0],[Number.NEGATIVE_INFINITY],[M],[R]]),kd(e,z)};for(let M=1;M<b;M*=2){const R=2*M;for(let U=M;U>=1;U/=2)x(R,U,[g,_])}for(let M=_;M>b;M/=2){const R=v(),U=new cWe([g,M/2]),K=y;y=e.runWebGLProgram(U,R,"int32",[[u],[null===y?1:0],[b]]),kd(e,K);const O=b/2,z=2*O;for(let B=O;B>=1;B/=2)x(z,B,y.shape)}let S=y;y=op({inputs:{x:y},backend:e,attrs:{begin:0,size:[g,r]}}),kd(e,S);let E=Dq({inputs:{x:m,indices:y},backend:e,attrs:{axis:1,batchDims:1}});kd(e,m);const k=c.slice(0,-1);k.push(r),S=y,y=Se({inputs:{x:y},attrs:{shape:k},backend:e}),kd(e,S);const D=E;return E=Se({inputs:{x:E},attrs:{shape:k},backend:e}),kd(e,D),[E,y]}};class hWe{constructor(t,e,i,s,r,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a="nearest"===i?1:2;let l;switch(s){case"constant":default:l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${l} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${l} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${l} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${r});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${r});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${e}));\n                float mapY = mapCoord(inY, float(${t}));\n\n                if (${a} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}const pWe={kernelName:WN,backendName:"webgl",kernelFunc:function fWe(n){const{inputs:t,backend:e,attrs:i}=n,{image:s,transforms:r}=t,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=i,[u,d,h,f]=s.shape,[p,g]=c??[d,h],b=new hWe(d,h,o,a,l,[u,p,g,f]);return e.runWebGLProgram(b,[s,r],"float32")}},gWe={kernelName:HN,backendName:"webgl",kernelFunc:function mWe(n){const{inputs:t,attrs:e,backend:i}=n,{axis:s}=e,{x:r}=t;r_(r,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=i.readSync(r.dataId),{outputValues:a,outputShape:l,indices:c}=o$e(o,s,r.shape,r.dtype);return[i.makeTensorInfo(l,r.dtype,a),i.makeTensorInfo([c.length],"int32",c)]}},_We={kernelName:aC,backendName:"webgl",kernelFunc:function bWe(n){const{inputs:t,backend:e,attrs:i}=n,{value:s}=t;let{axis:r}=i;r<0&&(r+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[r],c=new Array(a-1);let u=0;for(let g=0;g<a;g++)g!==r&&(c[u++]=o.shape[g]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[r]=1;const p=new Array(l);for(let g=0;g<p.length;g++){h[r]=g;const m=op({inputs:{x:o},backend:e,attrs:{begin:h,size:f}}),b=Se({inputs:{x:m},backend:e,attrs:{shape:c}});p[g]=b,d.push(m)}return d.forEach(g=>e.disposeIntermediateTensorInfo(g)),p}};class yWe{constructor(t,e){this.variableNames=["x","segmentIds"];const i=t.windowSize,s=t.batchSize,r=t.inSize,o=t.numSegments,a=o*Math.ceil(r/i);this.outputShape=[s,a];const u=4*Math.floor(i/4),d=i%4,h="\n        sumValue += dot(values, segFilter);\n    ";let f="";r%i>0&&(f=`\n        if (inIdx < 0 || inIdx >= ${r}) {\n          return initializationValue;\n        }\n      `);let p="";r%i>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${r}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${f}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${p}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${o})) * float(${i}));\n        int currentSeg = int(mod(float(outIdx), float(${o})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===d}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${h}\n        } else if (${2===d}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${h}\n        } else if (${3===d}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${h}\n        }\n        setOutput(sumValue);\n      }\n    `}}const CWe=[eBe,nBe,rBe,lBe,uBe,fBe,mBe,bBe,xBe,wBe,EBe,DBe,MBe,FBe,BBe,zBe,WBe,qBe,XBe,ZBe,e3e,o3e,l3e,h3e,p3e,y3e,x3e,I3e,L$e,T3e,P3e,L3e,W3e,G3e,K3e,Y3e,Q3e,nVe,sVe,oVe,lVe,uVe,hVe,mVe,bVe,xVe,wVe,EVe,DVe,AVe,PVe,FVe,$Ve,zVe,WVe,HVe,GVe,KVe,YVe,QVe,eze,nze,rze,lze,uze,fze,gze,_ze,vze,F$e,Cze,A3e,Sze,Eze,Tze,B$e,Nze,Mze,Rze,Lze,Vze,Uze,Hze,Gze,Xze,Zze,Jze,i4e,r4e,a4e,d4e,f4e,m4e,b4e,y4e,w4e,E4e,N4e,F4e,U$e,V4e,W4e,G4e,X4e,m3e,Z4e,J4e,tUe,sUe,lUe,z$e,uUe,hUe,pUe,gUe,bUe,g3e,M4e,yUe,CUe,IUe,H$e,DUe,MUe,FUe,BUe,WUe,jUe,qUe,XUe,QUe,t5e,s5e,a5e,u5e,h5e,g5e,_5e,r3e,R4e,v5e,x5e,w5e,I5e,k5e,D5e,A5e,P5e,O5e,L5e,B5e,z5e,W5e,G5e,K5e,Y5e,Q5e,P4e,Z$e,eWe,nWe,sWe,aWe,dWe,pWe,Q$e,gWe,_We,{kernelName:lC,backendName:"webgl",kernelFunc:function vWe(n){const{inputs:t,backend:e,attrs:i}=n,{x:s,segmentIds:r}=t,{numSegments:o}=i,a=s.shape.length,l=[];let c=0;const u=ti([c],a);let d=s;null!=u&&(d=zs({inputs:{x:s},backend:e,attrs:{perm:u}}),l.push(d),c=xi(1,a)[0]);const h=BG(d.shape,c,o),f=te([d.shape[c]]),p=Se({inputs:{x:d},backend:e,attrs:{shape:[-1,f]}});l.push(p);const g=ZN(s.dtype),m=(v,x,S,E,k)=>{const D=v.shape[0],M=v.shape[1],R=$G(M,k),X=new yWe({windowSize:R,inSize:M,batchSize:D,numSegments:k},x),ee=e.compileAndRun(X,[v,S],E);if(l.push(ee),ee.shape[1]===k)return ee;const K=Lq({backend:e,attrs:{start:0,stop:k,step:1,dtype:"float32"}}),O=Vq({inputs:{x:K},backend:e,attrs:{reps:[M/R]}});return l.push(K),l.push(O),m(ee,x,O,E,k)},_=Se({inputs:{x:m(p,"unsortedSegmentSum",r,g,o)},backend:e,attrs:{shape:h}});let y=_;if(null!=u){l.push(_);const v=Fc(u);y=zs({inputs:{x:y},backend:e,attrs:{perm:v}})}return l.forEach(v=>e.disposeIntermediateTensorInfo(v)),y}},Q4e];for(const n of CWe)qN(n);const h_={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:i}=h_;i&&(t=i.requestAnimationFrame,e=i.cancelAnimationFrame);const s=t(r=>{e=void 0,n(r)});return new G(()=>e?.(s))},requestAnimationFrame(...n){const{delegate:t}=h_;return(t?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=h_;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},Wq=new class AWe extends Wk{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;t=t||i.shift();do{if(s=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,s){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw s}}}(class NWe extends Uk{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=h_.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:r}=t;null!=e&&(null===(s=r[r.length-1])||void 0===s?void 0:s.id)!==e&&(h_.cancelAnimationFrame(e),t._scheduled=void 0)}});let r2,MWe=1;const Kw={};function Hq(n){return n in Kw&&(delete Kw[n],!0)}const PWe={setImmediate(n){const t=MWe++;return Kw[t]=!0,r2||(r2=Promise.resolve()),r2.then(()=>Hq(t)&&n()),t},clearImmediate(n){Hq(n)}},{setImmediate:RWe,clearImmediate:OWe}=PWe,Xw={setImmediate(...n){const{delegate:t}=Xw;return(t?.setImmediate||RWe)(...n)},clearImmediate(n){const{delegate:t}=Xw;return(t?.clearImmediate||OWe)(n)},delegate:void 0};new class LWe extends Wk{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;t=t||i.shift();do{if(s=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,s){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw s}}}(class FWe extends Uk{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=Xw.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:r}=t;null!=e&&(null===(s=r[r.length-1])||void 0===s?void 0:s.id)!==e&&(Xw.clearImmediate(e),t._scheduled=void 0)}});function jq(n=0,t,e=Kde){let i=-1;return null!=t&&(KR(t)?e=t:i=t),new dt(s=>{let r=function VWe(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;r<0&&(r=0);let o=0;return e.schedule(function(){s.closed||(s.next(o++),0<=i?this.schedule(void 0,i):s.complete())},r)})}let HWe=(()=>{class n{constructor(e,i,s){this._platform=e,this._change=new Ut,this._changeListener=r=>{this._change.next(r)},this._document=s,i.runOutsideAngular(()=>{if(e.isBrowser){const r=this._getWindow();r.addEventListener("resize",this._changeListener),r.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:i,height:s}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+s,right:e.left+i,height:s,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,i=this._getWindow(),s=e.documentElement,r=s.getBoundingClientRect();return{top:-r.top||e.body.scrollTop||i.scrollY||s.scrollTop||0,left:-r.left||e.body.scrollLeft||i.scrollX||s.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(function Gq(n,t=tv){return function BWe(n){return fi((t,e)=>{let i=!1,s=null,r=null,o=!1;const a=()=>{if(r?.unsubscribe(),r=null,i){i=!1;const c=s;s=null,e.next(c)}o&&e.complete()},l=()=>{r=null,o&&e.complete()};t.subscribe(Yn(e,c=>{i=!0,s=c,r||qs(n(c)).subscribe(r=Yn(e,a,l))},()=>{o=!0,(!i||!r||r.closed)&&e.complete()}))})}(()=>jq(n,t))}(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(e){return new(e||n)(me(ac),me(Zt),me(Jt,8))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),jWe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({}),n})();function o2(n,t,e){for(let i in t)if(t.hasOwnProperty(i)){const s=t[i];s?n.setProperty(i,s,e?.has(i)?"important":""):n.removeProperty(i)}return n}function cp(n,t){const e=t?"":"none";o2(n.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function qq(n,t,e){o2(n.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},e)}function Yw(n,t){return t&&"none"!=t?n+" "+t:n}function Kq(n){const t=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*t}function a2(n,t){return n.getPropertyValue(t).split(",").map(i=>i.trim())}function l2(n){const t=n.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function c2(n,t,e){const{top:i,bottom:s,left:r,right:o}=n;return e>=i&&e<=s&&t>=r&&t<=o}function f_(n,t,e){n.top+=t,n.bottom=n.top+n.height,n.left+=e,n.right=n.left+n.width}function Xq(n,t,e,i){const{top:s,right:r,bottom:o,left:a,width:l,height:c}=n,u=l*t,d=c*t;return i>s-d&&i<o+d&&e>a-u&&e<r+u}class Yq{constructor(t){this._document=t,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:l2(e)})})}handleScroll(t){const e=wa(t),i=this.positions.get(e);if(!i)return null;const s=i.scrollPosition;let r,o;if(e===this._document){const c=this.getViewportScrollPosition();r=c.top,o=c.left}else r=e.scrollTop,o=e.scrollLeft;const a=s.top-r,l=s.left-o;return this.positions.forEach((c,u)=>{c.clientRect&&e!==u&&e.contains(u)&&f_(c.clientRect,a,l)}),s.top=r,s.left=o,{top:a,left:l}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function Zq(n){const t=n.cloneNode(!0),e=t.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();t.removeAttribute("id");for(let s=0;s<e.length;s++)e[s].removeAttribute("id");return"canvas"===i?eK(n,t):("input"===i||"select"===i||"textarea"===i)&&Jq(n,t),Qq("canvas",n,t,eK),Qq("input, textarea, select",n,t,Jq),t}function Qq(n,t,e,i){const s=t.querySelectorAll(n);if(s.length){const r=e.querySelectorAll(n);for(let o=0;o<s.length;o++)i(s[o],r[o])}}let KWe=0;function Jq(n,t){"file"!==t.type&&(t.value=n.value),"radio"===t.type&&t.name&&(t.name=`mat-clone-${t.name}-${KWe++}`)}function eK(n,t){const e=t.getContext("2d");if(e)try{e.drawImage(n,0,0)}catch{}}const tK=lc({passive:!0}),Zw=lc({passive:!1}),u2=new Set(["position"]);class YWe{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){const e=Wo(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(i=>cp(i,e)))}constructor(t,e,i,s,r,o){this._config=e,this._document=i,this._ngZone=s,this._viewportRuler=r,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new Ut,this._pointerMoveSubscription=G.EMPTY,this._pointerUpSubscription=G.EMPTY,this._scrollSubscription=G.EMPTY,this._resizeSubscription=G.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new Ut,this.started=new Ut,this.released=new Ut,this.ended=new Ut,this.entered=new Ut,this.exited=new Ut,this.dropped=new Ut,this.moved=this._moveEvents,this._pointerDown=a=>{if(this.beforeStarted.next(),this._handles.length){const l=this._getTargetHandle(a);l&&!this._disabledHandles.has(l)&&!this.disabled&&this._initializeDragSequence(l,a)}else this.disabled||this._initializeDragSequence(this._rootElement,a)},this._pointerMove=a=>{const l=this._getPointerPositionOnPage(a);if(!this._hasStartedDragging){if(Math.abs(l.x-this._pickupPositionOnPage.x)+Math.abs(l.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const f=Date.now()>=this._dragStartTime+this._getDragStartDelay(a),p=this._dropContainer;if(!f)return void this._endDragSequence(a);(!p||!p.isDragging()&&!p.isReceiving())&&(a.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(a)))}return}a.preventDefault();const c=this._getConstrainedPointerPosition(l);if(this._hasMoved=!0,this._lastKnownPointerPosition=l,this._updatePointerDirectionDelta(c),this._dropContainer)this._updateActiveDropContainer(c,l);else{const u=this.constrainPosition?this._initialClientRect:this._pickupPositionOnPage,d=this._activeTransform;d.x=c.x-u.x+this._passiveTransform.x,d.y=c.y-u.y+this._passiveTransform.y,this._applyRootElementTransform(d.x,d.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:c,event:a,distance:this._getDragDistance(c),delta:this._pointerDirectionDelta})})},this._pointerUp=a=>{this._endDragSequence(a)},this._nativeDragStart=a=>{if(this._handles.length){const l=this._getTargetHandle(a);l&&!this._disabledHandles.has(l)&&!this.disabled&&a.preventDefault()}else this.disabled||a.preventDefault()},this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new Yq(i),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(i=>Yi(i)),this._handles.forEach(i=>cp(i,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&e.add(i)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const e=Yi(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,Zw),e.addEventListener("touchstart",this._pointerDown,tK),e.addEventListener("dragstart",this._nativeDragStart,Zw)}),this._initialTransform=void 0,this._rootElement=e),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Yi(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),cp(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),cp(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){p_(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const i=this._rootElement,s=i.parentNode,r=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment(""),a=this._getShadowRoot();s.insertBefore(o,i),this._initialTransform=i.style.transform||"",this._preview=this._createPreviewElement(),qq(i,!1,u2),this._document.body.appendChild(s.replaceChild(r,i)),this._getPreviewInsertionPoint(s,a).appendChild(this._preview),this.started.next({source:this,event:t}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();const i=this.isDragging(),s=p_(e),r=!s&&0!==e.button,o=this._rootElement,a=wa(e),l=!s&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),c=s?jk(e):Hk(e);if(a&&a.draggable&&"mousedown"===e.type&&e.preventDefault(),i||r||l||c)return;if(this._handles.length){const h=o.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialClientRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=l2(this._boundaryElement));const u=this._previewTemplate;this._pickupPositionInElement=u&&u.template&&!u.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialClientRect,t,e);const d=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:d.x,y:d.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){qq(this._rootElement,!0,u2),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialClientRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const e=this._dropContainer,i=e.getItemIndex(this),s=this._getPointerPositionOnPage(t),r=this._getDragDistance(s),o=e._isOverContainer(s.x,s.y);this.ended.next({source:this,distance:r,dropPoint:s,event:t}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:r,dropPoint:s,event:t}),e.drop(this,i,this._initialIndex,this._initialContainer,o,r,s,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:s}){let r=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=r,this._dropContainer.enter(this,t,e,r===this._initialContainer&&r.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:r,currentIndex:r.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,s),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,e):this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_createPreviewElement(){const t=this._previewTemplate,e=this.previewClass,i=t?t.template:null;let s;if(i&&t){const r=t.matchSize?this._initialClientRect:null,o=t.viewContainer.createEmbeddedView(i,t.context);o.detectChanges(),s=iK(o,this._document),this._previewRef=o,t.matchSize?sK(s,r):s.style.transform=Qw(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else s=Zq(this._rootElement),sK(s,this._initialClientRect),this._initialTransform&&(s.style.transform=this._initialTransform);return o2(s.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},u2),cp(s,!1),s.classList.add("cdk-drag-preview"),s.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(r=>s.classList.add(r)):s.classList.add(e)),s}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);const e=function qWe(n){const t=getComputedStyle(n),e=a2(t,"transition-property"),i=e.find(a=>"transform"===a||"all"===a);if(!i)return 0;const s=e.indexOf(i),r=a2(t,"transition-duration"),o=a2(t,"transition-delay");return Kq(r[s])+Kq(o[s])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const s=o=>{(!o||wa(o)===this._preview&&"transform"===o.propertyName)&&(this._preview?.removeEventListener("transitionend",s),i(),clearTimeout(r))},r=setTimeout(s,1.5*e);this._preview.addEventListener("transitionend",s)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,e=t?t.template:null;let i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=iK(this._placeholderRef,this._document)):i=Zq(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(t,e,i){const s=e===this._rootElement?null:e,r=s?s.getBoundingClientRect():t,o=p_(i)?i.targetTouches[0]:i,a=this._getViewportScrollPosition();return{x:r.left-t.left+(o.pageX-r.left-a.left),y:r.top-t.top+(o.pageY-r.top-a.top)}}_getPointerPositionOnPage(t){const e=this._getViewportScrollPosition(),i=p_(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,s=i.pageX-e.left,r=i.pageY-e.top;if(this._ownerSVGElement){const o=this._ownerSVGElement.getScreenCTM();if(o){const a=this._ownerSVGElement.createSVGPoint();return a.x=s,a.y=r,a.matrixTransform(o.inverse())}}return{x:s,y:r}}_getConstrainedPointerPosition(t){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:s}=this.constrainPosition?this.constrainPosition(t,this,this._initialClientRect,this._pickupPositionInElement):t;if("x"===this.lockAxis||"x"===e?s=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===e)&&(i=this._pickupPositionOnPage.x),this._boundaryRect){const{x:r,y:o}=this._pickupPositionInElement,a=this._boundaryRect,{width:l,height:c}=this._getPreviewRect(),u=a.top+o,d=a.bottom-(c-o);i=nK(i,a.left+r,a.right-(l-r)),s=nK(s,u,d)}return{x:i,y:s}}_updatePointerDirectionDelta(t){const{x:e,y:i}=t,s=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,o=Math.abs(e-r.x),a=Math.abs(i-r.y);return o>this._config.pointerDirectionChangeThreshold&&(s.x=e>r.x?1:-1,r.x=e),a>this._config.pointerDirectionChangeThreshold&&(s.y=i>r.y?1:-1,r.y=i),s}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,cp(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,Zw),t.removeEventListener("touchstart",this._pointerDown,tK),t.removeEventListener("dragstart",this._nativeDragStart,Zw)}_applyRootElementTransform(t,e){const i=Qw(t,e),s=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=s.transform&&"none"!=s.transform?s.transform:""),s.transform=Yw(i,this._initialTransform)}_applyPreviewTransform(t,e){const i=this._previewTemplate?.template?void 0:this._initialTransform,s=Qw(t,e);this._preview.style.transform=Yw(s,i)}_getDragDistance(t){const e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(0===t&&0===e||this.isDragging()||!this._boundaryElement)return;const i=this._rootElement.getBoundingClientRect(),s=this._boundaryElement.getBoundingClientRect();if(0===s.width&&0===s.height||0===i.width&&0===i.height)return;const r=s.left-i.left,o=i.right-s.right,a=s.top-i.top,l=i.bottom-s.bottom;s.width>i.width?(r>0&&(t+=r),o>0&&(t-=o)):t=0,s.height>i.height?(a>0&&(e+=a),l>0&&(e-=l)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){const e=this.dragStartDelay;return"number"==typeof e?e:p_(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){const e=this._parentPositions.handleScroll(t);if(e){const i=wa(t);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&f_(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=Vk(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){const i=this._previewContainer||"global";if("parent"===i)return t;if("global"===i){const s=this._document;return e||s.fullscreenElement||s.webkitFullscreenElement||s.mozFullScreenElement||s.msFullscreenElement||s.body}return Yi(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialClientRect),this._previewRect}_getTargetHandle(t){return this._handles.find(e=>t.target&&(t.target===e||e.contains(t.target)))}}function Qw(n,t){return`translate3d(${Math.round(n)}px, ${Math.round(t)}px, 0)`}function nK(n,t,e){return Math.max(t,Math.min(e,n))}function p_(n){return"t"===n.type[0]}function iK(n,t){const e=n.rootNodes;if(1===e.length&&e[0].nodeType===t.ELEMENT_NODE)return e[0];const i=t.createElement("div");return e.forEach(s=>i.appendChild(s)),i}function sK(n,t){n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,n.style.transform=Qw(t.left,t.top)}function m_(n,t){return Math.max(0,Math.min(t,n))}class QWe{constructor(t,e){this._element=t,this._dragDropRegistry=e,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(t){this.withItems(t)}sort(t,e,i,s){const r=this._itemPositions,o=this._getItemIndexFromPointerPosition(t,e,i,s);if(-1===o&&r.length>0)return null;const a="horizontal"===this.orientation,l=r.findIndex(m=>m.drag===t),c=r[o],d=c.clientRect,h=l>o?1:-1,f=this._getItemOffsetPx(r[l].clientRect,d,h),p=this._getSiblingOffsetPx(l,r,h),g=r.slice();return function ZWe(n,t,e){const i=m_(t,n.length-1),s=m_(e,n.length-1);if(i===s)return;const r=n[i],o=s<i?-1:1;for(let a=i;a!==s;a+=o)n[a]=n[a+o];n[s]=r}(r,l,o),r.forEach((m,b)=>{if(g[b]===m)return;const _=m.drag===t,y=_?f:p,v=_?t.getPlaceholderElement():m.drag.getRootElement();m.offset+=y,a?(v.style.transform=Yw(`translate3d(${Math.round(m.offset)}px, 0, 0)`,m.initialTransform),f_(m.clientRect,0,y)):(v.style.transform=Yw(`translate3d(0, ${Math.round(m.offset)}px, 0)`,m.initialTransform),f_(m.clientRect,y,0))}),this._previousSwap.overlaps=c2(d,e,i),this._previousSwap.drag=c.drag,this._previousSwap.delta=a?s.x:s.y,{previousIndex:l,currentIndex:o}}enter(t,e,i,s){const r=null==s||s<0?this._getItemIndexFromPointerPosition(t,e,i):s,o=this._activeDraggables,a=o.indexOf(t),l=t.getPlaceholderElement();let c=o[r];if(c===t&&(c=o[r+1]),!c&&(null==r||-1===r||r<o.length-1)&&this._shouldEnterAsFirstChild(e,i)&&(c=o[0]),a>-1&&o.splice(a,1),c&&!this._dragDropRegistry.isDragging(c)){const u=c.getRootElement();u.parentElement.insertBefore(l,u),o.splice(r,0,t)}else Yi(this._element).appendChild(l),o.push(t);l.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables.forEach(t=>{const e=t.getRootElement();if(e){const i=this._itemPositions.find(s=>s.drag===t)?.initialTransform;e.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===t)}updateOnScroll(t,e){this._itemPositions.forEach(({clientRect:i})=>{f_(i,t,e)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}_cacheItemPositions(){const t="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(e=>{const i=e.getVisibleElement();return{drag:e,offset:0,initialTransform:i.style.transform||"",clientRect:l2(i)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_getItemOffsetPx(t,e,i){const s="horizontal"===this.orientation;let r=s?e.left-t.left:e.top-t.top;return-1===i&&(r+=s?e.width-t.width:e.height-t.height),r}_getSiblingOffsetPx(t,e,i){const s="horizontal"===this.orientation,r=e[t].clientRect,o=e[t+-1*i];let a=r[s?"width":"height"]*i;if(o){const l=s?"left":"top",c=s?"right":"bottom";-1===i?a-=o.clientRect[l]-r[c]:a+=r[l]-o.clientRect[c]}return a}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,s="horizontal"===this.orientation;if(i[0].drag!==this._activeDraggables[0]){const o=i[i.length-1].clientRect;return s?t>=o.right:e>=o.bottom}{const o=i[0].clientRect;return s?t<=o.left:e<=o.top}}_getItemIndexFromPointerPosition(t,e,i,s){const r="horizontal"===this.orientation,o=this._itemPositions.findIndex(({drag:a,clientRect:l})=>a!==t&&((!s||a!==this._previousSwap.drag||!this._previousSwap.overlaps||(r?s.x:s.y)!==this._previousSwap.delta)&&(r?e>=Math.floor(l.left)&&e<Math.floor(l.right):i>=Math.floor(l.top)&&i<Math.floor(l.bottom))));return-1!==o&&this._sortPredicate(o,t)?o:-1}}const oK=.05;class JWe{constructor(t,e,i,s,r){this._dragDropRegistry=e,this._ngZone=s,this._viewportRuler=r,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new Ut,this.entered=new Ut,this.exited=new Ut,this.dropped=new Ut,this.sorted=new Ut,this.receivingStarted=new Ut,this.receivingStopped=new Ut,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=G.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new Ut,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function GWe(n=0,t=tv){return n<0&&(n=0),jq(n,n,t)}(0,Wq).pipe(Xh(this._stopScrollTimers)).subscribe(()=>{const o=this._scrollNode,a=this.autoScrollStep;1===this._verticalScrollDirection?o.scrollBy(0,-a):2===this._verticalScrollDirection&&o.scrollBy(0,a),1===this._horizontalScrollDirection?o.scrollBy(-a,0):2===this._horizontalScrollDirection&&o.scrollBy(a,0)})},this.element=Yi(t),this._document=i,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new Yq(i),this._sortStrategy=new QWe(this.element,e),this._sortStrategy.withSortPredicate((o,a)=>this.sortPredicate(o,a,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,s){this._draggingStarted(),null==s&&this.sortingDisabled&&(s=this._draggables.indexOf(t)),this._sortStrategy.enter(t,e,i,s),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,s,r,o,a,l={}){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:s,isPointerOverContainer:r,distance:o,dropPoint:a,event:l})}withItems(t){const e=this._draggables;return this._draggables=t,t.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(e.filter(s=>s.isDragging()).every(s=>-1===t.indexOf(s))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._sortStrategy.direction=t,this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){return this._sortStrategy.orientation=t,this}withScrollableParents(t){const e=Yi(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e,...t]:t.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,s){if(this.sortingDisabled||!this._clientRect||!Xq(this._clientRect,.05,e,i))return;const r=this._sortStrategy.sort(t,e,i,s);r&&this.sorted.next({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,s=0,r=0;if(this._parentPositions.positions.forEach((o,a)=>{a===this._document||!o.clientRect||i||Xq(o.clientRect,.05,t,e)&&([s,r]=function eHe(n,t,e,i){const s=aK(t,i),r=lK(t,e);let o=0,a=0;if(s){const l=n.scrollTop;1===s?l>0&&(o=1):n.scrollHeight-l>n.clientHeight&&(o=2)}if(r){const l=n.scrollLeft;1===r?l>0&&(a=1):n.scrollWidth-l>n.clientWidth&&(a=2)}return[o,a]}(a,o.clientRect,t,e),(s||r)&&(i=a))}),!s&&!r){const{width:o,height:a}=this._viewportRuler.getViewportSize(),l={width:o,height:a,top:0,right:o,bottom:a,left:0};s=aK(l,e),r=lK(l,t),i=window}i&&(s!==this._verticalScrollDirection||r!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=s,this._horizontalScrollDirection=r,this._scrollNode=i,(s||r)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const t=Yi(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const t=Yi(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}_reset(){this._isDragging=!1;const t=Yi(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(t,e){return null!=this._clientRect&&c2(this._clientRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(s=>s._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._clientRect||!c2(this._clientRect,e,i)||!this.enterPredicate(t,this))return!1;const s=this._getShadowRoot().elementFromPoint(e,i);if(!s)return!1;const r=Yi(this.element);return s===r||r.contains(s)}_startReceiving(t,e){const i=this._activeSiblings;!i.has(t)&&e.every(s=>this.enterPredicate(s,this)||this._draggables.indexOf(s)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:e}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(t);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=Vk(Yi(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const t=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}}function aK(n,t){const{top:e,bottom:i,height:s}=n,r=s*oK;return t>=e-r&&t<=e+r?1:t>=i-r&&t<=i+r?2:0}function lK(n,t){const{left:e,right:i,width:s}=n,r=s*oK;return t>=e-r&&t<=e+r?1:t>=i-r&&t<=i+r?2:0}const Jw=lc({passive:!1,capture:!0});let tHe=(()=>{class n{constructor(e,i){this._ngZone=e,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=s=>s.isDragging(),this.pointerMove=new Ut,this.pointerUp=new Ut,this.scroll=new Ut,this._preventDefaultWhileDragging=s=>{this._activeDragInstances.length>0&&s.preventDefault()},this._persistentTouchmoveListener=s=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&s.preventDefault(),this.pointerMove.next(s))},this._document=i}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,Jw)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,Jw)}startDragging(e,i){if(!(this._activeDragInstances.indexOf(e)>-1)&&(this._activeDragInstances.push(e),1===this._activeDragInstances.length)){const s=i.type.startsWith("touch");this._globalListeners.set(s?"touchend":"mouseup",{handler:r=>this.pointerUp.next(r),options:!0}).set("scroll",{handler:r=>this.scroll.next(r),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Jw}),s||this._globalListeners.set("mousemove",{handler:r=>this.pointerMove.next(r),options:Jw}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((r,o)=>{this._document.addEventListener(o,r.handler,r.options)})})}}stopDragging(e){const i=this._activeDragInstances.indexOf(e);i>-1&&(this._activeDragInstances.splice(i,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(e){return this._activeDragInstances.indexOf(e)>-1}scrolled(e){const i=[this.scroll];return e&&e!==this._document&&i.push(new dt(s=>this._ngZone.runOutsideAngular(()=>{const o=a=>{this._activeDragInstances.length&&s.next(a)};return e.addEventListener("scroll",o,!0),()=>{e.removeEventListener("scroll",o,!0)}}))),q_(...i)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((e,i)=>{this._document.removeEventListener(i,e.handler,e.options)}),this._globalListeners.clear()}}return n.\u0275fac=function(e){return new(e||n)(me(Zt),me(Jt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const nHe={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let d2=(()=>{class n{constructor(e,i,s,r){this._document=e,this._ngZone=i,this._viewportRuler=s,this._dragDropRegistry=r}createDrag(e,i=nHe){return new YWe(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new JWe(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return n.\u0275fac=function(e){return new(e||n)(me(Jt),me(Zt),me(HWe),me(tHe))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const h2=new Ce("CDK_DRAG_PARENT"),cK=new Ce("CDK_DRAG_CONFIG"),uK=new Ce("CdkDropList"),p2=new Ce("CdkDragHandle"),dK=new Ce("CdkDragPlaceholder"),hK=new Ce("CdkDragPreview");let fK=(()=>{class n{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(e){this._disabled=Wo(e),this._dragRef.disabled=this._disabled}constructor(e,i,s,r,o,a,l,c,u,d,h){this.element=e,this.dropContainer=i,this._ngZone=r,this._viewContainerRef=o,this._dir=l,this._changeDetectorRef=u,this._selfHandle=d,this._parentDrag=h,this._destroyed=new Ut,this.started=new Yt,this.released=new Yt,this.ended=new Yt,this.entered=new Yt,this.exited=new Yt,this.dropped=new Yt,this.moved=new dt(f=>{const p=this._dragRef.moved.pipe(lt(g=>({source:this,pointerPosition:g.pointerPosition,event:g.event,delta:g.delta,distance:g.distance}))).subscribe(f);return()=>{p.unsubscribe()}}),this._dragRef=c.createDrag(e,{dragStartThreshold:a&&null!=a.dragStartThreshold?a.dragStartThreshold:5,pointerDirectionChangeThreshold:a&&null!=a.pointerDirectionChangeThreshold?a.pointerDirectionChangeThreshold:5,zIndex:a?.zIndex}),this._dragRef.data=this,n._dragInstances.push(this),a&&this._assignDefaults(a),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(va(1),Xh(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(e){const i=e.rootElementSelector,s=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),s&&!s.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const e=n._dragInstances.indexOf(this);e>-1&&n._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const e=this.element.nativeElement;let i=e;this.rootElementSelector&&(i=void 0!==e.closest?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){const e=this.boundaryElement;return e?"string"==typeof e?this.element.nativeElement.closest(e):Yi(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const i=this._dir,s=this.dragStartDelay,r=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay="object"==typeof s&&s?s:function l4(n,t=0){return function Gde(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):t}(s),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(va(1)).subscribe(()=>{if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains("cdk-drag")){e.withParent(n._dragInstances.find(s=>s.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){const{lockAxis:i,dragStartDelay:s,constrainPosition:r,previewClass:o,boundaryElement:a,draggingDisabled:l,rootElementSelector:c,previewContainer:u}=e;this.disabled=l??!1,this.dragStartDelay=s||0,i&&(this.lockAxis=i),r&&(this.constrainPosition=r),o&&(this.previewClass=o),a&&(this.boundaryElement=a),c&&(this.rootElementSelector=c),u&&(this.previewContainer=u)}_setupHandlesListener(){this._handles.changes.pipe(mm(this._handles),Li(e=>{const i=e.filter(s=>s._parentDrag===this).map(s=>s.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),zo(e=>q_(...e.map(i=>i._stateChanges.pipe(mm(i))))),Xh(this._destroyed)).subscribe(e=>{const i=this._dragRef,s=e.element.nativeElement;e.disabled?i.disableHandle(s):i.enableHandle(s)})}}return n._dragInstances=[],n.\u0275fac=function(e){return new(e||n)(ie(Ri),ie(uK,12),ie(Jt),ie(Zt),ie(so),ie(cK,8),ie(_4,8),ie(d2),ie(Su),ie(p2,10),ie(h2,12))},n.\u0275dir=Ze({type:n,selectors:[["","cdkDrag",""]],contentQueries:function(e,i,s){if(1&e&&(sm(s,hK,5),sm(s,dK,5),sm(s,p2,5)),2&e){let r;Ah(r=Mh())&&(i._previewTemplate=r.first),Ah(r=Mh())&&(i._placeholderTemplate=r.first),Ah(r=Mh())&&(i._handles=r)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(e,i){2&e&&Zs("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:["cdkDragData","data"],lockAxis:["cdkDragLockAxis","lockAxis"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],boundaryElement:["cdkDragBoundary","boundaryElement"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"],disabled:["cdkDragDisabled","disabled"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],previewContainer:["cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[pn([{provide:h2,useExisting:n}]),kr]}),n})(),uHe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({providers:[d2],imports:[jWe]}),n})();function dHe(n,t){if(1&n&&(w(0,"div",6),Ne(1,"div",7)(2,"div",8)(3,"div",9),C()),2&n){const e=t.$implicit;oe("cdkDragFreeDragPosition",e.position),W(1),Zs("active","red"===e.activeLight),W(1),Zs("active","yellow"===e.activeLight),W(1),Zs("active","green"===e.activeLight)}}function hHe(n,t){1&n&&(w(0,"div",13)(1,"span",14),I(2," directions_walk "),C()())}function fHe(n,t){1&n&&(w(0,"div",15)(1,"span",14),I(2," front_hand "),C()())}function pHe(n,t){if(1&n&&(w(0,"div",10),ze(1,hHe,3,0,"div",11),ze(2,fHe,3,0,"div",12),C()),2&n){const e=t.$implicit;oe("cdkDragFreeDragPosition",e.position),W(1),oe("ngIf","walk"===e.activeLight),W(1),oe("ngIf","dontWalk"===e.activeLight)}}function mHe(n,t){if(1&n&&(w(0,"div",16)(1,"h3"),I(2),C()()),2&n){const e=t.$implicit;Wy("transform","translate("+e.position.x+"px, "+e.position.y+"px)"),Zs("verticle",0===e.id),W(2),ot(e.totalNumCars)}}function gHe(n,t){if(1&n&&(w(0,"div",17)(1,"h3"),I(2),C()()),2&n){const e=t.$implicit;Wy("transform","translate("+e.position.x+"px, "+e.position.y+"px)"),Zs("verticle",0===e.id),W(2),ot(e.totalNumPeds)}}let bHe=(()=>{class n{constructor(){this.trafficLights=[{id:0,activeLight:"red",position:{x:950,y:50}},{id:1,activeLight:"red",position:{x:600,y:200}},{id:2,activeLight:"red",position:{x:1300,y:500}}],this.pedestrianSigns=[{id:0,activeLight:"dontWalk",position:{x:740,y:400}},{id:1,activeLight:"dontWalk",position:{x:1125,y:400}},{id:2,activeLight:"dontWalk",position:{x:950,y:660}}],this.cars=[{id:0,position:{x:950,y:825},initialPosition:{x:950,y:825},totalNumCars:0},{id:1,position:{x:1300,y:250},initialPosition:{x:1300,y:250},totalNumCars:0},{id:2,position:{x:600,y:550},initialPosition:{x:600,y:550},totalNumCars:0}],this.pedestrians=[{id:0,position:{x:740,y:75},initialPosition:{x:740,y:75},totalNumPeds:0},{id:1,position:{x:1125,y:75},initialPosition:{x:1125,y:75},totalNumPeds:0}],this.currentState="base",this.isLoadingModel=!0,this.statusMessage="Loading AI model...",this.carsL1_West=0,this.carsL2_East=0,this.carsL3_North=0,this.pedsW1_West=0,this.pedsW2_East=0,this.pedsW3_South=0,this.waitTimeL1_L2=0,this.waitTimeL3=0,this.waitTimeW1_W2=0,this.SCALER_MEAN=[6.994502748625687,7.011694152923538,1.9861069465267367,3.0368815592203897,3.049775112443778,0,14.593003498250875,14.50064967516242,14.522038980509745],this.SCALER_SCALE=[4.325195499288317,4.307050944032767,1.4159464800406658,1.985287985726915,2.002776982486944,1,8.699760232927833,8.675925814190926,8.68162160910034],this.firebaseConfig={apiKey:"AIzaSyAqm7ooUgqpyKCWH3fPM1yzyANdWmFsGH4",authDomain:"fir-mywebsite.firebaseapp.com",databaseURL:"https://fir-mywebsite-default-rtdb.firebaseio.com",projectId:"fir-mywebsite",storageBucket:"fir-mywebsite.appspot.com",messagingSenderId:"271679200792",appId:"1:271679200792:web:807031f3f43102c9a2ad6d",measurementId:"G-8JCVNF7W86"},this.app=rf(this.firebaseConfig),this.db=Da(this.app)}ngOnInit(){this.loadModel().then(()=>{this.pollTrafficData(),setInterval(()=>this.pollTrafficData(),5e3)})}ngAfterViewInit(){this.updatePositions()}ngOnDestroy(){this.predictionInterval&&clearInterval(this.predictionInterval),this.stateTimer&&clearTimeout(this.stateTimer),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}loadModel(){var e=this;return Q(function*(){try{e.model=yield function GTe(n,t){return rP.apply(this,arguments)}("assets/tfjs_model/model.json"),e.isLoadingModel=!1,e.statusMessage="AI Model Loaded. Listening for traffic data...",e.setBaseState()}catch(i){e.isLoadingModel=!1,e.statusMessage="Error loading AI model. Please check console.",console.error("Model loading error:",i)}})()}pollTrafficData(){var e=this;return Q(function*(){const i=_i(e.db,"trafficData/");try{const r=(yield vc(i)).val();r?(console.log("Polled data:",r),e.statusMessage="Polled data received. AI is active.",e.carsL1_West=r.carsL1_West||0,e.carsL2_East=r.carsL2_East||0,e.carsL3_North=r.carsL3_North||0,e.pedsW1_West=r.pedsW1_West||0,e.pedsW2_East=r.pedsW2_East||0,e.pedsW3_South=r.pedsW3_South||0,e.waitTimeL1_L2=r.waitTimeL1_L2||0,e.waitTimeL3=r.waitTimeL3||0,e.waitTimeW1_W2=r.waitTimeW1_W2||0,e.updateCarsAndPedsBasedOnData(),e.runPrediction()):e.statusMessage="ERROR: AI active, but no data found at Firebase path"}catch(s){console.error("Error polling traffic data:",s),e.statusMessage="ERROR: Failed to poll Firebase data"}})()}runPrediction(){if(!this.model||this.isLoadingModel)return;const s=Ob([[this.carsL1_West,this.carsL2_East,this.carsL3_North,this.pedsW1_West,this.pedsW2_East,this.pedsW3_South,this.waitTimeL1_L2,this.waitTimeL3,this.waitTimeW1_W2].map((a,l)=>(a-this.SCALER_MEAN[l])/this.SCALER_SCALE[l])]);console.log("running prediction with input:"),this.statusMessage="Running AI prediction...";const r=this.model.predict(s),o=r.argMax(-1).dataSync()[0];switch(s.dispose(),r.dispose(),o){case 0:"base"!==this.currentState&&this.setYellowTransition(()=>this.setBaseState());break;case 1:"car_only"!==this.currentState&&this.setYellowTransition(()=>this.setCarOnlyState());break;case 2:"pedestrian"!==this.currentState&&this.setYellowTransition(()=>this.setPedestrianState());break;default:this.setYellowTransition(()=>this.setBaseState())}}setBaseState(){clearTimeout(this.stateTimer),this.stateTimer=null,this.currentState="base",this.statusMessage="State: Base (East/West traffic flow)",this.trafficLights[0].activeLight="red",this.trafficLights[1].activeLight="green",this.trafficLights[2].activeLight="green",this.pedestrianSigns[0].activeLight="dontWalk",this.pedestrianSigns[1].activeLight="dontWalk",this.pedestrianSigns[2].activeLight="walk"}setCarOnlyState(){clearTimeout(this.stateTimer),this.currentState="car_only";const e=this.carsL3_North>3?1e4:5e3;this.statusMessage=`State: Car Only (North flow) for ${e/1e3}s`,this.trafficLights[0].activeLight="green",this.trafficLights[1].activeLight="red",this.trafficLights[2].activeLight="red",this.pedestrianSigns.forEach(i=>i.activeLight="dontWalk"),this.stateTimer=setTimeout(()=>this.setBaseState(),e)}setPedestrianState(){clearTimeout(this.stateTimer),this.currentState="pedestrian";const i=this.pedsW1_West+this.pedsW2_East>5?25e3:15e3;this.statusMessage=`State: Pedestrian Crossing (East/West) for ${i/1e3}s`,this.trafficLights[0].activeLight="green",this.trafficLights[1].activeLight="red",this.trafficLights[2].activeLight="red",this.pedestrianSigns[0].activeLight="walk",this.pedestrianSigns[1].activeLight="walk",this.pedestrianSigns[2].activeLight="dontWalk",this.stateTimer=setTimeout(()=>this.setBaseState(),i)}updateCarsAndPedsBasedOnData(){this.cars[0].totalNumCars=this.carsL3_North,this.cars[1].totalNumCars=this.carsL1_West,this.cars[2].totalNumCars=this.carsL2_East,this.pedestrians[0].totalNumPeds=this.pedsW1_West,this.pedestrians[1].totalNumPeds=this.pedsW2_East}setYellowTransition(e){this.trafficLights.forEach(i=>{"green"===i.activeLight&&(i.activeLight="yellow")}),this.statusMessage="Transitioning: Yellow phase...",this.resetAll(),this.stateTimer=setTimeout(()=>{e()},3e3)}updatePositions(){this.cars.forEach(e=>{0===e.id&&"green"==this.trafficLights[0].activeLight?(e.position.y<400&&(e.position.x-=1.5),e.position.y>200&&(e.position.y-=1.5),e.position.x<500&&(e.position.x=e.initialPosition.x,e.position.y=e.initialPosition.y)):1===e.id&&"green"==this.trafficLights[1].activeLight?(e.position.x-=1.5,e.position.x<600&&(e.position.x=e.initialPosition.x)):2===e.id&&"green"==this.trafficLights[2].activeLight&&(e.position.x+=1.5,e.position.x>1300&&(e.position.x=e.initialPosition.x))}),this.pedestrians.forEach(e=>{(0===e.id&&"walk"===this.pedestrianSigns[0].activeLight&&e.totalNumPeds>0||1===e.id&&"walk"===this.pedestrianSigns[1].activeLight&&e.totalNumPeds>0)&&(e.position.y+=1.5,e.position.y>800&&(e.position.y=e.initialPosition.y))}),this.animationFrameId=requestAnimationFrame(()=>this.updatePositions())}resetAll(){this.cars.forEach(e=>{e.position.x=e.initialPosition.x,e.position.y=e.initialPosition.y}),this.pedestrians.forEach(e=>{e.position.x=e.initialPosition.x,e.position.y=e.initialPosition.y})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-stop-light"]],decls:7,vars:8,consts:[[1,"intersection-container"],["class","traffic-light-post","cdkDrag","",3,"cdkDragFreeDragPosition",4,"ngFor","ngForOf"],["class","pedestrian-sign","cdkDrag","",3,"cdkDragFreeDragPosition",4,"ngFor","ngForOf"],["class","car",3,"transform","verticle",4,"ngFor","ngForOf"],["class","pedestrian",3,"transform","verticle",4,"ngFor","ngForOf"],[1,"content"],["cdkDrag","",1,"traffic-light-post",3,"cdkDragFreeDragPosition"],[1,"light","red"],[1,"light","yellow"],[1,"light","green"],["cdkDrag","",1,"pedestrian-sign",3,"cdkDragFreeDragPosition"],["class","ped-icon walk active",4,"ngIf"],["class","ped-icon dont-walk active",4,"ngIf"],[1,"ped-icon","walk","active"],[1,"material-icons"],[1,"ped-icon","dont-walk","active"],[1,"car"],[1,"pedestrian"]],template:function(e,i){1&e&&(w(0,"div",0),ze(1,dHe,4,7,"div",1),ze(2,pHe,3,3,"div",2),ze(3,mHe,3,5,"div",3),ze(4,gHe,3,5,"div",4),C(),w(5,"h3",5),I(6),C()),2&e&&(W(1),oe("ngForOf",i.trafficLights),W(1),oe("ngForOf",i.pedestrianSigns),W(1),oe("ngForOf",i.cars),W(1),oe("ngForOf",i.pedestrians),W(2),jI("",i.statusMessage,". WaitTimeL1_L2: ",i.waitTimeL1_L2,". WaitTimeL3: ",i.waitTimeL3,". WaitTimeW1_W2: ",i.waitTimeW1_W2,"."))},dependencies:[ku,pl,fK],styles:[".cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:8px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.traffic-light-post[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;background-color:#333;padding:10px;border-radius:8px;border:2px solid #222;box-shadow:2px 2px 10px #00000080;cursor:move;z-index:10}.light[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;margin:2px;background-color:#555;transition:all .3s ease-in-out;border:1px solid #111}.light.red.active[_ngcontent-%COMP%]{background-color:red;box-shadow:0 0 20px red,0 0 30px red}.light.yellow.active[_ngcontent-%COMP%]{background-color:#ff0;box-shadow:0 0 20px #ff0,0 0 30px #ff0}.light.green.active[_ngcontent-%COMP%]{background-color:#0f0;box-shadow:0 0 20px #0f0,0 0 30px #0f0}.pedestrian-sign[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;width:40px;height:40px;background-color:#333;padding:5px;border-radius:8px;border:2px solid #222;box-shadow:2px 2px 10px #00000080;cursor:move;z-index:10}.ped-icon[_ngcontent-%COMP%]{width:40px;height:40px;transition:all .3s ease-in-out;color:#555}.ped-icon.walk.active[_ngcontent-%COMP%]{color:#fff;filter:drop-shadow(0 0 8px #fff)}.ped-icon.dont-walk.active[_ngcontent-%COMP%]{color:#ff4500;filter:drop-shadow(0 0 8px #ff4500)}.intersection-container[_ngcontent-%COMP%]{position:relative;width:100%;height:1000px;background-image:url(intersection.5d3e4be7a2a65f08.png);background-size:cover;background-position:center;overflow:hidden}.car[_ngcontent-%COMP%]{position:absolute;width:50px;height:30px;background-color:#007bff;border:2px solid #0056b3;border-radius:4px 4px 8px 8px;z-index:5}.car.verticle[_ngcontent-%COMP%]{width:30px;height:50px;border-radius:8px 8px 4px 4px}.pedestrian[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;background-color:#28a745;border:2px solid #218838;border-radius:50%;z-index:5}.pedestrian.verticle[_ngcontent-%COMP%]{width:30px;height:30px;border-radius:50%}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}span[_ngcontent-%COMP%]{margin-left:5px;margin-top:5px}"]}),n})();function Td(n,t){const e="object"==typeof t;return new Promise((i,s)=>{const r=new Je({next:o=>{i(o),r.unsubscribe()},error:s,complete:()=>{e?i(t.defaultValue):s(new pm)}});n.subscribe(r)})}function g_(n){return(g_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function Ie(n,t,e){return(t=function yHe(n){var t=function _He(n,t){if("object"!==g_(n)||null===n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var i=e.call(n,t||"default");if("object"!==g_(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"===g_(t)?t:String(t)}(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function up(n){return n+.5|0}const Ll=(n,t,e)=>Math.max(Math.min(n,e),t);function b_(n){return Ll(up(2.55*n),0,255)}function Zc(n){return Ll(up(255*n),0,255)}function $l(n){return Ll(up(n/2.55)/100,0,1)}function pK(n){return Ll(up(100*n),0,100)}const Eo={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},m2=[..."0123456789ABCDEF"],vHe=n=>m2[15&n],xHe=n=>m2[(240&n)>>4]+m2[15&n],e1=n=>(240&n)>>4==(15&n),EHe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function mK(n,t,e){const i=t*Math.min(e,1-e),s=(r,o=(r+n/30)%12)=>e-i*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function kHe(n,t,e){const i=(s,r=(s+n/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function THe(n,t,e){const i=mK(n,1,.5);let s;for(t+e>1&&(s=1/(t+e),t*=s,e*=s),s=0;s<3;s++)i[s]*=1-t-e,i[s]+=t;return i}function g2(n){const e=n.r/255,i=n.g/255,s=n.b/255,r=Math.max(e,i,s),o=Math.min(e,i,s),a=(r+o)/2;let l,c,u;return r!==o&&(u=r-o,c=a>.5?u/(2-r-o):u/(r+o),l=function DHe(n,t,e,i,s){return n===s?(t-e)/i+(t<e?6:0):t===s?(e-n)/i+2:(n-t)/i+4}(e,i,s,u,r),l=60*l+.5),[0|l,c||0,a]}function b2(n,t,e,i){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,i)).map(Zc)}function _2(n,t,e){return b2(mK,n,t,e)}function gK(n){return(n%360+360)%360}const bK={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},_K={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let t1;const LHe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,y2=n=>n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055,dp=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function n1(n,t,e){if(n){let i=g2(n);i[t]=Math.max(0,Math.min(i[t]+i[t]*e,0===t?360:1)),i=_2(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function yK(n,t){return n&&Object.assign(t||{},n)}function vK(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=Zc(n[3]))):(t=yK(n,{r:0,g:0,b:0,a:1})).a=Zc(t.a),t}function zHe(n){return"r"===n.charAt(0)?function $He(n){const t=LHe.exec(n);let i,s,r,e=255;if(t){if(t[7]!==i){const o=+t[7];e=t[8]?b_(o):Ll(255*o,0,255)}return i=+t[1],s=+t[3],r=+t[5],i=255&(t[2]?b_(i):Ll(i,0,255)),s=255&(t[4]?b_(s):Ll(s,0,255)),r=255&(t[6]?b_(r):Ll(r,0,255)),{r:i,g:s,b:r,a:e}}}(n):function MHe(n){const t=EHe.exec(n);let i,e=255;if(!t)return;t[5]!==i&&(e=t[6]?b_(+t[5]):Zc(+t[5]));const s=gK(+t[2]),r=+t[3]/100,o=+t[4]/100;return i="hwb"===t[1]?function NHe(n,t,e){return b2(THe,n,t,e)}(s,r,o):"hsv"===t[1]?function AHe(n,t,e){return b2(kHe,n,t,e)}(s,r,o):_2(s,r,o),{r:i[0],g:i[1],b:i[2],a:e}}(n)}class hp{constructor(t){if(t instanceof hp)return t;const e=typeof t;let i;"object"===e?i=vK(t):"string"===e&&(i=function wHe(n){var e,t=n.length;return"#"===n[0]&&(4===t||5===t?e={r:255&17*Eo[n[1]],g:255&17*Eo[n[2]],b:255&17*Eo[n[3]],a:5===t?17*Eo[n[4]]:255}:(7===t||9===t)&&(e={r:Eo[n[1]]<<4|Eo[n[2]],g:Eo[n[3]]<<4|Eo[n[4]],b:Eo[n[5]]<<4|Eo[n[6]],a:9===t?Eo[n[7]]<<4|Eo[n[8]]:255})),e}(t)||function FHe(n){t1||(t1=function OHe(){const n={},t=Object.keys(_K),e=Object.keys(bK);let i,s,r,o,a;for(i=0;i<t.length;i++){for(o=a=t[i],s=0;s<e.length;s++)r=e[s],a=a.replace(r,bK[r]);r=parseInt(_K[o],16),n[a]=[r>>16&255,r>>8&255,255&r]}return n}(),t1.transparent=[0,0,0,0]);const t=t1[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}(t)||zHe(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=yK(this._rgb);return t&&(t.a=$l(t.a)),t}set rgb(t){this._rgb=vK(t)}rgbString(){return this._valid?function BHe(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${$l(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}(this._rgb):void 0}hexString(){return this._valid?function IHe(n){var t=(n=>e1(n.r)&&e1(n.g)&&e1(n.b)&&e1(n.a))(n)?vHe:xHe;return n?"#"+t(n.r)+t(n.g)+t(n.b)+((n,t)=>n<255?t(n):"")(n.a,t):void 0}(this._rgb):void 0}hslString(){return this._valid?function RHe(n){if(!n)return;const t=g2(n),e=t[0],i=pK(t[1]),s=pK(t[2]);return n.a<255?`hsla(${e}, ${i}%, ${s}%, ${$l(n.a)})`:`hsl(${e}, ${i}%, ${s}%)`}(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,s=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,l=i.a-s.a,c=((a*l==-1?a:(a+l)/(1+a*l))+1)/2;r=1-c,i.r=255&c*i.r+r*s.r+.5,i.g=255&c*i.g+r*s.g+.5,i.b=255&c*i.b+r*s.b+.5,i.a=o*i.a+(1-o)*s.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=function VHe(n,t,e){const i=dp($l(n.r)),s=dp($l(n.g)),r=dp($l(n.b));return{r:Zc(y2(i+e*(dp($l(t.r))-i))),g:Zc(y2(s+e*(dp($l(t.g))-s))),b:Zc(y2(r+e*(dp($l(t.b))-r))),a:n.a+e*(t.a-n.a)}}(this._rgb,t._rgb,e)),this}clone(){return new hp(this.rgb)}alpha(t){return this._rgb.a=Zc(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=up(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return n1(this._rgb,2,t),this}darken(t){return n1(this._rgb,2,-t),this}saturate(t){return n1(this._rgb,1,t),this}desaturate(t){return n1(this._rgb,1,-t),this}rotate(t){return function PHe(n,t){var e=g2(n);e[0]=gK(e[0]+t),e=_2(e),n.r=e[0],n.g=e[1],n.b=e[2]}(this._rgb,t),this}}function Bl(){}const UHe=(()=>{let n=0;return()=>n++})();function Vt(n){return null==n}function qn(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function Wt(n){return null!==n&&"[object Object]"===Object.prototype.toString.call(n)}function Ii(n){return("number"==typeof n||n instanceof Number)&&isFinite(+n)}function Gr(n,t){return Ii(n)?n:t}function yt(n,t){return typeof n>"u"?t:n}const xK=(n,t)=>"string"==typeof n&&n.endsWith("%")?parseFloat(n)/100*t:+n;function Fn(n,t,e){if(n&&"function"==typeof n.call)return n.apply(e,t)}function vn(n,t,e,i){let s,r,o;if(qn(n))if(r=n.length,i)for(s=r-1;s>=0;s--)t.call(e,n[s],s);else for(s=0;s<r;s++)t.call(e,n[s],s);else if(Wt(n))for(o=Object.keys(n),r=o.length,s=0;s<r;s++)t.call(e,n[o[s]],o[s])}function s1(n,t){let e,i,s,r;if(!n||!t||n.length!==t.length)return!1;for(e=0,i=n.length;e<i;++e)if(s=n[e],r=t[e],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function r1(n){if(qn(n))return n.map(r1);if(Wt(n)){const t=Object.create(null),e=Object.keys(n),i=e.length;let s=0;for(;s<i;++s)t[e[s]]=r1(n[e[s]]);return t}return n}function CK(n){return-1===["__proto__","prototype","constructor"].indexOf(n)}function HHe(n,t,e,i){if(!CK(n))return;const s=t[n],r=e[n];Wt(s)&&Wt(r)?__(s,r,i):t[n]=r1(r)}function __(n,t,e){const i=qn(t)?t:[t],s=i.length;if(!Wt(n))return n;const r=(e=e||{}).merger||HHe;let o;for(let a=0;a<s;++a){if(o=i[a],!Wt(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)r(l[c],n,o,e)}return n}function y_(n,t){return __(n,t,{merger:jHe})}function jHe(n,t,e){if(!CK(n))return;const i=t[n],s=e[n];Wt(i)&&Wt(s)?y_(i,s):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=r1(s))}const wK={"":n=>n,x:n=>n.x,y:n=>n.y};function Qc(n,t){return(wK[t]||(wK[t]=function qHe(n){const t=function GHe(n){const t=n.split("."),e=[];let i="";for(const s of t)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}(n);return e=>{for(const i of t){if(""===i)break;e=e&&e[i]}return e}}(t)))(n)}function v2(n){return n.charAt(0).toUpperCase()+n.slice(1)}const v_=n=>typeof n<"u",Jc=n=>"function"==typeof n,SK=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0},sn=Math.PI,Kn=2*sn,XHe=Kn+sn,o1=Number.POSITIVE_INFINITY,YHe=sn/180,Ai=sn/2,Dd=sn/4,IK=2*sn/3,eu=Math.log10,Ka=Math.sign;function x_(n,t,e){return Math.abs(n-t)<e}function EK(n){const t=Math.round(n);n=x_(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(eu(n))),i=n/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function fp(n){return!function QHe(n){return"symbol"==typeof n||"object"==typeof n&&null!==n&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function kK(n,t,e){let i,s,r;for(i=0,s=n.length;i<s;i++)r=n[i][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function sa(n){return n*(sn/180)}function x2(n){return n*(180/sn)}function TK(n){if(!Ii(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function DK(n,t){const e=t.x-n.x,i=t.y-n.y,s=Math.sqrt(e*e+i*i);let r=Math.atan2(i,e);return r<-.5*sn&&(r+=Kn),{angle:r,distance:s}}function C2(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function eje(n,t){return(n-t+XHe)%Kn-sn}function Us(n){return(n%Kn+Kn)%Kn}function C_(n,t,e,i){const s=Us(n),r=Us(t),o=Us(e),a=Us(r-s),l=Us(o-s),c=Us(s-r),u=Us(s-o);return s===r||s===o||i&&r===o||a>l&&c<u}function ms(n,t,e){return Math.max(t,Math.min(e,n))}function Vl(n,t,e,i=1e-6){return n>=Math.min(t,e)-i&&n<=Math.max(t,e)+i}function w2(n,t,e){e=e||(o=>n[o]<t);let r,i=n.length-1,s=0;for(;i-s>1;)r=s+i>>1,e(r)?s=r:i=r;return{lo:s,hi:i}}const zl=(n,t,e,i)=>w2(n,e,i?s=>{const r=n[s][t];return r<e||r===e&&n[s+1][t]===e}:s=>n[s][t]<e),nje=(n,t,e)=>w2(n,e,i=>n[i][t]>=e),NK=["push","pop","shift","splice","unshift"];function AK(n,t){const e=n._chartjs;if(!e)return;const i=e.listeners,s=i.indexOf(t);-1!==s&&i.splice(s,1),!(i.length>0)&&(NK.forEach(r=>{delete n[r]}),delete n._chartjs)}function MK(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const PK=typeof window>"u"?function(n){return n()}:window.requestAnimationFrame;function RK(n,t){let e=[],i=!1;return function(...s){e=s,i||(i=!0,PK.call(window,()=>{i=!1,n.apply(t,e)}))}}const S2=n=>"start"===n?"left":"end"===n?"right":"center",Ws=(n,t,e)=>"start"===n?t:"end"===n?e:(t+e)/2;function OK(n,t,e){const i=t.length;let s=0,r=i;if(n._sorted){const{iScale:o,vScale:a,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:d,max:h,minDefined:f,maxDefined:p}=o.getUserBounds();if(f){if(s=Math.min(zl(l,u,d).lo,e?i:zl(t,u,o.getPixelForValue(d)).lo),c){const g=l.slice(0,s+1).reverse().findIndex(m=>!Vt(m[a.axis]));s-=Math.max(0,g)}s=ms(s,0,i-1)}if(p){let g=Math.max(zl(l,o.axis,h,!0).hi+1,e?0:zl(t,u,o.getPixelForValue(h),!0).hi+1);if(c){const m=l.slice(g-1).findIndex(b=>!Vt(b[a.axis]));g+=Math.max(0,m)}r=ms(g,s,i)-s}else r=i-s}return{start:s,count:r}}function FK(n){const{xScale:t,yScale:e,_scaleRanges:i}=n,s={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!i)return n._scaleRanges=s,!0;const r=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==e.min||i.ymax!==e.max;return Object.assign(i,s),r}const a1=n=>0===n||1===n,LK=(n,t,e)=>-Math.pow(2,10*(n-=1))*Math.sin((n-t)*Kn/e),$K=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*Kn/e)+1,w_={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>1-Math.cos(n*Ai),easeOutSine:n=>Math.sin(n*Ai),easeInOutSine:n=>-.5*(Math.cos(sn*n)-1),easeInExpo:n=>0===n?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>1===n?1:1-Math.pow(2,-10*n),easeInOutExpo:n=>a1(n)?n:n<.5?.5*Math.pow(2,10*(2*n-1)):.5*(2-Math.pow(2,-10*(2*n-1))),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>a1(n)?n:LK(n,.075,.3),easeOutElastic:n=>a1(n)?n:$K(n,.075,.3),easeInOutElastic:n=>a1(n)?n:n<.5?.5*LK(2*n,.1125,.45):.5+.5*$K(2*n-1,.1125,.45),easeInBack:n=>n*n*(2.70158*n-1.70158),easeOutBack:n=>(n-=1)*n*(2.70158*n+1.70158)+1,easeInOutBack(n){let t=1.70158;return(n/=.5)<1?n*n*((1+(t*=1.525))*n-t)*.5:.5*((n-=2)*n*((1+(t*=1.525))*n+t)+2)},easeInBounce:n=>1-w_.easeOutBounce(1-n),easeOutBounce:n=>n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375,easeInOutBounce:n=>n<.5?.5*w_.easeInBounce(2*n):.5*w_.easeOutBounce(2*n-1)+.5};function I2(n){if(n&&"object"==typeof n){const t=n.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function BK(n){return I2(n)?n:new hp(n)}function E2(n){return I2(n)?n:new hp(n).saturate(.5).darken(.1).hexString()}const aje=["x","y","borderWidth","radius","tension"],lje=["color","borderColor","backgroundColor"],VK=new Map;function S_(n,t,e){return function dje(n,t){t=t||{};const e=n+JSON.stringify(t);let i=VK.get(e);return i||(i=new Intl.NumberFormat(n,t),VK.set(e,i)),i}(t,e).format(n)}const zK={values:n=>qn(n)?n:""+n,numeric(n,t,e){if(0===n)return"0";const i=this.chart.options.locale;let s,r=n;if(e.length>1){const c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),r=function hje(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}(n,e)}const o=eu(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),S_(n,i,l)},logarithmic(n,t,e){if(0===n)return"0";const i=e[t].significand||n/Math.pow(10,Math.floor(eu(n)));return[1,2,3,5,10,15].includes(i)||t>.8*e.length?zK.numeric.call(this,n,t,e):""}};var l1={formatters:zK};const Nd=Object.create(null),k2=Object.create(null);function I_(n,t){if(!t)return n;const e=t.split(".");for(let i=0,s=e.length;i<s;++i){const r=e[i];n=n[r]||(n[r]=Object.create(null))}return n}function T2(n,t,e){return"string"==typeof t?__(I_(n,t),e):__(I_(n,""),t)}class pje{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,s)=>E2(s.backgroundColor),this.hoverBorderColor=(i,s)=>E2(s.borderColor),this.hoverColor=(i,s)=>E2(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return T2(this,t,e)}get(t){return I_(this,t)}describe(t,e){return T2(k2,t,e)}override(t,e){return T2(Nd,t,e)}route(t,e,i,s){const r=I_(this,t),o=I_(this,i),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[a],c=o[s];return Wt(l)?Object.assign({},c,l):yt(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(e=>e(this))}}var ii=new pje({_scriptable:n=>!n.startsWith("on"),_indexable:n=>"events"!==n,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function cje(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),n.set("animations",{colors:{type:"color",properties:lje},numbers:{type:"number",properties:aje}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function uje(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function fje(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:l1.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function c1(n,t,e,i,s){let r=t[s];return r||(r=t[s]=n.measureText(s).width,e.push(s)),r>i&&(i=r),i}function gje(n,t,e,i){let s=(i=i||{}).data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},r=i.garbageCollect=[],i.font=t),n.save(),n.font=t;let o=0;const a=e.length;let l,c,u,d,h;for(l=0;l<a;l++)if(d=e[l],null==d||qn(d)){if(qn(d))for(c=0,u=d.length;c<u;c++)h=d[c],null!=h&&!qn(h)&&(o=c1(n,s,r,o,h))}else o=c1(n,s,r,o,d);n.restore();const f=r.length/2;if(f>e.length){for(l=0;l<f;l++)delete s[r[l]];r.splice(0,f)}return o}function Ad(n,t,e){const i=n.currentDevicePixelRatio,s=0!==e?Math.max(e/2,.5):0;return Math.round((t-s)*i)/i+s}function UK(n,t){!t&&!n||((t=t||n.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function D2(n,t,e,i){WK(n,t,e,i,null)}function WK(n,t,e,i,s){let r,o,a,l,c,u,d,h;const f=t.pointStyle,p=t.rotation,g=t.radius;let m=(p||0)*YHe;if(f&&"object"==typeof f&&(r=f.toString(),"[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r))return n.save(),n.translate(e,i),n.rotate(m),n.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void n.restore();if(!(isNaN(g)||g<=0)){switch(n.beginPath(),f){default:s?n.ellipse(e,i,s/2,g,0,0,Kn):n.arc(e,i,g,0,Kn),n.closePath();break;case"triangle":u=s?s/2:g,n.moveTo(e+Math.sin(m)*u,i-Math.cos(m)*g),m+=IK,n.lineTo(e+Math.sin(m)*u,i-Math.cos(m)*g),m+=IK,n.lineTo(e+Math.sin(m)*u,i-Math.cos(m)*g),n.closePath();break;case"rectRounded":c=.516*g,l=g-c,o=Math.cos(m+Dd)*l,d=Math.cos(m+Dd)*(s?s/2-c:l),a=Math.sin(m+Dd)*l,h=Math.sin(m+Dd)*(s?s/2-c:l),n.arc(e-d,i-a,c,m-sn,m-Ai),n.arc(e+h,i-o,c,m-Ai,m),n.arc(e+d,i+a,c,m,m+Ai),n.arc(e-h,i+o,c,m+Ai,m+sn),n.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,u=s?s/2:l,n.rect(e-u,i-l,2*u,2*l);break}m+=Dd;case"rectRot":d=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(s?s/2:g),n.moveTo(e-d,i-a),n.lineTo(e+h,i-o),n.lineTo(e+d,i+a),n.lineTo(e-h,i+o),n.closePath();break;case"crossRot":m+=Dd;case"cross":d=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(s?s/2:g),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+h,i-o),n.lineTo(e-h,i+o);break;case"star":d=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(s?s/2:g),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+h,i-o),n.lineTo(e-h,i+o),m+=Dd,d=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(s?s/2:g),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+h,i-o),n.lineTo(e-h,i+o);break;case"line":o=s?s/2:Math.cos(m)*g,a=Math.sin(m)*g,n.moveTo(e-o,i-a),n.lineTo(e+o,i+a);break;case"dash":n.moveTo(e,i),n.lineTo(e+Math.cos(m)*(s?s/2:g),i+Math.sin(m)*g);break;case!1:n.closePath()}n.fill(),t.borderWidth>0&&n.stroke()}}function Ul(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function u1(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function d1(n){n.restore()}function bje(n,t,e,i,s){if(!t)return n.lineTo(e.x,e.y);if("middle"===s){const r=(t.x+e.x)/2;n.lineTo(r,t.y),n.lineTo(r,e.y)}else"after"===s!=!!i?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function _je(n,t,e,i){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?e.cp2x:e.cp1x,i?e.cp2y:e.cp1y,e.x,e.y)}function vje(n,t,e,i,s){if(s.strikethrough||s.underline){const r=n.measureText(i),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,c=e+r.actualBoundingBoxDescent,u=s.strikethrough?(e-r.actualBoundingBoxAscent+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function xje(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function Md(n,t,e,i,s,r={}){const o=qn(t)?t:[t],a=r.strokeWidth>0&&""!==r.strokeColor;let l,c;for(n.save(),n.font=s.string,function yje(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),Vt(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}(n,r),l=0;l<o.length;++l)c=o[l],r.backdrop&&xje(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),Vt(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(c,e,i,r.maxWidth)),n.fillText(c,e,i,r.maxWidth),vje(n,e,i,c,r),i+=Number(s.lineHeight);n.restore()}function E_(n,t){const{x:e,y:i,w:s,h:r,radius:o}=t;n.arc(e+o.topLeft,i+o.topLeft,o.topLeft,1.5*sn,sn,!0),n.lineTo(e,i+r-o.bottomLeft),n.arc(e+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,sn,Ai,!0),n.lineTo(e+s-o.bottomRight,i+r),n.arc(e+s-o.bottomRight,i+r-o.bottomRight,o.bottomRight,Ai,0,!0),n.lineTo(e+s,i+o.topRight),n.arc(e+s-o.topRight,i+o.topRight,o.topRight,0,-Ai,!0),n.lineTo(e+o.topLeft,i)}const Cje=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,wje=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Sje(n,t){const e=(""+n).match(Cje);if(!e||"normal"===e[1])return 1.2*t;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100}return t*n}const Ije=n=>+n||0;function N2(n,t){const e={},i=Wt(t),s=i?Object.keys(t):t,r=Wt(n)?i?o=>yt(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of s)e[o]=Ije(r(o));return e}function HK(n){return N2(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Pd(n){return N2(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Hs(n){const t=HK(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function rs(n,t){let e=yt((n=n||{}).size,(t=t||ii.font).size);"string"==typeof e&&(e=parseInt(e,10));let i=yt(n.style,t.style);i&&!(""+i).match(wje)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:yt(n.family,t.family),lineHeight:Sje(yt(n.lineHeight,t.lineHeight),e),size:e,style:i,weight:yt(n.weight,t.weight),string:""};return s.string=function mje(n){return!n||Vt(n.size)||Vt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}(s),s}function k_(n,t,e,i){let r,o,a,s=!0;for(r=0,o=n.length;r<o;++r)if(a=n[r],void 0!==a&&(void 0!==t&&"function"==typeof a&&(a=a(t),s=!1),void 0!==e&&qn(a)&&(a=a[e%a.length],s=!1),void 0!==a))return i&&!s&&(i.cacheable=!1),a}function tu(n,t){return Object.assign(Object.create(n),t)}function A2(n,t=[""],e,i,s=(()=>n[0])){const r=e||n;typeof i>"u"&&(i=XK("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:i,_getTarget:s,override:a=>A2([a,...n],t,r,i)};return new Proxy(o,{deleteProperty:(a,l)=>(delete a[l],delete a._keys,delete n[0][l],!0),get:(a,l)=>GK(a,l,()=>function Rje(n,t,e,i){let s;for(const r of t)if(s=XK(kje(r,n),e),typeof s<"u")return M2(n,s)?P2(e,i,n,s):s}(l,t,n,a)),getOwnPropertyDescriptor:(a,l)=>Reflect.getOwnPropertyDescriptor(a._scopes[0],l),getPrototypeOf:()=>Reflect.getPrototypeOf(n[0]),has:(a,l)=>YK(a).includes(l),ownKeys:a=>YK(a),set(a,l,c){const u=a._storage||(a._storage=s());return a[l]=u[l]=c,delete a._keys,!0}})}function pp(n,t,e,i){const s={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:jK(n,i),setContext:r=>pp(n,r,e,i),override:r=>pp(n.override(r),t,e,i)};return new Proxy(s,{deleteProperty:(r,o)=>(delete r[o],delete n[o],!0),get:(r,o,a)=>GK(r,o,()=>function Tje(n,t,e){const{_proxy:i,_context:s,_subProxy:r,_descriptors:o}=n;let a=i[t];return Jc(a)&&o.isScriptable(t)&&(a=function Dje(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=t(r,o||i);return a.delete(n),M2(n,l)&&(l=P2(s._scopes,s,n,l)),l}(t,a,n,e)),qn(a)&&a.length&&(a=function Nje(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&i(n))return t[r.index%t.length];if(Wt(t[0])){const l=t,c=s._scopes.filter(u=>u!==l);t=[];for(const u of l){const d=P2(c,s,n,u);t.push(pp(d,r,o&&o[n],a))}}return t}(t,a,n,o.isIndexable)),M2(t,a)&&(a=pp(a,s,r&&r[t],o)),a}(r,o,a)),getOwnPropertyDescriptor:(r,o)=>r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o),getPrototypeOf:()=>Reflect.getPrototypeOf(n),has:(r,o)=>Reflect.has(n,o),ownKeys:()=>Reflect.ownKeys(n),set:(r,o,a)=>(n[o]=a,delete r[o],!0)})}function jK(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:i=t.indexable,_allKeys:s=t.allKeys}=n;return{allKeys:s,scriptable:e,indexable:i,isScriptable:Jc(e)?e:()=>e,isIndexable:Jc(i)?i:()=>i}}const kje=(n,t)=>n?n+v2(t):t,M2=(n,t)=>Wt(t)&&"adapters"!==n&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function GK(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||"constructor"===t)return n[t];const i=e();return n[t]=i,i}function qK(n,t,e){return Jc(n)?n(t,e):n}const Aje=(n,t)=>!0===n?t:"string"==typeof n?Qc(t,n):void 0;function Mje(n,t,e,i,s){for(const r of t){const o=Aje(e,r);if(o){n.add(o);const a=qK(o._fallback,e,s);if(typeof a<"u"&&a!==e&&a!==i)return a}else if(!1===o&&typeof i<"u"&&e!==i)return null}return!1}function P2(n,t,e,i){const s=t._rootScopes,r=qK(t._fallback,e,i),o=[...n,...s],a=new Set;a.add(i);let l=KK(a,o,e,r||e,i);return!(null===l||typeof r<"u"&&r!==e&&(l=KK(a,o,r,l,i),null===l))&&A2(Array.from(a),[""],s,r,()=>function Pje(n,t,e){const i=n._getTarget();t in i||(i[t]={});const s=i[t];return qn(s)&&Wt(e)?e:s||{}}(t,e,i))}function KK(n,t,e,i,s){for(;e;)e=Mje(n,t,e,i,s);return e}function XK(n,t){for(const e of t){if(!e)continue;const i=e[n];if(typeof i<"u")return i}}function YK(n){let t=n._keys;return t||(t=n._keys=function Oje(n){const t=new Set;for(const e of n)for(const i of Object.keys(e).filter(s=>!s.startsWith("_")))t.add(i);return Array.from(t)}(n._scopes)),t}function ZK(n,t,e,i){const{iScale:s}=n,{key:r="r"}=this._parsing,o=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+e,u=t[c],o[a]={r:s.parse(Qc(u,r),c)};return o}const Fje=Number.EPSILON||1e-14,mp=(n,t)=>t<n.length&&!n[t].skip&&n[t],QK=n=>"x"===n?"y":"x";function Lje(n,t,e,i){const s=n.skip?t:n,r=t,o=e.skip?t:e,a=C2(r,s),l=C2(o,r);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=i*c,h=i*u;return{previous:{x:r.x-d*(o.x-s.x),y:r.y-d*(o.y-s.y)},next:{x:r.x+h*(o.x-s.x),y:r.y+h*(o.y-s.y)}}}function h1(n,t,e){return Math.max(Math.min(n,e),t)}function Uje(n,t,e,i,s){let r,o,a,l;if(t.spanGaps&&(n=n.filter(c=>!c.skip)),"monotone"===t.cubicInterpolationMode)!function Vje(n,t="x"){const e=QK(t),i=n.length,s=Array(i).fill(0),r=Array(i);let o,a,l,c=mp(n,0);for(o=0;o<i;++o)if(a=l,l=c,c=mp(n,o+1),l){if(c){const u=c[t]-l[t];s[o]=0!==u?(c[e]-l[e])/u:0}r[o]=a?c?Ka(s[o-1])!==Ka(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}(function $je(n,t,e){const i=n.length;let s,r,o,a,l,c=mp(n,0);for(let u=0;u<i-1;++u)if(l=c,c=mp(n,u+1),l&&c){if(x_(t[u],0,Fje)){e[u]=e[u+1]=0;continue}s=e[u]/t[u],r=e[u+1]/t[u],a=Math.pow(s,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[u]=s*o*t[u],e[u+1]=r*o*t[u])}})(n,s,r),function Bje(n,t,e="x"){const i=QK(e),s=n.length;let r,o,a,l=mp(n,0);for(let c=0;c<s;++c){if(o=a,a=l,l=mp(n,c+1),!a)continue;const u=a[e],d=a[i];o&&(r=(u-o[e])/3,a[`cp1${e}`]=u-r,a[`cp1${i}`]=d-r*t[c]),l&&(r=(l[e]-u)/3,a[`cp2${e}`]=u+r,a[`cp2${i}`]=d+r*t[c])}}(n,r,t)}(n,s);else{let c=i?n[n.length-1]:n[0];for(r=0,o=n.length;r<o;++r)a=n[r],l=Lje(c,a,n[Math.min(r+1,o-(i?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&function zje(n,t){let e,i,s,r,o,a=Ul(n[0],t);for(e=0,i=n.length;e<i;++e)o=r,r=a,a=e<i-1&&Ul(n[e+1],t),r&&(s=n[e],o&&(s.cp1x=h1(s.cp1x,t.left,t.right),s.cp1y=h1(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=h1(s.cp2x,t.left,t.right),s.cp2y=h1(s.cp2y,t.top,t.bottom)))}(n,e)}function R2(){return typeof window<"u"&&typeof document<"u"}function O2(n){let t=n.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function f1(n,t,e){let i;return"string"==typeof n?(i=parseInt(n,10),-1!==n.indexOf("%")&&(i=i/100*t.parentNode[e])):i=n,i}const p1=n=>n.ownerDocument.defaultView.getComputedStyle(n,null),Hje=["top","right","bottom","left"];function Rd(n,t,e){const i={};e=e?"-"+e:"";for(let s=0;s<4;s++){const r=Hje[s];i[r]=parseFloat(n[t+"-"+r+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const jje=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function Od(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:i}=t,s=p1(e),r="border-box"===s.boxSizing,o=Rd(s,"padding"),a=Rd(s,"border","width"),{x:l,y:c,box:u}=function Gje(n,t){const e=n.touches,i=e&&e.length?e[0]:n,{offsetX:s,offsetY:r}=i;let a,l,o=!1;if(jje(s,r,n.target))a=s,l=r;else{const c=t.getBoundingClientRect();a=i.clientX-c.left,l=i.clientY-c.top,o=!0}return{x:a,y:l,box:o}}(n,e),d=o.left+(u&&a.left),h=o.top+(u&&a.top);let{width:f,height:p}=t;return r&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-d)/f*e.width/i),y:Math.round((c-h)/p*e.height/i)}}const nu=n=>Math.round(10*n)/10;function JK(n,t,e){const i=t||1,s=nu(n.height*i),r=nu(n.width*i);n.height=nu(n.height),n.width=nu(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),(n.currentDevicePixelRatio!==i||o.height!==s||o.width!==r)&&(n.currentDevicePixelRatio=i,o.height=s,o.width=r,n.ctx.setTransform(i,0,0,i,0,0),!0)}const Xje=function(){let n=!1;try{const t={get passive(){return n=!0,!1}};R2()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n}();function eX(n,t){const e=function Wje(n,t){return p1(n).getPropertyValue(t)}(n,t),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Fd(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function Yje(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:"middle"===i?e<.5?n.y:t.y:"after"===i?e<1?n.y:t.y:e>0?t.y:n.y}}function Zje(n,t,e,i){const s={x:n.cp2x,y:n.cp2y},r={x:t.cp1x,y:t.cp1y},o=Fd(n,s,e),a=Fd(s,r,e),l=Fd(r,t,e),c=Fd(o,a,e),u=Fd(a,l,e);return Fd(c,u,e)}const Qje=function(n,t){return{x:e=>n+n+t-e,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,i)=>e-i,leftForLtr:(e,i)=>e-i}},Jje=function(){return{x:n=>n,setWidth(n){},textAlign:n=>n,xPlus:(n,t)=>n+t,leftForLtr:(n,t)=>n}};function gp(n,t,e){return n?Qje(t,e):Jje()}function tX(n,t){let e,i;("ltr"===t||"rtl"===t)&&(e=n.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=i)}function nX(n,t){void 0!==t&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function iX(n){return"angle"===n?{between:C_,compare:eje,normalize:Us}:{between:Vl,compare:(t,e)=>t-e,normalize:t=>t}}function sX({start:n,end:t,count:e,loop:i,style:s}){return{start:n%e,end:t%e,loop:i&&(t-n+1)%e==0,style:s}}function rX(n,t,e){if(!e)return[n];const{property:i,start:s,end:r}=e,o=t.length,{compare:a,between:l,normalize:c}=iX(i),{start:u,end:d,loop:h,style:f}=function eGe(n,t,e){const{property:i,start:s,end:r}=e,{between:o,normalize:a}=iX(i),l=t.length;let h,f,{start:c,end:u,loop:d}=n;if(d){for(c+=l,u+=l,h=0,f=l;h<f&&o(a(t[c%l][i]),s,r);++h)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:n.style}}(n,t,e),p=[];let b,_,y,g=!1,m=null;for(let k=u,D=u;k<=d;++k)_=t[k%o],!_.skip&&(b=c(_[i]),b!==y&&(g=l(b,s,r),null===m&&(g||l(s,y,b)&&0!==a(s,y))&&(m=0===a(b,s)?k:D),null!==m&&(!g||0===a(r,b)||l(r,y,b))&&(p.push(sX({start:m,end:k,loop:h,count:o,style:f})),m=null),D=k,y=b));return null!==m&&p.push(sX({start:m,end:d,loop:h,count:o,style:f})),p}function oX(n,t){const e=[],i=n.segments;for(let s=0;s<i.length;s++){const r=rX(i[s],n.points,t);r.length&&e.push(...r)}return e}function lX(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function rGe(n,t){if(!t)return!1;const e=[],i=function(s,r){return I2(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(n,i)!==JSON.stringify(t,i)}function m1(n,t,e){return n.options.clip?n[e]:t[e]}function cX(n,t){const e=t._clip;if(e.disabled)return!1;const i=function oGe(n,t){const{xScale:e,yScale:i}=n;return e&&i?{left:m1(e,t,"left"),right:m1(e,t,"right"),top:m1(i,t,"top"),bottom:m1(i,t,"bottom")}:t}(t,n.chartArea);return{left:!1===e.left?0:i.left-(!0===e.left?0:e.left),right:!1===e.right?n.width:i.right+(!0===e.right?0:e.right),top:!1===e.top?0:i.top-(!0===e.top?0:e.top),bottom:!1===e.bottom?n.height:i.bottom+(!0===e.bottom?0:e.bottom)}}class aGe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,s){const o=e.duration;e.listeners[s].forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(i-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=PK.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const r=i.items;let l,o=r.length-1,a=!1;for(;o>=0;--o)l=r[o],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(s.draw(),this._notify(s,i,t,"progress")),r.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),e+=r.length}),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Wl=new aGe;const uX="transparent",lGe={boolean:(n,t,e)=>e>.5?t:n,color(n,t,e){const i=BK(n||uX),s=i.valid&&BK(t||uX);return s&&s.valid?s.mix(i,e).hexString():t},number:(n,t,e)=>n+(t-n)*e};class cGe{constructor(t,e,i,s){const r=e[i];s=k_([t.to,s,r,t.from]);const o=k_([t.from,r,s]);this._active=!0,this._fn=t.fn||lGe[t.type||typeof o],this._easing=w_[t.easing]||w_.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const s=this._target[this._prop],r=i-this._start,o=this._duration-r;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=k_([t.to,e,s,t.from]),this._from=k_([t.from,s,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,s=this._prop,r=this._from,o=this._loop,a=this._to;let l;if(this._active=r!==a&&(o||e<i),!this._active)return this._target[s]=a,void this._notify(!0);e<0?this._target[s]=r:(l=e/i%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(r,a,l))}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][e]()}}class dX{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Wt(t))return;const e=Object.keys(ii.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const r=t[s];if(!Wt(r))return;const o={};for(const a of e)o[a]=r[a];(qn(r.properties)&&r.properties||[s]).forEach(a=>{(a===s||!i.has(a))&&i.set(a,o)})})}_animateOptions(t,e){const i=e.options,s=function dGe(n,t){if(!t)return;let e=n.options;if(e)return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e;n.options=t}(t,i);if(!s)return[];const r=this._createAnimations(s,i);return i.$shared&&function uGe(n,t){const e=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const r=n[i[s]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}(t.options.$animations,i).then(()=>{t.options=i},()=>{}),r}_createAnimations(t,e){const i=this._properties,s=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if("$"===c.charAt(0))continue;if("options"===c){s.push(...this._animateOptions(t,e));continue}const u=e[c];let d=r[c];const h=i.get(c);if(d){if(h&&d.active()){d.update(h,u,a);continue}d.cancel()}h&&h.duration?(r[c]=d=new cGe(h,t,c,u),s.push(d)):t[c]=u}return s}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const i=this._createAnimations(t,e);return i.length?(Wl.add(this._chart,i),!0):void 0}}function hX(n,t){const e=n&&n.options||{},i=e.reverse,s=void 0===e.min?t:0,r=void 0===e.max?t:0;return{start:i?r:s,end:i?s:r}}function fX(n,t){const e=[],i=n._getSortedDatasetMetas(t);let s,r;for(s=0,r=i.length;s<r;++s)e.push(i[s].index);return e}function pX(n,t,e,i={}){const s=n.keys,r="single"===i.mode;let o,a,l,c;if(null===t)return;let u=!1;for(o=0,a=s.length;o<a;++o){if(l=+s[o],l===e){if(u=!0,i.all)continue;break}c=n.values[l],Ii(c)&&(r||0===t||Ka(t)===Ka(c))&&(t+=c)}return u||i.all?t:0}function F2(n,t){const e=n&&n.options.stacked;return e||void 0===e&&void 0!==t.stack}function bGe(n,t,e){const i=n[t]||(n[t]={});return i[e]||(i[e]={})}function mX(n,t,e,i){for(const s of t.getMatchingVisibleMetas(i).reverse()){const r=n[s.index];if(e&&r>0||!e&&r<0)return s.index}return null}function gX(n,t){const{chart:e,_cachedMeta:i}=n,s=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=i,l=r.axis,c=o.axis,u=function mGe(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}(r,o,i),d=t.length;let h;for(let f=0;f<d;++f){const p=t[f],{[l]:g,[c]:m}=p;h=(p._stacks||(p._stacks={}))[c]=bGe(s,u,g),h[a]=m,h._top=mX(h,o,!0,i.type),h._bottom=mX(h,o,!1,i.type),(h._visualValues||(h._visualValues={}))[a]=m}}function L2(n,t){const e=n.scales;return Object.keys(e).filter(i=>e[i].axis===t).shift()}function T_(n,t){const e=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){t=t||n._parsed;for(const s of t){const r=s._stacks;if(!r||void 0===r[i]||void 0===r[i][e])return;delete r[i][e],void 0!==r[i]._visualValues&&void 0!==r[i]._visualValues[e]&&delete r[i]._visualValues[e]}}}const $2=n=>"reset"===n||"none"===n,bX=(n,t)=>t?n:Object.assign({},n);let iu=(()=>{class n{constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=F2(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&T_(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,i=this._cachedMeta,s=this.getDataset(),r=(h,f,p,g)=>"x"===h?f:"r"===h?g:p,o=i.xAxisID=yt(s.xAxisID,L2(e,"x")),a=i.yAxisID=yt(s.yAxisID,L2(e,"y")),l=i.rAxisID=yt(s.rAxisID,L2(e,"r")),c=i.indexAxis,u=i.iAxisID=r(c,o,a,l),d=i.vAxisID=r(c,a,o,l);i.xScale=this.getScaleForId(o),i.yScale=this.getScaleForId(a),i.rScale=this.getScaleForId(l),i.iScale=this.getScaleForId(u),i.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&AK(this._data,this),e._stacked&&T_(e)}_dataCheck(){const e=this.getDataset(),i=e.data||(e.data=[]),s=this._data;if(Wt(i))this._data=function pGe(n,t){const{iScale:e,vScale:i}=t,s="x"===e.axis?"x":"y",r="x"===i.axis?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[s]:u,[r]:n[u]};return a}(i,this._cachedMeta);else if(s!==i){if(s){AK(s,this);const r=this._cachedMeta;T_(r),r._parsed=[]}i&&Object.isExtensible(i)&&function sje(n,t){n._chartjs?n._chartjs.listeners.push(t):(Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),NK.forEach(e=>{const i="_onData"+v2(e),s=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...r){const o=s.apply(this,r);return n._chartjs.listeners.forEach(a=>{"function"==typeof a[i]&&a[i](...r)}),o}})}))}(i,this),this._syncList=[],this._data=i}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const i=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const o=i._stacked;i._stacked=F2(i.vScale,i),i.stack!==s.stack&&(r=!0,T_(i),i.stack=s.stack),this._resyncElements(e),(r||o!==i._stacked)&&(gX(this,i._parsed),i._stacked=F2(i.vScale,i))}configure(){const e=this.chart.config,i=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){const{_cachedMeta:s,_data:r}=this,{iScale:o,_stacked:a}=s,l=o.axis;let d,h,f,c=0===e&&i===r.length||s._sorted,u=e>0&&s._parsed[e-1];if(!1===this._parsing)s._parsed=r,s._sorted=!0,f=r;else{f=qn(r[e])?this.parseArrayData(s,r,e,i):Wt(r[e])?this.parseObjectData(s,r,e,i):this.parsePrimitiveData(s,r,e,i);const p=()=>null===h[l]||u&&h[l]<u[l];for(d=0;d<i;++d)s._parsed[d+e]=h=f[d],c&&(p()&&(c=!1),u=h);s._sorted=c}a&&gX(this,f)}parsePrimitiveData(e,i,s,r){const{iScale:o,vScale:a}=e,l=o.axis,c=a.axis,u=o.getLabels(),d=o===a,h=new Array(r);let f,p,g;for(f=0,p=r;f<p;++f)g=f+s,h[f]={[l]:d||o.parse(u[g],g),[c]:a.parse(i[g],g)};return h}parseArrayData(e,i,s,r){const{xScale:o,yScale:a}=e,l=new Array(r);let c,u,d,h;for(c=0,u=r;c<u;++c)d=c+s,h=i[d],l[c]={x:o.parse(h[0],d),y:a.parse(h[1],d)};return l}parseObjectData(e,i,s,r){const{xScale:o,yScale:a}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(r);let d,h,f,p;for(d=0,h=r;d<h;++d)f=d+s,p=i[f],u[d]={x:o.parse(Qc(p,l),f),y:a.parse(Qc(p,c),f)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,s){const o=this._cachedMeta,a=i[e.axis];return pX({keys:fX(this.chart,!0),values:i._stacks[e.axis]._visualValues},a,o.index,{mode:s})}updateRangeFromParsed(e,i,s,r){const o=s[i.axis];let a=null===o?NaN:o;const l=r&&s._stacks[i.axis];r&&l&&(r.values=l,a=pX(r,o,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,i){const s=this._cachedMeta,r=s._parsed,o=s._sorted&&e===s.iScale,a=r.length,l=this._getOtherScale(e),c=((n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:fX(this.chart,!0),values:null})(i,s),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=function gGe(n){const{min:t,max:e,minDefined:i,maxDefined:s}=n.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:s?e:Number.POSITIVE_INFINITY}}(l);let f,p;function g(){p=r[f];const m=p[l.axis];return!Ii(p[e.axis])||d>m||h<m}for(f=0;f<a&&(g()||(this.updateRangeFromParsed(u,e,p,c),!o));++f);if(o)for(f=a-1;f>=0;--f)if(!g()){this.updateRangeFromParsed(u,e,p,c);break}return u}getAllParsedValues(e){const i=this._cachedMeta._parsed,s=[];let r,o,a;for(r=0,o=i.length;r<o;++r)a=i[r][e.axis],Ii(a)&&s.push(a);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const i=this._cachedMeta,s=i.iScale,r=i.vScale,o=this.getParsed(e);return{label:s?""+s.getLabelForValue(o[s.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(e){const i=this._cachedMeta;this.update(e||"default"),i._clip=function fGe(n){let t,e,i,s;return Wt(n)?(t=n.top,e=n.right,i=n.bottom,s=n.left):t=e=i=s=n,{top:t,right:e,bottom:i,left:s,disabled:!1===n}}(yt(this.options.clip,function hGe(n,t,e){if(!1===e)return!1;const i=hX(n,e),s=hX(t,e);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,s=this._cachedMeta,r=s.data||[],o=this.chart.chartArea,a=[],l=this._drawStart||0,c=this._drawCount||r.length-l,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(e,o,l,c),d=l;d<l+c;++d){const h=r[d];h.hidden||(h.active&&u?a.push(h):h.draw(e,o))}for(d=0;d<a.length;++d)a[d].draw(e,o)}getStyle(e,i){const s=i?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,i,s){const r=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];o=a.$context||(a.$context=function yGe(n,t,e){return tu(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}(this.getContext(),e,a)),o.parsed=this.getParsed(e),o.raw=r.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=function _Ge(n,t){return tu(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!i,o.mode=s,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",s){const r="active"===i,o=this._cachedDataOpts,a=e+"-"+i,l=o[a],c=this.enableOptionSharing&&v_(s);if(l)return bX(l,c);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],f=u.getOptionScopes(this.getDataset(),d),p=Object.keys(ii.elements[e]),m=u.resolveNamedOptions(f,p,()=>this.getContext(s,r,i),h);return m.$shared&&(m.$shared=c,o[a]=Object.freeze(bX(m,c))),m}_resolveAnimations(e,i,s){const r=this.chart,o=this._cachedDataOpts,a=`animation-${i}`,l=o[a];if(l)return l;let c;if(!1!==r.options.animation){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,i),f=d.getOptionScopes(this.getDataset(),h);c=d.createResolver(f,this.getContext(e,s,i))}const u=new dX(r,c&&c.animations);return c&&c._cacheable&&(o[a]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||$2(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){const s=this.resolveDataElementOptions(e,i),r=this._sharedOptions,o=this.getSharedOptions(s),a=this.includeOptions(i,o)||o!==r;return this.updateSharedOptions(o,i,s),{sharedOptions:o,includeOptions:a}}updateElement(e,i,s,r){$2(r)?Object.assign(e,s):this._resolveAnimations(i,r).update(e,s)}updateSharedOptions(e,i,s){e&&!$2(i)&&this._resolveAnimations(void 0,i).update(e,s)}_setStyle(e,i,s,r){e.active=r;const o=this.getStyle(i,r);this._resolveAnimations(i,s,r).update(e,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(e,i,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,i,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const i=this._data,s=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const r=s.length,o=i.length,a=Math.min(o,r);a&&this.parse(0,a),o>r?this._insertElements(r,o-r,e):o<r&&this._removeElements(o,r-o)}_insertElements(e,i,s=!0){const r=this._cachedMeta,o=r.data,a=e+i;let l;const c=u=>{for(u.length+=i,l=u.length-1;l>=a;l--)u[l]=u[l-i]};for(c(o),l=e;l<a;++l)o[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(e,i),s&&this.updateElements(o,e,i,"reset")}updateElements(e,i,s,r){}_removeElements(e,i){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,i);s._stacked&&T_(s,r)}s.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[i,s,r]=e;this[i](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return Ie(n,"defaults",{}),Ie(n,"datasetElementType",null),Ie(n,"dataElementType",null),n})();function CGe(n){const t=n.iScale,e=function xGe(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let i=[];for(let s=0,r=e.length;s<r;s++)i=i.concat(e[s].controller.getAllParsedValues(n));n._cache.$bar=MK(i.sort((s,r)=>s-r))}return n._cache.$bar}(t,n.type);let s,r,o,a,i=t._length;const l=()=>{32767===o||-32768===o||(v_(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(s=0,r=e.length;s<r;++s)o=t.getPixelForValue(e[s]),l();for(a=void 0,s=0,r=t.ticks.length;s<r;++s)o=t.getPixelForTick(s),l();return i}function _X(n,t,e,i){return qn(n)?function IGe(n,t,e,i){const s=e.parse(n[0],i),r=e.parse(n[1],i),o=Math.min(s,r),a=Math.max(s,r);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),t[e.axis]=c,t._custom={barStart:l,barEnd:c,start:s,end:r,min:o,max:a}}(n,t,e,i):t[e.axis]=e.parse(n,i),t}function yX(n,t,e,i){const s=n.iScale,r=n.vScale,o=s.getLabels(),a=s===r,l=[];let c,u,d,h;for(c=e,u=e+i;c<u;++c)h=t[c],d={},d[s.axis]=a||s.parse(o[c],c),l.push(_X(h,d,r,c));return l}function B2(n){return n&&void 0!==n.barStart&&void 0!==n.barEnd}function TGe(n,t,e,i){let s=t.borderSkipped;const r={};if(!s)return void(n.borderSkipped=r);if(!0===s)return void(n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:a,reverse:l,top:c,bottom:u}=function kGe(n){let t,e,i,s,r;return n.horizontal?(t=n.base>n.x,e="left",i="right"):(t=n.base<n.y,e="bottom",i="top"),t?(s="end",r="start"):(s="start",r="end"),{start:e,end:i,reverse:t,top:s,bottom:r}}(n);"middle"===s&&e&&(n.enableBorderRadius=!0,(e._top||0)===i?s=c:(e._bottom||0)===i?s=u:(r[vX(u,o,a,l)]=!0,s=c)),r[vX(s,o,a,l)]=!0,n.borderSkipped=r}function vX(n,t,e,i){return i?(n=function DGe(n,t,e){return n===t?e:n===e?t:n}(n,t,e),n=xX(n,e,t)):n=xX(n,t,e),n}function xX(n,t,e){return"start"===n?t:"end"===n?e:n}function NGe(n,{inflateAmount:t},e){n.inflateAmount="auto"===t?1===e?.33:0:t}let AGe=(()=>{class n extends iu{parsePrimitiveData(e,i,s,r){return yX(e,i,s,r)}parseArrayData(e,i,s,r){return yX(e,i,s,r)}parseObjectData(e,i,s,r){const{iScale:o,vScale:a}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u="x"===o.axis?l:c,d="x"===a.axis?l:c,h=[];let f,p,g,m;for(f=s,p=s+r;f<p;++f)m=i[f],g={},g[o.axis]=o.parse(Qc(m,u),f),h.push(_X(Qc(m,d),g,a,f));return h}updateRangeFromParsed(e,i,s,r){super.updateRangeFromParsed(e,i,s,r);const o=s._custom;o&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const i=this._cachedMeta,{iScale:s,vScale:r}=i,o=this.getParsed(e),a=o._custom,l=B2(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(o[r.axis]);return{label:""+s.getLabelForValue(o[s.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(e){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,s,r){const o="reset"===r,{index:a,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(i,r);for(let p=i;p<i+s;p++){const g=this.getParsed(p),m=o||Vt(g[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(p),b=this._calculateBarIndexPixels(p,d),_=(g._stacks||{})[l.axis],y={horizontal:u,base:m.base,enableBorderRadius:!_||B2(g._custom)||a===_._top||a===_._bottom,x:u?m.head:b.center,y:u?b.center:m.head,height:u?b.size:Math.abs(m.size),width:u?Math.abs(m.size):b.size};f&&(y.options=h||this.resolveDataElementOptions(p,e[p].active?"active":r));const v=y.options||e[p].options;TGe(y,v,_,a),NGe(y,v,d.ratio),this.updateElement(e[p],p,y,r)}}_getStacks(e,i){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),o=s.options.stacked,a=[],l=this._cachedMeta.controller.getParsed(i),c=l&&l[s.axis],u=d=>{const h=d._parsed.find(p=>p[s.axis]===c),f=h&&h[d.vScale.axis];if(Vt(f)||isNaN(f))return!0};for(const d of r)if((void 0===i||!u(d))&&((!1===o||-1===a.indexOf(d.stack)||void 0===o&&void 0===d.stack)&&a.push(d.stack),d.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,i=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===i).shift()}_getAxis(){const e={},i=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[yt("x"===this.chart.options.indexAxis?s.xAxisID:s.yAxisID,i)]=!0;return Object.keys(e)}_getStackIndex(e,i,s){const r=this._getStacks(e,s),o=void 0!==i?r.indexOf(i):-1;return-1===o?r.length-1:o}_getRuler(){const e=this.options,i=this._cachedMeta,s=i.iScale,r=[];let o,a;for(o=0,a=i.data.length;o<a;++o)r.push(s.getPixelForValue(this.getParsed(o)[s.axis],o));const l=e.barThickness;return{min:l||CGe(i),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:i,_stacked:s,index:r},options:{base:o,minBarLength:a}}=this,l=o||0,c=this.getParsed(e),u=c._custom,d=B2(u);let g,m,h=c[i.axis],f=0,p=s?this.applyStack(i,c,s):h;p!==h&&(f=p-h,p=h),d&&(h=u.barStart,p=u.barEnd-u.barStart,0!==h&&Ka(h)!==Ka(u.barEnd)&&(f=0),f+=h);const b=Vt(o)||d?f:o;let _=i.getPixelForValue(b);if(g=this.chart.getDataVisibility(e)?i.getPixelForValue(f+p):_,m=g-_,Math.abs(m)<a){m=function EGe(n,t,e){return 0!==n?Ka(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}(m,i,l)*a,h===l&&(_-=m/2);const y=i.getPixelForDecimal(0),v=i.getPixelForDecimal(1),x=Math.min(y,v),S=Math.max(y,v);_=Math.max(Math.min(_,S),x),g=_+m,s&&!d&&(c._stacks[i.axis]._visualValues[r]=i.getValueForPixel(g)-i.getValueForPixel(_))}if(_===i.getPixelForValue(l)){const y=Ka(m)*i.getLineWidthForValue(l)/2;_+=y,m-=y}return{size:m,base:_,head:g,center:g+m/2}}_calculateBarIndexPixels(e,i){const s=i.scale,r=this.options,o=r.skipNull,a=yt(r.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(i.grouped){const d=o?this._getStackCount(e):i.stackCount,h="flex"===r.barThickness?function SGe(n,t,e,i){const s=t.pixels,r=s[n];let o=n>0?s[n-1]:null,a=n<s.length-1?s[n+1]:null;const l=e.categoryPercentage;null===o&&(o=r-(null===a?t.end-t.start:a-r)),null===a&&(a=r+r-o);const c=r-(r-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/i,ratio:e.barPercentage,start:c}}(e,i,r,d*u):function wGe(n,t,e,i){const s=e.barThickness;let r,o;return Vt(s)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=s*i,o=1),{chunk:r/i,ratio:o,start:t.pixels[n]-r/2}}(e,i,r,d*u),f="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(yt(f,this.getFirstScaleIdForIndexAxis())),g=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+p;l=h.start+h.chunk*g+h.chunk/2,c=Math.min(a,h.chunk*h.ratio)}else l=s.getPixelForValue(this.getParsed(e)[s.axis],e),c=Math.min(a,i.min*i.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,i=e.vScale,s=e.data,r=s.length;let o=0;for(;o<r;++o)null!==this.getParsed(o)[i.axis]&&!s[o].hidden&&s[o].draw(this._ctx)}}return Ie(n,"id","bar"),Ie(n,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ie(n,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}}),n})(),MGe=(()=>{class n extends iu{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,s,r){const o=super.parsePrimitiveData(e,i,s,r);for(let a=0;a<o.length;a++)o[a]._custom=this.resolveDataElementOptions(a+s).radius;return o}parseArrayData(e,i,s,r){const o=super.parseArrayData(e,i,s,r);for(let a=0;a<o.length;a++)o[a]._custom=yt(i[s+a][2],this.resolveDataElementOptions(a+s).radius);return o}parseObjectData(e,i,s,r){const o=super.parseObjectData(e,i,s,r);for(let a=0;a<o.length;a++){const l=i[s+a];o[a]._custom=yt(l&&l.r&&+l.r,this.resolveDataElementOptions(a+s).radius)}return o}getMaxOverflow(){const e=this._cachedMeta.data;let i=0;for(let s=e.length-1;s>=0;--s)i=Math.max(i,e[s].size(this.resolveDataElementOptions(s))/2);return i>0&&i}getLabelAndValue(e){const i=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:o}=i,a=this.getParsed(e),l=r.getLabelForValue(a.x),c=o.getLabelForValue(a.y),u=a._custom;return{label:s[e]||"",value:"("+l+", "+c+(u?", "+u:"")+")"}}update(e){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,s,r){const o="reset"===r,{iScale:a,vScale:l}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(i,r),d=a.axis,h=l.axis;for(let f=i;f<i+s;f++){const p=e[f],g=!o&&this.getParsed(f),m={},b=m[d]=o?a.getPixelForDecimal(.5):a.getPixelForValue(g[d]),_=m[h]=o?l.getBasePixel():l.getPixelForValue(g[h]);m.skip=isNaN(b)||isNaN(_),u&&(m.options=c||this.resolveDataElementOptions(f,p.active?"active":r),o&&(m.options.radius=0)),this.updateElement(p,f,m,r)}}resolveDataElementOptions(e,i){const s=this.getParsed(e);let r=super.resolveDataElementOptions(e,i);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const o=r.radius;return"active"!==i&&(r.radius=0),r.radius+=yt(s&&s._custom,o),r}}return Ie(n,"id","bubble"),Ie(n,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Ie(n,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}}),n})(),V2=(()=>{class n extends iu{constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){const s=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=s;else{let a,l,o=c=>+s[c];if(Wt(s[e])){const{key:c="value"}=this._parsing;o=u=>+Qc(s[u],c)}for(a=e,l=e+i;a<l;++a)r._parsed[a]=o(a)}}_getRotation(){return sa(this.options.rotation-90)}_getCircumference(){return sa(this.options.circumference)}_getRotationExtents(){let e=Kn,i=-Kn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,o=r._getRotation(),a=r._getCircumference();e=Math.min(e,o),i=Math.max(i,o+a)}return{rotation:e,circumference:i-e}}update(e){const i=this.chart,{chartArea:s}=i,r=this._cachedMeta,o=r.data,a=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,l=Math.max((Math.min(s.width,s.height)-a)/2,0),c=Math.min(((n,t)=>"string"==typeof n&&n.endsWith("%")?parseFloat(n)/100:+n/t)(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:g,offsetY:m}=function PGe(n,t,e){let i=1,s=1,r=0,o=0;if(t<Kn){const a=n,l=a+t,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),h=Math.sin(l),f=(y,v,x)=>C_(y,a,l,!0)?1:Math.max(v,v*e,x,x*e),p=(y,v,x)=>C_(y,a,l,!0)?-1:Math.min(v,v*e,x,x*e),g=f(0,c,d),m=f(Ai,u,h),b=p(sn,c,d),_=p(sn+Ai,u,h);i=(g-b)/2,s=(m-_)/2,r=-(g+b)/2,o=-(m+_)/2}return{ratioX:i,ratioY:s,offsetX:r,offsetY:o}}(h,d,c),y=Math.max(Math.min((s.width-a)/f,(s.height-a)/p)/2,0),v=xK(this.options.radius,y),S=(v-Math.max(v*c,0))/this._getVisibleDatasetWeightTotal();this.offsetX=g*v,this.offsetY=m*v,r.total=this.calculateTotal(),this.outerRadius=v-S*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-S*u,0),this.updateElements(o,0,o.length,e)}_circumference(e,i){const s=this.options,r=this._cachedMeta,o=this._getCircumference();return i&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*o/Kn)}updateElements(e,i,s,r){const o="reset"===r,a=this.chart,l=a.chartArea,d=(l.left+l.right)/2,h=(l.top+l.bottom)/2,f=o&&a.options.animation.animateScale,p=f?0:this.innerRadius,g=f?0:this.outerRadius,{sharedOptions:m,includeOptions:b}=this._getSharedOptions(i,r);let y,_=this._getRotation();for(y=0;y<i;++y)_+=this._circumference(y,o);for(y=i;y<i+s;++y){const v=this._circumference(y,o),x=e[y],S={x:d+this.offsetX,y:h+this.offsetY,startAngle:_,endAngle:_+v,circumference:v,outerRadius:g,innerRadius:p};b&&(S.options=m||this.resolveDataElementOptions(y,x.active?"active":r)),_+=v,this.updateElement(x,y,S,r)}}calculateTotal(){const e=this._cachedMeta,i=e.data;let r,s=0;for(r=0;r<i.length;r++){const o=e._parsed[r];null!==o&&!isNaN(o)&&this.chart.getDataVisibility(r)&&!i[r].hidden&&(s+=Math.abs(o))}return s}calculateCircumference(e){const i=this._cachedMeta.total;return i>0&&!isNaN(e)?Kn*(Math.abs(e)/i):0}getLabelAndValue(e){const s=this.chart,r=s.data.labels||[],o=S_(this._cachedMeta._parsed[e],s.options.locale);return{label:r[e]||"",value:o}}getMaxBorderWidth(e){let i=0;const s=this.chart;let r,o,a,l,c;if(!e)for(r=0,o=s.data.datasets.length;r<o;++r)if(s.isDatasetVisible(r)){a=s.getDatasetMeta(r),e=a.data,l=a.controller;break}if(!e)return 0;for(r=0,o=e.length;r<o;++r)c=l.resolveDataElementOptions(r),"inner"!==c.borderAlign&&(i=Math.max(i,c.borderWidth||0,c.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let s=0,r=e.length;s<r;++s){const o=this.resolveDataElementOptions(s);i=Math.max(i,o.offset||0,o.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(i+=this._getRingWeight(s));return i}_getRingWeight(e){return Math.max(yt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return Ie(n,"id","doughnut"),Ie(n,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Ie(n,"descriptors",{_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Ie(n,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data,{labels:{pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=t.legend.options;return e.labels.length&&e.datasets.length?e.labels.map((l,c)=>{const d=t.getDatasetMeta(0).controller.getStyle(c);return{text:l,fillStyle:d.backgroundColor,fontColor:r,hidden:!t.getDataVisibility(c),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:s,pointStyle:i,borderRadius:o&&(a||d.borderRadius),index:c}}):[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}}),n})(),RGe=(()=>{class n extends iu{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const i=this._cachedMeta,{dataset:s,data:r=[],_dataset:o}=i,a=this.chart._animationsDisabled;let{start:l,count:c}=OK(i,r,a);this._drawStart=l,this._drawCount=c,FK(i)&&(l=0,c=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!o._decimated,s.points=r;const u=this.resolveDatasetElementOptions(e);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(s,void 0,{animated:!a,options:u},e),this.updateElements(r,l,c,e)}updateElements(e,i,s,r){const o="reset"===r,{iScale:a,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:d,includeOptions:h}=this._getSharedOptions(i,r),f=a.axis,p=l.axis,{spanGaps:g,segment:m}=this.options,b=fp(g)?g:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||o||"none"===r,y=i+s,v=e.length;let x=i>0&&this.getParsed(i-1);for(let S=0;S<v;++S){const E=e[S],k=_?E:{};if(S<i||S>=y){k.skip=!0;continue}const D=this.getParsed(S),M=Vt(D[p]),R=k[f]=a.getPixelForValue(D[f],S),U=k[p]=o||M?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,D,c):D[p],S);k.skip=isNaN(R)||isNaN(U)||M,k.stop=S>0&&Math.abs(D[f]-x[f])>b,m&&(k.parsed=D,k.raw=u.data[S]),h&&(k.options=d||this.resolveDataElementOptions(S,E.active?"active":r)),_||this.updateElement(E,S,k,r),x=D}}getMaxOverflow(){const e=this._cachedMeta,i=e.dataset,s=i.options&&i.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const o=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,o,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}return Ie(n,"id","line"),Ie(n,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Ie(n,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}}),n})(),CX=(()=>{class n extends iu{constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const s=this.chart,r=s.data.labels||[],o=S_(this._cachedMeta._parsed[e].r,s.options.locale);return{label:r[e]||"",value:o}}parseObjectData(e,i,s,r){return ZK.bind(this)(e,i,s,r)}update(e){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){const i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return this._cachedMeta.data.forEach((s,r)=>{const o=this.getParsed(r).r;!isNaN(o)&&this.chart.getDataVisibility(r)&&(o<i.min&&(i.min=o),o>i.max&&(i.max=o))}),i}_updateRadius(){const e=this.chart,i=e.chartArea,s=e.options,r=Math.min(i.right-i.left,i.bottom-i.top),o=Math.max(r/2,0),l=(o-Math.max(s.cutoutPercentage?o/100*s.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=o-l*this.index,this.innerRadius=this.outerRadius-l}updateElements(e,i,s,r){const o="reset"===r,a=this.chart,c=a.options.animation,u=this._cachedMeta.rScale,d=u.xCenter,h=u.yCenter,f=u.getIndexAngle(0)-.5*sn;let g,p=f;const m=360/this.countVisibleElements();for(g=0;g<i;++g)p+=this._computeAngle(g,r,m);for(g=i;g<i+s;g++){const b=e[g];let _=p,y=p+this._computeAngle(g,r,m),v=a.getDataVisibility(g)?u.getDistanceFromCenterForValue(this.getParsed(g).r):0;p=y,o&&(c.animateScale&&(v=0),c.animateRotate&&(_=y=f));const x={x:d,y:h,innerRadius:0,outerRadius:v,startAngle:_,endAngle:y,options:this.resolveDataElementOptions(g,b.active?"active":r)};this.updateElement(b,g,x,r)}}countVisibleElements(){let i=0;return this._cachedMeta.data.forEach((s,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&i++}),i}_computeAngle(e,i,s){return this.chart.getDataVisibility(e)?sa(this.resolveDataElementOptions(e,i).angle||s):0}}return Ie(n,"id","polarArea"),Ie(n,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Ie(n,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((r,o)=>{const l=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}}),n})();var OGe=Object.freeze({__proto__:null,BarController:AGe,BubbleController:MGe,DoughnutController:V2,LineController:RGe,PieController:(()=>{class n extends V2{}return Ie(n,"id","pie"),Ie(n,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"}),n})(),PolarAreaController:CX,RadarController:(()=>{class n extends iu{getLabelAndValue(e){const i=this._cachedMeta.vScale,s=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(s[i.axis])}}parseObjectData(e,i,s,r){return ZK.bind(this)(e,i,s,r)}update(e){const i=this._cachedMeta,s=i.dataset,r=i.data||[],o=i.iScale.getLabels();if(s.points=r,"resize"!==e){const a=this.resolveDatasetElementOptions(e);this.options.showLine||(a.borderWidth=0),this.updateElement(s,void 0,{_loop:!0,_fullLoop:o.length===r.length,options:a},e)}this.updateElements(r,0,r.length,e)}updateElements(e,i,s,r){const o=this._cachedMeta.rScale,a="reset"===r;for(let l=i;l<i+s;l++){const c=e[l],u=this.resolveDataElementOptions(l,c.active?"active":r),d=o.getPointPositionForValue(l,this.getParsed(l).r),h=a?o.xCenter:d.x,f=a?o.yCenter:d.y,p={x:h,y:f,angle:d.angle,skip:isNaN(h)||isNaN(f),options:u};this.updateElement(c,l,p,r)}}}return Ie(n,"id","radar"),Ie(n,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Ie(n,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}}),n})(),ScatterController:(()=>{class n extends iu{getLabelAndValue(e){const i=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:o}=i,a=this.getParsed(e),l=r.getLabelForValue(a.x),c=o.getLabelForValue(a.y);return{label:s[e]||"",value:"("+l+", "+c+")"}}update(e){const i=this._cachedMeta,{data:s=[]}=i,r=this.chart._animationsDisabled;let{start:o,count:a}=OK(i,s,r);if(this._drawStart=o,this._drawCount=a,FK(i)&&(o=0,a=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:l,_dataset:c}=i;l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!c._decimated,l.points=s;const u=this.resolveDatasetElementOptions(e);u.segment=this.options.segment,this.updateElement(l,void 0,{animated:!r,options:u},e)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(s,o,a,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,s,r){const o="reset"===r,{iScale:a,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,d=this.resolveDataElementOptions(i,r),h=this.getSharedOptions(d),f=this.includeOptions(r,h),p=a.axis,g=l.axis,{spanGaps:m,segment:b}=this.options,_=fp(m)?m:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||o||"none"===r;let v=i>0&&this.getParsed(i-1);for(let x=i;x<i+s;++x){const S=e[x],E=this.getParsed(x),k=y?S:{},D=Vt(E[g]),M=k[p]=a.getPixelForValue(E[p],x),R=k[g]=o||D?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,E,c):E[g],x);k.skip=isNaN(M)||isNaN(R)||D,k.stop=x>0&&Math.abs(E[p]-v[p])>_,b&&(k.parsed=E,k.raw=u.data[x]),f&&(k.options=h||this.resolveDataElementOptions(x,S.active?"active":r)),y||this.updateElement(S,x,k,r),v=E}this.updateSharedOptions(h,r,d)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let l=0;for(let c=i.length-1;c>=0;--c)l=Math.max(l,i[c].size(this.resolveDataElementOptions(c))/2);return l>0&&l}const s=e.dataset,r=s.options&&s.options.borderWidth||0;if(!i.length)return r;const o=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,o,a)/2}}return Ie(n,"id","scatter"),Ie(n,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Ie(n,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}}),n})()});function Ld(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class z2{static override(t){Object.assign(z2.prototype,t)}constructor(t){Ie(this,"options",void 0),this.options=t||{}}init(){}formats(){return Ld()}parse(){return Ld()}format(){return Ld()}add(){return Ld()}diff(){return Ld()}startOf(){return Ld()}endOf(){return Ld()}}var FGe__date=z2;function LGe(n,t,e,i){const{controller:s,data:r,_sorted:o}=n,a=s._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&"r"!==t&&o&&r.length){const c=a._reversePixels?nje:zl;if(!i){const u=c(r,t,e);if(l){const{vScale:d}=s._cachedMeta,{_parsed:h}=n,f=h.slice(0,u.lo+1).reverse().findIndex(g=>!Vt(g[d.axis]));u.lo-=Math.max(0,f);const p=h.slice(u.hi).findIndex(g=>!Vt(g[d.axis]));u.hi+=Math.max(0,p)}return u}if(s._sharedOptions){const u=r[0],d="function"==typeof u.getRange&&u.getRange(t);if(d){const h=c(r,t,e-d),f=c(r,t,e+d);return{lo:h.lo,hi:f.hi}}}}return{lo:0,hi:r.length-1}}function D_(n,t,e,i,s){const r=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,l=r.length;a<l;++a){const{index:c,data:u}=r[a],{lo:d,hi:h}=LGe(r[a],t,o,s);for(let f=d;f<=h;++f){const p=u[f];p.skip||i(p,c,f)}}}function U2(n,t,e,i,s){const r=[];return!s&&!n.isPointInArea(t)||D_(n,e,t,function(a,l,c){!s&&!Ul(a,n.chartArea,0)||a.inRange(t.x,t.y,i)&&r.push({element:a,datasetIndex:l,index:c})},!0),r}function W2(n,t,e,i,s,r){return r||n.isPointInArea(t)?"r"!==e||i?function VGe(n,t,e,i,s,r){let o=[];const a=function $Ge(n){const t=-1!==n.indexOf("x"),e=-1!==n.indexOf("y");return function(i,s){const r=t?Math.abs(i.x-s.x):0,o=e?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}(e);let l=Number.POSITIVE_INFINITY;return D_(n,e,t,function c(u,d,h){const f=u.inRange(t.x,t.y,s);if(i&&!f)return;const p=u.getCenterPoint(s);if(!r&&!n.isPointInArea(p)&&!f)return;const m=a(t,p);m<l?(o=[{element:u,datasetIndex:d,index:h}],l=m):m===l&&o.push({element:u,datasetIndex:d,index:h})}),o}(n,t,e,i,s,r):function BGe(n,t,e,i){let s=[];return D_(n,e,t,function r(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],i),{angle:d}=DK(o,{x:t.x,y:t.y});C_(d,c,u)&&s.push({element:o,datasetIndex:a,index:l})}),s}(n,t,e,s):[]}function wX(n,t,e,i,s){const r=[],o="x"===e?"inXRange":"inYRange";let a=!1;return D_(n,e,t,(l,c,u)=>{l[o]&&l[o](t[e],s)&&(r.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(t.x,t.y,s))}),i&&!a?[]:r}var zGe={evaluateInteractionItems:D_,modes:{index(n,t,e,i){const s=Od(t,n),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?U2(n,s,r,i,o):W2(n,s,r,!1,i,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(n,t,e,i){const s=Od(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?U2(n,s,r,i,o):W2(n,s,r,!1,i,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point:(n,t,e,i)=>U2(n,Od(t,n),e.axis||"xy",i,e.includeInvisible||!1),nearest:(n,t,e,i)=>W2(n,Od(t,n),e.axis||"xy",e.intersect,i,e.includeInvisible||!1),x:(n,t,e,i)=>wX(n,Od(t,n),"x",e.intersect,i),y:(n,t,e,i)=>wX(n,Od(t,n),"y",e.intersect,i)}};const SX=["left","top","right","bottom"];function N_(n,t){return n.filter(e=>e.pos===t)}function IX(n,t){return n.filter(e=>-1===SX.indexOf(e.pos)&&e.box.axis===t)}function A_(n,t){return n.sort((e,i)=>{const s=t?i:e,r=t?e:i;return s.weight===r.weight?s.index-r.index:s.weight-r.weight})}function EX(n,t,e,i){return Math.max(n[e],t[e])+Math.max(n[i],t[i])}function kX(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function GGe(n,t,e,i){const{pos:s,box:r}=e,o=n.maxPadding;if(!Wt(s)){e.size&&(n[s]-=e.size);const d=i[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,n[s]+=e.size}r.getPadding&&kX(o,r.getPadding());const a=Math.max(0,t.outerWidth-EX(o,n,"left","right")),l=Math.max(0,t.outerHeight-EX(o,n,"top","bottom")),c=a!==n.w,u=l!==n.h;return n.w=a,n.h=l,e.horizontal?{same:c,other:u}:{same:u,other:c}}function KGe(n,t){const e=t.maxPadding;return function i(s){const r={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}(n?["left","right"]:["top","bottom"])}function M_(n,t,e,i){const s=[];let r,o,a,l,c,u;for(r=0,o=n.length,c=0;r<o;++r){a=n[r],l=a.box,l.update(a.width||t.w,a.height||t.h,KGe(a.horizontal,t));const{same:d,other:h}=GGe(t,e,a,i);c|=d&&s.length,u=u||h,l.fullSize||s.push(a)}return c&&M_(s,t,e,i)||u}function g1(n,t,e,i,s){n.top=e,n.left=t,n.right=t+i,n.bottom=e+s,n.width=i,n.height=s}function TX(n,t,e,i){const s=e.padding;let{x:r,y:o}=t;for(const a of n){const l=a.box,c=i[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=t.w*u,h=c.size||l.height;v_(c.start)&&(o=c.start),l.fullSize?g1(l,s.left,o,e.outerWidth-s.right-s.left,h):g1(l,t.left+c.placed,o,d,h),c.start=o,c.placed+=d,o=l.bottom}else{const d=t.h*u,h=c.size||l.width;v_(c.start)&&(r=c.start),l.fullSize?g1(l,r,s.top,h,e.outerHeight-s.bottom-s.top):g1(l,r,t.top+c.placed,h,d),c.start=r,c.placed+=d,r=l.right}}t.x=r,t.y=o}var js={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;-1!==e&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,i){if(!n)return;const s=Hs(n.options.layout.padding),r=Math.max(t-s.width,0),o=Math.max(e-s.height,0),a=function jGe(n){const t=function UGe(n){const t=[];let e,i,s,r,o,a;for(e=0,i=(n||[]).length;e<i;++e)s=n[e],({position:r,options:{stack:o,stackWeight:a=1}}=s),t.push({index:e,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return t}(n),e=A_(t.filter(c=>c.box.fullSize),!0),i=A_(N_(t,"left"),!0),s=A_(N_(t,"right")),r=A_(N_(t,"top"),!0),o=A_(N_(t,"bottom")),a=IX(t,"x"),l=IX(t,"y");return{fullSize:e,leftAndTop:i.concat(r),rightAndBottom:s.concat(l).concat(o).concat(a),chartArea:N_(t,"chartArea"),vertical:i.concat(s).concat(l),horizontal:r.concat(o).concat(a)}}(n.boxes),l=a.vertical,c=a.horizontal;vn(n.boxes,g=>{"function"==typeof g.beforeLayout&&g.beforeLayout()});const u=l.reduce((g,m)=>m.box.options&&!1===m.box.options.display?g:g+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/u,hBoxMaxHeight:o/2}),h=Object.assign({},s);kX(h,Hs(i));const f=Object.assign({maxPadding:h,w:r,h:o,x:s.left,y:s.top},s),p=function HGe(n,t){const e=function WGe(n){const t={};for(const e of n){const{stack:i,pos:s,stackWeight:r}=e;if(!i||!SX.includes(s))continue;const o=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}(n),{vBoxMaxWidth:i,hBoxMaxHeight:s}=t;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:l}=a.box,c=e[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*i:l&&t.availableWidth,a.height=s):(a.width=i,a.height=u?u*s:l&&t.availableHeight)}return e}(l.concat(c),d);M_(a.fullSize,f,d,p),M_(l,f,d,p),M_(c,f,d,p)&&M_(l,f,d,p),function qGe(n){const t=n.maxPadding;function e(i){const s=Math.max(t[i]-n[i],0);return n[i]+=s,s}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}(f),TX(a.leftAndTop,f,d,p),f.x+=f.w,f.y+=f.h,TX(a.rightAndBottom,f,d,p),n.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},vn(a.chartArea,g=>{const m=g.box;Object.assign(m,n.chartArea),m.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class DX{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,s){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,s?Math.floor(e/s):i)}}isAttached(t){return!0}updateConfig(t){}}class XGe extends DX{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const b1="$chartjs",YGe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},NX=n=>null===n||""===n,AX=!!Xje&&{passive:!0};function JGe(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,AX)}function _1(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function t6e(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||_1(a.addedNodes,i),o=o&&!_1(a.removedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}function n6e(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||_1(a.removedNodes,i),o=o&&!_1(a.addedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}const P_=new Map;let MX=0;function PX(){const n=window.devicePixelRatio;n!==MX&&(MX=n,P_.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function r6e(n,t,e){const i=n.canvas,s=i&&O2(i);if(!s)return;const r=RK((a,l)=>{const c=s.clientWidth;e(a,l),c<s.clientWidth&&e()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;0===c&&0===u||r(c,u)});return o.observe(s),function i6e(n,t){P_.size||window.addEventListener("resize",PX),P_.set(n,t)}(n,r),o}function H2(n,t,e){e&&e.disconnect(),"resize"===t&&function s6e(n){P_.delete(n),P_.size||window.removeEventListener("resize",PX)}(n)}function o6e(n,t,e){const i=n.canvas,s=RK(r=>{null!==n.ctx&&e(function e6e(n,t){const e=YGe[n.type]||n.type,{x:i,y:s}=Od(n,t);return{type:e,chart:t,native:n,x:void 0!==i?i:null,y:void 0!==s?s:null}}(r,n))},n);return function QGe(n,t,e){n&&n.addEventListener(t,e,AX)}(i,t,s),s}class a6e extends DX{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(function ZGe(n,t){const e=n.style,i=n.getAttribute("height"),s=n.getAttribute("width");if(n[b1]={initial:{height:i,width:s,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",NX(s)){const r=eX(n,"width");void 0!==r&&(n.width=r)}if(NX(i))if(""===n.style.height)n.height=n.width/(t||2);else{const r=eX(n,"height");void 0!==r&&(n.height=r)}}(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[b1])return!1;const i=e[b1].initial;["height","width"].forEach(r=>{const o=i[r];Vt(o)?e.removeAttribute(r):e.setAttribute(r,o)});const s=i.style||{};return Object.keys(s).forEach(r=>{e.style[r]=s[r]}),e.width=e.width,delete e[b1],!0}addEventListener(t,e,i){this.removeEventListener(t,e),(t.$proxies||(t.$proxies={}))[e]=({attach:t6e,detach:n6e,resize:r6e}[e]||o6e)(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),s=i[e];s&&(({attach:H2,detach:H2,resize:H2}[e]||JGe)(t,e,s),i[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,s){return function Kje(n,t,e,i){const s=p1(n),r=Rd(s,"margin"),o=f1(s.maxWidth,n,"clientWidth")||o1,a=f1(s.maxHeight,n,"clientHeight")||o1,l=function qje(n,t,e){let i,s;if(void 0===t||void 0===e){const r=n&&O2(n);if(r){const o=r.getBoundingClientRect(),a=p1(r),l=Rd(a,"border","width"),c=Rd(a,"padding");t=o.width-c.width-l.width,e=o.height-c.height-l.height,i=f1(a.maxWidth,r,"clientWidth"),s=f1(a.maxHeight,r,"clientHeight")}else t=n.clientWidth,e=n.clientHeight}return{width:t,height:e,maxWidth:i||o1,maxHeight:s||o1}}(n,t,e);let{width:c,height:u}=l;if("content-box"===s.boxSizing){const h=Rd(s,"border","width"),f=Rd(s,"padding");c-=f.width+h.width,u-=f.height+h.height}return c=Math.max(0,c-r.width),u=Math.max(0,i?c/i:u-r.height),c=nu(Math.min(c,o,l.maxWidth)),u=nu(Math.min(u,a,l.maxHeight)),c&&!u&&(u=nu(c/2)),(void 0!==t||void 0!==e)&&i&&l.height&&u>l.height&&(u=l.height,c=nu(Math.floor(u*i))),{width:c,height:u}}(t,e,i,s)}isAttached(t){const e=t&&O2(t);return!(!e||!e.isConnected)}}class ra{constructor(){Ie(this,"x",void 0),Ie(this,"y",void 0),Ie(this,"active",!1),Ie(this,"options",void 0),Ie(this,"$animations",void 0)}tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return fp(this.x)&&fp(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const s={};return t.forEach(r=>{s[r]=i[r]&&i[r].active()?i[r]._to:this[r]}),s}}function y1(n,t,e,i,s){const r=yt(i,0),o=Math.min(yt(s,n.length),n.length);let l,c,u,a=0;for(e=Math.ceil(e),s&&(l=s-i,e=l/Math.floor(l/e)),u=r;u<0;)a++,u=Math.round(r+a*e);for(c=Math.max(r,0);c<o;c++)c===u&&(t.push(n[c]),a++,u=Math.round(r+a*e))}Ie(ra,"defaults",{}),Ie(ra,"defaultRoutes",void 0);const m6e=n=>"left"===n?"right":"right"===n?"left":n,RX=(n,t,e)=>"top"===t||"left"===t?n[t]+e:n[t]-e,OX=(n,t)=>Math.min(t||n,n);function FX(n,t){const e=[],i=n.length/t,s=n.length;let r=0;for(;r<s;r+=i)e.push(n[Math.floor(r)]);return e}function g6e(n,t,e){const i=n.ticks.length,s=Math.min(t,i-1),r=n._startPixel,o=n._endPixel,a=1e-6;let c,l=n.getPixelForTick(s);if(!(e&&(c=1===i?Math.max(l-r,o-l):0===t?(n.getPixelForTick(1)-l)/2:(l-n.getPixelForTick(s-1))/2,l+=s<t?c:-c,l<r-a||l>o+a)))return l}function R_(n){return n.drawTicks?n.tickLength:0}function LX(n,t){if(!n.display)return 0;const e=rs(n.font,t),i=Hs(n.padding);return(qn(n.text)?n.text.length:1)*e.lineHeight+i.height}function v6e(n,t,e){let i=S2(n);return(e&&"right"!==t||!e&&"right"===t)&&(i=m6e(i)),i}class $d extends ra{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:s}=this;return t=Gr(t,Number.POSITIVE_INFINITY),e=Gr(e,Number.NEGATIVE_INFINITY),i=Gr(i,Number.POSITIVE_INFINITY),s=Gr(s,Number.NEGATIVE_INFINITY),{min:Gr(t,i),max:Gr(e,s),minDefined:Ii(t),maxDefined:Ii(e)}}getMinMax(t){let o,{min:e,max:i,minDefined:s,maxDefined:r}=this.getUserBounds();if(s&&r)return{min:e,max:i};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,t),s||(e=Math.min(e,o.min)),r||(i=Math.max(i,o.max));return e=r&&e>i?i:e,i=s&&e>i?e:i,{min:Gr(e,Gr(i,e)),max:Gr(i,Gr(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Fn(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:s,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function Eje(n,t,e){const{min:i,max:s}=n,r=xK(t,(s-i)/2),o=(a,l)=>e&&0===a?0:a+l;return{min:o(i,-Math.abs(r)),max:o(s,r)}}(this,r,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?FX(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=function c6e(n,t){const e=n.options.ticks,i=function u6e(n){const t=n.options.offset,e=n._tickSize();return Math.floor(Math.min(n._length/e+(t?0:1),n._maxLength/e))}(n),s=Math.min(e.maxTicksLimit||i,i),r=e.major.enabled?function h6e(n){const t=[];let e,i;for(e=0,i=n.length;e<i;e++)n[e].major&&t.push(e);return t}(t):[],o=r.length,a=r[0],l=r[o-1],c=[];if(o>s)return function f6e(n,t,e,i){let o,s=0,r=e[0];for(i=Math.ceil(i),o=0;o<n.length;o++)o===r&&(t.push(n[o]),s++,r=e[s*i])}(t,c,r,o/s),c;const u=function d6e(n,t,e){const i=function p6e(n){const t=n.length;let e,i;if(t<2)return!1;for(i=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==i)return!1;return i}(n),s=t.length/e;if(!i)return Math.max(s,1);const r=function ZHe(n){const t=[],e=Math.sqrt(n);let i;for(i=1;i<e;i++)n%i==0&&(t.push(i),t.push(n/i));return e===(0|e)&&t.push(e),t.sort((s,r)=>s-r).pop(),t}(i);for(let o=0,a=r.length-1;o<a;o++){const l=r[o];if(l>s)return l}return Math.max(s,1)}(r,t,s);if(o>0){let d,h;const f=o>1?Math.round((l-a)/(o-1)):null;for(y1(t,c,u,Vt(f)?0:a-f,a),d=0,h=o-1;d<h;d++)y1(t,c,u,r[d],r[d+1]);return y1(t,c,u,l,Vt(f)?t.length:l+f),c}return y1(t,c,u),c}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,i,t=this.options.reverse;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,t=!t),this._startPixel=e,this._endPixel=i,this._reversePixels=t,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Fn(this.options.afterUpdate,[this])}beforeSetDimensions(){Fn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Fn(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Fn(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Fn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,s,r;for(i=0,s=t.length;i<s;i++)r=t[i],r.label=Fn(e.callback,[r.value,i,t],this)}afterTickToLabelConversion(){Fn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Fn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=OX(this.ticks.length,t.ticks.maxTicksLimit),s=e.minRotation||0,r=e.maxRotation;let a,l,c,o=s;if(!this._isVisible()||!e.display||s>=r||i<=1||!this.isHorizontal())return void(this.labelRotation=s);const u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,f=ms(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/i:f/(i-1),d+6>a&&(a=f/(i-(t.offset?.5:1)),l=this.maxHeight-R_(t.grid)-e.padding-LX(t.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),o=x2(Math.min(Math.asin(ms((u.highest.height+6)/a,-1,1)),Math.asin(ms(l/c,-1,1))-Math.asin(ms(h/c,-1,1)))),o=Math.max(s,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){Fn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Fn(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:s,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=LX(s,e.options.font);if(a?(t.width=this.maxWidth,t.height=R_(r)+l):(t.height=this.maxHeight,t.width=R_(r)+l),i.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:h}=this._getLabelSizes(),f=2*i.padding,p=sa(this.labelRotation),g=Math.cos(p),m=Math.sin(p);a?t.height=Math.min(this.maxHeight,t.height+(i.mirror?0:m*d.width+g*h.height)+f):t.width=Math.min(this.maxWidth,t.width+(i.mirror?0:g*d.width+m*h.height)+f),this._calculatePadding(c,u,m,g)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,s){const{ticks:{align:r,padding:o},position:a}=this.options,l=0!==this.labelRotation,c="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,f=0;l?c?(h=s*t.width,f=i*e.height):(h=i*t.height,f=s*e.width):"start"===r?f=e.width:"end"===r?h=t.width:"inner"!==r&&(h=t.width/2,f=e.width/2),this.paddingLeft=Math.max((h-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-d+o)*this.width/(this.width-d),0)}else{let u=e.height/2,d=t.height/2;"start"===r?(u=0,d=t.height):"end"===r&&(u=e.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Fn(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,i;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,i=t.length;e<i;e++)Vt(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=FX(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:s,_longestTextCache:r}=this,o=[],a=[],l=Math.floor(e/OX(e,i));let d,h,f,p,g,m,b,_,y,v,x,c=0,u=0;for(d=0;d<e;d+=l){if(p=t[d].label,g=this._resolveTickFontOptions(d),s.font=m=g.string,b=r[m]=r[m]||{data:{},gc:[]},_=g.lineHeight,y=v=0,Vt(p)||qn(p)){if(qn(p))for(h=0,f=p.length;h<f;++h)x=p[h],!Vt(x)&&!qn(x)&&(y=c1(s,b.data,b.gc,y,x),v+=_)}else y=c1(s,b.data,b.gc,y,p),v=_;o.push(y),a.push(v),c=Math.max(y,c),u=Math.max(v,u)}!function b6e(n,t){vn(n,e=>{const i=e.gc,s=i.length/2;let r;if(s>t){for(r=0;r<s;++r)delete e.data[i[r]];i.splice(0,s)}})}(r,e);const S=o.indexOf(c),E=a.indexOf(u),k=D=>({width:o[D]||0,height:a[D]||0});return{first:k(0),last:k(e-1),widest:k(S),highest:k(E),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return function tje(n){return ms(n,-32768,32767)}(this._alignToPixels?Ad(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=function y6e(n,t,e){return tu(n,{tick:e,index:t,type:"tick"})}(this.getContext(),t,i))}return this.$context||(this.$context=function _6e(n,t){return tu(n,{scale:t,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=sa(this.labelRotation),i=Math.abs(Math.cos(e)),s=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,l=r?r.highest.height+o:0;return this.isHorizontal()?l*i>a*s?a/i:l/s:l*s<a*i?l/i:a/s}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,s=this.options,{grid:r,position:o,border:a}=s,l=r.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=R_(r),f=[],p=a.setContext(this.getContext()),g=p.display?p.width:0,m=g/2,b=function(O){return Ad(i,O,g)};let _,y,v,x,S,E,k,D,M,R,U,X;if("top"===o)_=b(this.bottom),E=this.bottom-h,D=_-m,R=b(t.top)+m,X=t.bottom;else if("bottom"===o)_=b(this.top),R=t.top,X=b(t.bottom)-m,E=_+m,D=this.top+h;else if("left"===o)_=b(this.right),S=this.right-h,k=_-m,M=b(t.left)+m,U=t.right;else if("right"===o)_=b(this.left),M=t.left,U=b(t.right)-m,S=_+m,k=this.left+h;else if("x"===e){if("center"===o)_=b((t.top+t.bottom)/2+.5);else if(Wt(o)){const O=Object.keys(o)[0];_=b(this.chart.scales[O].getPixelForValue(o[O]))}R=t.top,X=t.bottom,E=_+m,D=E+h}else if("y"===e){if("center"===o)_=b((t.left+t.right)/2);else if(Wt(o)){const O=Object.keys(o)[0];_=b(this.chart.scales[O].getPixelForValue(o[O]))}S=_-m,k=S-h,M=t.left,U=t.right}const ee=yt(s.ticks.maxTicksLimit,d),K=Math.max(1,Math.ceil(d/ee));for(y=0;y<d;y+=K){const O=this.getContext(y),z=r.setContext(O),B=a.setContext(O),q=z.lineWidth,se=z.color,le=B.dash||[],he=B.dashOffset,ue=z.tickWidth,de=z.tickColor,ve=z.tickBorderDash||[],Ee=z.tickBorderDashOffset;v=g6e(this,y,l),void 0!==v&&(x=Ad(i,v,q),c?S=k=M=U=x:E=D=R=X=x,f.push({tx1:S,ty1:E,tx2:k,ty2:D,x1:M,y1:R,x2:U,y2:X,width:q,color:se,borderDash:le,borderDashOffset:he,tickWidth:ue,tickColor:de,tickBorderDash:ve,tickBorderDashOffset:Ee}))}return this._ticksLength=d,this._borderValue=_,f}_computeLabelItems(t){const e=this.axis,i=this.options,{position:s,ticks:r}=i,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=r,h=R_(i.grid),f=h+u,p=d?-u:f,g=-sa(this.labelRotation),m=[];let b,_,y,v,x,S,E,k,D,M,R,U,X="middle";if("top"===s)S=this.bottom-p,E=this._getXAxisLabelAlignment();else if("bottom"===s)S=this.top+p,E=this._getXAxisLabelAlignment();else if("left"===s){const K=this._getYAxisLabelAlignment(h);E=K.textAlign,x=K.x}else if("right"===s){const K=this._getYAxisLabelAlignment(h);E=K.textAlign,x=K.x}else if("x"===e){if("center"===s)S=(t.top+t.bottom)/2+f;else if(Wt(s)){const K=Object.keys(s)[0];S=this.chart.scales[K].getPixelForValue(s[K])+f}E=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===s)x=(t.left+t.right)/2-f;else if(Wt(s)){const K=Object.keys(s)[0];x=this.chart.scales[K].getPixelForValue(s[K])}E=this._getYAxisLabelAlignment(h).textAlign}"y"===e&&("start"===l?X="top":"end"===l&&(X="bottom"));const ee=this._getLabelSizes();for(b=0,_=a.length;b<_;++b){y=a[b],v=y.label;const K=r.setContext(this.getContext(b));k=this.getPixelForTick(b)+r.labelOffset,D=this._resolveTickFontOptions(b),M=D.lineHeight,R=qn(v)?v.length:1;const O=R/2,z=K.color,B=K.textStrokeColor,q=K.textStrokeWidth;let le,se=E;if(o?(x=k,"inner"===E&&(se=b===_-1?this.options.reverse?"left":"right":0===b?this.options.reverse?"right":"left":"center"),U="top"===s?"near"===c||0!==g?-R*M+M/2:"center"===c?-ee.highest.height/2-O*M+M:M/2-ee.highest.height:"near"===c||0!==g?M/2:"center"===c?ee.highest.height/2-O*M:ee.highest.height-R*M,d&&(U*=-1),0!==g&&!K.showLabelBackdrop&&(x+=M/2*Math.sin(g))):(S=k,U=(1-R)*M/2),K.showLabelBackdrop){const he=Hs(K.backdropPadding),ue=ee.heights[b],de=ee.widths[b];let ve=U-he.top,Ee=0-he.left;switch(X){case"middle":ve-=ue/2;break;case"bottom":ve-=ue}switch(E){case"center":Ee-=de/2;break;case"right":Ee-=de;break;case"inner":b===_-1?Ee-=de:b>0&&(Ee-=de/2)}le={left:Ee,top:ve,width:de+he.width,height:ue+he.height,color:K.backdropColor}}m.push({label:v,font:D,textOffset:U,options:{rotation:g,color:z,strokeColor:B,strokeWidth:q,textAlign:se,textBaseline:X,translation:[x,S],backdrop:le}})}return m}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-sa(this.labelRotation))return"top"===t?"left":"right";let s="center";return"start"===e.align?s="left":"end"===e.align?s="right":"inner"===e.align&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:s,padding:r}}=this.options,a=t+r,l=this._getLabelSizes().widest.width;let c,u;return"left"===e?s?(u=this.right+r,"near"===i?c="left":"center"===i?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,"near"===i?c="right":"center"===i?(c="center",u-=l/2):(c="left",u=this.left)):"right"===e?s?(u=this.left+r,"near"===i?c="right":"center"===i?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,"near"===i?c="left":"center"===i?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:s,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,s,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const s=this.ticks.findIndex(r=>r.value===t);return s>=0?e.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(l,c,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(e.display)for(r=0,o=s.length;r<o;++r){const l=s[r];e.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:s}}=this,r=i.setContext(this.getContext()),o=i.display?r.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,h;this.isHorizontal()?(c=Ad(t,this.left,o)-o/2,u=Ad(t,this.right,a)+a/2,d=h=l):(d=Ad(t,this.top,o)-o/2,h=Ad(t,this.bottom,a)+a/2,c=u=l),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(c,d),e.lineTo(u,h),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&u1(i,s);const r=this.getLabelItems(t);for(const o of r)Md(i,o.label,0,o.textOffset,o.font,o.options);s&&d1(i)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:s}}=this;if(!i.display)return;const r=rs(i.font),o=Hs(i.padding),a=i.align;let l=r.lineHeight/2;"bottom"===e||"center"===e||Wt(e)?(l+=o.bottom,qn(i.text)&&(l+=r.lineHeight*(i.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:d,rotation:h}=function x6e(n,t,e,i){const{top:s,left:r,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:u}=l;let h,f,p,d=0;const g=o-s,m=a-r;if(n.isHorizontal()){if(f=Ws(i,r,a),Wt(e)){const b=Object.keys(e)[0];p=u[b].getPixelForValue(e[b])+g-t}else p="center"===e?(c.bottom+c.top)/2+g-t:RX(n,e,t);h=a-r}else{if(Wt(e)){const b=Object.keys(e)[0];f=u[b].getPixelForValue(e[b])-m+t}else f="center"===e?(c.left+c.right)/2-m+t:RX(n,e,t);p=Ws(i,o,s),d="left"===e?-Ai:Ai}return{titleX:f,titleY:p,maxWidth:h,rotation:d}}(this,l,e,a);Md(t,i.text,0,0,r,{color:i.color,maxWidth:d,rotation:h,textAlign:v6e(a,e,s),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=yt(t.grid&&t.grid.z,-1),s=yt(t.border&&t.border.z,0);return this._isVisible()&&this.draw===$d.prototype.draw?[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]:[{z:e,draw:r=>{this.draw(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[i]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){return rs(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class v1{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;(function S6e(n){return"id"in n&&"defaults"in n})(e)&&(i=this.register(e));const s=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in s||(s[r]=t,function C6e(n,t,e){const i=__(Object.create(null),[e?ii.get(e):{},ii.get(t),n.defaults]);ii.set(t,i),n.defaultRoutes&&function w6e(n,t){Object.keys(t).forEach(e=>{const i=e.split("."),s=i.pop(),r=[n].concat(i).join("."),o=t[e].split("."),a=o.pop(),l=o.join(".");ii.route(r,s,l,a)})}(t,n.defaultRoutes),n.descriptors&&ii.describe(t,n.descriptors)}(t,o,i),this.override&&ii.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,s=this.scope;i in e&&delete e[i],s&&i in ii[s]&&(delete ii[s][i],this.override&&delete Nd[i])}}class I6e{constructor(){this.controllers=new v1(iu,"datasets",!0),this.elements=new v1(ra,"elements"),this.plugins=new v1(Object,"plugins"),this.scales=new v1($d,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(s=>{const r=i||this._getRegistryForType(s);i||r.isForType(s)||r===this.plugins&&s.id?this._exec(t,r,s):vn(s,o=>{const a=i||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,i){const s=v2(t);Fn(i["before"+s],[],i),e[t](i),Fn(i["after"+s],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const s=e.get(t);if(void 0===s)throw new Error('"'+t+'" is not a registered '+i+".");return s}}var Xa=new I6e;class E6e{constructor(){this._init=void 0}notify(t,e,i,s){if("beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),void 0===this._init)return;const r=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(r,t,e,i);return"afterDestroy"===e&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,e,i,s){s=s||{};for(const r of t){const o=r.plugin;if(!1===Fn(o[i],[e,s,r.options],o)&&s.cancelable)return!1}return!0}invalidate(){Vt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,s=yt(i.options&&i.options.plugins,{}),r=function k6e(n){const t={},e=[],i=Object.keys(Xa.plugins.items);for(let r=0;r<i.length;r++)e.push(Xa.getPlugin(i[r]));const s=n.plugins||[];for(let r=0;r<s.length;r++){const o=s[r];-1===e.indexOf(o)&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}(i);return!1!==s||e?function D6e(n,{plugins:t,localIds:e},i,s){const r=[],o=n.getContext();for(const a of t){const l=a.id,c=T6e(i[l],s);null!==c&&r.push({plugin:a,options:N6e(n.config,{plugin:a,local:e[l]},c,o)})}return r}(t,r,s,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,s=(r,o)=>r.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(s(e,i),t,"stop"),this._notify(s(i,e),t,"start")}}function T6e(n,t){return t||!1!==n?!0===n?{}:n:null}function N6e(n,{plugin:t,local:e},i,s){const r=n.pluginScopeKeys(t),o=n.getOptionScopes(i,r);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function j2(n,t){return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||(ii.datasets[n]||{}).indexAxis||"x"}function $X(n){if("x"===n||"y"===n||"r"===n)return n}function P6e(n){return"top"===n||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0}function G2(n,...t){if($X(n))return n;for(const e of t){const i=e.axis||P6e(e.position)||n.length>1&&$X(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function BX(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function VX(n){const t=n.options||(n.options={});t.plugins=yt(t.plugins,{}),t.scales=function O6e(n,t){const e=Nd[n.type]||{scales:{}},i=t.scales||{},s=j2(n.type,t),r=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!Wt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=G2(o,a,function R6e(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(e.length)return BX(n,"x",e[0])||BX(n,"y",e[0])}return{}}(o,n),ii.scales[a.type]),c=function M6e(n,t){return n===t?"_index_":"_value_"}(l,s),u=e.scales||{};r[o]=y_(Object.create(null),[{axis:l},a,u[l],u[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||j2(a,t),u=(Nd[a]||{}).scales||{};Object.keys(u).forEach(d=>{const h=function A6e(n,t){let e=n;return"_index_"===n?e=t:"_value_"===n&&(e="x"===t?"y":"x"),e}(d,l),f=o[h+"AxisID"]||h;r[f]=r[f]||Object.create(null),y_(r[f],[{axis:h},i[f],u[d]])})}),Object.keys(r).forEach(o=>{const a=r[o];y_(a,[ii.scales[a.type],ii.scale])}),r}(n,t)}function zX(n){return(n=n||{}).datasets=n.datasets||[],n.labels=n.labels||[],n}const UX=new Map,WX=new Set;function x1(n,t){let e=UX.get(n);return e||(e=t(),UX.set(n,e),WX.add(e)),e}const O_=(n,t,e)=>{const i=Qc(t,e);void 0!==i&&n.add(i)};class L6e{constructor(t){this._config=function F6e(n){return(n=n||{}).data=zX(n.data),VX(n),n}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=zX(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),VX(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return x1(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return x1(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return x1(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id;return x1(`${this.type}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const i=this._scopeCache;let s=i.get(t);return(!s||e)&&(s=new Map,i.set(t,s)),s}getOptionScopes(t,e,i){const{options:s,type:r}=this,o=this._cachedScopes(t,i),a=o.get(e);if(a)return a;const l=new Set;e.forEach(u=>{t&&(l.add(t),u.forEach(d=>O_(l,t,d))),u.forEach(d=>O_(l,s,d)),u.forEach(d=>O_(l,Nd[r]||{},d)),u.forEach(d=>O_(l,ii,d)),u.forEach(d=>O_(l,k2,d))});const c=Array.from(l);return 0===c.length&&c.push(Object.create(null)),WX.has(e)&&o.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,Nd[e]||{},ii.datasets[e]||{},{type:e},ii,k2]}resolveNamedOptions(t,e,i,s=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=HX(this._resolverCache,t,s);let l=o;(function B6e(n,t){const{isScriptable:e,isIndexable:i}=jK(n);for(const s of t){const r=e(s),o=i(s),a=(o||r)&&n[s];if(r&&(Jc(a)||$6e(a))||o&&qn(a))return!0}return!1})(o,e)&&(r.$shared=!1,l=pp(o,i=Jc(i)?i():i,this.createResolver(t,i,a)));for(const c of e)r[c]=l[c];return r}createResolver(t,e,i=[""],s){const{resolver:r}=HX(this._resolverCache,t,i);return Wt(e)?pp(r,e,void 0,s):r}}function HX(n,t,e){let i=n.get(t);i||(i=new Map,n.set(t,i));const s=e.join();let r=i.get(s);return r||(r={resolver:A2(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},i.set(s,r)),r}const $6e=n=>Wt(n)&&Object.getOwnPropertyNames(n).some(t=>Jc(n[t])),z6e=["top","bottom","left","right","chartArea"];function jX(n,t){return"top"===n||"bottom"===n||-1===z6e.indexOf(n)&&"x"===t}function GX(n,t){return function(e,i){return e[n]===i[n]?e[t]-i[t]:e[n]-i[n]}}function qX(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),Fn(e&&e.onComplete,[n],t)}function U6e(n){const t=n.chart,e=t.options.animation;Fn(e&&e.onProgress,[n],t)}function KX(n){return R2()&&"string"==typeof n?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const C1={},XX=n=>{const t=KX(n);return Object.values(C1).filter(e=>e.canvas===t).pop()};function W6e(n,t,e){const i=Object.keys(n);for(const s of i){const r=+s;if(r>=t){const o=n[s];delete n[s],(e>0||r>t)&&(n[r+e]=o)}}}let F_=(()=>{class n{static register(...e){Xa.add(...e),YX()}static unregister(...e){Xa.remove(...e),YX()}constructor(e,i){const s=this.config=new L6e(i),r=KX(e),o=XX(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const a=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||function l6e(n){return!R2()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?XGe:a6e}(r)),this.platform.updateConfig(s);const l=this.platform.acquireContext(r,a.aspectRatio),c=l&&l.canvas,u=c&&c.height,d=c&&c.width;this.id=UHe(),this.ctx=l,this.canvas=c,this.width=d,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new E6e,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function rje(n,t){let e;return function(...i){return t?(clearTimeout(e),e=setTimeout(n,t,i)):n.apply(this,i),t}}(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],C1[this.id]=this,l&&c?(Wl.listen(this,"complete",qX),Wl.listen(this,"progress",U6e),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:i},width:s,height:r,_aspectRatio:o}=this;return Vt(e)?i&&o?o:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Xa}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():JK(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return UK(this.canvas,this.ctx),this}stop(){return Wl.stop(this),this}resize(e,i){Wl.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){const s=this.options,a=this.platform.getMaximumSize(this.canvas,e,i,s.maintainAspectRatio&&this.aspectRatio),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,JK(this,l,!0)&&(this.notifyPlugins("resize",{size:a}),Fn(s.onResize,[this,a],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){vn(this.options.scales||{},(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,i=e.scales,s=this.scales,r=Object.keys(s).reduce((a,l)=>(a[l]=!1,a),{});let o=[];i&&(o=o.concat(Object.keys(i).map(a=>{const l=i[a],c=G2(a,l),u="r"===c,d="x"===c;return{options:l,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),vn(o,a=>{const l=a.options,c=l.id,u=G2(c,l),d=yt(l.type,a.dtype);(void 0===l.position||jX(l.position,u)!==jX(a.dposition))&&(l.position=a.dposition),r[c]=!0;let h=null;c in s&&s[c].type===d?h=s[c]:(h=new(Xa.getScale(d))({id:c,type:d,ctx:this.ctx,chart:this}),s[h.id]=h),h.init(l,e)}),vn(r,(a,l)=>{a||delete s[l]}),vn(s,a=>{js.configure(this,a,a.options),js.addBox(this,a)})}_updateMetasets(){const e=this._metasets,i=this.data.datasets.length,s=e.length;if(e.sort((r,o)=>r.index-o.index),s>i){for(let r=i;r<s;++r)this._destroyDatasetMeta(r);e.splice(i,s-i)}this._sortedMetasets=e.slice(0).sort(GX("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((s,r)=>{0===i.filter(o=>o===s._dataset).length&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],i=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=i.length;s<r;s++){const o=i[s];let a=this.getDatasetMeta(s);const l=o.type||this.config.type;if(a.type&&a.type!==l&&(this._destroyDatasetMeta(s),a=this.getDatasetMeta(s)),a.type=l,a.indexAxis=o.indexAxis||j2(l,this.options),a.order=o.order||0,a.index=s,a.label=""+o.label,a.visible=this.isDatasetVisible(s),a.controller)a.controller.updateIndex(s),a.controller.linkScales();else{const c=Xa.getController(l),{datasetElementType:u,dataElementType:d}=ii.datasets[l];Object.assign(c,{dataElementType:Xa.getElement(d),datasetElementType:u&&Xa.getElement(u)}),a.controller=new c(this,s),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){vn(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const s=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),f=!r&&-1===o.indexOf(h);h.buildOrUpdateElements(f),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=s.layout.autoPadding?a:0,this._updateLayout(a),r||vn(o,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(GX("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){vn(this.scales,e=>{js.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,i=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!SK(i,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:o}of i)W6e(e,r,"_removeElements"===s?-o:o)}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const i=this.data.datasets.length,s=o=>new Set(e.filter(a=>a[0]===o).map((a,l)=>l+","+a.splice(1).join(","))),r=s(0);for(let o=1;o<i;o++)if(!SK(r,s(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;js.update(this,this.width,this.height,e);const i=this.chartArea,s=i.width<=0||i.height<=0;this._layers=[],vn(this.boxes,r=>{s&&"chartArea"===r.position||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let i=0,s=this.data.datasets.length;i<s;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,s=this.data.datasets.length;i<s;++i)this._updateDataset(i,Jc(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:i,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(s.controller._update(i),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Wl.has(this)?this.attached&&!Wl.running(this)&&Wl.start(this):(this.draw(),qX({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const i=this._sortedMetasets,s=[];let r,o;for(r=0,o=i.length;r<o;++r){const a=i[r];(!e||a.visible)&&s.push(a)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const i=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=cX(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",s)&&(r&&u1(i,r),e.controller.draw(),r&&d1(i),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return Ul(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,s,r){const o=zGe.modes[i];return"function"==typeof o?o(this,e,s,r):[]}getDatasetMeta(e){const i=this.data.datasets[e],s=this._metasets;let r=s.filter(o=>o&&o._dataset===i).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=tu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const i=this.data.datasets[e];if(!i)return!1;const s=this.getDatasetMeta(e);return"boolean"==typeof s.hidden?!s.hidden:!i.hidden}setDatasetVisibility(e,i){this.getDatasetMeta(e).hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,s){const r=s?"show":"hide",o=this.getDatasetMeta(e),a=o.controller._resolveAnimations(void 0,r);v_(i)?(o.data[i].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),a.update(o,{visible:s}),this.update(l=>l.datasetIndex===e?r:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){const i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),Wl.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),UK(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete C1[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,i=this.platform,s=(o,a)=>{i.addEventListener(this,o,a),e[o]=a},r=(o,a,l)=>{o.offsetX=a,o.offsetY=l,this._eventHandler(o)};vn(this.options.events,o=>s(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,i=this.platform,s=(c,u)=>{i.addEventListener(this,c,u),e[c]=u},r=(c,u)=>{e[c]&&(i.removeEventListener(this,c,u),delete e[c])},o=(c,u)=>{this.canvas&&this.resize(c,u)};let a;const l=()=>{r("attach",l),this.attached=!0,this.resize(),s("resize",o),s("detach",a)};a=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),s("attach",l)},i.isAttached(this.canvas)?l():a()}unbindEvents(){vn(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},vn(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,s){const r=s?"set":"remove";let o,a,l,c;for("dataset"===i&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){a=e[l];const u=a&&this.getDatasetMeta(a.datasetIndex).controller;u&&u[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const i=this._active||[],s=e.map(({datasetIndex:o,index:a})=>{const l=this.getDatasetMeta(o);if(!l)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:l.data[a],index:a}});!s1(s,i)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,i))}notifyPlugins(e,i,s){return this._plugins.notify(this,e,i,s)}isPluginEnabled(e){return 1===this._plugins._cache.filter(i=>i.plugin.id===e).length}_updateHoverStyles(e,i,s){const r=this.options.hover,o=(c,u)=>c.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),a=o(i,e),l=s?e:o(e,i);a.length&&this.updateHoverStyle(a,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(e,i){const s={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},r=a=>(a.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",s,r))return;const o=this._handleEvent(e,i,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(o||s.changed)&&this.render(),this}_handleEvent(e,i,s){const{_active:r=[],options:o}=this,l=this._getActiveElements(e,r,s,i),c=function KHe(n){return"mouseup"===n.type||"click"===n.type||"contextmenu"===n.type}(e),u=function H6e(n,t,e,i){return e&&"mouseout"!==n.type?i?t:n:null}(e,this._lastEvent,s,c);s&&(this._lastEvent=null,Fn(o.onHover,[e,l,this],this),c&&Fn(o.onClick,[e,l,this],this));const d=!s1(l,r);return(d||i)&&(this._active=l,this._updateHoverStyles(l,r,i)),this._lastEvent=u,d}_getActiveElements(e,i,s,r){if("mouseout"===e.type)return[];if(!s)return i;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,r)}}return Ie(n,"defaults",ii),Ie(n,"instances",C1),Ie(n,"overrides",Nd),Ie(n,"registry",Xa),Ie(n,"version","4.5.1"),Ie(n,"getChart",XX),n})();function YX(){return vn(F_.instances,n=>n._plugins.invalidate())}function bp(n,t,e,i){return{x:e+n*Math.cos(t),y:i+n*Math.sin(t)}}function w1(n,t,e,i,s,r){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,d=Math.max(t.outerRadius+i+e-c,0),h=u>0?u+i+e+c:0;let f=0;const p=s-l;if(i){const z=((u>0?u-i:0)+(d>0?d-i:0))/2;f=(p-(0!==z?p*z/(z+i):p))/2}const m=(p-Math.max(.001,p*d-e/sn)/d)/2,b=l+m+f,_=s-m-f,{outerStart:y,outerEnd:v,innerStart:x,innerEnd:S}=function K6e(n,t,e,i){const s=function q6e(n){return N2(n,["outerStart","outerEnd","innerStart","innerEnd"])}(n.options.borderRadius),r=(e-t)/2,o=Math.min(r,i*t/2),a=l=>{const c=(e-Math.min(r,l))*i/2;return ms(l,0,Math.min(r,c))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:ms(s.innerStart,0,o),innerEnd:ms(s.innerEnd,0,o)}}(t,h,d,_-b),E=d-y,k=d-v,D=b+y/E,M=_-v/k,R=h+x,U=h+S,X=b+x/R,ee=_-S/U;if(n.beginPath(),r){const K=(D+M)/2;if(n.arc(o,a,d,D,K),n.arc(o,a,d,K,M),v>0){const q=bp(k,M,o,a);n.arc(q.x,q.y,v,M,_+Ai)}const O=bp(U,_,o,a);if(n.lineTo(O.x,O.y),S>0){const q=bp(U,ee,o,a);n.arc(q.x,q.y,S,_+Ai,ee+Math.PI)}const z=(_-S/h+(b+x/h))/2;if(n.arc(o,a,h,_-S/h,z,!0),n.arc(o,a,h,z,b+x/h,!0),x>0){const q=bp(R,X,o,a);n.arc(q.x,q.y,x,X+Math.PI,b-Ai)}const B=bp(E,b,o,a);if(n.lineTo(B.x,B.y),y>0){const q=bp(E,D,o,a);n.arc(q.x,q.y,y,b-Ai,D)}}else{n.moveTo(o,a);const K=Math.cos(D)*d+o,O=Math.sin(D)*d+a;n.lineTo(K,O);const z=Math.cos(M)*d+o,B=Math.sin(M)*d+a;n.lineTo(z,B)}n.closePath()}class L_ extends ra{constructor(t){super(),Ie(this,"circumference",void 0),Ie(this,"endAngle",void 0),Ie(this,"fullCircles",void 0),Ie(this,"innerRadius",void 0),Ie(this,"outerRadius",void 0),Ie(this,"pixelMargin",void 0),Ie(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.getProps(["x","y"],i),{angle:r,distance:o}=DK(s,{x:t,y:e}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:u,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),h=(this.options.spacing+this.options.borderWidth)/2,f=yt(d,l-a),p=C_(r,a,l)&&a!==l,g=f>=Kn||p,m=Vl(o,c+h,u+h);return g&&m}getCenterPoint(t){const{x:e,y:i,startAngle:s,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:l,spacing:c}=this.options,u=(s+r)/2,d=(o+a+c+l)/2;return{x:e+Math.cos(u)*d,y:i+Math.sin(u)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:i}=this,s=(e.offset||0)/4,r=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=i>Kn?Math.floor(i/Kn):0,0===i||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*s,Math.sin(a)*s);const c=s*(1-Math.sin(Math.min(sn,i||0)));t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,function X6e(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a}=t;let l=t.endAngle;if(r){w1(n,t,e,i,l,s);for(let c=0;c<r;++c)n.fill();isNaN(a)||(l=o+(a%Kn||Kn))}w1(n,t,e,i,l,s),n.fill()}(t,this,c,r,o),function Y6e(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h,borderRadius:f}=l,p="inner"===l.borderAlign;if(!c)return;n.setLineDash(d||[]),n.lineDashOffset=h,p?(n.lineWidth=2*c,n.lineJoin=u||"round"):(n.lineWidth=c,n.lineJoin=u||"bevel");let g=t.endAngle;if(r){w1(n,t,e,i,g,s);for(let m=0;m<r;++m)n.stroke();isNaN(a)||(g=o+(a%Kn||Kn))}p&&function G6e(n,t,e){const{startAngle:i,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:l}=t;let c=s/a;n.beginPath(),n.arc(r,o,a,i-c,e+c),l>s?(c=s/l,n.arc(r,o,l,e+c,i-c,!0)):n.arc(r,o,s,e+Ai,i-Ai),n.closePath(),n.clip()}(n,t,g),l.selfJoin&&g-o>=sn&&0===f&&"miter"!==u&&function j6e(n,t,e){const{startAngle:i,x:s,y:r,outerRadius:o,innerRadius:a,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,d=Math.min(c/o,Us(i-e));if(n.beginPath(),n.arc(s,r,o-c/2,i+d/2,e-d/2),a>0){const h=Math.min(c/a,Us(i-e));n.arc(s,r,a+c/2,e-h/2,i+h/2,!0)}else{const h=Math.min(c/2,o*Us(i-e));if("round"===u)n.arc(s,r,h,e-sn/2,i+sn/2,!0);else if("bevel"===u){const f=2*h*h,p=-f*Math.cos(e+sn/2)+s,g=-f*Math.sin(e+sn/2)+r,m=f*Math.cos(i+sn/2)+s,b=f*Math.sin(i+sn/2)+r;n.lineTo(p,g),n.lineTo(m,b)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}(n,t,g),r||(w1(n,t,e,i,g,s),n.stroke())}(t,this,c,r,o),t.restore()}}function ZX(n,t,e=t){n.lineCap=yt(e.borderCapStyle,t.borderCapStyle),n.setLineDash(yt(e.borderDash,t.borderDash)),n.lineDashOffset=yt(e.borderDashOffset,t.borderDashOffset),n.lineJoin=yt(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=yt(e.borderWidth,t.borderWidth),n.strokeStyle=yt(e.borderColor,t.borderColor)}function Z6e(n,t,e){n.lineTo(e.x,e.y)}function QX(n,t,e={}){const i=n.length,{start:s=0,end:r=i-1}=e,{start:o,end:a}=t,l=Math.max(s,o),c=Math.min(r,a);return{count:i,start:l,loop:t.loop,ilen:c<l&&!(s<o&&r<o||s>a&&r>a)?i+c-l:c-l}}function J6e(n,t,e,i){const{points:s,options:r}=t,{count:o,start:a,loop:l,ilen:c}=QX(s,e,i),u=function Q6e(n){return n.stepped?bje:n.tension||"monotone"===n.cubicInterpolationMode?_je:Z6e}(r);let f,p,g,{move:d=!0,reverse:h}=i||{};for(f=0;f<=c;++f)p=s[(a+(h?c-f:f))%o],!p.skip&&(d?(n.moveTo(p.x,p.y),d=!1):u(n,g,p,h,r.stepped),g=p);return l&&(p=s[(a+(h?c:0))%o],u(n,g,p,h,r.stepped)),!!l}function e8e(n,t,e,i){const s=t.points,{count:r,start:o,ilen:a}=QX(s,e,i),{move:l=!0,reverse:c}=i||{};let h,f,p,g,m,b,u=0,d=0;const _=v=>(o+(c?a-v:v))%r,y=()=>{g!==m&&(n.lineTo(u,m),n.lineTo(u,g),n.lineTo(u,b))};for(l&&(f=s[_(0)],n.moveTo(f.x,f.y)),h=0;h<=a;++h){if(f=s[_(h)],f.skip)continue;const v=f.x,x=f.y,S=0|v;S===p?(x<g?g=x:x>m&&(m=x),u=(d*u+v)/++d):(y(),n.lineTo(v,x),p=S,d=0,g=m=x),b=x}y()}function q2(n){const t=n.options;return n._decimated||n._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||t.borderDash&&t.borderDash.length?J6e:e8e}Ie(L_,"id","arc"),Ie(L_,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Ie(L_,"defaultRoutes",{backgroundColor:"backgroundColor"}),Ie(L_,"descriptors",{_scriptable:!0,_indexable:n=>"borderDash"!==n});const s8e="function"==typeof Path2D;let S1=(()=>{class n extends ra{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){const s=this.options;!s.tension&&"monotone"!==s.cubicInterpolationMode||s.stepped||this._pointsUpdated||(Uje(this._points,s,e,s.spanGaps?this._loop:this._fullLoop,i),this._pointsUpdated=!0)}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function iGe(n,t){const e=n.points,i=n.options.spanGaps,s=e.length;if(!s)return[];const r=!!n._loop,{start:o,end:a}=function tGe(n,t,e,i){let s=0,r=t-1;if(e&&!i)for(;s<t&&!n[s].skip;)s++;for(;s<t&&n[s].skip;)s++;for(s%=t,e&&(r+=s);r>s&&n[r%t].skip;)r--;return r%=t,{start:s,end:r}}(e,s,r,i);return function aX(n,t,e,i){return i&&i.setContext&&e?function sGe(n,t,e,i){const s=n._chart.getContext(),r=lX(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=e.length,c=[];let u=r,d=t[0].start,h=d;function f(p,g,m,b){const _=a?-1:1;if(p!==g){for(p+=l;e[p%l].skip;)p-=_;for(;e[g%l].skip;)g+=_;p%l!=g%l&&(c.push({start:p%l,end:g%l,loop:m,style:b}),u=b,d=g%l)}}for(const p of t){d=a?d:p.start;let m,g=e[d%l];for(h=d+1;h<=p.end;h++){const b=e[h%l];m=lX(i.setContext(tu(s,{type:"segment",p0:g,p1:b,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:o}))),rGe(m,u)&&f(d,h-1,p.loop,u),g=b,u=m}d<h-1&&f(d,h-1,p.loop,u)}return c}(n,t,e,i):t}(n,!0===i?[{start:o,end:a,loop:r}]:function nGe(n,t,e,i){const s=n.length,r=[];let l,o=t,a=n[t];for(l=t+1;l<=e;++l){const c=n[l%s];c.skip||c.stop?a.skip||(r.push({start:t%s,end:(l-1)%s,loop:i=!1}),t=o=c.stop?l:null):(o=l,a.skip&&(t=l)),a=c}return null!==o&&r.push({start:t%s,end:o%s,loop:i}),r}(e,o,a<o?a+s:a,!!n._fullLoop&&0===o&&a===s-1),e,t)}(this,this.options.segment))}first(){const e=this.segments;return e.length&&this.points[e[0].start]}last(){const e=this.segments,s=e.length;return s&&this.points[e[s-1].end]}interpolate(e,i){const s=this.options,r=e[i],o=this.points,a=oX(this,{property:i,start:r,end:r});if(!a.length)return;const l=[],c=function t8e(n){return n.stepped?Yje:n.tension||"monotone"===n.cubicInterpolationMode?Zje:Fd}(s);let u,d;for(u=0,d=a.length;u<d;++u){const{start:h,end:f}=a[u],p=o[h],g=o[f];if(p===g){l.push(p);continue}const b=c(p,g,Math.abs((r-p[i])/(g[i]-p[i])),s.stepped);b[i]=e[i],l.push(b)}return 1===l.length?l[0]:l}pathSegment(e,i,s){return q2(this)(e,this,i,s)}path(e,i,s){const r=this.segments,o=q2(this);let a=this._loop;i=i||0,s=s||this.points.length-i;for(const l of r)a&=o(e,this,l,{start:i,end:i+s-1});return!!a}draw(e,i,s,r){(this.points||[]).length&&(this.options||{}).borderWidth&&(e.save(),function r8e(n,t,e,i){s8e&&!t.options.segment?function n8e(n,t,e,i){let s=t._path;s||(s=t._path=new Path2D,t.path(s,e,i)&&s.closePath()),ZX(n,t.options),n.stroke(s)}(n,t,e,i):function i8e(n,t,e,i){const{segments:s,options:r}=t,o=q2(t);for(const a of s)ZX(n,r,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+i-1})&&n.closePath(),n.stroke()}(n,t,e,i)}(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return Ie(n,"id","line"),Ie(n,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Ie(n,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Ie(n,"descriptors",{_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t}),n})();function JX(n,t,e,i){const s=n.options,{[e]:r}=n.getProps([e],i);return Math.abs(t-r)<s.radius+s.hitRadius}let o8e=(()=>{class n extends ra{constructor(e){super(),Ie(this,"parsed",void 0),Ie(this,"skip",void 0),Ie(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,i,s){const r=this.options,{x:o,y:a}=this.getProps(["x","y"],s);return Math.pow(e-o,2)+Math.pow(i-a,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,i){return JX(this,e,"x",i)}inYRange(e,i){return JX(this,e,"y",i)}getCenterPoint(e){const{x:i,y:s}=this.getProps(["x","y"],e);return{x:i,y:s}}size(e){let i=(e=e||this.options||{}).radius||0;return i=Math.max(i,i&&e.hoverRadius||0),2*(i+(i&&e.borderWidth||0))}draw(e,i){const s=this.options;this.skip||s.radius<.1||!Ul(this,i,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,D2(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}return Ie(n,"id","point"),Ie(n,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Ie(n,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),n})();function eY(n,t){const{x:e,y:i,base:s,width:r,height:o}=n.getProps(["x","y","base","width","height"],t);let a,l,c,u,d;return n.horizontal?(d=o/2,a=Math.min(e,s),l=Math.max(e,s),c=i-d,u=i+d):(d=r/2,a=e-d,l=e+d,c=Math.min(i,s),u=Math.max(i,s)),{left:a,top:c,right:l,bottom:u}}function su(n,t,e,i){return n?0:ms(t,e,i)}function K2(n,t,e,i){const s=null===t,r=null===e,a=n&&!(s&&r)&&eY(n,i);return a&&(s||Vl(t,a.left,a.right))&&(r||Vl(e,a.top,a.bottom))}function d8e(n,t){n.rect(t.x,t.y,t.w,t.h)}function X2(n,t,e={}){const i=n.x!==e.x?-t:0,s=n.y!==e.y?-t:0;return{x:n.x+i,y:n.y+s,w:n.w+((n.x+n.w!==e.x+e.w?t:0)-i),h:n.h+((n.y+n.h!==e.y+e.h?t:0)-s),radius:n.radius}}class I1 extends ra{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:s}}=this,{inner:r,outer:o}=function c8e(n){const t=eY(n),e=t.right-t.left,i=t.bottom-t.top,s=function a8e(n,t,e){const s=n.borderSkipped,r=HK(n.options.borderWidth);return{t:su(s.top,r.top,0,e),r:su(s.right,r.right,0,t),b:su(s.bottom,r.bottom,0,e),l:su(s.left,r.left,0,t)}}(n,e/2,i/2),r=function l8e(n,t,e){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,r=Pd(s),o=Math.min(t,e),a=n.borderSkipped,l=i||Wt(s);return{topLeft:su(!l||a.top||a.left,r.topLeft,0,o),topRight:su(!l||a.top||a.right,r.topRight,0,o),bottomLeft:su(!l||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:su(!l||a.bottom||a.right,r.bottomRight,0,o)}}(n,e/2,i/2);return{outer:{x:t.left,y:t.top,w:e,h:i,radius:r},inner:{x:t.left+s.l,y:t.top+s.t,w:e-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}(this),a=function u8e(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}(o.radius)?E_:d8e;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,X2(o,e,r)),t.clip(),a(t,X2(r,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,X2(r,e)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,e,i){return K2(this,t,e,i)}inXRange(t,e){return K2(this,t,null,e)}inYRange(t,e){return K2(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:s,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+s)/2:e,y:r?i:(i+s)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}Ie(I1,"id","bar"),Ie(I1,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ie(I1,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var h8e=Object.freeze({__proto__:null,ArcElement:L_,BarElement:I1,LineElement:S1,PointElement:o8e});const Y2=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],tY=Y2.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function nY(n){return Y2[n%Y2.length]}function iY(n){return tY[n%tY.length]}function sY(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}var y8e={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:i},options:s}=n.config,{elements:r}=s,o=sY(i)||function b8e(n){return n&&(n.borderColor||n.backgroundColor)}(s)||r&&sY(r)||function _8e(){return"rgba(0,0,0,0.1)"!==ii.borderColor||"rgba(0,0,0,0.1)"!==ii.backgroundColor}();if(!e.forceOverride&&o)return;const a=function g8e(n){let t=0;return(e,i)=>{const s=n.getDatasetMeta(i).controller;s instanceof V2?t=function p8e(n,t){return n.backgroundColor=n.data.map(()=>nY(t++)),t}(e,t):s instanceof CX?t=function m8e(n,t){return n.backgroundColor=n.data.map(()=>iY(t++)),t}(e,t):s&&(t=function f8e(n,t){return n.borderColor=nY(t),n.backgroundColor=iY(t),++t}(e,t))}}(n);i.forEach(a)}};function rY(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function oY(n){n.data.datasets.forEach(t=>{rY(t)})}var w8e={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled)return void oY(n);const i=n.width;n.data.datasets.forEach((s,r)=>{const{_data:o,indexAxis:a}=s,l=n.getDatasetMeta(r),c=o||s.data;if("y"===k_([a,n.options.indexAxis])||!l.controller.supportsDecimation)return;const u=n.scales[l.xAxisID];if("linear"!==u.type&&"time"!==u.type||n.options.parsing)return;let p,{start:d,count:h}=function C8e(n,t){const e=t.length;let s,i=0;const{iScale:r}=n,{min:o,max:a,minDefined:l,maxDefined:c}=r.getUserBounds();return l&&(i=ms(zl(t,r.axis,o).lo,0,e-1)),s=c?ms(zl(t,r.axis,a).hi+1,i,e)-i:e-i,{start:i,count:s}}(l,c);if(h<=(e.threshold||4*i))rY(s);else{switch(Vt(o)&&(s._data=c,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(g){this._data=g}})),e.algorithm){case"lttb":p=function v8e(n,t,e,i,s){const r=s.samples||i;if(r>=e)return n.slice(t,t+e);const o=[],a=(e-2)/(r-2);let l=0;const c=t+e-1;let d,h,f,p,g,u=t;for(o[l++]=n[u],d=0;d<r-2;d++){let _,m=0,b=0;const y=Math.floor((d+1)*a)+1+t,v=Math.min(Math.floor((d+2)*a)+1,e)+t,x=v-y;for(_=y;_<v;_++)m+=n[_].x,b+=n[_].y;m/=x,b/=x;const S=Math.floor(d*a)+1+t,E=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:k,y:D}=n[u];for(f=p=-1,_=S;_<E;_++)p=.5*Math.abs((k-m)*(n[_].y-D)-(k-n[_].x)*(b-D)),p>f&&(f=p,h=n[_],g=_);o[l++]=h,u=g}return o[l++]=n[c],o}(c,d,h,i,e);break;case"min-max":p=function x8e(n,t,e,i){let o,a,l,c,u,d,h,f,p,g,s=0,r=0;const m=[],_=n[t].x,v=n[t+e-1].x-_;for(o=t;o<t+e;++o){a=n[o],l=(a.x-_)/v*i,c=a.y;const x=0|l;if(x===u)c<p?(p=c,d=o):c>g&&(g=c,h=o),s=(r*s+a.x)/++r;else{const S=o-1;if(!Vt(d)&&!Vt(h)){const E=Math.min(d,h),k=Math.max(d,h);E!==f&&E!==S&&m.push({...n[E],x:s}),k!==f&&k!==S&&m.push({...n[k],x:s})}o>0&&S!==f&&m.push(n[S]),m.push(a),u=x,r=0,p=g=c,d=h=f=o}}return m}(c,d,h,i);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}s._decimated=p}})},destroy(n){oY(n)}};function Z2(n,t,e,i){if(i)return;let s=t[n],r=e[n];return"angle"===n&&(s=Us(s),r=Us(r)),{property:n,start:s,end:r}}function E1(n,t,e){for(;t>n;t--){const i=e[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function aY(n,t,e,i){return n&&t?i(n[e],t[e]):n?n[e]:t?t[e]:0}function lY(n,t){let e=[],i=!1;return qn(n)?(i=!0,e=n):e=function I8e(n,t){const{x:e=null,y:i=null}=n||{},s=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=E1(o,a,s);const l=s[o],c=s[a];null!==i?(r.push({x:l.x,y:i}),r.push({x:c.x,y:i})):null!==e&&(r.push({x:e,y:l.y}),r.push({x:e,y:c.y}))}),r}(n,t),e.length?new S1({points:e,options:{tension:0},_loop:i,_fullLoop:i}):null}function cY(n){return n&&!1!==n.fill}function E8e(n,t,e){let s=n[t].fill;const r=[t];let o;if(!e)return s;for(;!1!==s&&-1===r.indexOf(s);){if(!Ii(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;r.push(s),s=o.fill}return!1}function k8e(n,t,e){const i=function A8e(n){const t=n.options,e=t.fill;let i=yt(e&&e.target,e);return void 0===i&&(i=!!t.backgroundColor),!1!==i&&null!==i&&(!0===i?"origin":i)}(n);if(Wt(i))return!isNaN(i.value)&&i;let s=parseFloat(i);return Ii(s)&&Math.floor(s)===s?function T8e(n,t,e,i){return("-"===n||"+"===n)&&(e=t+e),!(e===t||e<0||e>=i)&&e}(i[0],t,s,e):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function R8e(n,t,e){const i=[];for(let s=0;s<e.length;s++){const r=e[s],{first:o,last:a,point:l}=O8e(r,t,"x");if(!(!l||o&&a))if(o)i.unshift(l);else if(n.push(l),!a)break}n.push(...i)}function O8e(n,t,e){const i=n.interpolate(t,e);if(!i)return{};const s=i[e],r=n.segments,o=n.points;let a=!1,l=!1;for(let c=0;c<r.length;c++){const u=r[c],d=o[u.start][e],h=o[u.end][e];if(Vl(s,d,h)){a=s===d,l=s===h;break}}return{first:a,last:l,point:i}}class uY{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:s,y:r,radius:o}=this;return t.arc(s,r,o,(e=e||{start:0,end:Kn}).end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:s}=this,r=t.angle;return{x:e+Math.cos(r)*s,y:i+Math.sin(r)*s,angle:r}}}function Q2(n,t,e){const i=function F8e(n){const{chart:t,fill:e,line:i}=n;if(Ii(e))return function L8e(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}(t,e);if("stack"===e)return function M8e(n){const{scale:t,index:e,line:i}=n,s=[],r=i.segments,o=i.points,a=function P8e(n,t){const e=[],i=n.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const r=i[s];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}(t,e);a.push(lY({x:null,y:t.bottom},i));for(let l=0;l<r.length;l++){const c=r[l];for(let u=c.start;u<=c.end;u++)R8e(s,o[u],a)}return new S1({points:s,options:{}})}(n);if("shape"===e)return!0;const s=function $8e(n){return(n.scale||{}).getPointPositionForValue?function V8e(n){const{scale:t,fill:e}=n,i=t.options,s=t.getLabels().length,r=i.reverse?t.max:t.min,o=function N8e(n,t,e){let i;return i="start"===n?e:"end"===n?t.options.reverse?t.min:t.max:Wt(n)?n.value:t.getBaseValue(),i}(e,t,r),a=[];if(i.grid.circular){const l=t.getPointPositionForValue(0,r);return new uY({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(o)})}for(let l=0;l<s;++l)a.push(t.getPointPositionForValue(l,o));return a}(n):function B8e(n){const{scale:t={},fill:e}=n,i=function D8e(n,t){let e=null;return"start"===n?e=t.bottom:"end"===n?e=t.top:Wt(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}(e,t);if(Ii(i)){const s=t.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}(n)}(n);return s instanceof uY?s:lY(s,i)}(t),{chart:s,index:r,line:o,scale:a,axis:l}=t,c=o.options,u=c.fill,d=c.backgroundColor,{above:h=d,below:f=d}=u||{},p=s.getDatasetMeta(r),g=cX(s,p);i&&o.points.length&&(u1(n,e),function z8e(n,t){const{line:e,target:i,above:s,below:r,area:o,scale:a,clip:l}=t,c=e._loop?"angle":t.axis;n.save();let u=r;r!==s&&("x"===c?(dY(n,i,o.top),J2(n,{line:e,target:i,color:s,scale:a,property:c,clip:l}),n.restore(),n.save(),dY(n,i,o.bottom)):"y"===c&&(hY(n,i,o.left),J2(n,{line:e,target:i,color:r,scale:a,property:c,clip:l}),n.restore(),n.save(),hY(n,i,o.right),u=s)),J2(n,{line:e,target:i,color:u,scale:a,property:c,clip:l}),n.restore()}(n,{line:o,target:i,above:h,below:f,area:e,scale:a,axis:l,clip:g}),d1(n))}function dY(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:l,end:c}=a,u=s[l],d=s[E1(l,c,s)];r?(n.moveTo(u.x,u.y),r=!1):(n.lineTo(u.x,e),n.lineTo(u.x,u.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function hY(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:l,end:c}=a,u=s[l],d=s[E1(l,c,s)];r?(n.moveTo(u.x,u.y),r=!1):(n.lineTo(e,u.y),n.lineTo(u.x,u.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(e,d.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function J2(n,t){const{line:e,target:i,property:s,color:r,scale:o,clip:a}=t,l=function S8e(n,t,e){const i=n.segments,s=n.points,r=t.points,o=[];for(const a of i){let{start:l,end:c}=a;c=E1(l,c,s);const u=Z2(e,s[l],s[c],a.loop);if(!t.segments){o.push({source:a,target:u,start:s[l],end:s[c]});continue}const d=oX(t,u);for(const h of d){const f=Z2(e,r[h.start],r[h.end],h.loop),p=rX(a,s,f);for(const g of p)o.push({source:g,target:h,start:{[e]:aY(u,f,"start",Math.max)},end:{[e]:aY(u,f,"end",Math.min)}})}}return o}(e,i,s);for(const{source:c,target:u,start:d,end:h}of l){const{style:{backgroundColor:f=r}={}}=c,p=!0!==i;n.save(),n.fillStyle=f,U8e(n,o,a,p&&Z2(s,d,h)),n.beginPath();const g=!!e.pathSegment(n,c);let m;if(p){g?n.closePath():fY(n,i,h,s);const b=!!i.pathSegment(n,u,{move:g,reverse:!0});m=g&&b,m||fY(n,i,d,s)}n.closePath(),n.fill(m?"evenodd":"nonzero"),n.restore()}}function U8e(n,t,e,i){const s=t.chart.chartArea,{property:r,start:o,end:a}=i||{};if("x"===r||"y"===r){let l,c,u,d;"x"===r?(l=o,c=s.top,u=a,d=s.bottom):(l=s.left,c=o,u=s.right,d=a),n.beginPath(),e&&(l=Math.max(l,e.left),u=Math.min(u,e.right),c=Math.max(c,e.top),d=Math.min(d,e.bottom)),n.rect(l,c,u-l,d-c),n.clip()}}function fY(n,t,e,i){const s=t.interpolate(e,i);s&&n.lineTo(s.x,s.y)}var W8e={id:"filler",afterDatasetsUpdate(n,t,e){const i=(n.data.datasets||[]).length,s=[];let r,o,a,l;for(o=0;o<i;++o)r=n.getDatasetMeta(o),a=r.dataset,l=null,a&&a.options&&a instanceof S1&&(l={visible:n.isDatasetVisible(o),index:o,fill:k8e(a,o,i),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=l,s.push(l);for(o=0;o<i;++o)l=s[o],l&&!1!==l.fill&&(l.fill=E8e(s,o,e.propagate))},beforeDraw(n,t,e){const i="beforeDraw"===e.drawTime,s=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let o=s.length-1;o>=0;--o){const a=s[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),i&&a.fill&&Q2(n.ctx,a,r))}},beforeDatasetsDraw(n,t,e){if("beforeDatasetsDraw"!==e.drawTime)return;const i=n.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const r=i[s].$filler;cY(r)&&Q2(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,t,e){const i=t.meta.$filler;!cY(i)||"beforeDatasetDraw"!==e.drawTime||Q2(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const pY=(n,t)=>{let{boxHeight:e=t,boxWidth:i=t}=n;return n.usePointStyle&&(e=Math.min(e,t),i=n.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(t,e)}};class mY extends ra{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=Fn(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(i=>t.filter(i,this.chart.data))),t.sort&&(e=e.sort((i,s)=>t.sort(i,s,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const i=t.labels,s=rs(i.font),r=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=pY(i,r);let c,u;e.font=s.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,r,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,s,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,s){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=s+a;let d=t;r.textAlign="left",r.textBaseline="middle";let h=-1,f=-u;return this.legendItems.forEach((p,g)=>{const m=i+e/2+r.measureText(p.text).width;(0===g||c[c.length-1]+m+2*a>o)&&(d+=u,c[c.length-(g>0?0:1)]=0,f+=u,h++),l[g]={left:0,top:f,row:h,width:m,height:s},c[c.length-1]+=m+a}),d}_fitCols(t,e,i,s){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-t;let d=a,h=0,f=0,p=0,g=0;return this.legendItems.forEach((m,b)=>{const{itemWidth:_,itemHeight:y}=function j8e(n,t,e,i,s){const r=function G8e(n,t,e,i){let s=n.text;return s&&"string"!=typeof s&&(s=s.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+i.measureText(s).width}(i,n,t,e),o=function q8e(n,t,e){let i=n;return"string"!=typeof t.text&&(i=gY(t,e)),i}(s,i,t.lineHeight);return{itemWidth:r,itemHeight:o}}(i,e,r,m,s);b>0&&f+y+2*a>u&&(d+=h+a,c.push({width:h,height:f}),p+=h+a,g++,h=f=0),l[b]={left:p,top:f,col:g,width:_,height:y},h=Math.max(h,_),f+=y+a}),d+=h,c.push({width:h,height:f}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:s},rtl:r}}=this,o=gp(r,this.left,this.width);if(this.isHorizontal()){let a=0,l=Ws(i,this.left+s,this.right-this.lineWidths[a]);for(const c of e)a!==c.row&&(a=c.row,l=Ws(i,this.left+s,this.right-this.lineWidths[a])),c.top+=this.top+t+s,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+s}else{let a=0,l=Ws(i,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const c of e)c.col!==a&&(a=c.col,l=Ws(i,this.top+t+s,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+s,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;u1(t,this),this._draw(),d1(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:s}=this,{align:r,labels:o}=t,a=ii.color,l=gp(t.rtl,this.left,this.width),c=rs(o.font),{padding:u}=o,d=c.size,h=d/2;let f;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:p,boxHeight:g,itemHeight:m}=pY(o,d),y=this.isHorizontal(),v=this._computeTitleHeight();f=y?{x:Ws(r,this.left+u,this.right-i[0]),y:this.top+u+v,line:0}:{x:this.left+u,y:Ws(r,this.top+v+u,this.bottom-e[0].height),line:0},tX(this.ctx,t.textDirection);const x=m+u;this.legendItems.forEach((S,E)=>{s.strokeStyle=S.fontColor,s.fillStyle=S.fontColor;const k=s.measureText(S.text).width,D=l.textAlign(S.textAlign||(S.textAlign=o.textAlign)),M=p+h+k;let R=f.x,U=f.y;l.setWidth(this.width),y?E>0&&R+M+u>this.right&&(U=f.y+=x,f.line++,R=f.x=Ws(r,this.left+u,this.right-i[f.line])):E>0&&U+x>this.bottom&&(R=f.x=R+e[f.line].width+u,f.line++,U=f.y=Ws(r,this.top+v+u,this.bottom-e[f.line].height)),function(S,E,k){if(isNaN(p)||p<=0||isNaN(g)||g<0)return;s.save();const D=yt(k.lineWidth,1);if(s.fillStyle=yt(k.fillStyle,a),s.lineCap=yt(k.lineCap,"butt"),s.lineDashOffset=yt(k.lineDashOffset,0),s.lineJoin=yt(k.lineJoin,"miter"),s.lineWidth=D,s.strokeStyle=yt(k.strokeStyle,a),s.setLineDash(yt(k.lineDash,[])),o.usePointStyle){const M={radius:g*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:D},R=l.xPlus(S,p/2);WK(s,M,R,E+h,o.pointStyleWidth&&p)}else{const M=E+Math.max((d-g)/2,0),R=l.leftForLtr(S,p),U=Pd(k.borderRadius);s.beginPath(),Object.values(U).some(X=>0!==X)?E_(s,{x:R,y:M,w:p,h:g,radius:U}):s.rect(R,M,p,g),s.fill(),0!==D&&s.stroke()}s.restore()}(l.x(R),U,S),R=((n,t,e,i)=>n===(i?"left":"right")?e:"center"===n?(t+e)/2:t)(D,R+p+h,y?R+M:this.right,t.rtl),function(S,E,k){Md(s,k.text,S,E+m/2,c,{strikethrough:k.hidden,textAlign:l.textAlign(k.textAlign)})}(l.x(R),U,S),y?f.x+=M+u:f.y+="string"!=typeof S.text?gY(S,c.lineHeight)+u:x}),nX(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=rs(e.font),s=Hs(e.padding);if(!e.display)return;const r=gp(t.rtl,this.left,this.width),o=this.ctx,a=e.position,c=s.top+i.size/2;let u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,d=Ws(t.align,d,this.right-h);else{const p=this.columnSizes.reduce((g,m)=>Math.max(g,m.height),0);u=c+Ws(t.align,this.top,this.bottom-p-t.labels.padding-this._computeTitleHeight())}const f=Ws(a,d,d+h);o.textAlign=r.textAlign(S2(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,Md(o,e.text,f,u,i)}_computeTitleHeight(){const t=this.options.title,e=rs(t.font),i=Hs(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,s,r;if(Vl(t,this.left,this.right)&&Vl(e,this.top,this.bottom))for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(s=r[i],Vl(t,s.left,s.left+s.width)&&Vl(e,s.top,s.top+s.height))return this.legendItems[i];return null}handleEvent(t){const e=this.options;if(!function K8e(n,t){return!(("mousemove"!==n&&"mouseout"!==n||!t.onHover&&!t.onLeave)&&(!t.onClick||"click"!==n&&"mouseup"!==n))}(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const s=this._hoveredItem,r=((n,t)=>null!==n&&null!==t&&n.datasetIndex===t.datasetIndex&&n.index===t.index)(s,i);s&&!r&&Fn(e.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!r&&Fn(e.onHover,[t,i,this],this)}else i&&Fn(e.onClick,[t,i,this],this)}}function gY(n,t){return t*(n.text?n.text.length:0)}var X8e={id:"legend",_element:mY,start(n,t,e){const i=n.legend=new mY({ctx:n.ctx,options:e,chart:n});js.configure(n,i,e),js.addBox(n,i)},stop(n){js.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const i=n.legend;js.configure(n,i,e),i.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const i=t.datasetIndex,s=e.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(e?0:void 0),u=Hs(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:r,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:i||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class eR extends ra{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const s=qn(i.text)?i.text.length:1;this._padding=Hs(i.padding);const r=s*rs(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:i,bottom:s,right:r,options:o}=this,a=o.align;let c,u,d,l=0;return this.isHorizontal()?(u=Ws(a,i,r),d=e+t,c=r-i):("left"===o.position?(u=i+t,d=Ws(a,s,e),l=-.5*sn):(u=r-t,d=Ws(a,e,s),l=.5*sn),c=s-e),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=rs(e.font),r=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(r);Md(t,e.text,0,0,i,{color:e.color,maxWidth:l,rotation:c,textAlign:S2(e.align),textBaseline:"middle",translation:[o,a]})}}var Z8e={id:"title",_element:eR,start(n,t,e){!function Y8e(n,t){const e=new eR({ctx:n.ctx,options:t,chart:n});js.configure(n,e,t),js.addBox(n,e),n.titleBlock=e}(n,e)},stop(n){js.removeBox(n,n.titleBlock),delete n.titleBlock},beforeUpdate(n,t,e){const i=n.titleBlock;js.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const k1=new WeakMap;var Q8e={id:"subtitle",start(n,t,e){const i=new eR({ctx:n.ctx,options:e,chart:n});js.configure(n,i,e),js.addBox(n,i),k1.set(n,i)},stop(n){js.removeBox(n,k1.get(n)),k1.delete(n)},beforeUpdate(n,t,e){const i=k1.get(n);js.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const $_={average(n){if(!n.length)return!1;let t,e,i=new Set,s=0,r=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();i.add(l.x),s+=l.y,++r}}return 0!==r&&0!==i.size&&{x:[...i].reduce((a,l)=>a+l)/i.size,y:s/r}},nearest(n,t){if(!n.length)return!1;let r,o,a,e=t.x,i=t.y,s=Number.POSITIVE_INFINITY;for(r=0,o=n.length;r<o;++r){const l=n[r].element;if(l&&l.hasValue()){const u=C2(t,l.getCenterPoint());u<s&&(s=u,a=l)}}if(a){const l=a.tooltipPosition();e=l.x,i=l.y}return{x:e,y:i}}};function Ya(n,t){return t&&(qn(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function Hl(n){return("string"==typeof n||n instanceof String)&&n.indexOf("\n")>-1?n.split("\n"):n}function J8e(n,t){const{element:e,datasetIndex:i,index:s}=t,r=n.getDatasetMeta(i).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:n,label:o,parsed:r.getParsed(s),raw:n.data.datasets[i].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:i,element:e}}function bY(n,t){const e=n.chart.ctx,{body:i,footer:s,title:r}=n,{boxWidth:o,boxHeight:a}=t,l=rs(t.bodyFont),c=rs(t.titleFont),u=rs(t.footerFont),d=r.length,h=s.length,f=i.length,p=Hs(t.padding);let g=p.height,m=0,b=i.reduce((v,x)=>v+x.before.length+x.lines.length+x.after.length,0);b+=n.beforeBody.length+n.afterBody.length,d&&(g+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),b&&(g+=f*(t.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(b-f)*l.lineHeight+(b-1)*t.bodySpacing),h&&(g+=t.footerMarginTop+h*u.lineHeight+(h-1)*t.footerSpacing);let _=0;const y=function(v){m=Math.max(m,e.measureText(v).width+_)};return e.save(),e.font=c.string,vn(n.title,y),e.font=l.string,vn(n.beforeBody.concat(n.afterBody),y),_=t.displayColors?o+2+t.boxPadding:0,vn(i,v=>{vn(v.before,y),vn(v.lines,y),vn(v.after,y)}),_=0,e.font=u.string,vn(n.footer,y),e.restore(),m+=p.width,{width:m,height:g}}function n7e(n,t,e,i){const{x:s,width:r}=e,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return"center"===i?c=s<=(a+l)/2?"left":"right":s<=r/2?c="left":s>=o-r/2&&(c="right"),function t7e(n,t,e,i){const{x:s,width:r}=i,o=e.caretSize+e.caretPadding;if("left"===n&&s+r+o>t.width||"right"===n&&s-r-o<0)return!0}(c,n,t,e)&&(c="center"),c}function _Y(n,t,e){const i=e.yAlign||t.yAlign||function e7e(n,t){const{y:e,height:i}=t;return e<i/2?"top":e>n.height-i/2?"bottom":"center"}(n,e);return{xAlign:e.xAlign||t.xAlign||n7e(n,t,e,i),yAlign:i}}function yY(n,t,e,i){const{caretSize:s,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:l}=e,c=s+r,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Pd(o);let p=function i7e(n,t){let{x:e,width:i}=n;return"right"===t?e-=i:"center"===t&&(e-=i/2),e}(t,a);const g=function s7e(n,t,e){let{y:i,height:s}=n;return"top"===t?i+=e:i-="bottom"===t?s+e:s/2,i}(t,l,c);return"center"===l?"left"===a?p+=c:"right"===a&&(p-=c):"left"===a?p-=Math.max(u,h)+s:"right"===a&&(p+=Math.max(d,f)+s),{x:ms(p,0,i.width-t.width),y:ms(g,0,i.height-t.height)}}function T1(n,t,e){const i=Hs(e.padding);return"center"===t?n.x+n.width/2:"right"===t?n.x+n.width-i.right:n.x+i.left}function vY(n){return Ya([],Hl(n))}function xY(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const CY={beforeTitle:Bl,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,i=e?e.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return e[t.dataIndex]}return""},afterTitle:Bl,beforeBody:Bl,beforeLabel:Bl,label(n){if(this&&this.options&&"dataset"===this.options.mode)return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return Vt(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Bl,afterBody:Bl,beforeFooter:Bl,footer:Bl,afterFooter:Bl};function xr(n,t,e,i){const s=n[t].call(e,i);return typeof s>"u"?CY[t].call(e,i):s}let wY=(()=>{class n extends ra{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const i=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&i.options.animation&&s.animations,o=new dX(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=function r7e(n,t,e){return tu(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){const{callbacks:s}=i,r=xr(s,"beforeTitle",this,e),o=xr(s,"title",this,e),a=xr(s,"afterTitle",this,e);let l=[];return l=Ya(l,Hl(r)),l=Ya(l,Hl(o)),l=Ya(l,Hl(a)),l}getBeforeBody(e,i){return vY(xr(i.callbacks,"beforeBody",this,e))}getBody(e,i){const{callbacks:s}=i,r=[];return vn(e,o=>{const a={before:[],lines:[],after:[]},l=xY(s,o);Ya(a.before,Hl(xr(l,"beforeLabel",this,o))),Ya(a.lines,xr(l,"label",this,o)),Ya(a.after,Hl(xr(l,"afterLabel",this,o))),r.push(a)}),r}getAfterBody(e,i){return vY(xr(i.callbacks,"afterBody",this,e))}getFooter(e,i){const{callbacks:s}=i,r=xr(s,"beforeFooter",this,e),o=xr(s,"footer",this,e),a=xr(s,"afterFooter",this,e);let l=[];return l=Ya(l,Hl(r)),l=Ya(l,Hl(o)),l=Ya(l,Hl(a)),l}_createItems(e){const i=this._active,s=this.chart.data,r=[],o=[],a=[];let c,u,l=[];for(c=0,u=i.length;c<u;++c)l.push(J8e(this.chart,i[c]));return e.filter&&(l=l.filter((d,h,f)=>e.filter(d,h,f,s))),e.itemSort&&(l=l.sort((d,h)=>e.itemSort(d,h,s))),vn(l,d=>{const h=xY(e.callbacks,d);r.push(xr(h,"labelColor",this,d)),o.push(xr(h,"labelPointStyle",this,d)),a.push(xr(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=a,this.dataPoints=l,l}update(e,i){const s=this.options.setContext(this.getContext()),r=this._active;let o,a=[];if(r.length){const l=$_[s.position].call(this,r,this._eventPosition);a=this._createItems(s),this.title=this.getTitle(a,s),this.beforeBody=this.getBeforeBody(a,s),this.body=this.getBody(a,s),this.afterBody=this.getAfterBody(a,s),this.footer=this.getFooter(a,s);const c=this._size=bY(this,s),u=Object.assign({},l,c),d=_Y(this.chart,s,u),h=yY(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,o={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}else 0!==this.opacity&&(o={opacity:0});this._tooltipItems=a,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,s,r){const o=this.getCaretPosition(e,s,r);i.lineTo(o.x1,o.y1),i.lineTo(o.x2,o.y2),i.lineTo(o.x3,o.y3)}getCaretPosition(e,i,s){const{xAlign:r,yAlign:o}=this,{caretSize:a,cornerRadius:l}=s,{topLeft:c,topRight:u,bottomLeft:d,bottomRight:h}=Pd(l),{x:f,y:p}=e,{width:g,height:m}=i;let b,_,y,v,x,S;return"center"===o?(x=p+m/2,"left"===r?(b=f,_=b-a,v=x+a,S=x-a):(b=f+g,_=b+a,v=x-a,S=x+a),y=b):(_="left"===r?f+Math.max(c,d)+a:"right"===r?f+g-Math.max(u,h)-a:this.caretX,"top"===o?(v=p,x=v-a,b=_-a,y=_+a):(v=p+m,x=v+a,b=_+a,y=_-a),S=v),{x1:b,x2:_,x3:y,y1:v,y2:x,y3:S}}drawTitle(e,i,s){const r=this.title,o=r.length;let a,l,c;if(o){const u=gp(s.rtl,this.x,this.width);for(e.x=T1(this,s.titleAlign,s),i.textAlign=u.textAlign(s.titleAlign),i.textBaseline="middle",a=rs(s.titleFont),l=s.titleSpacing,i.fillStyle=s.titleColor,i.font=a.string,c=0;c<o;++c)i.fillText(r[c],u.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+l,c+1===o&&(e.y+=s.titleMarginBottom-l)}}_drawColorBox(e,i,s,r,o){const a=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:u}=o,d=rs(o.bodyFont),h=T1(this,"left",o),f=r.x(h),g=i.y+(c<d.lineHeight?(d.lineHeight-c)/2:0);if(o.usePointStyle){const m={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},b=r.leftForLtr(f,u)+u/2,_=g+c/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,D2(e,m,b,_),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,D2(e,m,b,_)}else{e.lineWidth=Wt(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const m=r.leftForLtr(f,u),b=r.leftForLtr(r.xPlus(f,1),u-2),_=Pd(a.borderRadius);Object.values(_).some(y=>0!==y)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,E_(e,{x:m,y:g,w:u,h:c,radius:_}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),E_(e,{x:b,y:g+1,w:u-2,h:c-2,radius:_}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(m,g,u,c),e.strokeRect(m,g,u,c),e.fillStyle=a.backgroundColor,e.fillRect(b,g+1,u-2,c-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,i,s){const{body:r}=this,{bodySpacing:o,bodyAlign:a,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:d}=s,h=rs(s.bodyFont);let f=h.lineHeight,p=0;const g=gp(s.rtl,this.x,this.width),m=function(D){i.fillText(D,g.x(e.x+p),e.y+f/2),e.y+=f+o},b=g.textAlign(a);let _,y,v,x,S,E,k;for(i.textAlign=a,i.textBaseline="middle",i.font=h.string,e.x=T1(this,b,s),i.fillStyle=s.bodyColor,vn(this.beforeBody,m),p=l&&"right"!==b?"center"===a?u/2+d:u+2+d:0,x=0,E=r.length;x<E;++x){for(_=r[x],y=this.labelTextColors[x],i.fillStyle=y,vn(_.before,m),v=_.lines,l&&v.length&&(this._drawColorBox(i,e,x,g,s),f=Math.max(h.lineHeight,c)),S=0,k=v.length;S<k;++S)m(v[S]),f=h.lineHeight;vn(_.after,m)}p=0,f=h.lineHeight,vn(this.afterBody,m),e.y-=o}drawFooter(e,i,s){const r=this.footer,o=r.length;let a,l;if(o){const c=gp(s.rtl,this.x,this.width);for(e.x=T1(this,s.footerAlign,s),e.y+=s.footerMarginTop,i.textAlign=c.textAlign(s.footerAlign),i.textBaseline="middle",a=rs(s.footerFont),i.fillStyle=s.footerColor,i.font=a.string,l=0;l<o;++l)i.fillText(r[l],c.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+s.footerSpacing}}drawBackground(e,i,s,r){const{xAlign:o,yAlign:a}=this,{x:l,y:c}=e,{width:u,height:d}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:g}=Pd(r.cornerRadius);i.fillStyle=r.backgroundColor,i.strokeStyle=r.borderColor,i.lineWidth=r.borderWidth,i.beginPath(),i.moveTo(l+h,c),"top"===a&&this.drawCaret(e,i,s,r),i.lineTo(l+u-f,c),i.quadraticCurveTo(l+u,c,l+u,c+f),"center"===a&&"right"===o&&this.drawCaret(e,i,s,r),i.lineTo(l+u,c+d-g),i.quadraticCurveTo(l+u,c+d,l+u-g,c+d),"bottom"===a&&this.drawCaret(e,i,s,r),i.lineTo(l+p,c+d),i.quadraticCurveTo(l,c+d,l,c+d-p),"center"===a&&"left"===o&&this.drawCaret(e,i,s,r),i.lineTo(l,c+h),i.quadraticCurveTo(l,c,l+h,c),i.closePath(),i.fill(),r.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){const i=this.chart,s=this.$animations,r=s&&s.x,o=s&&s.y;if(r||o){const a=$_[e.position].call(this,this._active,this._eventPosition);if(!a)return;const l=this._size=bY(this,e),c=Object.assign({},a,this._size),u=_Y(i,e,c),d=yY(e,c,u,i);(r._to!==d.x||o._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const i=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(i);const r={width:this.width,height:this.height},o={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const a=Hs(i.padding);i.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(e.save(),e.globalAlpha=s,this.drawBackground(o,e,r,i),tX(e,i.textDirection),o.y+=a.top,this.drawTitle(o,e,i),this.drawBody(o,e,i),this.drawFooter(o,e,i),nX(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){const s=this._active,r=e.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),o=!s1(s,r),a=this._positionChanged(r,i);(o||a)&&(this._active=r,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,s=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,o=this._active||[],a=this._getActiveElements(e,o,i,s),l=this._positionChanged(a,e),c=i||!s1(a,o)||l;return c&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),c}_getActiveElements(e,i,s,r){const o=this.options;if("mouseout"===e.type)return[];if(!r)return i.filter(l=>this.chart.data.datasets[l.datasetIndex]&&void 0!==this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index));const a=this.chart.getElementsAtEventForMode(e,o.mode,o,s);return o.reverse&&a.reverse(),a}_positionChanged(e,i){const{caretX:s,caretY:r,options:o}=this,a=$_[o.position].call(this,e,i);return!1!==a&&(s!==a.x||r!==a.y)}}return Ie(n,"positioners",$_),n})();var a7e=Object.freeze({__proto__:null,Colors:y8e,Decimation:w8e,Filler:W8e,Legend:X8e,SubTitle:Q8e,Title:Z8e,Tooltip:{id:"tooltip",_element:wY,positioners:$_,afterInit(n,t,e){e&&(n.tooltip=new wY({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(!1===n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0}))return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){n.tooltip&&n.tooltip.handleEvent(t.event,t.replay,t.inChartArea)&&(t.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:CY},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>"filter"!==n&&"itemSort"!==n&&"external"!==n,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]}});function SY(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}let d7e=(()=>{class n extends $d{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const i=this._addedLabels;if(i.length){const s=this.getLabels();for(const{index:r,label:o}of i)s[r]===o&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(Vt(e))return null;const s=this.getLabels();return i=isFinite(i)&&s[i]===e?i:function c7e(n,t,e,i){const s=n.indexOf(t);return-1===s?((n,t,e,i)=>("string"==typeof t?(e=n.push(t)-1,i.unshift({index:e,label:t})):isNaN(t)&&(e=null),e))(n,t,e,i):s!==n.lastIndexOf(t)?e:s}(s,e,yt(i,e),this._addedLabels),((n,t)=>null===n?null:ms(Math.round(n),0,t))(i,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(s=0),i||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,i=this.max,s=this.options.offset,r=[];let o=this.getLabels();o=0===e&&i===o.length-1?o:o.slice(e,i+1),this._valueRange=Math.max(o.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let a=e;a<=i;a++)r.push({value:a});return r}getLabelForValue(e){return SY.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!=typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}return Ie(n,"id","category"),Ie(n,"defaults",{ticks:{callback:SY}}),n})();function IY(n,t,{horizontal:e,minRotation:i}){const s=sa(i),r=(e?Math.sin(s):Math.cos(s))||.001;return Math.min(t/r,.75*t*(""+n).length)}class D1 extends $d{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return Vt(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:r}=this;const o=l=>s=e?s:l,a=l=>r=i?r:l;if(t){const l=Ka(s),c=Ka(r);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(s===r){let l=0===r?1:Math.abs(.05*r);a(r+l),t||o(s-l)}this.min=s,this.max=r}getTickLimit(){const t=this.options.ticks;let s,{maxTicksLimit:e,stepSize:i}=t;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),e=e||11),e&&(s=Math.min(e,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const o=function h7e(n,t){const e=[],{bounds:s,step:r,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:h}=n,f=r||1,p=u-1,{min:g,max:m}=t,b=!Vt(o),_=!Vt(a),y=!Vt(c),v=(m-g)/(d+1);let S,E,k,D,x=EK((m-g)/p/f)*f;if(x<1e-14&&!b&&!_)return[{value:g},{value:m}];D=Math.ceil(m/x)-Math.floor(g/x),D>p&&(x=EK(D*x/p/f)*f),Vt(l)||(S=Math.pow(10,l),x=Math.ceil(x*S)/S),"ticks"===s?(E=Math.floor(g/x)*x,k=Math.ceil(m/x)*x):(E=g,k=m),b&&_&&r&&function JHe(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}((a-o)/r,x/1e3)?(D=Math.round(Math.min((a-o)/x,u)),x=(a-o)/D,E=o,k=a):y?(E=b?o:E,k=_?a:k,D=c-1,x=(k-E)/D):(D=(k-E)/x,D=x_(D,Math.round(D),x/1e3)?Math.round(D):Math.ceil(D));const M=Math.max(TK(x),TK(E));S=Math.pow(10,Vt(l)?M:l),E=Math.round(E*S)/S,k=Math.round(k*S)/S;let R=0;for(b&&(h&&E!==o?(e.push({value:o}),E<o&&R++,x_(Math.round((E+R*x)*S)/S,o,IY(o,v,n))&&R++):E<o&&R++);R<D;++R){const U=Math.round((E+R*x)*S)/S;if(_&&U>a)break;e.push({value:U})}return _&&h&&k!==a?e.length&&x_(e[e.length-1].value,a,IY(a,v,n))?e[e.length-1].value=a:e.push({value:a}):(!_||k===a)&&e.push({value:k}),e}({maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&kK(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-e)/Math.max(t.length-1,1)/2;e-=s,i+=s}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return S_(t,this.chart.options.locale,this.options.ticks.format)}}class tR extends D1{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Ii(t)?t:0,this.max=Ii(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=sa(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/s))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Ie(tR,"id","linear"),Ie(tR,"defaults",{ticks:{callback:l1.formatters.numeric}});const B_=n=>Math.floor(eu(n)),Bd=(n,t)=>Math.pow(10,B_(n)+t);function EY(n){return n/Math.pow(10,B_(n))==1}function kY(n,t,e){const i=Math.pow(10,e),s=Math.floor(n/i);return Math.ceil(t/i)-s}class nR extends $d{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=D1.prototype.parse.apply(this,[t,e]);if(0!==i)return Ii(i)&&i>0?i:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Ii(t)?Math.max(0,t):null,this.max=Ii(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Ii(this._userMin)&&(this.min=t===Bd(this.min,0)?Bd(this.min,-1):Bd(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,s=this.max;const r=a=>i=t?i:a,o=a=>s=e?s:a;i===s&&(i<=0?(r(1),o(10)):(r(Bd(i,-1)),o(Bd(s,1)))),i<=0&&r(Bd(s,-1)),s<=0&&o(Bd(i,1)),this.min=i,this.max=s}buildTicks(){const t=this.options,i=function p7e(n,{min:t,max:e}){t=Gr(n.min,t);const i=[],s=B_(t);let r=function f7e(n,t){let i=B_(t-n);for(;kY(n,t,i)>10;)i++;for(;kY(n,t,i)<10;)i--;return Math.min(i,B_(n))}(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),l=s>r?Math.pow(10,s):0,c=Math.round((t-l)*o)/o,u=Math.floor((t-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,r)),h=Gr(n.min,Math.round((l+u+d*Math.pow(10,r))*o)/o);for(;h<e;)i.push({value:h,major:EY(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(r++,d=2,o=r>=0?1:o),h=Math.round((l+u+d*Math.pow(10,r))*o)/o;const f=Gr(n.max,h);return i.push({value:f,major:EY(f),significand:d}),i}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&kK(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return void 0===t?"0":S_(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=eu(t),this._valueRange=eu(this.max)-eu(t)}getPixelForValue(t){return(void 0===t||0===t)&&(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(eu(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function iR(n){const t=n.ticks;if(t.display&&n.display){const e=Hs(t.backdropPadding);return yt(t.font&&t.font.size,ii.font.size)+e.height}return 0}function m7e(n,t,e){return e=qn(e)?e:[e],{w:gje(n,t.string,e),h:e.length*t.lineHeight}}function TY(n,t,e,i,s){return n===i||n===s?{start:t-e/2,end:t+e/2}:n<i||n>s?{start:t-e,end:t}:{start:t,end:t+e}}function b7e(n,t,e,i,s){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,l=0;i.start<t.l?(a=(t.l-i.start)/r,n.l=Math.min(n.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/r,n.r=Math.max(n.r,t.r+a)),s.start<t.t?(l=(t.t-s.start)/o,n.t=Math.min(n.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/o,n.b=Math.max(n.b,t.b+l))}function _7e(n,t,e){const i=n.drawingArea,{extra:s,additionalAngle:r,padding:o,size:a}=e,l=n.getPointPosition(t,i+s+o,r),c=Math.round(x2(Us(l.angle+Ai))),u=function w7e(n,t,e){return 90===e||270===e?n-=t/2:(e>270||e<90)&&(n-=t),n}(l.y,a.h,c),d=function x7e(n){return 0===n||180===n?"center":n<180?"left":"right"}(c),h=function C7e(n,t,e){return"right"===e?n-=t:"center"===e&&(n-=t/2),n}(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function y7e(n,t){if(!t)return!0;const{left:e,top:i,right:s,bottom:r}=n;return!(Ul({x:e,y:i},t)||Ul({x:e,y:r},t)||Ul({x:s,y:i},t)||Ul({x:s,y:r},t))}function S7e(n,t,e){const{left:i,top:s,right:r,bottom:o}=e,{backdropColor:a}=t;if(!Vt(a)){const l=Pd(t.borderRadius),c=Hs(t.backdropPadding);n.fillStyle=a;const u=i-c.left,d=s-c.top,h=r-i+c.width,f=o-s+c.height;Object.values(l).some(p=>0!==p)?(n.beginPath(),E_(n,{x:u,y:d,w:h,h:f,radius:l}),n.fill()):n.fillRect(u,d,h,f)}}function DY(n,t,e,i){const{ctx:s}=n;if(e)s.arc(n.xCenter,n.yCenter,t,0,Kn);else{let r=n.getPointPosition(0,t);s.moveTo(r.x,r.y);for(let o=1;o<i;o++)r=n.getPointPosition(o,t),s.lineTo(r.x,r.y)}}Ie(nR,"id","logarithmic"),Ie(nR,"defaults",{ticks:{callback:l1.formatters.logarithmic,major:{enabled:!0}}});class V_ extends D1{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Hs(iR(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=Ii(t)&&!isNaN(t)?t:0,this.max=Ii(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/iR(this.options))}generateTickLabels(t){D1.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,i)=>{const s=Fn(this.options.pointLabels.callback,[e,i],this);return s||0===s?s:""}).filter((e,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?function g7e(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),i=[],s=[],r=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?sn/r:0;for(let l=0;l<r;l++){const c=o.setContext(n.getPointLabelContext(l));s[l]=c.padding;const u=n.getPointPosition(l,n.drawingArea+s[l],a),d=rs(c.font),h=m7e(n.ctx,d,n._pointLabels[l]);i[l]=h;const f=Us(n.getIndexAngle(l)+a),p=Math.round(x2(f));b7e(e,t,f,TY(p,u.x,h.w,0,180),TY(p,u.y,h.h,90,270))}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=function v7e(n,t,e){const i=[],s=n._pointLabels.length,r=n.options,{centerPointLabels:o,display:a}=r.pointLabels,l={extra:iR(r)/2,additionalAngle:o?sn/s:0};let c;for(let u=0;u<s;u++){l.padding=e[u],l.size=t[u];const d=_7e(n,u,l);i.push(d),"auto"===a&&(d.visible=y7e(d,c),d.visible&&(c=d))}return i}(n,i,s)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,s){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,s))}getIndexAngle(t){return Us(t*(Kn/(this._pointLabels.length||1))+sa(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(Vt(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(Vt(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return function k7e(n,t,e){return tu(n,{label:e,index:t,type:"pointLabel"})}(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const s=this.getIndexAngle(t)-Ai+i;return{x:Math.cos(s)*e+this.xCenter,y:Math.sin(s)*e+this.yCenter,angle:s}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:s,bottom:r}=this._pointLabelItems[t];return{left:e,top:i,right:s,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),DY(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:i,grid:s,border:r}=e,o=this._pointLabels.length;let a,l,c;if(e.pointLabels.display&&function I7e(n,t){const{ctx:e,options:{pointLabels:i}}=n;for(let s=t-1;s>=0;s--){const r=n._pointLabelItems[s];if(!r.visible)continue;const o=i.setContext(n.getPointLabelContext(s));S7e(e,o,r);const a=rs(o.font),{x:l,y:c,textAlign:u}=r;Md(e,n._pointLabels[s],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}(this,o),s.display&&this.ticks.forEach((u,d)=>{if(0!==d||0===d&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const h=this.getContext(d),f=s.setContext(h),p=r.setContext(h);!function E7e(n,t,e,i,s){const r=n.ctx,o=t.circular,{color:a,lineWidth:l}=t;!o&&!i||!a||!l||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=l,r.setLineDash(s.dash||[]),r.lineDashOffset=s.dashOffset,r.beginPath(),DY(n,e,o,i),r.closePath(),r.stroke(),r.restore())}(this,f,l,o,p)}}),i.display){for(t.save(),a=o-1;a>=0;a--){const u=i.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:h}=u;!h||!d||(t.lineWidth=h,t.strokeStyle=d,t.setLineDash(u.borderDash),t.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(0===l&&this.min>=0&&!e.reverse)return;const c=i.setContext(this.getContext(l)),u=rs(c.font);if(r=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=u.string,o=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const d=Hs(c.backdropPadding);t.fillRect(-o/2-d.left,-r-u.size/2-d.top,o+d.width,u.size+d.height)}Md(t,a.label,0,-r,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}Ie(V_,"id","radialLinear"),Ie(V_,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:l1.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:n=>n,padding:5,centerPointLabels:!1}}),Ie(V_,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Ie(V_,"descriptors",{angleLines:{_fallback:"grid"}});const N1={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Cr=Object.keys(N1);function NY(n,t){return n-t}function AY(n,t){if(Vt(t))return null;const e=n._adapter,{parser:i,round:s,isoWeekday:r}=n._parseOpts;let o=t;return"function"==typeof i&&(o=i(o)),Ii(o)||(o="string"==typeof i?e.parse(o,i):e.parse(o)),null===o?null:(s&&(o="week"!==s||!fp(r)&&!0!==r?e.startOf(o,s):e.startOf(o,"isoWeek",r)),+o)}function MY(n,t,e,i){const s=Cr.length;for(let r=Cr.indexOf(n);r<s-1;++r){const o=N1[Cr[r]];if(o.common&&Math.ceil((e-t)/((o.steps?o.steps:Number.MAX_SAFE_INTEGER)*o.size))<=i)return Cr[r]}return Cr[s-1]}function PY(n,t,e){if(e){if(e.length){const{lo:i,hi:s}=w2(e,t);n[e[i]>=t?e[i]:e[s]]=!0}}else n[t]=!0}function RY(n,t,e){const i=[],s={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],s[a]=o,i.push({value:a,major:!1});return 0!==r&&e?function N7e(n,t,e,i){const s=n._adapter,r=+s.startOf(t[0].value,i),o=t[t.length-1].value;let a,l;for(a=r;a<=o;a=+s.add(a,1,i))l=e[a],l>=0&&(t[l].major=!0);return t}(n,i,s,e):i}let sR=(()=>{class n extends $d{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){const s=e.time||(e.time={}),r=this._adapter=new FGe__date(e.adapters.date);r.init(i),y_(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return void 0===e?null:AY(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,i=this._adapter,s=e.time.unit||"day";let{min:r,max:o,minDefined:a,maxDefined:l}=this.getUserBounds();function c(u){!a&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!l&&!isNaN(u.max)&&(o=Math.max(o,u.max))}(!a||!l)&&(c(this._getLabelBounds()),("ticks"!==e.bounds||"labels"!==e.ticks.source)&&c(this.getMinMax(!1))),r=Ii(r)&&!isNaN(r)?r:+i.startOf(Date.now(),s),o=Ii(o)&&!isNaN(o)?o:+i.endOf(Date.now(),s)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],s=e[e.length-1]),{min:i,max:s}}buildTicks(){const e=this.options,i=e.time,s=e.ticks,r="labels"===s.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,l=function ije(n,t,e){let i=0,s=n.length;for(;i<s&&n[i]<t;)i++;for(;s>i&&n[s-1]>e;)s--;return i>0||s<n.length?n.slice(i,s):n}(r,o,this.max);return this._unit=i.unit||(s.autoSkip?MY(i.minUnit,this.min,this.max,this._getLabelCapacity(o)):function T7e(n,t,e,i,s){for(let r=Cr.length-1;r>=Cr.indexOf(e);r--){const o=Cr[r];if(N1[o].common&&n._adapter.diff(s,i,o)>=t-1)return o}return Cr[e?Cr.indexOf(e):0]}(this,l.length,i.minUnit,this.min,this.max)),this._majorUnit=s.major.enabled&&"year"!==this._unit?function D7e(n){for(let t=Cr.indexOf(n)+1,e=Cr.length;t<e;++t)if(N1[Cr[t]].common)return Cr[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&l.reverse(),RY(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let r,o,i=0,s=0;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),i=1===e.length?1-r:(this.getDecimalForValue(e[1])-r)/2,o=this.getDecimalForValue(e[e.length-1]),s=1===e.length?o:(o-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;i=ms(i,0,a),s=ms(s,0,a),this._offsets={start:i,end:s,factor:1/(i+1+s)}}_generate(){const e=this._adapter,i=this.min,s=this.max,r=this.options,o=r.time,a=o.unit||MY(o.minUnit,i,s,this._getLabelCapacity(i)),l=yt(r.ticks.stepSize,1),c="week"===a&&o.isoWeekday,u=fp(c)||!0===c,d={};let f,p,h=i;if(u&&(h=+e.startOf(h,"isoWeek",c)),h=+e.startOf(h,u?"day":a),e.diff(s,i,a)>1e5*l)throw new Error(i+" and "+s+" are too far apart with stepSize of "+l+" "+a);const g="data"===r.ticks.source&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,l,a),p++)PY(d,f,g);return(f===s||"ticks"===r.bounds||1===p)&&PY(d,f,g),Object.keys(d).sort(NY).map(m=>+m)}getLabelForValue(e){const s=this.options.time;return this._adapter.format(e,s.tooltipFormat?s.tooltipFormat:s.displayFormats.datetime)}format(e,i){return this._adapter.format(e,i||this.options.time.displayFormats[this._unit])}_tickFormatFunction(e,i,s,r){const o=this.options,a=o.ticks.callback;if(a)return Fn(a,[e,i,s],this);const l=o.time.displayFormats,c=this._unit,u=this._majorUnit,h=u&&l[u],f=s[i];return this._adapter.format(e,r||(u&&h&&f&&f.major?h:c&&l[c]))}generateTickLabels(e){let i,s,r;for(i=0,s=e.length;i<s;++i)r=e[i],r.label=this._tickFormatFunction(r.value,i,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const i=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+s)*i.factor)}getValueForPixel(e){const i=this._offsets,s=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const i=this.options.ticks,s=this.ctx.measureText(e).width,r=sa(this.isHorizontal()?i.maxRotation:i.minRotation),o=Math.cos(r),a=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:s*o+l*a,h:s*a+l*o}}_getLabelCapacity(e){const i=this.options.time,s=i.displayFormats,r=s[i.unit]||s.millisecond,o=this._tickFormatFunction(e,0,RY(this,[e],this._majorUnit),r),a=this._getLabelSize(o),l=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return l>0?l:1}getDataTimestamps(){let i,s,e=this._cache.data||[];if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(i=0,s=r.length;i<s;++i)e=e.concat(r[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let i,s;if(e.length)return e;const r=this.getLabels();for(i=0,s=r.length;i<s;++i)e.push(AY(this,r[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return MK(e.sort(NY))}}return Ie(n,"id","time"),Ie(n,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}}),n})();function A1(n,t,e){let r,o,a,l,i=0,s=n.length-1;e?(t>=n[i].pos&&t<=n[s].pos&&({lo:i,hi:s}=zl(n,"pos",t)),({pos:r,time:a}=n[i]),({pos:o,time:l}=n[s])):(t>=n[i].time&&t<=n[s].time&&({lo:i,hi:s}=zl(n,"time",t)),({time:r,pos:a}=n[i]),({time:o,pos:l}=n[s]));const c=o-r;return c?a+(l-a)*(t-r)/c:a}class rR extends sR{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=A1(e,this.min),this._tableRange=A1(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,s=[],r=[];let o,a,l,c,u;for(o=0,a=t.length;o<a;++o)c=t[o],c>=e&&c<=i&&s.push(c);if(s.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(o=0,a=s.length;o<a;++o)u=s[o+1],l=s[o-1],c=s[o],Math.round((u+l)/2)!==c&&r.push({time:c,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(e)||1===i.length)&&i.push(e),i.sort((s,r)=>s-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return t=e.length&&i.length?this.normalize(e.concat(i)):e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(A1(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return A1(this._table,i*this._tableRange+this._minPos,!0)}}function P7e(n,t){1&n&&(w(0,"div",19),Ne(1,"div",20),w(2,"p"),I(3,"Loading..."),C()())}function R7e(n,t){if(1&n&&(w(0,"option",21),I(1),C()),2&n){const e=t.$implicit;oe("value",e),W(1),ot(e)}}function O7e(n,t){if(1&n&&(w(0,"option",21),I(1),C()),2&n){const e=t.$implicit;oe("value",e),W(1),ot(e)}}function F7e(n,t){if(1&n&&(w(0,"option",21),I(1),C()),2&n){const e=t.$implicit;oe("value",e),W(1),ot(e)}}function L7e(n,t){if(1&n&&(w(0,"option",21),I(1),C()),2&n){const e=t.$implicit;oe("value",e),W(1),ln(" ",e," ")}}function $7e(n,t){if(1&n&&(w(0,"option",21),I(1),C()),2&n){const e=t.index;oe("value",e+1),W(1),ln(" ",e+1," ")}}function B7e(n,t){if(1&n&&(w(0,"p",28),I(1),oi(2,"number"),C()),2&n){const e=Ge(2);W(1),ln(" Track Length = ",bi(2,1,e.currentAnalytics.trackLength,"1.3-3")," miles ")}}function V7e(n,t){if(1&n&&(w(0,"p",28),I(1),oi(2,"number"),C()),2&n){const e=Ge(2);W(1),ln(" Avg Pit Stop Time = ",bi(2,1,e.currentAnalytics.avgPitStopTime,"1.0-0")," seconds ")}}function z7e(n,t){if(1&n&&(w(0,"div",22)(1,"div",23),Ne(2,"img",24),w(3,"div",25)(4,"h3",26),I(5),C(),ze(6,B7e,3,4,"p",27),ze(7,V7e,3,4,"p",27),C()()()),2&n){const e=Ge();W(2),oe("src",e.currentTrackImage,dh)("alt",e.selectedTrack+" Track Layout"),W(3),ot(e.selectedTrack),W(1),oe("ngIf",e.currentAnalytics),W(1),oe("ngIf",e.currentAnalytics)}}function U7e(n,t){if(1&n&&(w(0,"p",29),I(1),C()),2&n){const e=Ge();W(1),ot(e.errorMessage)}}function W7e(n,t){if(1&n&&(w(0,"tr")(1,"td"),I(2),C(),w(3,"td"),I(4),oi(5,"number"),C()()),2&n){const e=t.$implicit,i=t.index,s=Ge(4);W(2),ot(+s.startingLapSelected+i),W(2),ot(bi(5,2,e,"1.2-2"))}}function H7e(n,t){if(1&n&&(w(0,"div",32)(1,"h3"),I(2,"Predicted Lap Times"),C(),w(3,"table")(4,"tr")(5,"th"),I(6,"Lap #"),C(),w(7,"th"),I(8,"Predicted Time (s)"),C()(),ze(9,W7e,6,5,"tr",33),C()()),2&n){const e=Ge(3);W(9),oe("ngForOf",e.stintResults.predicted_lap_times)}}function j7e(n,t){if(1&n&&(w(0,"div",30),ze(1,H7e,10,1,"div",31),C()),2&n){const e=Ge(2);W(1),oe("ngIf",e.stintResults.predicted_lap_times.length>0)}}function G7e(n,t){if(1&n&&(w(0,"div"),ze(1,j7e,2,1,"div",17),C()),2&n){const e=Ge();W(1),oe("ngIf","pre"!=e.activeMode&&"real"!=e.activeMode&&"post"!=e.activeMode&&"newSession"!=e.activeMode&&"trueEvent"!=e.activeMode)}}function q7e(n,t){if(1&n&&(w(0,"tr")(1,"td"),I(2),C(),w(3,"td"),I(4),oi(5,"number"),C(),w(6,"td"),I(7),oi(8,"number"),C(),w(9,"td"),I(10),oi(11,"number"),C(),w(12,"td"),I(13),oi(14,"number"),C()()),2&n){const e=t.$implicit,i=t.index,s=Ge(3);W(2),ot(+s.startingLapSelected+i),W(2),ot(s.isValidLapTime(e)?bi(5,5,e,"1.2-2"):"N/A"),W(3),ot(s.isValidLapTime(s.stintResults.true_lap_times[i])?bi(8,8,s.stintResults.true_lap_times[i],"1.2-2"):"N/A"),W(3),ot(s.isValidLapTime(e)&&s.isValidLapTime(s.stintResults.true_lap_times[i])?bi(11,11,s.Math.abs(e-s.stintResults.true_lap_times[i]),"1.2-2"):"N/A"),W(3),ot(s.isValidLapTime(e)&&s.isValidLapTime(s.stintResults.true_lap_times[i])?bi(14,14,100*s.Math.abs(e-s.stintResults.true_lap_times[i])/s.stintResults.true_lap_times[i],"1.1-1")+"%":"N/A")}}function K7e(n,t){if(1&n&&(w(0,"div")(1,"h3"),I(2,"Pre-Event Prediction Results"),C(),w(3,"table")(4,"tr")(5,"th"),I(6,"Lap #"),C(),w(7,"th"),I(8,"Predicted"),C(),w(9,"th"),I(10,"True Time"),C(),w(11,"th"),I(12,"Abs Error"),C(),w(13,"th"),I(14,"% Error"),C()(),ze(15,q7e,15,17,"tr",33),C(),Ne(16,"canvas",34),C()),2&n){const e=Ge(2);W(15),oe("ngForOf",e.stintResults.predicted_lap_times)}}function X7e(n,t){if(1&n&&(w(0,"div"),ze(1,K7e,17,1,"div",15),C()),2&n){const e=Ge();W(1),oe("ngIf","pre"===e.activeMode&&e.stintResults.predicted_lap_times.length)}}function Y7e(n,t){if(1&n&&(w(0,"tr")(1,"td"),I(2),C(),w(3,"td"),I(4),oi(5,"number"),C(),w(6,"td"),I(7),oi(8,"number"),C()()),2&n){const e=t.$implicit,i=t.index,s=Ge(3);W(2),ot(+s.startingLapSelected+i),W(2),ot(bi(5,3,e,"1.2-2")),W(3),ot(bi(8,6,s.realTimeResults.pit.predicted_lap_times[i],"1.2-2"))}}function Z7e(n,t){if(1&n&&(w(0,"div")(1,"h3"),I(2,"Real-Time Comparison"),C(),w(3,"table")(4,"tr")(5,"th"),I(6,"Lap"),C(),w(7,"th"),I(8,"No Pit"),C(),w(9,"th"),I(10,"Pit Stop"),C()(),ze(11,Y7e,9,9,"tr",33),C(),Ne(12,"canvas",35),C()),2&n){const e=Ge(2);W(11),oe("ngForOf",e.realTimeResults.noPit.predicted_lap_times)}}function Q7e(n,t){if(1&n&&(w(0,"div"),ze(1,Z7e,13,1,"div",15),C()),2&n){const e=Ge();W(1),oe("ngIf","real"===e.activeMode&&e.realTimeResults)}}Ie(rR,"id","timeseries"),Ie(rR,"defaults",sR.defaults);const J7e=function(n,t,e){return{good:n,neutral:t,bad:e}};function e9e(n,t){if(1&n&&(w(0,"div",36)(1,"h3"),I(2,"\u{1f4ca} Post-Event Summary"),C(),w(3,"div",37)(4,"div")(5,"b"),I(6,"Session MAE:"),C(),I(7),oi(8,"number"),C(),w(9,"div")(10,"b"),I(11,"Model R\xb2:"),C(),I(12),oi(13,"number"),C(),w(14,"div")(15,"b"),I(16,"Session RMSE:"),C(),I(17),oi(18,"number"),C(),w(19,"div")(20,"b"),I(21,"Model RMSE:"),C(),I(22),oi(23,"number"),C()(),w(24,"div",38),I(25),oi(26,"titlecase"),C(),w(27,"div",39)(28,"h4"),I(29,"\u{1f4a1} Insight"),C(),w(30,"p"),I(31),C()()()),2&n){const e=Ge();W(7),ln(" ",bi(8,7,e.postEventResults.mae,"1.2-2")," s"),W(5),ln(" ",bi(13,10,e.postEventResults.model_r2,"1.3-3"),"%"),W(5),ln(" ",bi(18,13,e.postEventResults.rmse,"1.2-2")," s"),W(5),ln(" ",bi(23,16,e.postEventResults.model_rmse,"1.2-2")," s"),W(2),oe("ngClass",CB(21,J7e,"above average"===e.postEventResults.performanceStatus,"on par"===e.postEventResults.performanceStatus,"below average"===e.postEventResults.performanceStatus)),W(1),ln(" Performance: ",TB(26,19,e.postEventResults.performanceStatus)," "),W(6),ot(e.postEventResults.insight)}}function t9e(n,t){if(1&n&&(w(0,"tr")(1,"td"),I(2),C(),w(3,"td"),I(4),oi(5,"number"),C(),w(6,"td"),I(7),oi(8,"number"),C(),w(9,"td"),I(10),oi(11,"number"),C(),w(12,"td"),I(13),oi(14,"number"),C()()),2&n){const e=t.index,i=Ge(3);W(2),ot(+i.startingLapSelected+e),W(2),ot(i.isValidLapTime(i.postEventResults.actual[e])?bi(5,5,i.postEventResults.actual[e],"1.2-2"):"N/A"),W(3),ot(i.isValidLapTime(i.postEventResults.predicted[e])?bi(8,8,i.postEventResults.predicted[e],"1.2-2"):"N/A"),W(3),ot(i.isValidLapTime(i.postEventResults.predicted[e])&&i.isValidLapTime(i.postEventResults.actual[e])?bi(11,11,i.Math.abs(i.postEventResults.predicted[e]-i.postEventResults.actual[e]),"1.2-2"):"N/A"),W(3),ot(i.isValidLapTime(i.postEventResults.predicted[e])&&i.isValidLapTime(i.postEventResults.actual[e])?bi(14,14,100*i.Math.abs(i.postEventResults.predicted[e]-i.postEventResults.actual[e])/i.postEventResults.actual[e],"1.1-1")+"%":"N/A")}}function n9e(n,t){if(1&n&&(w(0,"div")(1,"h3"),I(2,"Post-Event Analysis"),C(),w(3,"table")(4,"tr")(5,"th"),I(6,"Lap"),C(),w(7,"th"),I(8,"True Time"),C(),w(9,"th"),I(10,"Predicted Time"),C(),w(11,"th"),I(12,"Abs Error"),C(),w(13,"th"),I(14,"% Error"),C()(),ze(15,t9e,15,17,"tr",33),C(),Ne(16,"canvas",40),C()),2&n){const e=Ge(2);W(15),oe("ngForOf",e.postEventResults.actual)}}function i9e(n,t){if(1&n&&(w(0,"div"),ze(1,n9e,17,1,"div",15),C()),2&n){const e=Ge();W(1),oe("ngIf","post"===e.activeMode&&e.postEventResults)}}function s9e(n,t){if(1&n&&(w(0,"option",21),I(1),C()),2&n){const e=t.$implicit;oe("value",e),W(1),ln(" ",e," ")}}function r9e(n,t){if(1&n&&(w(0,"tr")(1,"td"),I(2),C(),w(3,"td"),I(4),C(),w(5,"td"),I(6),C(),w(7,"td"),I(8),oi(9,"number"),C(),w(10,"td"),I(11),C(),w(12,"td"),I(13),C()()),2&n){const e=t.$implicit;W(2),ot(e.vehicle_id),W(2),ot(e.completed_laps),W(2),ot(e.best_lap_time),W(2),ot(bi(9,6,e.total_time,"1.2-2")),W(3),ot(e.invalid_laps.length>0?e.invalid_laps.join(", "):"None"),W(2),ot(e.status)}}function o9e(n,t){if(1&n){const e=to();w(0,"div",30)(1,"h3"),I(2,"\u{1f3c6} Final Race Results"),C(),w(3,"div",41)(4,"p")(5,"b"),I(6,"Track:"),C(),I(7),C(),w(8,"p")(9,"b"),I(10,"Race Session:"),C(),I(11),C(),w(12,"p")(13,"b"),I(14,"Max Laps:"),C(),I(15),C(),w(16,"label")(17,"b"),I(18,"Min Lap Time (seconds):"),C()(),w(19,"select",42),H("ngModelChange",function(s){return Un(e),Wn(Ge().selectedMinLapTime=s)})("change",function(){return Un(e),Wn(Ge().runTrueEvent())}),ze(20,s9e,2,2,"option",6),C()(),w(21,"table",43)(22,"thead")(23,"tr")(24,"th"),I(25,"Vehicle ID"),C(),w(26,"th"),I(27,"Completed Laps"),C(),w(28,"th"),I(29,"Best Lap Time (s)"),C(),w(30,"th"),I(31,"Total Time (s)"),C(),w(32,"th"),I(33,"Invalid Laps"),C(),w(34,"th"),I(35,"Status"),C()()(),w(36,"tbody"),ze(37,r9e,14,9,"tr",33),C()()()}if(2&n){const e=Ge();W(7),ln(" ",e.postEventResults.track_name,""),W(4),ln(" ",e.postEventResults.race_session,""),W(4),ln(" ",e.postEventResults.max_lap,""),W(4),oe("ngModel",e.selectedMinLapTime),W(1),oe("ngForOf",e.minLapOptions),W(17),oe("ngForOf",e.postEventResults.results)}}function a9e(n,t){if(1&n&&(w(0,"option",21),I(1),C()),2&n){const e=t.$implicit;oe("value",e),W(1),ot(e)}}function l9e(n,t){1&n&&(w(0,"h4"),I(1,"Previous Laps "),C())}function c9e(n,t){if(1&n){const e=to();w(0,"div",55)(1,"div",56)(2,"label"),I(3,"Lap #*"),C(),w(4,"input",48),H("ngModelChange",function(s){return Wn(Un(e).$implicit.lap=s)}),C()(),w(5,"div",56)(6,"label"),I(7,"Lap Time (s)*"),C(),w(8,"input",48),H("ngModelChange",function(s){return Wn(Un(e).$implicit.lap_time_seconds=s)}),C()(),w(9,"div",56)(10,"label"),I(11,"Laps on tires"),C(),w(12,"input",57),H("ngModelChange",function(s){return Wn(Un(e).$implicit.laps_on_tires=s)}),C()(),w(13,"div",56)(14,"label"),I(15,"Fuel Load Proxy"),C(),w(16,"input",57),H("ngModelChange",function(s){return Wn(Un(e).$implicit.fuel_load_proxy=s)}),C()(),w(17,"div",56)(18,"label"),I(19,"Air Temp"),C(),w(20,"input",57),H("ngModelChange",function(s){return Wn(Un(e).$implicit.session_air_temp=s)}),C()(),w(21,"div",56)(22,"label"),I(23,"Track Temp"),C(),w(24,"input",57),H("ngModelChange",function(s){return Wn(Un(e).$implicit.session_track_temp=s)}),C()(),w(25,"button",58),H("click",function(){const r=Un(e).index;return Wn(Ge(2).removePrevLapRow(r))}),I(26,"Remove"),C()()}if(2&n){const e=t.$implicit;W(4),oe("ngModel",e.lap),W(4),oe("ngModel",e.lap_time_seconds),W(4),oe("ngModel",e.laps_on_tires),W(4),oe("ngModel",e.fuel_load_proxy),W(4),oe("ngModel",e.session_air_temp),W(4),oe("ngModel",e.session_track_temp)}}function u9e(n,t){if(1&n&&(w(0,"tr")(1,"td"),I(2),C(),w(3,"td"),I(4),oi(5,"number"),C(),w(6,"td"),I(7),C()()),2&n){const e=t.$implicit;W(2),ot(e.lap),W(2),ot(bi(5,3,e.lap_time_seconds,"1.2-2")),W(3),ot(e.provided?"Yes":"Predicted")}}function d9e(n,t){if(1&n&&(w(0,"div",59)(1,"h4"),I(2,"Prediction Result"),C(),w(3,"p")(4,"b"),I(5,"Track:"),C(),I(6),C(),w(7,"p")(8,"b"),I(9,"Vehicle:"),C(),I(10),C(),w(11,"p")(12,"b"),I(13,"Start Lap Predicted From:"),C(),I(14),C(),w(15,"p")(16,"b"),I(17,"Total Predicted Time:"),C(),I(18),oi(19,"number"),C(),w(20,"p")(21,"b"),I(22,"Best Lap:"),C(),I(23),oi(24,"number"),C(),w(25,"table",60)(26,"thead")(27,"tr")(28,"th"),I(29,"Lap"),C(),w(30,"th"),I(31,"Time (s)"),C(),w(32,"th"),I(33,"Provided?"),C()()(),w(34,"tbody"),ze(35,u9e,8,6,"tr",33),C()()()),2&n){const e=Ge(2);W(6),ln(" ",e.newSessionResult.track_name,""),W(4),ln(" ",e.newSessionResult.vehicle_id,""),W(4),ln(" ",e.newSessionResult.start_lap_predicted_from,""),W(4),ln(" ",bi(19,6,e.newSessionResult.total_predicted_time,"1.2-2")," s"),W(5),ln(" ",bi(24,9,e.newSessionResult.best_lap_time,"1.2-2")," s"),W(12),oe("ngForOf",e.newSessionResult.predicted_laps)}}function h9e(n,t){if(1&n){const e=to();w(0,"div",44)(1,"h3"),I(2,"New Race Session"),C(),w(3,"div",45)(4,"div",46)(5,"label"),I(6,"Track*"),C(),w(7,"select",7),H("ngModelChange",function(s){return Un(e),Wn(Ge().newSessionForm.track_name=s)}),ze(8,a9e,2,2,"option",6),C()(),w(9,"div",46)(10,"label"),I(11,"Vehicle ID*"),C(),w(12,"input",47),H("ngModelChange",function(s){return Un(e),Wn(Ge().newSessionForm.vehicle_id=s)}),C()(),w(13,"div",46)(14,"label"),I(15,"Total Laps to Predict*"),C(),w(16,"input",48),H("ngModelChange",function(s){return Un(e),Wn(Ge().newSessionForm.total_laps_to_predict=s)}),C()()(),w(17,"p"),I(18,"* = Required"),C(),w(19,"div",49),ze(20,l9e,2,0,"h4",15),ze(21,c9e,27,6,"div",50),w(22,"button",51),H("click",function(){return Un(e),Wn(Ge().addPrevLapRow())}),I(23,"Add Previous Lap (optional)"),C()(),w(24,"div",52)(25,"button",53),H("click",function(){return Un(e),Wn(Ge().predictNewSession())}),I(26,"Predict New Race"),C(),w(27,"button",12),H("click",function(){return Un(e),Wn(Ge().newSessionOpen=!1)}),I(28,"Close"),C()(),ze(29,d9e,36,12,"div",54),C()}if(2&n){const e=Ge();W(7),oe("ngModel",e.newSessionForm.track_name),W(1),oe("ngForOf",e.tracks),W(4),oe("ngModel",e.newSessionForm.vehicle_id),W(4),oe("ngModel",e.newSessionForm.total_laps_to_predict),W(4),oe("ngIf",e.newSessionForm&&e.newSessionForm.previous_laps&&e.newSessionForm.previous_laps.length>0),W(1),oe("ngForOf",e.newSessionForm.previous_laps),W(4),oe("disabled",e.isLoading),W(4),oe("ngIf",e.newSessionResult)}}const f9e=function(){return[]};F_.register(OGe,h8e,a7e,Object.freeze({__proto__:null,CategoryScale:d7e,LinearScale:tR,LogarithmicScale:nR,RadialLinearScale:V_,TimeScale:sR,TimeSeriesScale:rR}));const p9e=[{path:"",component:Ode},{path:"proj",component:Qh},{path:"timeLine",component:Bhe},{path:"exper",component:$he},{path:"contact",component:nye},{path:"curProjOne",component:sye},{path:"curProjTwo",component:rye},{path:"leah",component:uye},{path:"projOne",component:dye},{path:"projTwo",component:hye},{path:"projThree",component:fye},{path:"projFour",component:pye},{path:"projFive",component:mye},{path:"games",component:vye},{path:"sudoku",component:Tye},{path:"atom",component:$ye},{path:"chat",component:Cye},{path:"stopLight",component:bHe},{path:"hackathon",component:(()=>{class n{constructor(e,i){this.predictionService=e,this.cd=i,this.charts={},this.MIN_LAP_TIME=25,this.Math=Math,this.tracks=["Barber","Circuit of the Americas","Road America","Sonoma","Virginia International Raceway"],this.raceSessions=["Race 1","Race 2"],this.vehicles=[],this.trackAnalytics={Barber:{r2:96.929,rmse:1.18,trackLength:2.28,avgPitStopTime:34},"Circuit of the Americas":{r2:86.88,rmse:9.7,trackLength:3.416,avgPitStopTime:36},"Road America":{r2:95.621,rmse:1.48,trackLength:4.014,avgPitStopTime:52},Sonoma:{r2:80.01,rmse:5.24,trackLength:2.505,avgPitStopTime:45},"Virginia International Raceway":{r2:98.15,rmse:1.52,trackLength:3.27,avgPitStopTime:25}},this.trackImages={Barber:"assets/tracks/track_image_barber.png","Circuit of the Americas":"assets/tracks/track_image_cota.png","Road America":"assets/tracks/track_image_road_america.png",Sonoma:"assets/tracks/track_image_sonoma.png","Virginia International Raceway":"assets/tracks/track_image_vir.png"},this.currentTrackImage=null,this.selectedTrack=null,this.selectedSession=null,this.selectedSessionToSend=null,this.selectedVehicle=null,this.startingLap=null,this.startingLapSelected=null,this.stintLength=null,this.currentAnalytics=null,this.isPitStop=!1,this.helpingUserOutVehicle="Loading vehicles...",this.howManyStartingLaps={lap_numbers:[]},this.minLapOptions=Array.from({length:11},(s,r)=>10*r),this.selectedMinLapTime=60,this.newSessionOpen=!1,this.newSessionForm={track_name:"Barber",vehicle_id:"",total_laps_to_predict:10,previous_laps:[]},this.newSessionResult=null,this.sendStintObj={track_name:"Barber",is_pit_stop:!1,race_session:"R2",vehicle_id:"GR86-002-000",start_lap:5,stint_length:10},this.sendTrackAndRaceSession={track_name:"Barber",race_session:"R2"},this.sendTrackAndRaceSessionAndVehicleId={track_name:"Barber",race_session:"R2",vehicle_id:"GR86-002-000"},this.sendTrackAndRaceSessionAndMinTime={track_name:"Barber",race_session:"R2",min_lap_time_enforced:60},this.stintResults={vehicle_id:"",predicted_lap_times:[],true_lap_times:[],race_session:"",start_lap:0},this.realTimeResults=null,this.postEventResults=null,this.isLoading=!1,this.errorMessage="",this.activeMode=null}ngOnInit(){}onTrackChange(){var e=this;return Q(function*(){e.selectedSession=null,e.vehicles=[],e.selectedVehicle=null,e.currentAnalytics=null,e.startingLap=null,e.howManyStartingLaps={lap_numbers:[]},e.selectedTrack?(e.currentAnalytics=e.trackAnalytics[e.selectedTrack]||null,e.currentTrackImage=e.trackImages[e.selectedTrack]||null):(e.currentAnalytics=null,e.currentTrackImage=null)})()}onSessionChange(){var e=this;return Q(function*(){if(e.currentAnalytics=e.selectedTrack&&e.trackAnalytics[e.selectedTrack]||null,!e.selectedTrack||!e.selectedSession)return e.vehicles=[],void(e.selectedVehicle=null);e.vehicles=[],e.selectedVehicle=null,e.startingLap=null,e.howManyStartingLaps={lap_numbers:[]};try{const i="Race 1"===e.selectedSession?"R1":"R2";e.sendTrackAndRaceSession={track_name:e.selectedTrack,race_session:i},e.isLoading=!0;const s=yield Td(e.predictionService.getVehicleIdsByRaceSession(e.sendTrackAndRaceSession));s&&s.vehicle_ids&&s.vehicle_ids.length>0?(e.vehicles=s.vehicle_ids,e.helpingUserOutVehicle="Select Vehicle"):(e.vehicles=[],e.selectedVehicle=null,console.warn(`No vehicles found for ${i}`)),e.cd.detectChanges()}catch(i){e.errorMessage="Failed to load vehicle IDs.",console.error("Failed to load vehicle IDs:",i),e.vehicles=["Car-A","Car-B","Car-C"],e.helpingUserOutVehicle="Select Vehicle"}finally{e.isLoading=!1}})()}onVehicleChange(){var e=this;return Q(function*(){if(e.selectedTrack&&e.selectedSession&&e.selectedVehicle)try{const i="Race 1"===e.selectedSession?"R1":"R2";e.sendTrackAndRaceSessionAndVehicleId={track_name:e.selectedTrack,race_session:i,vehicle_id:e.selectedVehicle},e.isLoading=!0;const s=yield Td(e.predictionService.getLapNumbersByRaceSessionAndVehicleId(e.sendTrackAndRaceSessionAndVehicleId));s&&s.lap_numbers&&s.lap_numbers.length>0?(s.lap_numbers.includes(1)||s.lap_numbers.unshift(1),e.howManyStartingLaps=s,e.startingLap=e.howManyStartingLaps.lap_numbers[0]):console.warn(`No lap numbers found for ${e.selectedVehicle} in ${i}`)}catch(i){e.errorMessage="Failed to load lap numbers.",console.error("Failed to load lap numbers:",i)}finally{e.isLoading=!1}})()}isValidLapTime(e){return null!=e&&e>=this.MIN_LAP_TIME}onPredictStint(){var e=this;return Q(function*(){if(e.errorMessage="",e.stintResults={},e.selectedSession&&e.selectedVehicle&&e.startingLap&&e.stintLength){e.selectedSessionToSend="Race 1"===e.selectedSession?"R1":"R2",e.startingLapSelected=e.startingLap,e.isLoading=!0,e.sendStintObj={track_name:e.selectedTrack||"Barber",is_pit_stop:e.isPitStop,race_session:e.selectedSessionToSend,vehicle_id:e.selectedVehicle,start_lap:e.startingLap,stint_length:e.stintLength};try{const i=yield Td(e.predictionService.simulateStint(e.sendStintObj));e.stintResults=i,"def"!=e.activeMode?(e.cd.detectChanges(),setTimeout(()=>e.plotChart("preChart",i.predicted_lap_times,"Pre-Event Predictions"),0)):e.destroyAllCharts()}catch(i){console.error("Prediction failed:",i),e.errorMessage="Prediction failed. Please refresh the page to try again."}finally{e.isLoading=!1}}else e.errorMessage="Please fill all required fields."})()}runDefault(){var e=this;return Q(function*(){e.activeMode="def",yield e.onPredictStint()})()}runPreEvent(){var e=this;return Q(function*(){e.activeMode="pre",e.newSessionOpen=!1,e.newSessionResult=null,yield e.onPredictStint()})()}runRealTime(){var e=this;return Q(function*(){if(e.errorMessage="",e.activeMode="real",e.newSessionOpen=!1,e.newSessionResult=null,!e.selectedVehicle||!e.startingLap||!e.stintLength)return void(e.errorMessage="Please fill all required fields.");e.startingLapSelected=e.startingLap;const i={...e.sendStintObj,is_pit_stop:!1},s={...e.sendStintObj,is_pit_stop:!0};e.isLoading=!0;const[r,o]=yield Promise.all([Td(e.predictionService.simulateStint(i)),Td(e.predictionService.simulateStint(s))]);e.realTimeResults={noPit:r,pit:o},e.isLoading=!1,e.cd.detectChanges(),setTimeout(()=>e.plotRealTimeChart(r.predicted_lap_times,o.predicted_lap_times),0)})()}runPostEvent(){var e=this;return Q(function*(){if(e.errorMessage="",e.activeMode="post",e.newSessionOpen=!1,e.newSessionResult=null,!(e.stintResults.predicted_lap_times&&e.stintResults.true_lap_times&&e.stintResults.predicted_lap_times.length&&e.stintResults.true_lap_times.length))return e.errorMessage="Please run a prediction first to get post-event analysis.",void(e.activeMode=null);e.startingLapSelected=e.startingLap;const i=e.stintResults.true_lap_times,s=e.stintResults.predicted_lap_times,r=i.map((m,b)=>({actual:m,predicted:s[b]})).filter(m=>e.isValidLapTime(m.actual)&&e.isValidLapTime(m.predicted)),o=r.map(m=>Math.abs(m.predicted-m.actual)),a=r.length?o.reduce((m,b)=>m+b,0)/o.length:0,l=r.length?Math.sqrt(o.map(m=>m**2).reduce((m,b)=>m+b,0)/o.length):0,c=i.map((m,b)=>b+1),{m:u,b:d}=e.computeTrendline(c,i),h=c.map(m=>u*m+d),f=e.currentAnalytics||{r2:0,rmse:0,trackLength:0},p=l-f.rmse;let g="on par";p<=-.2?g="above average":p>=.2&&(g="below average"),e.postEventResults={actual:i,predicted:s,trendline:h,mae:a,rmse:l,model_r2:f.r2,model_rmse:f.rmse,performanceStatus:g,insight:e.getPostEventInsight(a,l,f.r2)},e.cd.detectChanges(),setTimeout(()=>e.plotPostEventChart(i,s,h),0)})()}runTrueEvent(){var e=this;return Q(function*(){if(e.errorMessage="",e.activeMode="trueEvent",e.newSessionOpen=!1,e.newSessionResult=null,!e.selectedTrack||!e.selectedSession)return e.vehicles=[],e.selectedVehicle=null,void(e.errorMessage="Please select track and session first.");try{const i="Race 1"===e.selectedSession?"R1":"R2";e.sendTrackAndRaceSessionAndMinTime={track_name:e.selectedTrack,race_session:i,min_lap_time_enforced:e.selectedMinLapTime},e.isLoading=!0;const s=yield Td(e.predictionService.getFinalResultsByTrackAndRaceSession(e.sendTrackAndRaceSessionAndMinTime));s&&s.results?.length>0?e.postEventResults=s:(e.postEventResults=null,console.warn(`No final results for ${i}`)),e.cd.detectChanges()}catch(i){e.errorMessage="Failed to load final results.",console.error("Failed to load final results:",i)}finally{e.isLoading=!1}})()}filterValidLapTimes(e){return e.filter(i=>this.isValidLapTime(i))}plotChart(e,i,s){const r=document.getElementById(e);if(!r)return;this.charts[e]&&this.charts[e].destroy();const o=this.stintResults.true_lap_times||[],a=Math.max(i.length,o.length),l=Array.from({length:a},(d,h)=>h+1),c=Array.from({length:a},(d,h)=>{const f=h<i.length?i[h]:null;return null!=f&&this.isValidLapTime(f)?f:null}),u=Array.from({length:a},(d,h)=>{const f=h<o.length?o[h]:null;if(null!=f&&this.isValidLapTime(f))return f;const p=h<i.length?i[h]:null;return null!=p&&this.isValidLapTime(p)?p:null});this.charts[e]=new F_(r,{type:"line",data:{labels:l,datasets:[{label:"Predicted Lap Times",data:c,borderColor:"#00BFFF",fill:!1,tension:.2,spanGaps:!0},{label:"True Lap Times",data:u,borderColor:"#4CAF50",fill:!1,tension:.2,spanGaps:!0}]},options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{title:{display:!0,text:"Lap Time (s)"}},x:{title:{display:!0,text:"Lap #"}}}}})}plotRealTimeChart(e,i){const s=document.getElementById("realChart");if(!s)return;this.charts.realChart&&this.charts.realChart.destroy();const r=this.filterValidLapTimes(e),o=this.filterValidLapTimes(i),a=Array.from({length:Math.max(r.length,o.length)},(l,c)=>c+1);this.charts.realChart=new F_(s,{type:"bar",data:{labels:a,datasets:[{label:"No Pit",data:r,backgroundColor:"#007bff"},{label:"Pit Stop",data:o,backgroundColor:"#ff9800"}]},options:{responsive:!0,scales:{y:{beginAtZero:!1,title:{display:!0,text:"Lap Time (s)"}},x:{title:{display:!0,text:"Lap #"}}}}})}plotPostEventChart(e,i,s){const r=document.getElementById("postChart");if(!r)return;this.charts.postChart&&this.charts.postChart.destroy();const o=Math.max(e.length,i.length,s.length),a=Array.from({length:o},(d,h)=>h+1),l=Array.from({length:o},(d,h)=>{const f=h<e.length?e[h]:null;if(null!=f&&this.isValidLapTime(f))return f;const p=h<i.length?i[h]:null;return null!=p&&this.isValidLapTime(p)?p:null}),c=Array.from({length:o},(d,h)=>{const f=h<i.length?i[h]:null;return null!=f&&this.isValidLapTime(f)?f:null}),u=Array.from({length:o},(d,h)=>{const f=h<e.length?e[h]:null;return null!=f&&this.isValidLapTime(f)&&h<s.length?s[h]:null});this.charts.postChart=new F_(r,{type:"line",data:{labels:a,datasets:[{label:"True Lap Times (visual fallback)",data:l,borderColor:"#4caf50",fill:!1,tension:.2,spanGaps:!0},{label:"Predicted Lap Times",data:c,borderColor:"#00BFFF",fill:!1,tension:.2,borderDash:[5,5],spanGaps:!0},{label:"Trendline (True)",data:u,borderColor:"#ff9800",fill:!1,borderDash:[3,3],borderWidth:1.5,pointRadius:0,spanGaps:!0}]},options:{responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Post-Event Analysis: True vs Predicted Lap Times"}},scales:{x:{title:{display:!0,text:"Lap #"}},y:{title:{display:!0,text:"Lap Time (s)"}}}}})}destroyAllCharts(){Object.values(this.charts).forEach(e=>{e&&e.destroy()}),this.charts={}}ngOnDestroy(){Object.values(this.charts).forEach(e=>e.destroy())}computeTrendline(e,i){const s=e.length,r=e.reduce((d,h)=>d+h,0),o=i.reduce((d,h)=>d+h,0),c=(s*e.reduce((d,h,f)=>d+h*i[f],0)-r*o)/(s*e.reduce((d,h)=>d+h*h,0)-r**2);return{m:c,b:(o-c*r)/s}}getPostEventInsight(e,i,s){return i<.5&&s>.95?"\u{1f3ce}\ufe0f Excellent predictive accuracy \u2014 model closely matches actual lap evolution.":i<1&&s>.9?"\u2699\ufe0f Strong model performance \u2014 minor deviations, but pacing trend is well captured.":i<1.5?"\u{1f4c9} Moderate fit \u2014 overall pattern correct, but larger lap-to-lap variation.":"\u26a0\ufe0f Weak agreement \u2014 model drifted from actual race behavior. Consider retraining."}openNewSession(){this.activeMode="newSession",this.newSessionOpen=!0,this.newSessionResult=null,this.newSessionForm={track_name:this.selectedTrack||"Barber",vehicle_id:"",total_laps_to_predict:10,previous_laps:[]}}addPrevLapRow(){this.newSessionForm.previous_laps.push({lap:this.newSessionForm.previous_laps.length+1,lap_time_seconds:100})}removePrevLapRow(e){this.newSessionForm.previous_laps.splice(e,1)}predictNewSession(){var e=this;return Q(function*(){if(e.newSessionForm.track_name&&e.newSessionForm.vehicle_id&&e.newSessionForm.total_laps_to_predict){e.newSessionForm.previous_laps=e.newSessionForm.previous_laps.map(i=>({lap:Number(i.lap),lap_time_seconds:i.lap_time_seconds?Number(i.lap_time_seconds):0,laps_on_tires:i.laps_on_tires?Number(i.laps_on_tires):void 0,fuel_load_proxy:i.fuel_load_proxy?Number(i.fuel_load_proxy):void 0,session_air_temp:i.session_air_temp?Number(i.session_air_temp):void 0,session_track_temp:i.session_track_temp?Number(i.session_track_temp):void 0})),e.isLoading=!0;try{const i={track_name:e.newSessionForm.track_name,vehicle_id:e.newSessionForm.vehicle_id,total_laps_to_predict:Number(e.newSessionForm.total_laps_to_predict),previous_laps:e.newSessionForm.previous_laps},s=yield Td(e.predictionService.predictNewRaceSession(i));e.newSessionResult=s,console.log("newSessionResult",s),e.cd.detectChanges()}catch(i){console.error("predictNewSession failed",i),e.errorMessage="Failed to predict new race session"}finally{e.isLoading=!1}}else e.errorMessage="Fill track, vehicle id and total laps to predict."})()}}return n.\u0275fac=function(e){return new(e||n)(ie(r4),ie(Su))},n.\u0275cmp=Zn({type:n,selectors:[["app-hackathon"]],decls:70,vars:27,consts:[[1,"container"],["class","loading-overlay",4,"ngIf"],[1,"form-row"],[1,"form-group"],[3,"ngModel","ngModelChange","change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"ngValue"],["id","predictButton",3,"disabled","click"],["class","track-image-container",4,"ngIf"],[1,"mode-buttons"],[3,"click"],[1,"btn",3,"click"],["class","error",4,"ngIf"],[4,"ngIf"],["class","post-summary",4,"ngIf"],["class","results-section",4,"ngIf"],["class","new-session-panel",4,"ngIf"],[1,"loading-overlay"],[1,"spinner"],[3,"value"],[1,"track-image-container"],[1,"track-image-wrapper"],[1,"track-image",3,"src","alt"],[1,"track-overlay"],[1,"overlay-title"],["class","overlay-sub",4,"ngIf"],[1,"overlay-sub"],[1,"error"],[1,"results-section"],["class","results",4,"ngIf"],[1,"results"],[4,"ngFor","ngForOf"],["id","preChart"],["id","realChart"],[1,"post-summary"],[1,"summary-grid"],[1,"badge",3,"ngClass"],[1,"insight-box"],["id","postChart"],[1,"final-header-box"],[1,"min-lap-select",3,"ngModel","ngModelChange","change"],[1,"results-table"],[1,"new-session-panel"],[1,"form-row-compact"],[1,"form-compact-item"],["placeholder","e.g. NEW-CAR-001",3,"ngModel","ngModelChange"],["type","number","min","1",3,"ngModel","ngModelChange"],[1,"prev-laps"],["class","prev-lap-row",4,"ngFor","ngForOf"],["type","button",3,"click"],[1,"new-session-actions"],[3,"disabled","click"],["class","new-session-results",4,"ngIf"],[1,"prev-lap-row"],[1,"prev-lap-item"],["type","number",3,"ngModel","ngModelChange"],["type","button",1,"removeButton",3,"click"],[1,"new-session-results"],[1,"pred-table"]],template:function(e,i){1&e&&(w(0,"div",0),ze(1,P7e,4,0,"div",1),w(2,"h2"),I(3,"\u{1f3c1} Race Predictor"),C(),w(4,"div",2)(5,"div",3)(6,"label"),I(7,"Track"),C(),w(8,"select",4),H("ngModelChange",function(r){return i.selectedTrack=r})("change",function(){return i.onTrackChange()}),w(9,"option",5),I(10,"Select Track"),C(),ze(11,R7e,2,2,"option",6),C()(),w(12,"div",3)(13,"label"),I(14,"Race Session"),C(),w(15,"select",4),H("ngModelChange",function(r){return i.selectedSession=r})("change",function(){return i.onSessionChange()}),w(16,"option",5),I(17,"Select Session"),C(),ze(18,O7e,2,2,"option",6),C()(),w(19,"div",3)(20,"label"),I(21,"Vehicle ID"),C(),w(22,"select",4),H("ngModelChange",function(r){return i.selectedVehicle=r})("change",function(){return i.onVehicleChange()}),w(23,"option",5),I(24),C(),ze(25,F7e,2,2,"option",6),C()(),w(26,"div",3)(27,"label"),I(28,"Starting Lap"),C(),w(29,"select",7),H("ngModelChange",function(r){return i.startingLap=r}),w(30,"option",5),I(31,"Select Lap"),C(),ze(32,L7e,2,2,"option",6),C()(),w(33,"div",3)(34,"label"),I(35,"How Many Laps to Predict"),C(),w(36,"select",7),H("ngModelChange",function(r){return i.stintLength=r}),w(37,"option",5),I(38,"Select Length"),C(),ze(39,$7e,2,2,"option",6),C()(),w(40,"div",3)(41,"label"),I(42,"Pit Stop?"),C(),w(43,"select",7),H("ngModelChange",function(r){return i.isPitStop=r}),w(44,"option",8),I(45,"False"),C(),w(46,"option",8),I(47,"True"),C()()(),w(48,"button",9),H("click",function(){return i.runDefault()}),I(49),C()(),ze(50,z7e,8,5,"div",10),w(51,"div",11)(52,"button",12),H("click",function(){return i.runPreEvent()}),I(53,"Pre-Event"),C(),w(54,"button",12),H("click",function(){return i.runRealTime()}),I(55,"Real-Time"),C(),w(56,"button",12),H("click",function(){return i.runPostEvent()}),I(57,"Post-Event"),C(),w(58,"button",12),H("click",function(){return i.runTrueEvent()}),I(59,"Race Results"),C(),w(60,"button",13),H("click",function(){return i.openNewSession()}),I(61,"New Race Session"),C()(),ze(62,U7e,2,1,"p",14),ze(63,G7e,2,1,"div",15),ze(64,X7e,2,1,"div",15),ze(65,Q7e,2,1,"div",15),ze(66,e9e,32,25,"div",16),ze(67,i9e,2,1,"div",15),ze(68,o9e,38,6,"div",17),ze(69,h9e,30,8,"div",18),C()),2&e&&(W(1),oe("ngIf",i.isLoading),W(7),oe("ngModel",i.selectedTrack),W(3),oe("ngForOf",i.tracks),W(4),oe("ngModel",i.selectedSession),W(3),oe("ngForOf",i.raceSessions),W(4),oe("ngModel",i.selectedVehicle),W(2),ot(i.helpingUserOutVehicle),W(1),oe("ngForOf",i.vehicles),W(4),oe("ngModel",i.startingLap),W(3),oe("ngForOf",i.howManyStartingLaps.lap_numbers),W(4),oe("ngModel",i.stintLength),W(3),oe("ngForOf",no(26,f9e).constructor(20)),W(4),oe("ngModel",i.isPitStop),W(1),oe("ngValue",!1),W(2),oe("ngValue",!0),W(2),oe("disabled",i.isLoading),W(1),ln(" ",i.isLoading?"Predicting...":"Predict"," "),W(1),oe("ngIf",i.currentTrackImage),W(12),oe("ngIf",i.errorMessage),W(1),oe("ngIf",i.stintResults&&!i.isLoading),W(1),oe("ngIf",i.stintResults&&!i.isLoading),W(1),oe("ngIf",i.stintResults&&!i.isLoading),W(1),oe("ngIf","post"===i.activeMode&&i.postEventResults),W(1),oe("ngIf",i.stintResults&&!i.isLoading),W(1),oe("ngIf","trueEvent"===i.activeMode&&i.postEventResults),W(1),oe("ngIf",i.newSessionOpen))},dependencies:[VE,ku,pl,UW,HW,gg,MD,sx,xD,$D,nx,tV,J3],styles:[".container[_ngcontent-%COMP%]{max-width:1050px;margin:2rem auto;padding:1.5rem;background:#1b1b1b;color:#fff;border-radius:12px;box-shadow:0 4px 10px #0006}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem 1rem;margin-bottom:1rem}select[_ngcontent-%COMP%]{padding:.4rem;border-radius:6px;border:1px solid #444;background:#252525;color:#fff}button[_ngcontent-%COMP%]{width:100%;padding:.6rem;font-weight:700;border:none;border-radius:8px;background-color:#007bff;color:#fff;cursor:pointer;transition:.3s}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.error[_ngcontent-%COMP%]{color:#ff6b6b;margin-top:.5rem}.results[_ngcontent-%COMP%]{margin-top:1.5rem;background:#252525;padding:1rem;border-radius:10px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border-bottom:1px solid #444;padding:.4rem;text-align:center}.control-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.75rem;flex-wrap:wrap;margin-bottom:1rem}.form-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:1rem;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:140px}.control-bar[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .control-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.4rem .6rem;border-radius:6px;background:#252525;color:#fff;border:1px solid #444;font-size:.9rem}#predictButton[_ngcontent-%COMP%]{background:#3c9aff;color:#fff}#predictButton[_ngcontent-%COMP%]:hover{background:#1967b9}.mode-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;margin:1rem 0}.mode-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:.6rem 1rem;border-radius:8px;cursor:pointer;font-weight:600;transition:.3s}.mode-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}canvas[_ngcontent-%COMP%]{width:100%!important;height:300px!important;margin-top:1rem}.analytics-box[_ngcontent-%COMP%]{background:#1b1b1b;font-size:.9rem}.analytics-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.2rem 0}.post-summary[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1.25rem;background:#000000;border-radius:12px;box-shadow:0 3px 10px #0000000d}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.5rem 2rem;font-size:1rem;margin-bottom:1rem}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.4rem 1rem;border-radius:20px;font-weight:600;font-size:.95rem;margin-bottom:1rem}.badge.good[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.neutral[_ngcontent-%COMP%]{background:#fffde7;color:#f9a825}.badge.bad[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.insight-box[_ngcontent-%COMP%]{background:#000000;border:5px solid #1976d2;border-radius:8px;padding:.75rem 1rem;font-size:1rem}.track-image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px 0;background:transparent;padding:0}.track-image-wrapper[_ngcontent-%COMP%]{position:relative;width:760px;max-width:95%;border-radius:12px;overflow:hidden;box-shadow:0 6px 18px #00000073}.track-image[_ngcontent-%COMP%]{display:block;width:100%;height:auto;object-fit:cover}.track-overlay[_ngcontent-%COMP%]{position:absolute;top:12px;left:12px;right:12px;display:flex;flex-direction:column;align-items:flex-start;gap:3px;color:#fff;text-shadow:0 1px 6px rgba(0,0,0,.7);pointer-events:none}.overlay-title[_ngcontent-%COMP%]{margin:0;font-size:1.4rem;font-weight:700;background:rgba(0,0,0,.45);padding:6px 10px;border-radius:6px}.overlay-sub[_ngcontent-%COMP%]{margin:0;font-size:.95rem;background:rgba(0,0,0,.35);padding:4px 8px;border-radius:6px;line-height:1.4}@media (max-width: 768px){.track-image-wrapper[_ngcontent-%COMP%]{width:100%}.overlay-title[_ngcontent-%COMP%]{font-size:1.15rem}.overlay-sub[_ngcontent-%COMP%]{font-size:.9rem}}.results-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:15px}.results-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .results-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px;border-bottom:1px solid #ccc}.results-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#000000;font-weight:700}.final-header-box[_ngcontent-%COMP%]{margin-bottom:15px;padding:10px;background:#000000;border-radius:6px}.min-lap-select[_ngcontent-%COMP%]{padding:4px 8px;margin-left:6px;border-radius:4px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.55);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);color:#fff;font-size:1.4rem;font-weight:500}.spinner[_ngcontent-%COMP%]{border:8px solid #f3f3f3;border-top:8px solid #3498db;border-radius:50%;width:65px;height:65px;animation:_ngcontent-%COMP%_spin .9s linear infinite;margin-bottom:15px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.new-session-panel[_ngcontent-%COMP%]{margin:12px 0;padding:12px;border:1px solid #ddd;border-radius:6px;background:#000000}.new-session-actions[_ngcontent-%COMP%]{margin-top:10px;display:flex;gap:8px}.new-session-results[_ngcontent-%COMP%]{margin-top:12px;background:#000000;padding:8px;border-radius:6px;border:1px solid #eee}.pred-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:8px}.pred-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .pred-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #eee;padding:6px;text-align:center}.form-row-compact[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px;align-items:flex-start}.form-compact-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:200px}.form-compact-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}.form-compact-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-compact-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:6px}.removeButton[_ngcontent-%COMP%]{background-color:#ff4d4d;color:#fff;width:25%;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:.3s;margin-top:20px}.prev-lap-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:3px;margin-bottom:12px;align-items:flex-start}.prev-lap-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:120px}.prev-lap-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px;font-size:13px}.prev-lap-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:6px;border-radius:4px;width:100px}"]}),n})()}];let m9e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[Uz.forRoot(p9e),Uz]}),n})();const g9e=function(){return[""]},b9e=function(){return["/exper"]},_9e=function(){return["/proj"]},y9e=function(){return["/timeLine"]},v9e=function(){return["/contact"]},x9e=function(){return["/sudoku"]},C9e=function(){return["/curProjOne"]},w9e=function(){return["/games"]},S9e=function(){return["/stopLight"]},I9e=function(){return["/hackathon"]};let E9e=(()=>{class n{constructor(){this.title="ayyyy what is up homie"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zn({type:n,selectors:[["app-root"]],decls:37,vars:20,consts:[[1,"mainHeader"],[1,"websiteMainHeader"],[1,"hide"],[2,"text-decoration","none","color","inherit",3,"routerLink"],["mat-raised-button","",1,"buttonHeader"]],template:function(e,i){1&e&&(w(0,"div",0)(1,"h1",1),I(2," Sam Brey "),C(),w(3,"h4",2),I(4,"Thank you Carter and Leah for testing out my website"),C(),w(5,"a",3)(6,"button",4),I(7,"Home"),C()(),w(8,"a",3)(9,"button",4),I(10,"Resume"),C()(),w(11,"a",3)(12,"button",4),I(13,"Past Projects"),C()(),w(14,"a",3)(15,"button",4),I(16,"Timeline"),C()(),w(17,"a",3)(18,"button",4),I(19,"Contact"),C()(),w(20,"a",3)(21,"button",4),I(22,"AI Sudoku"),C()(),w(23,"a",3)(24,"button",4),I(25,"AI Pathing"),C()(),w(26,"a",3)(27,"button",4),I(28,"Simon"),C()(),w(29,"a",3)(30,"button",4),I(31,"Stop Light"),C()(),w(32,"a",3)(33,"button",4),I(34,"Hackathon"),C()()(),w(35,"body"),Ne(36,"router-outlet"),C()),2&e&&(W(5),oe("routerLink",no(10,g9e)),W(3),oe("routerLink",no(11,b9e)),W(3),oe("routerLink",no(12,_9e)),W(3),oe("routerLink",no(13,y9e)),W(3),oe("routerLink",no(14,v9e)),W(3),oe("routerLink",no(15,x9e)),W(3),oe("routerLink",no(16,C9e)),W(3),oe("routerLink",no(17,w9e)),W(3),oe("routerLink",no(18,S9e)),W(3),oe("routerLink",no(19,I9e)))},dependencies:[vk,K0,co],styles:[".buttonHeader[_ngcontent-%COMP%]{margin:8px 8px 8px 0!important;background-color:#837272!important;color:#000!important;padding:7px!important;font-size:15px!important}.buttonHeader[_ngcontent-%COMP%]:hover{background-color:#b4b4b4!important;color:#fff!important}.buttonHeader[_ngcontent-%COMP%]:focus{background-color:#465547!important}.websiteMainHeader[_ngcontent-%COMP%]{margin-top:10px;transition:.5s all;font-size:2em}.websiteMainHeader[_ngcontent-%COMP%]:hover + .hide[_ngcontent-%COMP%]{display:block;cursor:default;transition-delay:0s}.hide[_ngcontent-%COMP%]{display:none;font-size:1em}"]}),n})();class OY{}class k9e{}const jl="*";function FY(n,t=null){return{type:2,steps:n,options:t}}function M1(n){return{type:6,styles:n,offset:null}}function LY(n){Promise.resolve().then(n)}class z_{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){LY(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class $Y{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,s=0;const r=this.players.length;0==r?LY(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==r&&this._onFinish()}),o.onDestroy(()=>{++i==r&&this._onDestroy()}),o.onStart(()=>{++s==r&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const s=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(s)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const oR="!";function BY(n){return new re(3e3,!1)}function hqe(){return typeof window<"u"&&typeof window.document<"u"}function aR(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function ru(n){switch(n.length){case 0:return new z_;case 1:return n[0];default:return new $Y(n)}}function VY(n,t,e,i,s=new Map,r=new Map){const o=[],a=[];let l=-1,c=null;if(i.forEach(u=>{const d=u.get("offset"),h=d==l,f=h&&c||new Map;u.forEach((p,g)=>{let m=g,b=p;if("offset"!==g)switch(m=t.normalizePropertyName(m,o),b){case oR:b=s.get(g);break;case jl:b=r.get(g);break;default:b=t.normalizeStyleValue(g,m,b,o)}f.set(m,b)}),h||a.push(f),c=f,l=d}),o.length)throw function eqe(n){return new re(3502,!1)}();return a}function lR(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&cR(e,"start",n)));break;case"done":n.onDone(()=>i(e&&cR(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&cR(e,"destroy",n)))}}function cR(n,t,e){const r=uR(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(r._data=o),r}function uR(n,t,e,i,s="",r=0,o){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:s,totalTime:r,disabled:!!o}}function qr(n,t,e){let i=n.get(t);return i||n.set(t,i=e),i}function zY(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let dR=(n,t)=>!1,UY=(n,t,e)=>[],WY=null;function hR(n){const t=n.parentNode||n.host;return t===WY?null:t}(aR()||typeof Element<"u")&&(hqe()?(WY=(()=>document.documentElement)(),dR=(n,t)=>{for(;t;){if(t===n)return!0;t=hR(t)}return!1}):dR=(n,t)=>n.contains(t),UY=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]});let Vd=null,HY=!1;const jY=dR,GY=UY;let qY=(()=>{class n{validateStyleProperty(e){return function pqe(n){Vd||(Vd=function mqe(){return typeof document<"u"?document.body:null}()||{},HY=!!Vd.style&&"WebkitAppearance"in Vd.style);let t=!0;return Vd.style&&!function fqe(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Vd.style,!t&&HY&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Vd.style)),t}(e)}matchesElement(e,i){return!1}containsElement(e,i){return jY(e,i)}getParentElement(e){return hR(e)}query(e,i,s){return GY(e,i,s)}computeStyle(e,i,s){return s||""}animate(e,i,s,r,o,a=[],l){return new z_(s,r)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})(),fR=(()=>{class n{}return n.NOOP=new qY,n})();const gqe=1e3,pR="ng-enter",P1="ng-leave",R1="ng-trigger",O1=".ng-trigger",XY="ng-animating",mR=".ng-animating";function Gl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:gR(parseFloat(t[1]),t[2])}function gR(n,t){return"s"===t?n*gqe:n}function F1(n,t,e){return n.hasOwnProperty("duration")?n:function _qe(n,t,e){let s,r=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(BY()),{duration:0,delay:0,easing:""};s=gR(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(r=gR(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else s=n;if(!e){let a=!1,l=t.length;s<0&&(t.push(function M9e(){return new re(3100,!1)}()),a=!0),r<0&&(t.push(function P9e(){return new re(3101,!1)}()),a=!0),a&&t.splice(l,0,BY())}return{duration:s,delay:r,easing:o}}(n,t,e)}function U_(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function YY(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function ou(n,t=new Map,e){if(e)for(let[i,s]of e)t.set(i,s);for(let[i,s]of n)t.set(i,s);return t}function QY(n,t,e){return e?t+":"+e+";":""}function JY(n){let t="";for(let e=0;e<n.style.length;e++){const i=n.style.item(e);t+=QY(0,i,n.style.getPropertyValue(i))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=QY(0,Cqe(e),n.style[e]));n.setAttribute("style",t)}function Za(n,t,e){n.style&&(t.forEach((i,s)=>{const r=_R(s);e&&!e.has(s)&&e.set(s,n.style[r]),n.style[r]=i}),aR()&&JY(n))}function zd(n,t){n.style&&(t.forEach((e,i)=>{const s=_R(i);n.style[s]=""}),aR()&&JY(n))}function W_(n){return Array.isArray(n)?1==n.length?n[0]:FY(n):n}const bR=new RegExp("{{\\s*(.+?)\\s*}}","g");function eZ(n){let t=[];if("string"==typeof n){let e;for(;e=bR.exec(n);)t.push(e[1]);bR.lastIndex=0}return t}function H_(n,t,e){const i=n.toString(),s=i.replace(bR,(r,o)=>{let a=t[o];return null==a&&(e.push(function O9e(n){return new re(3003,!1)}()),a=""),a.toString()});return s==i?n:s}function L1(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const xqe=/-+([a-z0-9])/g;function _R(n){return n.replace(xqe,(...t)=>t[1].toUpperCase())}function Cqe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Kr(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function F9e(n){return new re(3004,!1)}()}}function tZ(n,t){return window.getComputedStyle(n)[t]}const V1="*";function Tqe(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Dqe(n,t,e){if(":"==n[0]){const l=function Nqe(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function Y9e(n){return new re(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof l)return void t.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function X9e(n){return new re(3015,!1)}()),t;const s=i[1],r=i[2],o=i[3];t.push(nZ(s,o));"<"==r[0]&&!(s==V1&&o==V1)&&t.push(nZ(o,s))}(i,e,t)):e.push(n),e}const z1=new Set(["true","1"]),U1=new Set(["false","0"]);function nZ(n,t){const e=z1.has(n)||U1.has(n),i=z1.has(t)||U1.has(t);return(s,r)=>{let o=n==V1||n==s,a=t==V1||t==r;return!o&&e&&"boolean"==typeof s&&(o=s?z1.has(n):U1.has(n)),!a&&i&&"boolean"==typeof r&&(a=r?z1.has(t):U1.has(t)),o&&a}}const Aqe=new RegExp("s*:selfs*,?","g");function yR(n,t,e,i){return new Mqe(n).build(t,e,i)}class Mqe{constructor(t){this._driver=t}build(t,e,i){const s=new Oqe(e);return this._resetContextStyleTimingState(s),Kr(this,W_(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,s=e.depCount=0;const r=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function $9e(){return new re(3006,!1)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,r.push(this.visitState(l,e))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,e);i+=l.queryCount,s+=l.depCount,o.push(l)}else e.errors.push(function B9e(){return new re(3007,!1)}())}),{type:7,name:t.name,states:r,transitions:o,queryCount:i,depCount:s,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(i.containsDynamicStyles){const r=new Set,o=s||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{eZ(l).forEach(c=>{o.hasOwnProperty(c)||r.add(c)})})}),r.size&&(L1(r.values()),e.errors.push(function V9e(n,t){return new re(3008,!1)}()))}return{type:0,name:t.name,style:i,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=Kr(this,W_(t.animation),e);return{type:1,matchers:Tqe(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Ud(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>Kr(this,i,e)),options:Ud(t.options)}}visitGroup(t,e){const i=e.currentTime;let s=0;const r=t.steps.map(o=>{e.currentTime=i;const a=Kr(this,o,e);return s=Math.max(s,e.currentTime),a});return e.currentTime=s,{type:3,steps:r,options:Ud(t.options)}}visitAnimate(t,e){const i=function Lqe(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return vR(F1(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(r=>"{"==r.charAt(0)&&"{"==r.charAt(1))){const r=vR(0,0,"");return r.dynamic=!0,r.strValue=e,r}const s=F1(e,t);return vR(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let s,r=t.styles?t.styles:M1({});if(5==r.type)s=this.visitKeyframes(r,e);else{let o=t.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=M1(c)}e.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,e);l.isEmptyStep=a,s=l}return e.currentAnimateTimings=null,{type:4,timings:i,style:s,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let a of s)"string"==typeof a?a===jl?i.push(a):e.errors.push(new re(3002,!1)):i.push(YY(a));let r=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!r))for(let l of a.values())if(l.toString().indexOf("{{")>=0){r=!0;break}}),{type:6,styles:i,easing:o,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let s=e.currentTime,r=e.currentTime;i&&r>0&&(r-=i.duration+i.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=e.collectedStyles.get(e.currentQuerySelector),u=c.get(l);let d=!0;u&&(r!=s&&r>=u.startTime&&s<=u.endTime&&(e.errors.push(function U9e(n,t,e,i,s){return new re(3010,!1)}()),d=!1),r=u.startTime),d&&c.set(l,{startTime:r,endTime:s}),e.options&&function vqe(n,t,e){const i=t.params||{},s=eZ(n);s.length&&s.forEach(r=>{i.hasOwnProperty(r)||e.push(function R9e(n){return new re(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function W9e(){return new re(3011,!1)}()),i;let r=0;const o=[];let a=!1,l=!1,c=0;const u=t.steps.map(b=>{const _=this._makeStyleAst(b,e);let y=null!=_.offset?_.offset:function Fqe(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(_.styles),v=0;return null!=y&&(r++,v=_.offset=y),l=l||v<0||v>1,a=a||v<c,c=v,o.push(v),_});l&&e.errors.push(function H9e(){return new re(3012,!1)}()),a&&e.errors.push(function j9e(){return new re(3200,!1)}());const d=t.steps.length;let h=0;r>0&&r<d?e.errors.push(function G9e(){return new re(3202,!1)}()):0==r&&(h=1/(d-1));const f=d-1,p=e.currentTime,g=e.currentAnimateTimings,m=g.duration;return u.forEach((b,_)=>{const y=h>0?_==f?1:h*_:o[_],v=y*m;e.currentTime=p+g.delay+v,g.duration=v,this._validateStyleAst(b,e),b.offset=y,i.styles.push(b)}),i}visitReference(t,e){return{type:8,animation:Kr(this,W_(t.animation),e),options:Ud(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Ud(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Ud(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[r,o]=function Pqe(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(Aqe,"")),n=n.replace(/@\*/g,O1).replace(/@\w+/g,e=>O1+"-"+e.slice(1)).replace(/:animating/g,mR),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+r:r,qr(e.collectedStyles,e.currentQuerySelector,new Map);const a=Kr(this,W_(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:r,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:a,originalSelector:t.selector,options:Ud(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function q9e(){return new re(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:F1(t.timings,e.errors,!0);return{type:12,animation:Kr(this,W_(t.animation),e),timings:i,options:null}}}class Oqe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ud(n){return n?(n=U_(n)).params&&(n.params=function Rqe(n){return n?U_(n):null}(n.params)):n={},n}function vR(n,t,e){return{duration:n,delay:t,easing:e}}function xR(n,t,e,i,s,r,o=null,a=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:s,delay:r,totalTime:s+r,easing:o,subTimeline:a}}class W1{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Vqe=new RegExp(":enter","g"),Uqe=new RegExp(":leave","g");function CR(n,t,e,i,s,r=new Map,o=new Map,a,l,c=[]){return(new Wqe).buildKeyframes(n,t,e,i,s,r,o,a,l,c)}class Wqe{buildKeyframes(t,e,i,s,r,o,a,l,c,u=[]){c=c||new W1;const d=new wR(t,e,c,s,r,u,[]);d.options=l;const h=l.delay?Gl(l.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([o],null,d.errors,l),Kr(this,i,d);const f=d.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let g=f.length-1;g>=0;g--){const m=f[g];if(m.element===e){p=m;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,d.errors,l)}return f.length?f.map(p=>p.buildKeyframes()):[xR(e,[],[],[],0,h,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const s=e.createSubContext(t.options),r=e.currentTimeline.currentTime,o=this._visitSubInstructions(i,s,s.options);r!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,i),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,i){for(const s of t){const r=s?.delay;if(r){const o="number"==typeof r?r:Gl(H_(r,s?.params??{},e.errors));i.delayNextStep(o)}}}_visitSubInstructions(t,e,i){let r=e.currentTimeline.currentTime;const o=null!=i.duration?Gl(i.duration):null,a=null!=i.delay?Gl(i.delay):null;return 0!==o&&t.forEach(l=>{const c=e.appendInstructionToTimeline(l,o,a);r=Math.max(r,c.duration+c.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),Kr(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let s=e;const r=t.options;if(r&&(r.params||r.delay)&&(s=e.createSubContext(r),s.transformIntoNewTimeline(),null!=r.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=H1);const o=Gl(r.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>Kr(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>i&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let s=e.currentTimeline.currentTime;const r=t.options&&t.options.delay?Gl(t.options.delay):0;t.steps.forEach(o=>{const a=e.createSubContext(t.options);r&&a.delayNextStep(r),Kr(this,o,a),s=Math.max(s,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return F1(e.params?H_(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),s.snapshotCurrentStyles());const r=t.style;5==r.type?this.visitKeyframes(r,e):(e.incrementTime(i.duration),this.visitStyle(r,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,s=e.currentAnimateTimings;!s&&i.hasCurrentStyleProperties()&&i.forwardFrame();const r=s&&s.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(r):i.setStyles(t.styles,r,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,s=e.currentTimeline.duration,r=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(l=>{a.forwardTime((l.offset||0)*r),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(s+r),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,s=t.options||{},r=s.delay?Gl(s.delay):0;r&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=H1);let o=i;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;const d=e.createSubContext(t.options,c);r&&d.delayNextStep(r),c===e.element&&(l=d.currentTimeline),Kr(this,t.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,s=e.currentTimeline,r=t.timings,o=Math.abs(r.duration),a=o*(e.currentQueryTotal-1);let l=o*e.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=e.currentTimeline;l&&u.delayNextStep(l);const d=u.currentTime;Kr(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=s.currentTime-d+(s.startTime-i.currentTimeline.startTime)}}const H1={};class wR{constructor(t,e,i,s,r,o,a,l){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=s,this._leaveClassName=r,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=H1,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new j1(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let s=this.options;null!=i.duration&&(s.duration=Gl(i.duration)),null!=i.delay&&(s.delay=Gl(i.delay));const r=i.params;if(r){let o=s.params;o||(o=this.options.params={}),Object.keys(r).forEach(a=>{(!e||!o.hasOwnProperty(a))&&(o[a]=H_(r[a],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(s=>{i[s]=e[s]})}}return t}createSubContext(t=null,e,i){const s=e||this.element,r=new wR(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,i||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(t),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(t){return this.previousNode=H1,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},r=new Hqe(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(r),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,s,r,o){let a=[];if(s&&a.push(this.element),t.length>0){t=(t=t.replace(Vqe,"."+this._enterClassName)).replace(Uqe,"."+this._leaveClassName);let c=this._driver.query(this.element,t,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!r&&0==a.length&&o.push(function K9e(n){return new re(3014,!1)}()),a}}class j1{constructor(t,e,i,s){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=s,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new j1(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||jl),this._currentKeyframe.set(e,jl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,s){e&&this._previousKeyframe.set("easing",e);const r=s&&s.params||{},o=function jqe(n,t){const e=new Map;let i;return n.forEach(s=>{if("*"===s){i=i||t.keys();for(let r of i)e.set(r,jl)}else ou(s,e)}),e}(t,this._globalTimelineStyles);for(let[a,l]of o){const c=H_(l,r,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??jl),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,i)=>{const s=this._styleSummary.get(i);(!s||e.time>s.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((a,l)=>{const c=ou(a,new Map,this._backFill);c.forEach((u,d)=>{u===oR?t.add(d):u===jl&&e.add(d)}),i||c.set("offset",l/this.duration),s.push(c)});const r=t.size?L1(t.values()):[],o=e.size?L1(e.values()):[];if(i){const a=s[0],l=new Map(a);a.set("offset",0),l.set("offset",1),s=[a,l]}return xR(this.element,s,r,o,this.duration,this.startTime,this.easing,!1)}}class Hqe extends j1{constructor(t,e,i,s,r,o,a=!1){super(t,e,o.delay),this.keyframes=i,this.preStyleProps=s,this.postStyleProps=r,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const r=[],o=i+e,a=e/o,l=ou(t[0]);l.set("offset",0),r.push(l);const c=ou(t[0]);c.set("offset",rZ(a)),r.push(c);const u=t.length-1;for(let d=1;d<=u;d++){let h=ou(t[d]);const f=h.get("offset");h.set("offset",rZ((e+f*i)/o)),r.push(h)}i=o,e=0,s="",t=r}return xR(this.element,t,this.preStyleProps,this.postStyleProps,i,e,s,!0)}}function rZ(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class SR{}const Gqe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class qqe extends SR{normalizePropertyName(t,e){return _R(t)}normalizeStyleValue(t,e,i,s){let r="";const o=i.toString().trim();if(Gqe.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)r="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&s.push(function L9e(n,t){return new re(3005,!1)}())}return o+r}}function oZ(n,t,e,i,s,r,o,a,l,c,u,d,h){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:r,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:d,errors:h}}const IR={};class aZ{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,s){return function Kqe(n,t,e,i,s){return n.some(r=>r(t,e,i,s))}(this.ast.matchers,t,e,i,s)}buildStyles(t,e,i){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,i):new Map}build(t,e,i,s,r,o,a,l,c,u){const d=[],h=this.ast.options&&this.ast.options.params||IR,p=this.buildStyles(i,a&&a.params||IR,d),g=l&&l.params||IR,m=this.buildStyles(s,g,d),b=new Set,_=new Map,y=new Map,v="void"===s,x={params:Xqe(g,h),delay:this.ast.options?.delay},S=u?[]:CR(t,e,this.ast.animation,r,o,p,m,x,c,d);let E=0;if(S.forEach(D=>{E=Math.max(D.duration+D.delay,E)}),d.length)return oZ(e,this._triggerName,i,s,v,p,m,[],[],_,y,E,d);S.forEach(D=>{const M=D.element,R=qr(_,M,new Set);D.preStyleProps.forEach(X=>R.add(X));const U=qr(y,M,new Set);D.postStyleProps.forEach(X=>U.add(X)),M!==e&&b.add(M)});const k=L1(b.values());return oZ(e,this._triggerName,i,s,v,p,m,S,k,_,y,E)}}function Xqe(n,t){const e=U_(t);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(e[i]=n[i]);return e}class Yqe{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i=new Map,s=U_(this.defaultParams);return Object.keys(t).forEach(r=>{const o=t[r];null!==o&&(s[r]=o)}),this.styles.styles.forEach(r=>{"string"!=typeof r&&r.forEach((o,a)=>{o&&(o=H_(o,s,e));const l=this.normalizer.normalizePropertyName(a,e);o=this.normalizer.normalizeStyleValue(a,l,o,e),i.set(a,o)})}),i}}class Qqe{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new Yqe(s.style,s.options&&s.options.params||{},i))}),lZ(this.states,"true","1"),lZ(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new aZ(t,s,this.states))}),this.fallbackTransition=function Jqe(n,t,e){return new aZ(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,s){return this.transitionFactories.find(o=>o.match(t,e,i,s))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function lZ(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const eKe=new W1;class tKe{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const i=[],s=[],r=yR(this._driver,e,i,s);if(i.length)throw function tqe(n){return new re(3503,!1)}();this._animations.set(t,r)}_buildPlayer(t,e,i){const s=t.element,r=VY(0,this._normalizer,0,t.keyframes,e,i);return this._driver.animate(s,r,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const s=[],r=this._animations.get(t);let o;const a=new Map;if(r?(o=CR(this._driver,e,r,pR,P1,new Map,new Map,i,eKe,s),o.forEach(u=>{const d=qr(a,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(s.push(function nqe(){return new re(3300,!1)}()),o=[]),s.length)throw function iqe(n){return new re(3504,!1)}();a.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,jl))})});const c=ru(o.map(u=>{const d=a.get(u.element);return this._buildPlayer(u,new Map,d)}));return this._playersById.set(t,c),c.onDestroy(()=>this.destroy(t)),this.players.push(c),c}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function sqe(n){return new re(3301,!1)}();return e}listen(t,e,i,s){const r=uR(e,"","","");return lR(this._getPlayer(t),i,r,s),()=>{}}command(t,e,i,s){if("register"==i)return void this.register(t,s[0]);if("create"==i)return void this.create(t,e,s[0]||{});const r=this._getPlayer(t);switch(i){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const cZ="ng-animate-queued",ER="ng-animate-disabled",oKe=[],uZ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},aKe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ko="__ng_removed";class kR{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function dKe(n){return n??null}(i?t.value:t),i){const r=U_(t);delete r.value,this.options=r}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(s=>{null==i[s]&&(i[s]=e[s])})}}}const j_="void",TR=new kR(j_);class lKe{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,To(e,this._hostClassName)}listen(t,e,i,s){if(!this._triggers.has(e))throw function rqe(n,t){return new re(3302,!1)}();if(null==i||0==i.length)throw function oqe(n){return new re(3303,!1)}();if(!function hKe(n){return"start"==n||"done"==n}(i))throw function aqe(n,t){return new re(3400,!1)}();const r=qr(this._elementListeners,t,[]),o={name:e,phase:i,callback:s};r.push(o);const a=qr(this._engine.statesByElement,t,new Map);return a.has(e)||(To(t,R1),To(t,R1+"-"+e),a.set(e,TR)),()=>{this._engine.afterFlush(()=>{const l=r.indexOf(o);l>=0&&r.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function lqe(n){return new re(3401,!1)}();return e}trigger(t,e,i,s=!0){const r=this._getTrigger(e),o=new DR(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(To(t,R1),To(t,R1+"-"+e),this._engine.statesByElement.set(t,a=new Map));let l=a.get(e);const c=new kR(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(e,c),l||(l=TR),c.value!==j_&&l.value===c.value){if(!function mKe(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let s=0;s<e.length;s++){const r=e[s];if(!t.hasOwnProperty(r)||n[r]!==t[r])return!1}return!0}(l.params,c.params)){const g=[],m=r.matchStyles(l.value,l.params,g),b=r.matchStyles(c.value,c.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(()=>{zd(t,m),Za(t,b)})}return}const h=qr(this._engine.playersByElement,t,[]);h.forEach(g=>{g.namespaceId==this.id&&g.triggerName==e&&g.queued&&g.destroy()});let f=r.matchTransition(l.value,c.value,t,c.params),p=!1;if(!f){if(!s)return;f=r.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(To(t,cZ),o.onStart(()=>{_p(t,cZ)})),o.onDone(()=>{let g=this.players.indexOf(o);g>=0&&this.players.splice(g,1);const m=this._engine.playersByElement.get(t);if(m){let b=m.indexOf(o);b>=0&&m.splice(b,1)}}),this.players.push(o),h.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,O1,!0);i.forEach(s=>{if(s[ko])return;const r=this._engine.fetchNamespacesByElement(s);r.size?r.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,i,s){const r=this._engine.statesByElement.get(t),o=new Map;if(r){const a=[];if(r.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const u=this.trigger(t,c,j_,s);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),i&&ru(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const s=new Set;e.forEach(r=>{const o=r.name;if(s.has(o))return;s.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||TR,u=new kR(j_),d=new DR(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:l,fromState:c,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(i.totalAnimations){const r=i.players.length?i.playersByQueriedElement.get(t):[];if(r&&r.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(i.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)i.markElementAsRemoved(this.id,t,!1,e);else{const r=t[ko];(!r||r===uZ)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){To(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const s=i.player;if(s.destroyed)return;const r=i.element,o=this._elementListeners.get(r);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=uR(r,i.triggerName,i.fromState.value,i.toState.value);l._data=t,lR(i.player,a.phase,l,a.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(i)}),this._queue=[],e.sort((i,s)=>{const r=i.transition.ast.depCount,o=s.transition.ast.depCount;return 0==r||0==o?r-o:this._engine.driver.containsElement(i.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class cKe{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,r)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new lKe(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,s=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(e);for(;a;){const l=s.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,t),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(t)}else i.push(t);return s.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let s=this._namespaceLookup[t];s&&s.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(i);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i)for(let s of i.values())if(s.namespaceId){const r=this._fetchNamespace(s.namespaceId);r&&e.add(r)}return e}trigger(t,e,i,s){if(G1(e)){const r=this._fetchNamespace(t);if(r)return r.trigger(e,i,s),!0}return!1}insertNode(t,e,i,s){if(!G1(e))return;const r=e[ko];if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,i)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),To(t,ER)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),_p(t,ER))}removeNode(t,e,i,s){if(G1(e)){const r=t?this._fetchNamespace(t):null;if(r?r.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),i){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,i,s,r){this.collectedLeaveElements.push(e),e[ko]={namespaceId:t,setForRemoval:s,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:r}}listen(t,e,i,s,r){return G1(e)?this._fetchNamespace(t).listen(e,i,s,r):()=>{}}_buildInstruction(t,e,i,s,r){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,s,t.fromState.options,t.toState.options,e,r)}destroyInnerAnimations(t){let e=this.driver.query(t,O1,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,mR,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return ru(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[ko];if(e&&e.setForRemoval){if(t[ko]=uZ,e.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(ER)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,s)=>this._balanceNamespaceList(i,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)To(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let s=0;s<i.length;s++)i[s]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?ru(e).onDone(()=>{i.forEach(s=>s())}):i.forEach(s=>s())}}reportError(t){throw function cqe(n){return new re(3402,!1)}()}_flushAnimations(t,e){const i=new W1,s=[],r=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(O=>{u.add(O);const z=this.driver.query(O,".ng-animate-queued",!0);for(let B=0;B<z.length;B++)u.add(z[B])});const d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=fZ(h,this.collectedEnterElements),p=new Map;let g=0;f.forEach((O,z)=>{const B=pR+g++;p.set(z,B),O.forEach(q=>To(q,B))});const m=[],b=new Set,_=new Set;for(let O=0;O<this.collectedLeaveElements.length;O++){const z=this.collectedLeaveElements[O],B=z[ko];B&&B.setForRemoval&&(m.push(z),b.add(z),B.hasAnimation?this.driver.query(z,".ng-star-inserted",!0).forEach(q=>b.add(q)):_.add(z))}const y=new Map,v=fZ(h,Array.from(b));v.forEach((O,z)=>{const B=P1+g++;y.set(z,B),O.forEach(q=>To(q,B))}),t.push(()=>{f.forEach((O,z)=>{const B=p.get(z);O.forEach(q=>_p(q,B))}),v.forEach((O,z)=>{const B=y.get(z);O.forEach(q=>_p(q,B))}),m.forEach(O=>{this.processLeaveNode(O)})});const x=[],S=[];for(let O=this._namespaceList.length-1;O>=0;O--)this._namespaceList[O].drainQueuedTransitions(e).forEach(B=>{const q=B.player,se=B.element;if(x.push(q),this.collectedEnterElements.length){const Me=se[ko];if(Me&&Me.setForMove){if(Me.previousTriggersValues&&Me.previousTriggersValues.has(B.triggerName)){const Xe=Me.previousTriggersValues.get(B.triggerName),Ve=this.statesByElement.get(B.element);if(Ve&&Ve.has(B.triggerName)){const ut=Ve.get(B.triggerName);ut.value=Xe,Ve.set(B.triggerName,ut)}}return void q.destroy()}}const le=!d||!this.driver.containsElement(d,se),he=y.get(se),ue=p.get(se),de=this._buildInstruction(B,i,ue,he,le);if(de.errors&&de.errors.length)return void S.push(de);if(le)return q.onStart(()=>zd(se,de.fromStyles)),q.onDestroy(()=>Za(se,de.toStyles)),void s.push(q);if(B.isFallbackTransition)return q.onStart(()=>zd(se,de.fromStyles)),q.onDestroy(()=>Za(se,de.toStyles)),void s.push(q);const ve=[];de.timelines.forEach(Me=>{Me.stretchStartingKeyframe=!0,this.disabledNodes.has(Me.element)||ve.push(Me)}),de.timelines=ve,i.append(se,de.timelines),o.push({instruction:de,player:q,element:se}),de.queriedElements.forEach(Me=>qr(a,Me,[]).push(q)),de.preStyleProps.forEach((Me,Xe)=>{if(Me.size){let Ve=l.get(Xe);Ve||l.set(Xe,Ve=new Set),Me.forEach((ut,pt)=>Ve.add(pt))}}),de.postStyleProps.forEach((Me,Xe)=>{let Ve=c.get(Xe);Ve||c.set(Xe,Ve=new Set),Me.forEach((ut,pt)=>Ve.add(pt))})});if(S.length){const O=[];S.forEach(z=>{O.push(function uqe(n,t){return new re(3505,!1)}())}),x.forEach(z=>z.destroy()),this.reportError(O)}const E=new Map,k=new Map;o.forEach(O=>{const z=O.element;i.has(z)&&(k.set(z,z),this._beforeAnimationBuild(O.player.namespaceId,O.instruction,E))}),s.forEach(O=>{const z=O.element;this._getPreviousPlayers(z,!1,O.namespaceId,O.triggerName,null).forEach(q=>{qr(E,z,[]).push(q),q.destroy()})});const D=m.filter(O=>mZ(O,l,c)),M=new Map;hZ(M,this.driver,_,c,jl).forEach(O=>{mZ(O,l,c)&&D.push(O)});const U=new Map;f.forEach((O,z)=>{hZ(U,this.driver,new Set(O),l,oR)}),D.forEach(O=>{const z=M.get(O),B=U.get(O);M.set(O,new Map([...Array.from(z?.entries()??[]),...Array.from(B?.entries()??[])]))});const X=[],ee=[],K={};o.forEach(O=>{const{element:z,player:B,instruction:q}=O;if(i.has(z)){if(u.has(z))return B.onDestroy(()=>Za(z,q.toStyles)),B.disabled=!0,B.overrideTotalTime(q.totalTime),void s.push(B);let se=K;if(k.size>1){let he=z;const ue=[];for(;he=he.parentNode;){const de=k.get(he);if(de){se=de;break}ue.push(he)}ue.forEach(de=>k.set(de,se))}const le=this._buildAnimation(B.namespaceId,q,E,r,U,M);if(B.setRealPlayer(le),se===K)X.push(B);else{const he=this.playersByElement.get(se);he&&he.length&&(B.parentPlayer=ru(he)),s.push(B)}}else zd(z,q.fromStyles),B.onDestroy(()=>Za(z,q.toStyles)),ee.push(B),u.has(z)&&s.push(B)}),ee.forEach(O=>{const z=r.get(O.element);if(z&&z.length){const B=ru(z);O.setRealPlayer(B)}}),s.forEach(O=>{O.parentPlayer?O.syncPlayerEvents(O.parentPlayer):O.destroy()});for(let O=0;O<m.length;O++){const z=m[O],B=z[ko];if(_p(z,P1),B&&B.hasAnimation)continue;let q=[];if(a.size){let le=a.get(z);le&&le.length&&q.push(...le);let he=this.driver.query(z,mR,!0);for(let ue=0;ue<he.length;ue++){let de=a.get(he[ue]);de&&de.length&&q.push(...de)}}const se=q.filter(le=>!le.destroyed);se.length?fKe(this,z,se):this.processLeaveNode(z)}return m.length=0,X.forEach(O=>{this.players.push(O),O.onDone(()=>{O.destroy();const z=this.players.indexOf(O);this.players.splice(z,1)}),O.play()}),X}elementContainsData(t,e){let i=!1;const s=e[ko];return s&&s.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,s,r){let o=[];if(e){const a=this.playersByQueriedElement.get(t);a&&(o=a)}else{const a=this.playersByElement.get(t);if(a){const l=!r||r==j_;a.forEach(c=>{c.queued||!l&&c.triggerName!=s||o.push(c)})}}return(i||s)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||s&&s!=a.triggerName))),o}_beforeAnimationBuild(t,e,i){const r=e.element,o=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const l of e.timelines){const c=l.element,u=c!==r,d=qr(i,c,[]);this._getPreviousPlayers(c,u,o,a,e.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}zd(r,e.fromStyles)}_buildAnimation(t,e,i,s,r,o){const a=e.triggerName,l=e.element,c=[],u=new Set,d=new Set,h=e.timelines.map(p=>{const g=p.element;u.add(g);const m=g[ko];if(m&&m.removedBeforeQueried)return new z_(p.duration,p.delay);const b=g!==l,_=function pKe(n){const t=[];return pZ(n,t),t}((i.get(g)||oKe).map(E=>E.getRealPlayer())).filter(E=>!!E.element&&E.element===g),y=r.get(g),v=o.get(g),x=VY(0,this._normalizer,0,p.keyframes,y,v),S=this._buildPlayer(p,x,_);if(p.subTimeline&&s&&d.add(g),b){const E=new DR(t,a,g);E.setRealPlayer(S),c.push(E)}return S});c.forEach(p=>{qr(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function uKe(n,t,e){let i=n.get(t);if(i){if(i.length){const s=i.indexOf(e);i.splice(s,1)}0==i.length&&n.delete(t)}return i}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>To(p,XY));const f=ru(h);return f.onDestroy(()=>{u.forEach(p=>_p(p,XY)),Za(l,e.toStyles)}),d.forEach(p=>{qr(s,p,[]).push(f)}),f}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new z_(t.duration,t.delay)}}class DR{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new z_,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,i)=>{e.forEach(s=>lR(t,i,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){qr(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function G1(n){return n&&1===n.nodeType}function dZ(n,t){const e=n.style.display;return n.style.display=t??"none",e}function hZ(n,t,e,i,s){const r=[];e.forEach(l=>r.push(dZ(l)));const o=[];i.forEach((l,c)=>{const u=new Map;l.forEach(d=>{const h=t.computeStyle(c,d,s);u.set(d,h),(!h||0==h.length)&&(c[ko]=aKe,o.push(c))}),n.set(c,u)});let a=0;return e.forEach(l=>dZ(l,r[a++])),o}function fZ(n,t){const e=new Map;if(n.forEach(a=>e.set(a,[])),0==t.length)return e;const i=1,s=new Set(t),r=new Map;function o(a){if(!a)return i;let l=r.get(a);if(l)return l;const c=a.parentNode;return l=e.has(c)?c:s.has(c)?i:o(c),r.set(a,l),l}return t.forEach(a=>{const l=o(a);l!==i&&e.get(l).push(a)}),e}function To(n,t){n.classList?.add(t)}function _p(n,t){n.classList?.remove(t)}function fKe(n,t,e){ru(e).onDone(()=>n.processLeaveNode(t))}function pZ(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof $Y?pZ(i.players,t):t.push(i)}}function mZ(n,t,e){const i=e.get(n);if(!i)return!1;let s=t.get(n);return s?i.forEach(r=>s.add(r)):t.set(n,i),e.delete(n),!0}class q1{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(s,r)=>{},this._transitionEngine=new cKe(t,e,i),this._timelineEngine=new tKe(t,e,i),this._transitionEngine.onRemovalComplete=(s,r)=>this.onRemovalComplete(s,r)}registerTrigger(t,e,i,s,r){const o=t+"-"+s;let a=this._triggerCache[o];if(!a){const l=[],c=[],u=yR(this._driver,r,l,c);if(l.length)throw function J9e(n,t){return new re(3404,!1)}();a=function Zqe(n,t,e){return new Qqe(n,t,e)}(s,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(e,s,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,s){this._transitionEngine.insertNode(t,e,i,s)}onRemove(t,e,i,s){this._transitionEngine.removeNode(t,e,s||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,s){if("@"==i.charAt(0)){const[r,o]=zY(i);this._timelineEngine.command(r,e,o,s)}else this._transitionEngine.trigger(t,e,i,s)}listen(t,e,i,s,r){if("@"==i.charAt(0)){const[o,a]=zY(i);return this._timelineEngine.listen(o,e,a,r)}return this._transitionEngine.listen(t,e,i,s,r)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let bKe=(()=>{class n{constructor(e,i,s){this._element=e,this._startStyles=i,this._endStyles=s,this._state=0;let r=n.initialStylesByElement.get(e);r||n.initialStylesByElement.set(e,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Za(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Za(this._element,this._initialStyles),this._endStyles&&(Za(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(zd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(zd(this._element,this._endStyles),this._endStyles=null),Za(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function NR(n){let t=null;return n.forEach((e,i)=>{(function _Ke(n){return"display"===n||"position"===n})(i)&&(t=t||new Map,t.set(i,e))}),t}class gZ{constructor(t,e,i,s){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(t,e,i){return t.animate(this._convertKeyframesToObject(e),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,s)=>{"offset"!==s&&t.set(s,this._finished?i:tZ(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class yKe{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return jY(t,e)}getParentElement(t){return hR(t)}query(t,e,i){return GY(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,s,r,o=[]){const l={duration:i,delay:s,fill:0==s?"both":"forwards"};r&&(l.easing=r);const c=new Map,u=o.filter(f=>f instanceof gZ);(function wqe(n,t){return 0===n||0===t})(i,s)&&u.forEach(f=>{f.currentSnapshot.forEach((p,g)=>c.set(g,p))});let d=function yqe(n){return n.length?n[0]instanceof Map?n:n.map(t=>YY(t)):[]}(e).map(f=>ou(f));d=function Sqe(n,t,e){if(e.size&&t.length){let i=t[0],s=[];if(e.forEach((r,o)=>{i.has(o)||s.push(o),i.set(o,r)}),s.length)for(let r=1;r<t.length;r++){let o=t[r];s.forEach(a=>o.set(a,tZ(n,a)))}}return t}(t,d,c);const h=function gKe(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=NR(t[0]),t.length>1&&(i=NR(t[t.length-1]))):t instanceof Map&&(e=NR(t)),e||i?new bKe(n,e,i):null}(t,d);return new gZ(t,d,l,h)}}let vKe=(()=>{class n extends OY{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Do.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?FY(e):e;return bZ(this._renderer,null,i,"register",[s]),new xKe(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(me(Wp),me(Jt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();class xKe extends k9e{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new CKe(this._id,t,e||{},this._renderer)}}class CKe{constructor(t,e,i,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return bZ(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function bZ(n,t,e,i,s){return n.setProperty(t,`@@${e}:${i}`,s)}const _Z="@.disabled";let wKe=(()=>{class n{constructor(e,i,s){this.delegate=e,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(r,o)=>{const a=o?.parentNode(r);a&&o.removeChild(a,r)}}createRenderer(e,i){const r=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(r);return u||(u=new yZ("",r,this.engine,()=>this._rendererCache.delete(r)),this._rendererCache.set(r,u)),u}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,e,u.name,u)};return i.data.animation.forEach(l),new SKe(this,a,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,s){e>=0&&e<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(r=>{const[o,a]=r;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(me(Wp),me(q1),me(Zt))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})();class yZ{constructor(t,e,i,s){this.namespaceId=t,this.delegate=e,this.engine=i,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,s=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,s){this.delegate.setAttribute(t,e,i,s)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,s){this.delegate.setStyle(t,e,i,s)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==_Z?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class SKe extends yZ{constructor(t,e,i,s,r){super(e,i,s,r),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==_Z?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.slice(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const s=function IKe(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let r=e.slice(1),o="";return"@"!=r.charAt(0)&&([r,o]=function EKe(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(r)),this.engine.listen(this.namespaceId,s,r,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(t,e,i)}}const vZ=[{provide:OY,useClass:vKe},{provide:SR,useFactory:function TKe(){return new qqe}},{provide:q1,useClass:(()=>{class n extends q1{constructor(e,i,s,r){super(e.body,i,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(me(Jt),me(fR),me(SR),me(am))},n.\u0275prov=Pe({token:n,factory:n.\u0275fac}),n})()},{provide:Wp,useFactory:function DKe(n,t,e){return new wKe(n,t,e)},deps:[S0,q1,Zt]}],AR=[{provide:fR,useFactory:()=>new yKe},{provide:s0,useValue:"BrowserAnimations"},...vZ],xZ=[{provide:fR,useClass:qY},{provide:s0,useValue:"NoopAnimations"},...vZ];let NKe=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?xZ:AR}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({providers:AR,imports:[EV]}),n})(),AKe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({}),n})(),MKe=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),PKe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({providers:[MKe]}),n})(),CZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[Sa,jE,PKe,Sa]}),n})(),VKe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n}),n.\u0275inj=Bn({imports:[Sa,CZ,CZ,AKe,Sa]}),n})(),zKe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Qn({type:n,bootstrap:[E9e]}),n.\u0275inj=Bn({imports:[EV,s4,m9e,Lhe,VKe,z_e,U_e,eye,NKe,jE,s4,uHe]}),n})();Ele().bootstrapModule(zKe).catch(n=>console.error(n))},658:zt=>{zt.exports=xe;var Ft=null;try{Ft=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function xe(ae,P,Ae){this.low=0|ae,this.high=0|P,this.unsigned=!!Ae}function tt(ae){return!0===(ae&&ae.__isLong__)}Object.defineProperty(xe.prototype,"__isLong__",{value:!0}),xe.isLong=tt;var Mi={},rt={};function Ln(ae,P){var Ae,Je,Lt;return P?(Lt=0<=(ae>>>=0)&&ae<256)&&(Je=rt[ae])?Je:(Ae=Qe(ae,(0|ae)<0?-1:0,!0),Lt&&(rt[ae]=Ae),Ae):(Lt=-128<=(ae|=0)&&ae<128)&&(Je=Mi[ae])?Je:(Ae=Qe(ae,ae<0?-1:0,!1),Lt&&(Mi[ae]=Ae),Ae)}function Fe(ae,P){if(isNaN(ae))return P?os:un;if(P){if(ae<0)return os;if(ae>=_e)return qt}else{if(ae<=-$e)return rn;if(ae+1>=$e)return Et}return ae<0?Fe(-ae,P).neg():Qe(ae%ce|0,ae/ce|0,P)}function Qe(ae,P,Ae){return new xe(ae,P,Ae)}xe.fromInt=Ln,xe.fromNumber=Fe,xe.fromBits=Qe;var Ct=Math.pow;function Oe(ae,P,Ae){if(0===ae.length)throw Error("empty string");if("NaN"===ae||"Infinity"===ae||"+Infinity"===ae||"-Infinity"===ae)return un;if("number"==typeof P?(Ae=P,P=!1):P=!!P,(Ae=Ae||10)<2||36<Ae)throw RangeError("radix");var Je;if((Je=ae.indexOf("-"))>0)throw Error("interior hyphen");if(0===Je)return Oe(ae.substring(1),P,Ae).neg();for(var Lt=Fe(Ct(Ae,8)),Rt=un,Qt=0;Qt<ae.length;Qt+=8){var Ei=Math.min(8,ae.length-Qt),di=parseInt(ae.substring(Qt,Qt+Ei),Ae);if(Ei<8){var $n=Fe(Ct(Ae,Ei));Rt=Rt.mul($n).add(Fe(di))}else Rt=(Rt=Rt.mul(Lt)).add(Fe(di))}return Rt.unsigned=P,Rt}function G(ae,P){return"number"==typeof ae?Fe(ae,P):"string"==typeof ae?Oe(ae,P):Qe(ae.low,ae.high,"boolean"==typeof P?P:ae.unsigned)}xe.fromString=Oe,xe.fromValue=G;var ce=4294967296,_e=ce*ce,$e=_e/2,je=Ln(1<<24),un=Ln(0);xe.ZERO=un;var os=Ln(0,!0);xe.UZERO=os;var Gi=Ln(1);xe.ONE=Gi;var aa=Ln(1,!0);xe.UONE=aa;var wr=Ln(-1);xe.NEG_ONE=wr;var Et=Qe(-1,2147483647,!1);xe.MAX_VALUE=Et;var qt=Qe(-1,-1,!0);xe.MAX_UNSIGNED_VALUE=qt;var rn=Qe(0,-2147483648,!1);xe.MIN_VALUE=rn;var be=xe.prototype;be.toInt=function(){return this.unsigned?this.low>>>0:this.low},be.toNumber=function(){return this.unsigned?(this.high>>>0)*ce+(this.low>>>0):this.high*ce+(this.low>>>0)},be.toString=function(P){if((P=P||10)<2||36<P)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(rn)){var Ae=Fe(P),Je=this.div(Ae),Lt=Je.mul(Ae).sub(this);return Je.toString(P)+Lt.toInt().toString(P)}return"-"+this.neg().toString(P)}for(var Rt=Fe(Ct(P,6),this.unsigned),Qt=this,Ei="";;){var di=Qt.div(Rt),hi=(Qt.sub(di.mul(Rt)).toInt()>>>0).toString(P);if((Qt=di).isZero())return hi+Ei;for(;hi.length<6;)hi="0"+hi;Ei=""+hi+Ei}},be.getHighBits=function(){return this.high},be.getHighBitsUnsigned=function(){return this.high>>>0},be.getLowBits=function(){return this.low},be.getLowBitsUnsigned=function(){return this.low>>>0},be.getNumBitsAbs=function(){if(this.isNegative())return this.eq(rn)?64:this.neg().getNumBitsAbs();for(var P=0!=this.high?this.high:this.low,Ae=31;Ae>0&&!(P&1<<Ae);Ae--);return 0!=this.high?Ae+33:Ae+1},be.isZero=function(){return 0===this.high&&0===this.low},be.eqz=be.isZero,be.isNegative=function(){return!this.unsigned&&this.high<0},be.isPositive=function(){return this.unsigned||this.high>=0},be.isOdd=function(){return 1==(1&this.low)},be.isEven=function(){return 0==(1&this.low)},be.equals=function(P){return tt(P)||(P=G(P)),(this.unsigned===P.unsigned||this.high>>>31!=1||P.high>>>31!=1)&&this.high===P.high&&this.low===P.low},be.eq=be.equals,be.notEquals=function(P){return!this.eq(P)},be.neq=be.notEquals,be.ne=be.notEquals,be.lessThan=function(P){return this.comp(P)<0},be.lt=be.lessThan,be.lessThanOrEqual=function(P){return this.comp(P)<=0},be.lte=be.lessThanOrEqual,be.le=be.lessThanOrEqual,be.greaterThan=function(P){return this.comp(P)>0},be.gt=be.greaterThan,be.greaterThanOrEqual=function(P){return this.comp(P)>=0},be.gte=be.greaterThanOrEqual,be.ge=be.greaterThanOrEqual,be.compare=function(P){if(tt(P)||(P=G(P)),this.eq(P))return 0;var Ae=this.isNegative(),Je=P.isNegative();return Ae&&!Je?-1:!Ae&&Je?1:this.unsigned?P.high>>>0>this.high>>>0||P.high===this.high&&P.low>>>0>this.low>>>0?-1:1:this.sub(P).isNegative()?-1:1},be.comp=be.compare,be.negate=function(){return!this.unsigned&&this.eq(rn)?rn:this.not().add(Gi)},be.neg=be.negate,be.add=function(P){tt(P)||(P=G(P));var hi=0,Gs=0,dt=0,Es=0;return dt+=(Es+=(65535&this.low)+(65535&P.low))>>>16,Gs+=(dt+=(this.low>>>16)+(P.low>>>16))>>>16,hi+=(Gs+=(65535&this.high)+(65535&P.high))>>>16,hi+=(this.high>>>16)+(P.high>>>16),Qe((dt&=65535)<<16|(Es&=65535),(hi&=65535)<<16|(Gs&=65535),this.unsigned)},be.subtract=function(P){return tt(P)||(P=G(P)),this.add(P.neg())},be.sub=be.subtract,be.multiply=function(P){if(this.isZero())return un;if(tt(P)||(P=G(P)),Ft)return Qe(Ft.mul(this.low,this.high,P.low,P.high),Ft.get_high(),this.unsigned);if(P.isZero())return un;if(this.eq(rn))return P.isOdd()?rn:un;if(P.eq(rn))return this.isOdd()?rn:un;if(this.isNegative())return P.isNegative()?this.neg().mul(P.neg()):this.neg().mul(P).neg();if(P.isNegative())return this.mul(P.neg()).neg();if(this.lt(je)&&P.lt(je))return Fe(this.toNumber()*P.toNumber(),this.unsigned);var Lt=65535&this.high,Rt=this.low>>>16,Qt=65535&this.low,di=65535&P.high,$n=P.low>>>16,hi=65535&P.low,Gs=0,dt=0,Es=0,Hd=0;return Es+=(Hd+=Qt*hi)>>>16,dt+=(Es+=Rt*hi)>>>16,Es&=65535,dt+=(Es+=Qt*$n)>>>16,Gs+=(dt+=Lt*hi)>>>16,dt&=65535,Gs+=(dt+=Rt*$n)>>>16,dt&=65535,Gs+=(dt+=Qt*di)>>>16,Gs+=(this.high>>>16)*hi+Lt*$n+Rt*di+Qt*(P.high>>>16),Qe((Es&=65535)<<16|(Hd&=65535),(Gs&=65535)<<16|(dt&=65535),this.unsigned)},be.mul=be.multiply,be.divide=function(P){if(tt(P)||(P=G(P)),P.isZero())throw Error("division by zero");var Je,Lt,Rt;if(Ft)return this.unsigned||-2147483648!==this.high||-1!==P.low||-1!==P.high?Qe((this.unsigned?Ft.div_u:Ft.div_s)(this.low,this.high,P.low,P.high),Ft.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?os:un;if(this.unsigned){if(P.unsigned||(P=P.toUnsigned()),P.gt(this))return os;if(P.gt(this.shru(1)))return aa;Rt=os}else{if(this.eq(rn))return P.eq(Gi)||P.eq(wr)?rn:P.eq(rn)?Gi:(Je=this.shr(1).div(P).shl(1)).eq(un)?P.isNegative()?Gi:wr:(Lt=this.sub(P.mul(Je)),Rt=Je.add(Lt.div(P)));if(P.eq(rn))return this.unsigned?os:un;if(this.isNegative())return P.isNegative()?this.neg().div(P.neg()):this.neg().div(P).neg();if(P.isNegative())return this.div(P.neg()).neg();Rt=un}for(Lt=this;Lt.gte(P);){Je=Math.max(1,Math.floor(Lt.toNumber()/P.toNumber()));for(var Ei=Math.ceil(Math.log(Je)/Math.LN2),di=Ei<=48?1:Ct(2,Ei-48),$n=Fe(Je),hi=$n.mul(P);hi.isNegative()||hi.gt(Lt);)hi=($n=Fe(Je-=di,this.unsigned)).mul(P);$n.isZero()&&($n=Gi),Rt=Rt.add($n),Lt=Lt.sub(hi)}return Rt},be.div=be.divide,be.modulo=function(P){return tt(P)||(P=G(P)),Ft?Qe((this.unsigned?Ft.rem_u:Ft.rem_s)(this.low,this.high,P.low,P.high),Ft.get_high(),this.unsigned):this.sub(this.div(P).mul(P))},be.mod=be.modulo,be.rem=be.modulo,be.not=function(){return Qe(~this.low,~this.high,this.unsigned)},be.and=function(P){return tt(P)||(P=G(P)),Qe(this.low&P.low,this.high&P.high,this.unsigned)},be.or=function(P){return tt(P)||(P=G(P)),Qe(this.low|P.low,this.high|P.high,this.unsigned)},be.xor=function(P){return tt(P)||(P=G(P)),Qe(this.low^P.low,this.high^P.high,this.unsigned)},be.shiftLeft=function(P){return tt(P)&&(P=P.toInt()),0==(P&=63)?this:P<32?Qe(this.low<<P,this.high<<P|this.low>>>32-P,this.unsigned):Qe(0,this.low<<P-32,this.unsigned)},be.shl=be.shiftLeft,be.shiftRight=function(P){return tt(P)&&(P=P.toInt()),0==(P&=63)?this:P<32?Qe(this.low>>>P|this.high<<32-P,this.high>>P,this.unsigned):Qe(this.high>>P-32,this.high>=0?0:-1,this.unsigned)},be.shr=be.shiftRight,be.shiftRightUnsigned=function(P){if(tt(P)&&(P=P.toInt()),0==(P&=63))return this;var Ae=this.high;return P<32?Qe(this.low>>>P|Ae<<32-P,Ae>>>P,this.unsigned):Qe(32===P?Ae:Ae>>>P-32,0,this.unsigned)},be.shru=be.shiftRightUnsigned,be.shr_u=be.shiftRightUnsigned,be.toSigned=function(){return this.unsigned?Qe(this.low,this.high,!1):this},be.toUnsigned=function(){return this.unsigned?this:Qe(this.low,this.high,!0)},be.toBytes=function(P){return P?this.toBytesLE():this.toBytesBE()},be.toBytesLE=function(){var P=this.high,Ae=this.low;return[255&Ae,Ae>>>8&255,Ae>>>16&255,Ae>>>24,255&P,P>>>8&255,P>>>16&255,P>>>24]},be.toBytesBE=function(){var P=this.high,Ae=this.low;return[P>>>24,P>>>16&255,P>>>8&255,255&P,Ae>>>24,Ae>>>16&255,Ae>>>8&255,255&Ae]},xe.fromBytes=function(P,Ae,Je){return Je?xe.fromBytesLE(P,Ae):xe.fromBytesBE(P,Ae)},xe.fromBytesLE=function(P,Ae){return new xe(P[0]|P[1]<<8|P[2]<<16|P[3]<<24,P[4]|P[5]<<8|P[6]<<16|P[7]<<24,Ae)},xe.fromBytesBE=function(P,Ae){return new xe(P[4]<<24|P[5]<<16|P[6]<<8|P[7],P[0]<<24|P[1]<<16|P[2]<<8|P[3],Ae)}},340:(zt,Ft,xe)=>{var tt=xe(471),Mi=xe(992),rt=xe(657),Ln=xe(583),Fe=xe(929),Qe=xe(83),Ct=xe(818);Ct.alea=tt,Ct.xor128=Mi,Ct.xorwow=rt,Ct.xorshift7=Ln,Ct.xor4096=Fe,Ct.tychei=Qe,zt.exports=Ct},471:function(zt,Ft,xe){var tt;!function(Mi,rt,Ln){function Fe(G){var ye=this,De=function Oe(){var G=4022871197;return function(De){De=String(De);for(var ce=0;ce<De.length;ce++){var _e=.02519603282416938*(G+=De.charCodeAt(ce));_e-=G=_e>>>0,G=(_e*=G)>>>0,G+=4294967296*(_e-=G)}return 2.3283064365386963e-10*(G>>>0)}}();ye.next=function(){var ce=2091639*ye.s0+2.3283064365386963e-10*ye.c;return ye.s0=ye.s1,ye.s1=ye.s2,ye.s2=ce-(ye.c=0|ce)},ye.c=1,ye.s0=De(" "),ye.s1=De(" "),ye.s2=De(" "),ye.s0-=De(G),ye.s0<0&&(ye.s0+=1),ye.s1-=De(G),ye.s1<0&&(ye.s1+=1),ye.s2-=De(G),ye.s2<0&&(ye.s2+=1),De=null}function Qe(G,ye){return ye.c=G.c,ye.s0=G.s0,ye.s1=G.s1,ye.s2=G.s2,ye}function Ct(G,ye){var De=new Fe(G),ce=ye&&ye.state,_e=De.next;return _e.int32=function(){return 4294967296*De.next()|0},_e.double=function(){return _e()+11102230246251565e-32*(2097152*_e()|0)},_e.quick=_e,ce&&("object"==typeof ce&&Qe(ce,De),_e.state=function(){return Qe(De,{})}),_e}rt&&rt.exports?rt.exports=Ct:xe.amdD&&xe.amdO?void 0!==(tt=function(){return Ct}.call(Ft,xe,Ft,rt))&&(rt.exports=tt):this.alea=Ct}(0,zt=xe.nmd(zt))},83:function(zt,Ft,xe){var tt;!function(Mi,rt,Ln){function Fe(Oe){var G=this,ye="";G.next=function(){var ce=G.b,_e=G.c,$e=G.d,je=G.a;return ce=ce<<25^ce>>>7^_e,_e=_e-$e|0,$e=$e<<24^$e>>>8^je,je=je-ce|0,G.b=ce=ce<<20^ce>>>12^_e,G.c=_e=_e-$e|0,G.d=$e<<16^_e>>>16^je,G.a=je-ce|0},G.a=0,G.b=0,G.c=-1640531527,G.d=1367130551,Oe===Math.floor(Oe)?(G.a=Oe/4294967296|0,G.b=0|Oe):ye+=Oe;for(var De=0;De<ye.length+20;De++)G.b^=0|ye.charCodeAt(De),G.next()}function Qe(Oe,G){return G.a=Oe.a,G.b=Oe.b,G.c=Oe.c,G.d=Oe.d,G}function Ct(Oe,G){var ye=new Fe(Oe),De=G&&G.state,ce=function(){return(ye.next()>>>0)/4294967296};return ce.double=function(){do{var je=((ye.next()>>>11)+(ye.next()>>>0)/4294967296)/(1<<21)}while(0===je);return je},ce.int32=ye.next,ce.quick=ce,De&&("object"==typeof De&&Qe(De,ye),ce.state=function(){return Qe(ye,{})}),ce}rt&&rt.exports?rt.exports=Ct:xe.amdD&&xe.amdO?void 0!==(tt=function(){return Ct}.call(Ft,xe,Ft,rt))&&(rt.exports=tt):this.tychei=Ct}(0,zt=xe.nmd(zt))},992:function(zt,Ft,xe){var tt;!function(Mi,rt,Ln){function Fe(Oe){var G=this,ye="";G.x=0,G.y=0,G.z=0,G.w=0,G.next=function(){var ce=G.x^G.x<<11;return G.x=G.y,G.y=G.z,G.z=G.w,G.w^=G.w>>>19^ce^ce>>>8},Oe===(0|Oe)?G.x=Oe:ye+=Oe;for(var De=0;De<ye.length+64;De++)G.x^=0|ye.charCodeAt(De),G.next()}function Qe(Oe,G){return G.x=Oe.x,G.y=Oe.y,G.z=Oe.z,G.w=Oe.w,G}function Ct(Oe,G){var ye=new Fe(Oe),De=G&&G.state,ce=function(){return(ye.next()>>>0)/4294967296};return ce.double=function(){do{var je=((ye.next()>>>11)+(ye.next()>>>0)/4294967296)/(1<<21)}while(0===je);return je},ce.int32=ye.next,ce.quick=ce,De&&("object"==typeof De&&Qe(De,ye),ce.state=function(){return Qe(ye,{})}),ce}rt&&rt.exports?rt.exports=Ct:xe.amdD&&xe.amdO?void 0!==(tt=function(){return Ct}.call(Ft,xe,Ft,rt))&&(rt.exports=tt):this.xor128=Ct}(0,zt=xe.nmd(zt))},929:function(zt,Ft,xe){var tt;!function(Mi,rt,Ln){function Fe(Oe){var G=this;G.next=function(){var $e,je,De=G.w,ce=G.X,_e=G.i;return G.w=De=De+1640531527|0,je=ce[_e+34&127],$e=ce[_e=_e+1&127],je^=je<<13,$e^=$e<<17,je=ce[_e]=(je^=je>>>15)^($e^=$e>>>12),G.i=_e,je+(De^De>>>16)|0},function ye(De,ce){var _e,$e,je,un,os,Gi=[],aa=128;for(ce===(0|ce)?($e=ce,ce=null):(ce+="\0",$e=0,aa=Math.max(aa,ce.length)),je=0,un=-32;un<aa;++un)ce&&($e^=ce.charCodeAt((un+32)%ce.length)),0===un&&(os=$e),$e^=$e<<10,$e^=$e>>>15,$e^=$e<<4,$e^=$e>>>13,un>=0&&(je=0==(_e=Gi[127&un]^=$e+(os=os+1640531527|0))?je+1:0);for(je>=128&&(Gi[127&(ce&&ce.length||0)]=-1),je=127,un=512;un>0;--un)$e=Gi[je+34&127],_e=Gi[je=je+1&127],$e^=$e<<13,_e^=_e<<17,Gi[je]=($e^=$e>>>15)^(_e^=_e>>>12);De.w=os,De.X=Gi,De.i=je}(G,Oe)}function Qe(Oe,G){return G.i=Oe.i,G.w=Oe.w,G.X=Oe.X.slice(),G}function Ct(Oe,G){null==Oe&&(Oe=+new Date);var ye=new Fe(Oe),De=G&&G.state,ce=function(){return(ye.next()>>>0)/4294967296};return ce.double=function(){do{var je=((ye.next()>>>11)+(ye.next()>>>0)/4294967296)/(1<<21)}while(0===je);return je},ce.int32=ye.next,ce.quick=ce,De&&(De.X&&Qe(De,ye),ce.state=function(){return Qe(ye,{})}),ce}rt&&rt.exports?rt.exports=Ct:xe.amdD&&xe.amdO?void 0!==(tt=function(){return Ct}.call(Ft,xe,Ft,rt))&&(rt.exports=tt):this.xor4096=Ct}(0,zt=xe.nmd(zt))},583:function(zt,Ft,xe){var tt;!function(Mi,rt,Ln){function Fe(Oe){var G=this;G.next=function(){var _e,$e,De=G.x,ce=G.i;return _e=De[ce],$e=(_e^=_e>>>7)^_e<<24,$e^=(_e=De[ce+1&7])^_e>>>10,$e^=(_e=De[ce+3&7])^_e>>>3,$e^=(_e=De[ce+4&7])^_e<<7,_e=De[ce+7&7],De[ce]=$e^=(_e^=_e<<13)^_e<<9,G.i=ce+1&7,$e},function ye(De,ce){var _e,je=[];if(ce===(0|ce))je[0]=ce;else for(ce=""+ce,_e=0;_e<ce.length;++_e)je[7&_e]=je[7&_e]<<15^ce.charCodeAt(_e)+je[_e+1&7]<<13;for(;je.length<8;)je.push(0);for(_e=0;_e<8&&0===je[_e];++_e);for(8==_e&&(je[7]=-1),De.x=je,De.i=0,_e=256;_e>0;--_e)De.next()}(G,Oe)}function Qe(Oe,G){return G.x=Oe.x.slice(),G.i=Oe.i,G}function Ct(Oe,G){null==Oe&&(Oe=+new Date);var ye=new Fe(Oe),De=G&&G.state,ce=function(){return(ye.next()>>>0)/4294967296};return ce.double=function(){do{var je=((ye.next()>>>11)+(ye.next()>>>0)/4294967296)/(1<<21)}while(0===je);return je},ce.int32=ye.next,ce.quick=ce,De&&(De.x&&Qe(De,ye),ce.state=function(){return Qe(ye,{})}),ce}rt&&rt.exports?rt.exports=Ct:xe.amdD&&xe.amdO?void 0!==(tt=function(){return Ct}.call(Ft,xe,Ft,rt))&&(rt.exports=tt):this.xorshift7=Ct}(0,zt=xe.nmd(zt))},657:function(zt,Ft,xe){var tt;!function(Mi,rt,Ln){function Fe(Oe){var G=this,ye="";G.next=function(){var ce=G.x^G.x>>>2;return G.x=G.y,G.y=G.z,G.z=G.w,G.w=G.v,(G.d=G.d+362437|0)+(G.v=G.v^G.v<<4^ce^ce<<1)|0},G.x=0,G.y=0,G.z=0,G.w=0,G.v=0,Oe===(0|Oe)?G.x=Oe:ye+=Oe;for(var De=0;De<ye.length+64;De++)G.x^=0|ye.charCodeAt(De),De==ye.length&&(G.d=G.x<<10^G.x>>>4),G.next()}function Qe(Oe,G){return G.x=Oe.x,G.y=Oe.y,G.z=Oe.z,G.w=Oe.w,G.v=Oe.v,G.d=Oe.d,G}function Ct(Oe,G){var ye=new Fe(Oe),De=G&&G.state,ce=function(){return(ye.next()>>>0)/4294967296};return ce.double=function(){do{var je=((ye.next()>>>11)+(ye.next()>>>0)/4294967296)/(1<<21)}while(0===je);return je},ce.int32=ye.next,ce.quick=ce,De&&("object"==typeof De&&Qe(De,ye),ce.state=function(){return Qe(ye,{})}),ce}rt&&rt.exports?rt.exports=Ct:xe.amdD&&xe.amdO?void 0!==(tt=function(){return Ct}.call(Ft,xe,Ft,rt))&&(rt.exports=tt):this.xorwow=Ct}(0,zt=xe.nmd(zt))},818:function(zt,Ft,xe){var tt;!function(Mi,rt,Ln){var _e,Fe=256,Qe=6,Oe="random",G=Ln.pow(Fe,Qe),ye=Ln.pow(2,52),De=2*ye,ce=Fe-1;function $e(Et,qt,rn){var be=[],ae=Gi(os((qt=1==qt?{entropy:!0}:qt||{}).entropy?[Et,wr(rt)]:Et??function aa(){try{var Et;return _e&&(Et=_e.randomBytes)?Et=Et(Fe):(Et=new Uint8Array(Fe),(Mi.crypto||Mi.msCrypto).getRandomValues(Et)),wr(Et)}catch{var qt=Mi.navigator,rn=qt&&qt.plugins;return[+new Date,Mi,rn,Mi.screen,wr(rt)]}}(),3),be),P=new je(be),Ae=function(){for(var Je=P.g(Qe),Lt=G,Rt=0;Je<ye;)Je=(Je+Rt)*Fe,Lt*=Fe,Rt=P.g(1);for(;Je>=De;)Je/=2,Lt/=2,Rt>>>=1;return(Je+Rt)/Lt};return Ae.int32=function(){return 0|P.g(4)},Ae.quick=function(){return P.g(4)/4294967296},Ae.double=Ae,Gi(wr(P.S),rt),(qt.pass||rn||function(Je,Lt,Rt,Qt){return Qt&&(Qt.S&&un(Qt,P),Je.state=function(){return un(P,{})}),Rt?(Ln[Oe]=Je,Lt):Je})(Ae,ae,"global"in qt?qt.global:this==Ln,qt.state)}function je(Et){var qt,rn=Et.length,be=this,ae=0,P=be.i=be.j=0,Ae=be.S=[];for(rn||(Et=[rn++]);ae<Fe;)Ae[ae]=ae++;for(ae=0;ae<Fe;ae++)Ae[ae]=Ae[P=ce&P+Et[ae%rn]+(qt=Ae[ae])],Ae[P]=qt;(be.g=function(Je){for(var Lt,Rt=0,Qt=be.i,Ei=be.j,di=be.S;Je--;)Lt=di[Qt=ce&Qt+1],Rt=Rt*Fe+di[ce&(di[Qt]=di[Ei=ce&Ei+Lt])+(di[Ei]=Lt)];return be.i=Qt,be.j=Ei,Rt})(Fe)}function un(Et,qt){return qt.i=Et.i,qt.j=Et.j,qt.S=Et.S.slice(),qt}function os(Et,qt){var ae,rn=[],be=typeof Et;if(qt&&"object"==be)for(ae in Et)try{rn.push(os(Et[ae],qt-1))}catch{}return rn.length?rn:"string"==be?Et:Et+"\0"}function Gi(Et,qt){for(var be,rn=Et+"",ae=0;ae<rn.length;)qt[ce&ae]=ce&(be^=19*qt[ce&ae])+rn.charCodeAt(ae++);return wr(qt)}function wr(Et){return String.fromCharCode.apply(0,Et)}if(Gi(Ln.random(),rt),zt.exports){zt.exports=$e;try{_e=xe(42)}catch{}}else void 0!==(tt=function(){return $e}.call(Ft,xe,Ft,zt))&&(zt.exports=tt)}(typeof self<"u"?self:this,[],Math)},410:()=>{},628:()=>{},601:()=>{},792:()=>{},977:()=>{},42:()=>{}},zt=>{zt(zt.s=317)}]);